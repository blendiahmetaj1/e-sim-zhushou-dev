// ==UserScript==
// @name         e-sim助手
// @namespace    esim
// @version      2.5.7.8-release
// @description  e-sim增强功能，本版本为功能测试版，使用中可能会出现问题，如果影响正常使用可以换回之前版本。
// @author       E-sim插件开发组
// @match        http://*.e-sim.org/*
// @match        https://*.e-sim.org/*
// @require      http://cdn.e-sim.org/js/jquery-1.8.3.min.js
// @grant        GM_setClipboard
// @grant        GM_addStyle
// @grant        unsafewindow
// ==/UserScript==

// 前排提醒：如果你发现网页显示有问题，请先自行尝试 Ctrl+F5 刷新，如果问题依旧再来向开发组求助
// 前排提醒：如果战场输出或补充体力时出现404错误，请删除cookies并重新登录（chrome可以进入 chrome://settings/siteData 搜索服务器名，点▶进去，除了本地存储和数据库存储外全删）
// 前排提醒：如果你需要在游戏内截图并分享给国外玩家，请先关闭esim插件再截图

// 招人：E-sim插件开发组长期招收程序设计、编写、测试、优化、女装人员，要求：是活人就行
// 插件开发群：462288323 ，各位大佬进来拿插件也行呀

// ChangeLog
// 2.5.7.*：修正已知bug：初次使用插件加载国家失败、战场页原打枪按钮未绑定插件功能；预置最近输出；新的战场消耗统计；
// 2.5.7版本：发送战况到discord；简单的自动攻击；战斗显示网络错误信息；战场页终止请求；战斗方国旗修正；特殊道具页快捷菜单；在线玩家页增强功能；装备属性刷新和升级提示；请求超时设定；一些细节改进；
// 2.5.6版本：删除语音闹钟功能；修正国旗问题（请不要再使用其他修正国旗错位插件）；预约战场；快捷站点；个人消耗统计；记录玩家暴击和免体buff；修正战场飞行结果判断问题；一些优化和改进；
// 2.5.5版本：紧凑式战场界面；战场列表筛选、复制战场信息、显示T5时间；分解确认；观战列表点击国家可以查看在线玩家；在线玩家详细信息；存储战场飞行设置；替换会员原观战框；
// 2.5.4版本：添加显示全部战场功能；添加战场消耗统计功能；战场飞行可以在原网页刷新攻击框；攻击返回404时切换协议；战场飞行显示机票数量；应对profile界面更改；一些优化和改进；更新jqplot
// 2.5.3版本：插件内所有后生成的国旗均使用新国旗样式；更改本地加成地区判断；添加对联盟成员国的显示；添加桌面通知战场提醒；给闹钟加音效（大文件会有延迟）；上调“直接使用医疗包”按钮位置；修正Kekistan的国家缩写；战场界面功能框下移；会员上移观战框；修正一些小问题；稍微更改界面；
// 2.5.2版本：修正非起义战的防守方本地加成地区；添加国旗选择列的清空和锁定功能；添加战场中无需确认使用医疗包的功能；战场页面修改网页标题
// 2.5.1版本：修正从2.4.8版本以来因页面样式更新导致的各种功能失效的问题；添加显示货币市场玩家国籍的功能；在战场推测观战玩家中添加根据联盟分类玩家的功能；添加隐藏首页左上角提醒框的功能
//------------2.4.8及之前版本开发者：c*******, z*****，之后版本均由E-sim插件开发组维护------------


var G=[];var aG=unsafeWindow.$.ajax;var M=$.ajax;unsafeWindow.$.ajax=function(){var aO=Array.prototype.slice.call(arguments);var aP=aG.apply(this,aO);G.push(aP);return aP};$.ajax=function(){var aO=Array.prototype.slice.call(arguments);var aP=M.apply(this,aO);G.push(aP);return aP};function Z(){$.each(G,function(aO,aP){aP.abort()});G=[]};!function(aO){"function"==typeof define&&define.amd?define(["jquery"],aO):"object"==typeof exports?aO(require("jquery")):aO(jQuery)}(function(aP,aO){function aR(aT,aS,aV,aU){return !(aT.selector!=aS.selector||aT.context!=aS.context||aV&&aV.$lqguid!=aS.fn.$lqguid||aU&&aU.$lqguid!=aS.fn2.$lqguid)}aP.extend(aP.fn,{livequery:function(aS,aV){var aU,aT=this;return aP.each(aQ.queries,function(aW,aX){return aR(aT,aX,aS,aV)?(aU=aX)&&!1:void 0}),aU=aU||new aQ(aT.selector,aT.context,aS,aV),aU.stopped=!1,aU.run(),aT},expire:function(aS,aU){var aT=this;return aP.each(aQ.queries,function(aV,aW){aR(aT,aW,aS,aU)&&!aT.stopped&&aQ.stop(aW.id)}),aT}});var aQ=aP.livequery=function(aS,aW,aV,aU){var aT=this;return aT.selector=aS,aT.context=aW,aT.fn=aV,aT.fn2=aU,aT.elements=aP([]),aT.stopped=!1,aT.id=aQ.queries.push(aT)-1,aV.$lqguid=aV.$lqguid||aQ.guid++,aU&&(aU.$lqguid=aU.$lqguid||aQ.guid++),aT};aQ.prototype={stop:function(){var aS=this;aS.stopped||(aS.fn2&&aS.elements.each(aS.fn2),aS.elements=aP([]),aS.stopped=!0)},run:function(){var aS=this;if(!aS.stopped){var aW=aS.elements,aV=aP(aS.selector,aS.context),aU=aV.not(aW),aT=aW.not(aV);aS.elements=aV,aU.each(aS.fn),aS.fn2&&aT.each(aS.fn2)}}},aP.extend(aQ,{guid:0,queries:[],queue:[],running:!1,timeout:null,registered:[],checkQueue:function(){if(aQ.running&&aQ.queue.length){for(var aS=aQ.queue.length;aS--;){aQ.queries[aQ.queue.shift()].run()}}},pause:function(){aQ.running=!1},play:function(){aQ.running=!0,aQ.run()},registerPlugin:function(){aP.each(arguments,function(aS,aU){if(aP.fn[aU]&&!(aP.inArray(aU,aQ.registered)>0)){var aT=aP.fn[aU];aP.fn[aU]=function(){var aV=aT.apply(this,arguments);return aQ.run(),aV},aQ.registered.push(aU)}})},run:function(aS){aS!==aO?aP.inArray(aS,aQ.queue)<0&&aQ.queue.push(aS):aP.each(aQ.queries,function(aT){aP.inArray(aT,aQ.queue)<0&&aQ.queue.push(aT)}),aQ.timeout&&clearTimeout(aQ.timeout),aQ.timeout=setTimeout(aQ.checkQueue,20)},stop:function(aS){aS!==aO?aQ.queries[aS].stop():aP.each(aQ.queries,aQ.prototype.stop)}}),aQ.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove","html","prop","removeProp"),aP(function(){aQ.play()})});ax();function ax(){aO();function aP(aQ){var aT=[];for(var aS=0;aS<aQ.length;aS++){aT.push(aR(aQ[aS]))}return aT;function aR(a2){if(a2==""){return""}var a1="EsimHelper";if(a2==undefined||a2.length<8){return""}var a5="";for(var aY=0;aY<a1.length;aY++){a5+=a1.charCodeAt(aY).toString()}var a3=Math.floor(a5.length/5),aX=parseInt(a5.charAt(a3)+a5.charAt(a3*2)+a5.charAt(a3*3)+a5.charAt(a3*4)+a5.charAt(a3*5)),aV=Math.round(a1.length/2),a4=Math.pow(2,31)-1,aZ=parseInt(a2.substring(a2.length-8,a2.length),16);a2=a2.substring(0,a2.length-8);a5+=aZ;while(a5.length>10){a5=(parseInt(a5.substring(0,10))+parseInt(a5.substring(10,a5.length))).toString()}a5=(aX*a5+aV)%a4;var aU="",aW="";for(var aY=0,a0=a2.length;aY<a0;aY+=2){aU=parseInt(parseInt(a2.substring(aY,aY+2),16)^Math.floor((a5/a4)*255));aW+=String.fromCharCode(aU);a5=(aX*a5+aV)%a4}return decodeURIComponent(aW)}}function aO(){if(location.pathname=="/maintenance.html"){setTimeout(function(){location.pathname="/index.html"},10000);return}var aT=[];var aQ=aP(aT);var aS=$("a[href^='profile.html']",$("#userAvatar")).attr("href");var aR=window.location.host.split(".")[0].toLowerCase()+aS.replace("profile.html?id=","");if($.inArray(aR,aQ)>=0){return false}else{return r()}}}function r(){if($(".time").length!==2){console.log("未登录，e-sim助手停止运行");return}if($(".time:first").text().match(/-/g).length!=2){console.log("官方脚本还未执行，e-sim助手等待0.5秒");setTimeout(r,500);return}if($("#ehIcon2").length>0){console.log("已运行e-sim助手");return}aJ();u();an();aM();y();ao();al();e();if(document.URL.search("html")!=-1){var aO=document.URL.match("/([a-zA-Z0-9]+).html")[1];document.title="e-Sim - "+location.host.split(".")[0]+" - "+aO;switch(aO){case"index":S();break;case"profile":var aP=parseInt(document.URL.match("/profile.html[?]id=([0-9]+)")[1]);U(aP,$("body"));N(aP);break;case"citizensOnline":A();break;case"militaryUnitCompanies":case"companies":m();break;case"myMilitaryUnit":case"militaryUnit":ap();break;case"statistics":ae();break;case"storage":ag();break;case"monetaryMarket":q($("body"));ac();break;case"battle":W();break;case"battles":aF();break;case"battleStatistics":J();break;case"showEquipment":t();break;case"companyAllWorkers":ay();break;default:console.log(aO);break}}else{S()}}function S(){var aO=$("#frontPagePushQuestion");if(aO.length>0){aO.hide()}}function e(){GM_addStyle(".xflagsSmall{display:inline-block;vertical-align:bottom;margin:1px!important;padding:0!important;} .xflagsMedium{display:inline-block;} .xflagsBig{display:inline-block;} ")}function w(aQ){try{var aO=aQ.split(" ")[1];return aO.substring(aO.indexOf("-")+1)}catch(aP){return"未知"}}function b(){return parseInt($("#time2").text())}function aB(aS,aO){var aQ=aO.split(":");var aP=aS.split("-");var aR=new Date(aP[2],parseInt(aP[1])-1,aP[0],aQ[0],aQ[1],aQ[2],0);return Date.parse(aR)}function av(aP,aQ){var aO=b();if(aO-aP<aQ*1000){return false}return true}function aH(aO,aP){if(aO&&"date" in aO){return av(aO.date,aP)}return true}function aL(aO,aQ){var aP=JSON.parse(localStorage.getItem(aO));return aH(aP,aQ)}function ar(aO){aO.date=b()}function aj(aR){var aS=parseInt(aR/(24*3600*1000));aR-=aS*24*3600*1000;var aQ=parseInt(aR/(3600*1000));aR-=aQ*3600*1000;var aO=parseInt(aR/(60*1000));var aP="";if(aS>0){aP+=aS+"d"}if(aQ>0){aP+=aQ+"h"}if(aO>0){aP+=aO+"m"}return aP?aP:"0m"}function p(aR){var aS=parseInt(aR/(24*3600*1000));aR-=aS*24*3600*1000;var aQ=parseInt(aR/(3600*1000));aR-=aQ*3600*1000;var aO=parseInt(aR/(60*1000));var aP="";if(aS>0){aP=aS+"d"}else{if(aQ>0){aP=aQ+"h"}else{if(aO>0){aP=aO+"m"}else{aP="0m"}}}return aP}function aa(aV,aU,aQ,aR,aP){var aT=$("<input>",{type:"checkbox",id:aU});var aS=$("<label>",{"class":"checkboxlabel","for":aU,text:aQ});var aO=localStorage.getItem(aR);if(aO===null){localStorage.setItem(aR,aP);aT.attr("checked",aP=="true")}else{aT.attr("checked",aO=="true")}aV.append(aT,aS);aT.click(function(){if(aT.is(":checked")){localStorage.setItem(aR,true)}else{localStorage.setItem(aR,false)}})}function g(aT,aX,aU,aO,aP,aV){var aR=$("<p>",{style:"padding:3px; margin:3px",text:aX});var aS=$("<select>",{style:"padding:3px; margin:3px",id:aP}).appendTo(aR);for(var aQ=0;aQ<aU.length;aQ++){$("<option>",{value:aU[aQ],text:aO[aQ]}).appendTo(aS)}var aW=localStorage.getItem(aP);if(aW===null){localStorage.setItem(aP,aV);aS.val(aV)}else{aS.val(aW)}aT.append(aR);aS.change(function(){localStorage.setItem(aP,aS.val())})}function Y(aS,aR,aQ,aP){var aT=$("<input>",{type:"text",id:aQ,style:"vertical-align:5px;width:"+aR+"px;"}).appendTo(aS);var aO=localStorage.getItem(aQ);if(aO===null){localStorage.setItem(aQ,aP);aT.val(aP)}else{aT.val(aO)}aS.append(aT);aT.focus(function(){aT.css("background-color","#FFFFFF")});aT.blur(function(){if(aT.val()===""){aT.val(aP)}aT.css("background-color","#79FF79");localStorage.setItem(aQ,aT.val())})}function an(){config={};allies=JSON.parse(localStorage.getItem("allies"));enemies=JSON.parse(localStorage.getItem("enemies"));if(allies===null||enemies===null){allies=[];enemies=[]}coalitionMembers=JSON.parse(localStorage.getItem("coalitionMembers"));if(coalitionMembers===null){coalitionMembers=[]}currencyRatio=JSON.parse(localStorage.getItem("currencyRatio"));currencyRatio=currencyRatio===null?{}:currencyRatio;topCountryIds=JSON.parse(localStorage.getItem("topCountryIds"));topCountryIds=topCountryIds===null?[]:topCountryIds;var aX=$("<li>",{id:"ehIcon2"}).insertBefore($("#userAvatar"));var a8=$("<a>",{"data-dropdown":"contentDropEh",style:"padding:0 5px;",href:"#"}).appendTo(aX);var a9=$("<img>",{align:"absmiddle","class":"smallAvatar",style:"height:36px; width:36px;",src:"https://suna.e-sim.org:3000/avatars/140351_small"}).appendTo(a8);var aW=$("#contentDrop").clone().attr("id","contentDropEh").empty().insertBefore($("#contentDrop"));$("<b>",{text:"e-sim助手 版本 "+GM_info.script.version+" "}).appendTo(aW);$("<div>",{style:"text-align:left;line-height:30px;",text:"使用此脚本造成的一切后果（包括但不限于封号、经济损失）与作者无关"}).appendTo(aW);var a4=$("<table>",{id:"Eh2Config",style:"width:100%;"}).appendTo(aW);var aP=$("<tr>",{style:"line-height:30px;"}).appendTo(a4);var aT;var aZ=[["fetchCurrency","统计汇率 ","统计汇率和常用物资的价格",["currencyRatio","topCountryIds"],"扫描大国"],["fetchCitizen","统计玩家 ","估算玩家buff时间等",["citizenInfo","citizenPage","muInfo"],"扫描本页"]];for(var a2=0;a2<aZ.length;++a2){aT=$("<td>",{style:"text-align:left; background-color:SlateGray;"}).appendTo(aP);var aV=$("<label>",{"class":"checkboxlabel","for":aZ[a2][0]+"Checkbox",text:aZ[a2][1]}).appendTo(aT);var aY=$("<input>",{id:aZ[a2][0]+"Checkbox",type:"checkbox",style:"vertical-align:5px;",text:" "}).prependTo(aV);var aO=$("<button>",{id:aZ[a2][0]+"ClearButton","class":"foundation-style",style:"padding:5px; margin:5px",target:aZ[a2][3].join(" "),text:"清除"}).appendTo(aT);var a6=$("<button>",{id:aZ[a2][0]+"Scan","class":"foundation-style",style:"padding:5px; margin:5px",text:aZ[a2][4]}).appendTo(aT);aY.click(function(){var ba=$(this).attr("id")+"Disabled";if($(this).is(":checked")){localStorage.removeItem(ba)}else{localStorage.setItem(ba,"1")}});if(localStorage.getItem(aZ[a2][0]+"CheckboxDisabled")){config[aZ[a2][0]+"Disabled"]=true;aY.attr("checked",false)}else{config[aZ[a2][0]+"Disabled"]=false;aY.attr("checked",true)}aO.click(function(){var ba=$(this).attr("target").split(" ");for(var bb=0;bb<ba.length;++bb){console.log("清除",ba[bb]);localStorage.removeItem(ba[bb])}})}if(config.fetchCitizenDisabled){$("#fetchCitizenScan").hide()}else{$("#fetchCitizenScan").click(function(){$(this).attr("disabled",true);var ba=[];$("a[href*='profile.html'").each(function(){var bc=parseInt($(this).attr("href").match(/profile\.html[?]id=([0-9]+)/)[1]);if($.inArray(bc,ba)===-1){ba.push(bc)}});var bb=ba.length;$(this).text("剩余"+bb+"个");$.each(ba,function(bc,bd){$.ajax({url:"profile.html?id="+bd,success:function(be){if($(".time",be).length!==2){console.log(bd,"抓取错误，重新抓取");$.ajax(this);return}U(bd,be);$("#fetchCitizenScan").text("剩余"+(--bb)+"个");if(bb==0){$("#fetchCitizenScan").text("扫描完成")}},error:function(be,bf){console.log("抓取错误 (",bf,")，重新抓取");$.ajax(this)}})})})}a4=$("<table>",{style:"width:100%; text-align:left;"}).insertBefore($("#Eh2Config"));aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>",{id:"Eh2Homeland",text:"祖国: "}).appendTo(aP);var a0=$("<select>",{style:"padding:3px; margin:3px",id:"Eh2HomelandSelect"}).appendTo(aT);for(var a2=0;a2<countryIds.length;++a2){$("<option>",{value:countryIds[a2],text:countryInfo[countryIds[a2]].name}).appendTo(a0)}var aR=$("option",a0).sort(function(bb,ba){return $(bb).text().localeCompare($(ba).text())});a0.html(aR);a0.change(a1);var a5=$("<button>",{id:"refreshAlliesAndEnemies","class":"foundation-style",style:"padding:5px; margin:5px",text:"更新盟国和敌国"}).appendTo(aT);a5.click(a1);aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>",{text:"盟国: "}).appendTo(aP);var a7=$("<b>",{id:"Eh2Allies",text:"更新中..."}).appendTo(aT);aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>",{text:"敌国: "}).appendTo(aP);a7=$("<b>",{id:"Eh2Enemies",text:"更新中..."}).appendTo(aT);aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>",{text:"联盟成员国: "}).appendTo(aP);a7=$("<b>",{id:"Eh2CoalitionMembers",text:"更新中..."}).appendTo(aT);if(allies.length===0){a0[0].selectedIndex=0;a1()}else{a0.val(allies[0]);aQ()}function a1(){var ba=parseInt(a0.val());a0.attr("disabled",true);a5.attr("disabled",true);$("~ div.xflagsSmall",a0).remove();$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[ba].flagName,style:"vertical-align:middle;",value:ba,title:countryInfo[ba].name}).insertAfter(a0);console.log("正在更新"+countryInfo[ba].name+"的盟国和敌国信息");allies=[ba];enemies=[];coalitionMembers=[];$("#Eh2Allies").html("更新中...");$("#Eh2Enemies").html("更新中...");$("#Eh2CoalitionMembers").html("更新中...");$.ajax({url:"countryPoliticalStatistics.html?countryId="+ba,success:function(bg){var bf=$("div.xflagsMedium",$("table.dataTable:last",bg));bf.each(function(){var bi=$(this);var bh=bi.attr("class").split(" ").pop();bh=bh.substring(bh.indexOf("-")+1);allies.push(countryInfo[bh].id)});var bd=$("div.xflagsMedium",$("table.dataTable:eq(-2)",bg));bd.each(function(){var bi=$(this);var bh=w(bi.attr("class"));if(countryInfo[bh].id!==ba){enemies.push(countryInfo[bh].id)}});var bc=$("h2",bg);var be;if(bc.length>4){be=bc[2]}else{be=bc[1]}if(be.innerText.split(" ")[0]=="Coalition"){var bb=$(be,bg).nextAll("div.xflagsSmall");bb.each(function(){var bh=$(this).attr("class").split(" ").pop();bh=bh.substring(bh.indexOf("-")+1);coalitionMembers.push(countryInfo[bh].id)})}localStorage.setItem("allies",JSON.stringify(allies));localStorage.setItem("enemies",JSON.stringify(enemies));localStorage.setItem("coalitionMembers",JSON.stringify(coalitionMembers));aQ();a0.attr("disabled",false);a5.attr("disabled",false)},error:function(bb,bc){console.log("抓取错误 (",bc,")，重新抓取");$.ajax(this)}})}function aQ(){$("~ div.xflagsSmall",a0).remove();$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[allies[0]].flagName,style:"vertical-align:middle;",value:allies[0],title:countryInfo[allies[0]].name}).insertAfter(a0);$("#Eh2Allies").text("");$("#Eh2Enemies").text("");$("#Eh2CoalitionMembers").text("");for(var ba=1;ba<allies.length;++ba){countryId=allies[ba];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2Allies"))}for(var ba=0;ba<enemies.length;++ba){countryId=enemies[ba];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2Enemies"))}for(var ba=0;ba<coalitionMembers.length;++ba){countryId=coalitionMembers[ba];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2CoalitionMembers"))}}if(config.fetchCurrencyDisabled){$("#fetchCurrencyScan").hide()}else{var a4=$("<table>",{id:"Eh2CurrencyRatios",style:"width:100%;"}).appendTo(aW);if(topCountryIds.length===0){console.log("查看人口和生产力前5的国家");$.ajax({url:"countryStatistics.html?statisticType=PRODUCTIVITY",success:function(ba){$("div.xflagsMedium:lt(5)",ba).each(function(){var bb=$(this).attr("class").split(" ").pop();bb=bb.substring(bb.indexOf("-")+1);topCountryIds.push(bb)});if(topCountryIds.length===10){aS()}},error:function(ba,bb){console.log("抓取错误 (",bb,")，重新抓取");$.ajax(this)}});$.ajax({url:"countryStatistics.html?statisticType=CITIZENS",success:function(ba){$("div.xflagsMedium:lt(5)",ba).each(function(){var bb=$(this).attr("class").split(" ").pop();bb=bb.substring(bb.indexOf("-")+1);topCountryIds.push(bb)});if(topCountryIds.length===10){aS()}},error:function(ba,bb){console.log(name,"抓取错误 (",bb,")，重新抓取");$.ajax(this)}})}else{aS()}}function aS(){if(config.fetchCurrencyDisabled){return}var bm=[parseInt($("#Eh2HomelandSelect").val())];for(var bd=0;bd<topCountryIds.length;++bd){if(topCountryIds[bd]&&countryInfo[topCountryIds[bd]]){var bb=countryInfo[topCountryIds[bd]].id;if($.inArray(bb,bm)===-1){bm.push(bb)}}}topCountryIds=bm;localStorage.setItem("topCountryIds",JSON.stringify(topCountryIds));a4=$("#Eh2CurrencyRatios");a4.empty();var bh=$("<tr>",{style:"line-height:30px;"}).appendTo(a4);var ba=$("<td>",{style:"background-color:DarkSlateGray;",text:"货币"}).appendTo(bh);var bc=$("<tr>",{style:"line-height:30px;"}).appendTo(a4);var bl=$("<td>",{style:"background-color:DarkSlateGray;",html:"买 1<div class='xflagsSmall xflagsSmall-Gold' style='vertical-align:middle;' />"}).appendTo(bc);var bg=$("<tr>",{style:"line-height:30px;"}).appendTo(a4);var bf=$("<td>",{style:"background-color:DarkSlateGray;",html:"卖 1<div class='xflagsSmall xflagsSmall-Gold' style='vertical-align:middle;' />"}).appendTo(bg);for(var bd=0;bd<topCountryIds.length;++bd){var bj=topCountryIds[bd];var bk=ba.clone().text("").insertAfter(ba);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bj].flagName,style:"vertical-align:middle;"}).appendTo(bk);bk=bl.clone().text("").insertAfter(bl);var bi=$("<a>",{href:"monetaryMarket.html?buyerCurrencyId=0&sellerCurrencyId="+bj,text:"???"}).appendTo(bk);if(currencyRatio[bj]!==undefined&&currencyRatio[bj].sell!==undefined){bi.html(""+parseFloat(currencyRatio[bj].sell.ratio).toFixed(2)).after($("<div>",{style:"font-size:10px;",text:p(b()-currencyRatio[bj].sell.date)}))}bk=bf.clone().text("").insertAfter(bf);bi=$("<a>",{href:"monetaryMarket.html?buyerCurrencyId="+bj+"&sellerCurrencyId=0",text:"???"}).appendTo(bk);if(currencyRatio[bj]!==undefined&&currencyRatio[bj].buy!==undefined){bi.html(""+parseFloat(currencyRatio[bj].buy.ratio).toFixed(2)).after($("<div>",{style:"font-size:10px;",text:p(b()-currencyRatio[bj].buy.date)}))}}var be=$("#fetchCurrencyScan");be.click(function(){var bn=$("a",$("#Eh2CurrencyRatios")).length;$(this).attr("disabled",true).text("剩余"+bn+"个");$("a",$("#Eh2CurrencyRatios")).each(function(){$.ajax({url:$(this).attr("href"),success:function(bo){if($(".time",bo).length!==2){console.log("汇率抓取错误，重新抓取");$.ajax(this);return}q(bo);be.text("剩余"+(--bn)+"个");if(bn===0){$("#fetchCurrencyScan").text("扫描完成");aS()}},error:function(bo,bp){console.log("抓取错误 (",bp,")，重新抓取");$.ajax(this)}})})})}a4=$("<table>",{style:"width:100%; text-align:left;"}).insertBefore($("#Eh2Config"));aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>",{id:"FavoriteCountriesConfig"}).appendTo(aP);var aU=$("<button>",{id:"clearFavoriteCountries","class":"foundation-style",style:"padding:5px; margin:5px",text:"清空国旗选择列"}).appendTo(aT);aU.click(function(){$(this).attr("disabled",true);localStorage.removeItem("favoriteCountries")});aa(aT,"lockFavoriteCountries","锁定国旗选择列","lockFavoriteCountries",false);aP=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a4);aT=$("<td>").appendTo(aP);var a3=$("<button>",{id:"btnBattleSettings","class":"foundation-style",style:"padding:5px; margin:5px",text:"战场设置"}).appendTo(aT);a3.click(function(){a3.attr({disabled:true});aK()});varEnableBattleAjaxTimeout=localStorage.getItem("enableBattleAjaxTimeout");if(varEnableBattleAjaxTimeout!="true"){varEnableBattleAjaxTimeout=false}else{varEnableBattleAjaxTimeout=true}varBattleAjaxTimeout=parseInt(localStorage.getItem("battleAjaxTimeout"));if(varBattleAjaxTimeout<0){varBattleAjaxTimeout=5}return}function ac(){var aQ=$("table.dataTable:first");var aO=$("<div class='testDivblue'></div>");aQ.before(aO);var aR=$("<table></table>");aO.append(aR);var aP=$("<input type='button' id='gcbtn' value='检查卖家国籍'></input> ");aR.append(aP);aR.append("检查需要等待一段时间");$("#gcbtn").click(function(){aO.remove();var aS=$("a.profileLink");for(var aT=1;aT<aS.length;aT++){aw(aS[aT])}})}function aw(aP){var aO=$(aP).attr("href").split("=")[1];$.ajax({url:"apiCitizenById.html?id="+aO,success:function(aR){var aS=JSON.parse(aR);console.log("用户",aO,"API抓取成功");var aQ=aS.citizenshipId;$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[aQ].flagName,style:"vertical-align:middle;"}).insertBefore(aP)},error:function(aQ,aR){console.log("用户",aO,"API抓取错误 (",aR,")，重新抓取");$.ajax(this)}})}function n(aO){var aP=new RegExp("(^|&)"+aO+"=([^&]*)(&|$)");var aQ=window.location.search.substr(1).match(aP);if(aQ!=null){return unescape(aQ[2])}return null}function ag(){var aO=n("storageType");if(aO=="EQUIPMENT"){am()}else{if(aO=="SPECIAL_ITEM"||aO=="SPECIAL_ITEMS"){aA();c()}}}function am(){var aP=$("#mergeItem");var aR=$("<input type='button' style='display:inline-block;' id='eeqbtn' value='自定义拍卖'></input> ");aR.prependTo(aP);$("#eeqbtn").click(function(){ah();$("#eeqbtn").attr({disabled:true});$("#eeqbtn").remove()});var aQ=$("<div>",{id:"confirmSplitTable",style:"display:inline-block;"});aR.after(aQ);var aO=$("<input>",{type:"checkbox",id:"confirmSplitCheckbox"}).appendTo(aQ);var aS=$("<label>",{"class":"checkboxlabel","for":"confirmSplitCheckbox",text:"分解前确认"}).appendTo(aQ);var aT=localStorage.getItem("confirmSplit");if(aT!==null){aO.attr("checked",aT=="true");if(aT==="true"){$(".foundation-style.button.splitItemsButton").parent().attr("onSubmit","return confirm('确定要分解吗？')")}}aO.click(function(){if(aO.is(":checked")){localStorage.setItem("confirmSplit",true)}else{localStorage.setItem("confirmSplit",false)}location=location})}function ae(){var aO=n("selectedSite");if(aO=="MILITARY_UNIT"){B()}}function aJ(){countryIds=JSON.parse(localStorage.getItem("countryIds"));countryInfo=JSON.parse(localStorage.getItem("countryInfo"));regionInfo=JSON.parse(localStorage.getItem("regionInfo"));muInfo=JSON.parse(localStorage.getItem("muInfo"))||{};var aU=[["apiCountries.html",3600*24],["apiRegions.html",3600*24],["apiMap.html",600]];var aP=aU.length;for(var aT=0;aT<aU.length;++aT){var aS=aU[aT][0];var aV=aU[aT][1];var aR=localStorage.getItem(aS+".date");if(av(aR,aV)){aQ(aS)}else{aP--}}function aQ(aW){$.ajax({url:aW,success:function(aX){localStorage.setItem(aW,aX);localStorage.setItem(aW+".date",b());console.log(aW,"抓取成功");if(--aP===0){aO()}},error:function(aX,aY){console.log(aW,"抓取错误 (",aY,")，重新抓取",aW);$.ajax(this)}})}function aO(){countryInfo={};countryIds=[];var a0=JSON.parse(localStorage.getItem("apiCountries.html"));for(var aZ=0;aZ<a0.length;++aZ){var aY=a0[aZ];aY.flagName=aY.name.replace(/ /g,"-");countryIds.push(aY.id);countryInfo[aY.id]=aY;countryInfo[aY.name]=aY;countryInfo[aY.shortName]=aY;countryInfo[aY.flagName]=aY;countryInfo[aY.currencyName]=aY}regionInfo=[];var aX=JSON.parse(localStorage.getItem("apiMap.html"));var aW=JSON.parse(localStorage.getItem("apiRegions.html"));for(aZ=0;aZ<aX.length;++aZ){regionInfo[aX[aZ].regionId]=aX[aZ]}for(aZ=0;aZ<aW.length;++aZ){var a3=aW[aZ].id;for(var a2 in aW[aZ]){regionInfo[a3][a2]=aW[aZ][a2]}}var a1={};for(var aZ=0;aZ<regionInfo.length;++aZ){var aY=regionInfo[aZ];if(aY){a1[aY.id]=aY;a1[aY.name]=aY}}localStorage.setItem("countryIds",JSON.stringify(countryIds));localStorage.setItem("countryInfo",JSON.stringify(countryInfo));localStorage.setItem("regionInfo",JSON.stringify(a1));localStorage.setItem("maxRegionCount",regionInfo.length);console.log("国家和地图信息已更新")}}function aM(){var aO=$("a[href^='profile.html']",$("#userAvatar")).attr("href");userId=parseInt(aO.replace("profile.html?id=",""));citizenInfo=JSON.parse(localStorage.getItem("citizenInfo"));if(citizenInfo===null){citizenInfo={}}citizenPage=JSON.parse(localStorage.getItem("citizenPage"));if(citizenPage===null){citizenPage={}}aE(userId);H(userId)}function z(aP,aO){if(config.fetchCitizenDisabled&&aP.id!==userId){return}if(aO===undefined){aO=true}console.log("玩家",aP.id,"(",aP.login,") API已更新");ar(aP);citizenInfo[aP.id]=aP;if(aO){localStorage.setItem("citizenInfo",JSON.stringify(citizenInfo))}}function aE(aQ,aP){if(config.fetchCitizenDisabled&&aQ!==userId){return}var aO=citizenInfo[aQ];if(aO!==undefined&&!aH(aO,600)){return}$.ajax({url:"apiCitizenById.html?id="+aQ,success:function(aR){var aS=JSON.parse(aR);z(aS,aP)},error:function(aR,aS){console.log("用户",aQ,"API抓取错误 (",aS,")，重新抓取");$.ajax(this)}})}function U(aR,aU,aQ){if(config.fetchCitizenDisabled&&aR!==userId){return}if($("#indexShortcut",aU).length===0){return}if(aQ===undefined){aQ=true}console.log("玩家",aR,"(",$(".big-login",aU).text(),")页面已更新");page=citizenPage[aR];if(page===undefined){page={}}page.avatar=$(".bigAvatar",aU).attr("src").trim();page.premium=$("img[src$='star_32.png']",aU).length==1;page.buffIcons=[];$("img[src$='_positive.png']",aU).each(function(){if($(this).attr("class")!="smallhelp"){return true}if(page.buffIcons.indexOf(this)==-1){page.buffIcons.push($(this).attr("src"))}});page.debuffIcons=[];$("img[src$='_negative.png']",aU).each(function(){if($(this).attr("class")!="smallhelp"){return true}if(page.debuffIcons.indexOf(this)==-1){page.debuffIcons.push($(this).attr("src"))}});var aP=b();var aW=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aV=[24,24,24,24,1,10,25,24,24,24];for(var aT=0;aT<aW.length;++aT){$.each(page.buffIcons,function(){if(this.indexOf(aW[aT])>0){aO(aW[aT],aP-aV[aT]*3600*1000,aP)}});$.each(page.debuffIcons,function(){if(this.indexOf(aW[aT])>0){if(page.premium){aO(aW[aT],aP-aV[aT]*2*3600*1000,aP-aV[aT]*3600*1000)}else{aO(aW[aT],aP-aV[aT]*3*3600*1000,aP-aV[aT]*3600*1000)}}});if(page[aW[aT]]===undefined){page[aW[aT]]=[aP,aP+1000*24*3600*1000]}}function aO(a0,a2,aY){if(page[a0]===undefined){page[a0]=[a2,aY]}else{var a1=page[a0][0]>a2?page[a0][0]:a2;var aZ=page[a0][1]<aY?page[a0][1]:aY;if(a1>aZ){page[a0]=[a2,aY]}else{page[a0]=[a1,aZ]}}}var aS=[];$(".equipmentBack",aU).each(function(){if($(this).attr("class").indexOf("rewardEQ")<0){aS.push($(this).attr("class").split(" ").pop())}});page.equipments=aS;var aX=$("div.rank :eq(0)",aU).parent().children("div.profile-row:eq(7)").children("span.data");if(aX.length!=0){page.lowHit=parseInt($("div#hitHelp",aU).text().split("/")[0].replace(",",""));page.highHit=parseInt($("div#hitHelp",aU).text().split("/")[1].replace(",",""));page.critical=parseFloat($("#criticalHelp",aU).text().trim().split(" ")[0]);page.miss=parseFloat($("#missHelp",aU).text().trim().split(" ")[0]);page.avoid=parseFloat($("#avoidHelp",aU).text().trim().split(" ")[0]);page.power=parseInt((page.lowHit+page.highHit)/2*(1-page.miss/100)*(1+page.critical/100)/(1-page.avoid/100)*37*5*1.2*1.2*1.2);page.strength=parseInt($("div.rank :eq(0)",aU).parent().children("div.profile-row:eq(4)").children("span.data").text());page.totalDamage=parseInt($("div.rank :eq(0)",aU).parent().children("div.profile-row:eq(2)").children("span.data").text().replace(/,/g,""))}ar(page);citizenPage[aR]=page;if(aQ){localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}}function H(aQ,aO,aR){if(config.fetchCitizenDisabled&&aQ!==userId){return}var aP=citizenPage[aQ];if(aP!==undefined&&!aH(aP,600)){if(typeof(aR)==="function"){aR()}return}$.ajax({url:"profile.html?id="+aQ,success:function(aS){U(aQ,aS,aO);if(typeof(aR)==="function"){aR()}},error:function(aU,aV){var aS=(aQ%10)*0.5+1;var aT=this;console.log("用户",aQ,"页面抓取错误 (",aV,")，",aS,"秒后重新抓取");setTimeout(function(){$.ajax(aT)},aS*1000)}})}function I(aP,aQ){if(!muInfo[aP]){muInfo[aP]={}}var aO=muInfo[aP];if(aH(aO.member,48*3600)){$.ajax({url:"apiMilitaryUnitMembers.html?id="+aP,success:function(aT){var aS=JSON.parse(aT);for(var aR=0;aR<aS.length;++aR){z(aS[aR],false)}aO.member={};ar(aO.member);localStorage.setItem("citizenInfo",JSON.stringify(citizenInfo));localStorage.setItem("muInfo",JSON.stringify(muInfo));if(typeof(aQ)==="function"){aQ()}},error:function(aT,aU){var aR=(aP%10)*0.5+1;var aS=this;console.log("军团",aP,"的成员API抓取错误 (",aU,")，",aR,"秒后重新抓取");setTimeout(function(){$.ajax(aS)},aR*1000)}})}else{console.log("军团",aP,"的成员API无需抓取");if(typeof(aQ)==="function"){aQ()}}}function N(aR){if(config.fetchCitizenDisabled&&aR!==userId){return}var aO=b();$("img[src$='_positive.png']").after("<br>");$("img[src$='_negative.png']").after("<br>");var aV=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aU=[24,24,24,24,1,10,25,24,24,24];for(var aT=0;aT<aV.length;++aT){var aS=$("img[src$='"+aV[aT]+"_positive.png']:first")[0];var aP=$("img[src$='"+aV[aT]+"_negative.png']:first")[0];var aX=citizenPage[aR][aV[aT]];if(aS){if($(aS).attr("class")=="smallhelp"){var aQ=aX[0]+aU[aT]*3600*1000-aO;var aW=aX[1]+aU[aT]*3600*1000-aO;if((aW-aQ)<60*1000){$("<b>",{text:aj(aQ)}).insertAfter(aS)}else{$("<b>",{text:aj(aQ)+" - "+aj(aW)}).insertAfter(aS)}}}if(aP){if($(aP).attr("class")=="smallhelp"){var aQ=aX[0]+aU[aT]*2*3600*1000-aO;var aW=aX[1]+aU[aT]*2*3600*1000-aO;if(!citizenPage[aR].premium){aQ+=aU[aT]*3600*1000;aW+=aU[aT]*3600*1000}if((aW-aQ)<60*1000){$("<b>",{text:aj(aW)}).insertAfter(aP)}else{$("<b>",{text:aj(aQ)+" - "+aj(aW)}).insertAfter(aP)}}}}}function aA(){var aS=$(".time:first").text().trim().split(", ");var aP=aB(aS[1],aS[0]);var aR=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aQ=[24,24,24,24,1,10,25,24,24,24];var aO=$("#userAvatar span.premiumStar").length===1;$(".specialItemInventory").each(function(){var aZ=$(this);var aU=$("strong",aZ);if(aU.length===0){return}aS=aU.text().split(" ");var aT=aB(aS[0],aS[1]);var aX=aj(aT-aP);aU.append(" ("+aX+")");var aW=$("img:first",aZ).attr("src");for(var aV=0;aV<aR.length;++aV){if(aW.indexOf(aR[aV])>=0){if(aV<4){var aY=b()+aT-aP-48*3600*1000;if(!aO){aY-=24*3600*1000}}else{var aY=b()+aT-aP-aQ[aV]*3600*1000}citizenPage[userId][aR[aV]]=[aY,aY+1];localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}}})}function c(){var aO=$("<table id='quickBuffTable' UpdateCount='0'></table>").prependTo($("#storageConteiner"));var aP=$("<tr>").appendTo(aO);var aR=$("<tr>").appendTo(aO);var aT=$("<tr>").appendTo(aO);aQ($(".specialItemInventory").parent(),aP,aR,aT);function aQ(aW,aV,aY,aZ){var aX=["medkit_big","vacations_big","spa_big","steroids_big","tank_big","painDealer1h_big","painDealer10h_big","painDealer25h_big","resistance_big","bunker_big"];var aU=["#EAC100","#00BB00","#00BB00","#FF5809","#FF5809","#9F4D95","#9F4D95","#9F4D95","#7373B9","#7373B9"];$.each(aX,function(a5,bb){var bd=$("img[src$='"+bb+".png']",aW).parent();if(bd.length<=0){return true}var a6=$(".smallhelp",bd);if(a6.length===0){return true}var a2=$('<td bgcolor="'+aU[a5]+'"></td>').appendTo(aV);a6.clone().appendTo(a2);var a7=$("span",bd).text();if(a7!=""){$("<br><b>"+a7+"</b>").appendTo(a2)}else{$("<br><br>").appendTo(a2)}var a9=$('<td bgcolor="'+aU[a5]+'"></td>').appendTo(aY);var a1=$('<td bgcolor="'+aU[a5]+'"></td>').appendTo(aZ);var a3=$(".siForms",bd);var a0=$("form",a3);if(a0.length<1){return true}else{if(a0.length==1){var bc=$("select",a0);if(bc.length<1){var a8=$('input[name="item"]',a0).attr("value");var a4=$("<input type='button' class='foundation-style button' value='使用'></input>").appendTo(a9);a4.click(function(){var be=parseInt(aO.attr("UpdateCount"))+1;aO.attr("UpdateCount",be);a4.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"item="+a8+"&storageType=SPECIAL_ITEM&action=USE",success:function(bf){aS(bf,be);console.log("使用"+a8+"：成功响应")},error:function(bf,bg){a4.val("使用失败");console.log("使用"+a8+"时发生错误")}})})}else{var a8=$('input[name="itemType"]',a0).attr("value");var ba=$("<input type='button' class='foundation-style button' value='购买'></input>").appendTo(a1);ba.click(function(){var be=parseInt(aO.attr("UpdateCount"))+1;aO.attr("UpdateCount",be);ba.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"itemType="+a8+"&storageType=SPECIAL_ITEM&action=BUY&quantity=1",success:function(bf){aS(bf,be);console.log("购买"+a8+"：成功响应")},error:function(bf,bg){ba.val("购买失败");console.log("购买"+a8+"时发生错误")}})})}}else{var a8=$('input[name="itemType"]',a0).attr("value");var a4=$("<input type='button' class='foundation-style button' value='使用'></input>").appendTo(a9);a4.click(function(){var be=parseInt(aO.attr("UpdateCount"))+1;aO.attr("UpdateCount",be);a4.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"item="+a8+"&storageType=SPECIAL_ITEM&action=USE",success:function(bf){aS(bf,be);console.log("使用"+a8+"：成功响应")},error:function(bf,bg){a4.val("使用失败");console.log("使用"+a8+"时发生错误")}})});var ba=$("<input type='button' class='foundation-style button' value='购买'></input>").appendTo(a1);ba.click(function(){var be=parseInt(aO.attr("UpdateCount"))+1;aO.attr("UpdateCount",be);ba.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"itemType="+a8+"&storageType=SPECIAL_ITEM&action=BUY&quantity=1",success:function(bf){aS(bf,be);console.log("购买"+a8+"：成功响应")},error:function(bf,bg){ba.val("购买失败");console.log("购买"+a8+"时发生错误")}})})}}})}function aS(aW,aV){var aU=aO.attr("UpdateCount");if(aV>=aU){$("td",aO).remove();aQ($(".specialItemInventory",aW).parent(),aP,aR,aT)}}}function aK(){var aR=$("<div>",{"class":"battleSettingsDiv",style:"overflow:auto; width:450px; height:auto; display:block; position:fixed; top:50%; left:50%; margin-left: -225px; margin-top: -150px; padding-bottom: 20px; text-align:center;background-color:lightgray;"}).appendTo($("body"));var aO=$('<br>战场设置<br><table class="battleSettingsTable" style="text-align:left"></table><button class="battleSettingsCancel">关闭</button><br>').appendTo(aR);var aP=$(".battleSettingsTable");var aQ=$("<tr>").appendTo(aP);var aS=$("<td>").appendTo(aQ);aa(aS,"battleEnhanceDivPlacement","战场界面功能框下移","battleEnhanceDivPlacement",false);$("<p>",{text:"观战玩家变动不会改变按钮位置。"}).appendTo(aS);aQ=$("<tr>").appendTo(aP);aS=$("<td>").appendTo(aQ);aa(aS,"battleBorderless","战场页面缩小框体间距","battleBorderless",false);$("<p>",{text:"能看到下面的玩家输出排行和实时输出伤害。"}).appendTo(aS);aQ=$("<tr>").appendTo(aP);aS=$("<td>").appendTo(aQ);aa(aS,"addEmptyRecentRecord","预置最近输出栏位","addEmptyRecentRecord",false);$("<p>",{text:"当最近输出不足5个时补充至5个栏位，以便第一时间能看到输出状况。"}).appendTo(aS);aQ=$("<tr>").appendTo(aP);aS=$("<td>").appendTo(aQ);aa(aS,"enableBattleAjaxTimeout","设定请求超时时间：","enableBattleAjaxTimeout",false);Y(aS,60,"battleAjaxTimeout","5");$("<span>",{text:" 秒"}).appendTo(aS);$("<p>",{text:"缓解因网络环境差，同时进行的请求数量多，导致后续请求被堵塞。"}).appendTo(aS);aQ=$("<tr>").appendTo(aP);aS=$("<td>").appendTo(aQ);aa(aS,"EnableAutoFight","启用自动打枪功能","EnableAutoFight",false);$("<p>",{text:"珍惜账号，慎用自动。"}).appendTo(aS);$(".battleSettingsCancel").click(function(){$("#btnBattleSettings").attr({disabled:false});aR.remove()})}function al(){var aU=$('<li class="has-dropdown">').appendTo($("ul.foundation-left"));var aO=$('<a id="quickSite" href="#"><i class="icon-pin"></i>快捷站点</a>').appendTo(aU);var aS=$('<ul class="dropdown">').appendTo(aU);var aR=$('<li><a href="#" class="quickSiteSettings">快捷站点设置</a></li>').appendTo(aS);$(".quickSiteSettings").click(function(){aT()});var aQ=JSON.parse(localStorage.getItem("quickSite"));if(aQ!=null){for(var aP=0;aP<aQ.length;aP++){$('<li><a href="'+aQ[aP].url+'" target="_blank">'+aQ[aP].name+"</a></li>").appendTo(aS)}}function aT(){var aZ=$("<div>",{"class":"quickSiteDiv",style:"overflow:auto; width:450px; height:300px; display:block; position:absolute; top:50%; left:50%; margin-left: -225px; margin-top: -150px; padding-bottom: 20px; text-align:center;background-color:lightgray;"}).appendTo($("body"));var aW=$('<br>注意: 留空“名称”一栏则表示删除该行，修改后请保存，刷新后生效<br>站外链接请以http或https开头<br>举例：名称：EC在线玩家 链接：citizensOnline.html?countryId=28<br>举例：名称：Esim贴吧 链接：https://tieba.baidu.com/f?kw=esim<table style="text-align:center; margin:auto"><tbody><tr class="EHQS"><td>名称</td><td>链接</td></tr></tbody></table><button class="quickSiteAdd">增加站点</button><button class="quickSiteComplete">保存</button><button class="quickSiteCancel">取消</button><br>').appendTo(aZ);var aV=$(".EHQS").parent();$(".quickSiteAdd").click(function(){var a0=$('<tr><td><input class="EHQSSites" type="text" style="width:100px;"></td><td><input class="EHQSSites" type="text" style="width:300px;"></td></tr>').appendTo(aV)});var aY=JSON.parse(localStorage.getItem("quickSite"));if(aY!=null){for(var aX=0;aX<aY.length;aX++){$('<tr><td><input class="EHQSSites" type="text" style="width:100px;" value="'+aY[aX].name+'"></td><td><input class="EHQSSites" type="text" style="width:300px;" value="'+aY[aX].url+'"></td></tr>').appendTo(aV)}}$(".quickSiteComplete").click(function(){var a1=[];var a0=$("tr:gt(0)",$(".EHQS").parent());a0.each(function(){var a3=$(this);var a2=$("td:eq(0)",a3).find("input")[0].value;if(a2!=""){a1.push({name:a2,url:$("td:eq(1)",a3).find("input")[0].value})}});localStorage.setItem("quickSite",JSON.stringify(a1));aZ.remove()});$(".quickSiteCancel").click(function(){aZ.remove()})}}function u(){$("select").each(function(){var aV=$(this);var aY=$("option",aV);if(aY.length<countryIds.length-3){return}var aP=false;var aQ=false;var aO=true;for(var aR=0;aR<aY.length;++aR){var aW=parseInt(aY.eq(aR).val());if(aW===0){aP=true;continue}else{if(aW===-1){aQ=true;continue}else{if(aW<-1){return}else{if($.inArray(aW,countryIds)===-1){return}else{if(aY.eq(aR).text().indexOf(countryInfo[aW].currencyName)===-1){aO=false}}}}}}var aT=$("~ input[type='submit']",aV);aV.after("<br />");var aU=JSON.parse(localStorage.getItem("favoriteCountries"));if(aU===null){aU=[28]}$.each(aU,function(a0,a1){if(!countryInfo[a1]){return}var aZ=$("<div>",{"class":(aO?"xflagsSmall xflagsSmall-":"xflagsMedium xflagsMedium-")+countryInfo[a1].flagName,style:"vertical-align:middle;",value:a1,title:countryInfo[a1].name}).insertAfter(aV);aZ.click(function(){aV.val($(this).val());if(aT.length===1){aT.click()}})});if(!aO&&((aP&&!aQ)||(!aP&&aQ))){var aS=$("<div>",{"class":" xflagsMedium xflagsMedium-Adminland",style:"vertical-align:middle;",title:"全世界"}).insertAfter(aV);aS.click(function(){aV.val(aP?0:-1);if(aT.length===1){aT.click()}})}if(aP&&aO){var aS=$("<div>",{"class":"xflagsSmall xflagsSmall-Gold",style:"vertical-align:middle;"}).insertAfter(aV);aS.click(function(){aV.val(0);if(aT.length===1){aT.click()}})}if(aT.length===1){aT.click(function(){aX(parseInt(aV.val()))})}else{aV.change(function(){aX(parseInt(aV.val()))})}function aX(aZ){var a1=localStorage.getItem("lockFavoriteCountries");if(a1==null||a1!="true"){if(aZ>0){var a0=$.inArray(aZ,aU);if(a0>-1){aU.splice(a0,1)}aU.push(aZ)}localStorage.setItem("favoriteCountries",JSON.stringify(aU.slice(-9)))}}})}function y(){var aP=$("#editCitizenId").parent();var aQ=JSON.parse(localStorage.getItem("citizenNumber"));if(aQ===null||aH(aQ,24*3600)){$.ajax({url:"militaryUnitStorage.html",success:function(aS){aQ=aO(aS);console.log("团员编号为",aQ);aR(aQ)},error:function(aS,aT){console.log("抓取团员编号时发生错误 (",aT,")，重新尝试");$.ajax(this)}})}else{aR(aQ.cn)}function aR(aW){if(aW==="disabled"){return}var aS=0;var aY=0;if($("#foodLimit").length==1){aS=parseInt($("#foodLimit").text());aY=parseInt($("#giftLimit").text())}else{aS=parseInt($("#foodLimit2").text());aY=parseInt($("#giftLimit2").text())}var aT=[["bread","Food",5,"5-FOOD","Q5食物",Math.floor(Math.random()*4+2)*10],["gift","Gift",5,"5-GIFT","Q5礼物",Math.floor(Math.random()*4+2)*10],["tank","Weapon",5,"5-WEAPON","Q5武器",Math.floor(Math.random()*10+15)*10],["ticket ","Ticket",5,"5-TICKET","Q5机票",10],["bread","Food",3,"3-FOOD","Q3食物",10],["gift","Gift",3,"3-GIFT","Q3礼物",10],["tank","Weapon",1,"1-WEAPON","Q1武器",Math.floor(Math.random()*10+15)*10],["ticket ","Ticket",1,"1-TICKET","Q1机票",10]];var aX=$('<ul id="storageTable" class="button foundation-center foundation-style-group"></ul>');aP.parent().after(aX);$.each(aT,function(a4,a7){var a6=$("<li></li>");var a0=$("#storageTable").append(a6);var a1=a7[5];var a2=$("<button>",{id:"send"+a7[3],style:"width:41px; margin:1px;","class":"button foundation-style smallhelp only-icon profileButton",title:"从军团仓库取"+a1+"个"+a7[4]}).appendTo(a6);var a5=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/"+a7[1]+".png",style:"width:28px; height:28px;"}).appendTo(a2);var a3=$("<span>",{text:"x"+a1,style:"position: absolute; top: 26px; right: 1px;"}).appendTo(a2);a2.append($("<br />"));var aZ=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/q"+a7[2]+".png",style:"width:28px;"}).appendTo(a2);a2.click(function(){a2.attr({disabled:true});var a8={product:a7[3],quantity:a1,reason:" "};a8[aW]=userId;$.ajax({url:"militaryUnitStorage.html",type:"POST",data:a8,success:function(a9){console.log("已从军团仓库取了"+a1+"个"+a7[4]);a2.attr({disabled:false})},error:function(a9,ba){console.log("从军团仓库取"+a1+"个"+a7[4]+"时发生错误 (",ba,")，重新尝试");$.ajax(this)}})})});var aV=$("<input type='button' id='gsnbtn' value='获取仓库物资数目'></input> ");aP.parent().after(aV);aV.click(function(){aU(aW);aV.remove()});function aU(aZ){$.ajax({url:"storage.html?storageType=PRODUCT",success:function(a5){var a1=$("div.storage",a5);var a9=[0,0,0,0,0,0];var bb=[0,0,0,0,0,0];var a8=[0,0,0,0,0,0];var a3=[0,0,0,0,0,0];for(var a6=0;a6<a1.length;a6++){var ba;var a2;var a0;ba=parseInt("0"+a1[a6].children[0].innerText.trim());var a4=$(a1[a6]).children()[1];a0=$(a4.children[0]).attr("src").split("/")[6];a2=$(a4.children[1]).attr("src");if(a2!=null){a2=a2.split("/")[6];a2=a2.substring(1,2);if(a0=="Food.png"){a9[parseInt(a2)]=ba}else{if(a0=="Gift.png"){bb[parseInt(a2)]=ba}else{if(a0=="Weapon.png"){a8[parseInt(a2)]=ba}else{if(a0=="Ticket.png"){a3[parseInt(a2)]=ba}}}}}}var a7=parseInt((aS+aY+40)*5*100/(100-citizenPage[userId].avoid));console.log(aS,aY,a9,bb,a8,a3,a7);aT=[["bread","Food",5,"5-FOOD","Q5食物",a9[5]<aS+25,aS+30-a9[5],30],["gift","Gift",5,"5-GIFT","Q5礼物",bb[5]<aY+15,aY+20-bb[5],20],["tank","Weapon",5,"5-WEAPON","Q5武器",a8[5]<a7,a7-a8[5]+30,250],["ticket ","Ticket",5,"5-TICKET","Q5机票",a3[5]<6,10-a3[5],10],["bread","Food",3,"3-FOOD","Q3食物",a9[3]<10,10-a9[3],10],["gift","Gift",3,"3-GIFT","Q3礼物",bb[3]<10,10-bb[3],10],["tank","Weapon",1,"1-WEAPON","Q1武器",a8[1]<a7,a7-a8[1]+30,250],["ticket ","Ticket",1,"1-TICKET","Q1机票",a3[1]<6,10-a3[1],10]];$("ul#storageTable").html("");$.each(aT,function(bi,bl){var bk=$("<li></li>");var be=$("#storageTable").append(bk);var bd=bl[5]?"red;":"black;";var bf=bl[5]?bl[6]:bl[7];var bg=$("<button>",{id:"send"+bl[3],style:"width:41px; margin:1px; border-color:"+bd,"class":"button foundation-style smallhelp only-icon profileButton",title:"从军团仓库取"+bf+"个"+bl[4]+(bl[5]?", 补足2天的用量":"")}).appendTo(bk);var bj=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/"+bl[1]+".png",style:"width:28px; height:28px;"}).appendTo(bg);var bh=$("<span>",{text:"x"+bf,style:"position: absolute; top: 26px; right: 1px;"}).appendTo(bg);bg.append($("<br />"));var bc=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/q"+bl[2]+".png",style:"width:28px;"}).appendTo(bg);bg.click(function(){bg.attr({disabled:true});var bm={product:bl[3],quantity:bf,reason:" "};bm[aZ]=userId;$.ajax({url:"militaryUnitStorage.html",type:"POST",data:bm,success:function(bn){console.log("已从军团仓库取了"+bf+"个"+bl[4]);bg.attr({disabled:false})},error:function(bn,bo){console.log("从军团仓库取"+bf+"个"+bl[4]+"时发生错误 (",bo,")，重新尝试");$.ajax(this)}})})})},error:function(a0,a1){console.log("获取物资时发生错误 (",a1,")，重新尝试");$.ajax(this)}})}}function aO(aU){var aS=$("input[value='"+userId+"']",aU);var aT={};if(aS.length===1){aT.cn=aS.attr("name")}else{aT.cn="disabled"}ar(aT);localStorage.setItem("citizenNumber",JSON.stringify(aT));return aT.cn}}function m(){var aR=$("table.dataTable:last").width("100%");aR.parent().attr("style","width:98% !important;");var aO=$("tr:gt(0)",aR).sort(function(aT,aS){return $("td:eq(1)",aT).html().localeCompare($("td:eq(1)",aS).html())});$("tr:gt(0)",aR).remove();var aQ=$("tr",aR);aQ.after(aO);$("td:first",aQ).append(" ("+aO.length+")");var aP=$("<button>",{"class":"foundation-style button",text:"查看全部"}).appendTo($("<td>").appendTo(aQ));aP.click(function(){aP.attr("disabled",true);setTimeout(function(){aP.attr("disabled",false)},10000);$('button[id^="ehShow"]').click()});aO.each(function(){var aU=$(this);if(parseInt($("td:eq(3)",aU).text())===0){aU.append($("<td>"));return}var aS=parseInt($('td:first a[href^="company.html?id="]',aU).attr("href").match(/([0-9]+)$/)[1]);aU.attr("id","ehRow"+aS);var aT=$("<button>",{"class":"foundation-style button",style:"padding:10px;",id:"ehShow"+aS,text:"查看工作情况",target:aS}).appendTo($("<td>").appendTo(aU));aT.click(function(){aT.attr("disabled",true);var aV=aT.attr("target");$.ajax({url:"companyWorkResults.html?id="+aV,success:function(aZ){aT.remove();var aX=$("table.dataTable:last",aZ);if($("tr",aX).length===1){return}var aW=$("<tr>").insertAfter($("#ehRow"+aV));var aY=$("<td colspan=5></td>").appendTo(aW);aX.appendTo(aY)},error:function(aW,aX){console.log("工厂",aV,"抓取错误 (",aX,")");aT.click()}})})})}function ay(){var aO=$("<button>",{id:"returnButton","class":"foundation-style",style:"padding:5px; margin:5px",text:"回到工厂页面"});aO.click(function(){var aP=n("id");document.location=location.origin+"/company.html?id="+aP});$(".darkTable").before(aO)}function ap(){var aO=$("#orderForm > select");if(aO.length!=1){return}var aR=[];for(var aQ=0;aQ<allies.length;++aQ){aR.push("("+countryInfo[allies[aQ]].shortName)}var aP=$("option",aO).sort(function(aT,aS){return $(aT).text().localeCompare($(aS).text())});aP.each(function(){var aT=$(this);for(var aS=0;aS<aR.length;++aS){if(aT.text().indexOf(aR[aS]+" ")!=-1){if(aS==0){aT.attr("style","background:pink;")}else{aT.attr("style","background:lavender;")}}}});aO.html(aP)}function aF(){var a4=$(".dataTable :first");var a0=$("<div class='foundation-style'></div>");a0.insertBefore(a4);var aZ=$("<table align='right'></table>");a0.append(aZ);var aR=$("<tr align='right'></tr>");aZ.append(aR);var aX=$("<input type='button' class='foundation-style button' id='btnShowEndTime' value='显示T5时间'></input> ");aR.append(aX);var aQ=$("<input type='button' class='foundation-style button' id='btnCloseShowEndTime' value='关闭T5时间'></input> ");aQ.hide();aR.append(aQ);var aV=$("<input type='button' class='foundation-style button' id='btnShowBattleID' value='显示战场ID'></input> ");aR.append(aV);var a5=$("<input type='button' class='foundation-style button' id='btnCloseShowBattleID' value='关闭战场ID'></input> ");a5.hide();aR.append(a5);var aO=$("<tr align='right'></tr>");aZ.append(aO);var a6=$("<input type='button' class='foundation-style button' id='btnDeleteTourment' value='隐藏Cup战场'></input> ");aO.append(a6);var a2=$("<input type='button' class='foundation-style button' id='btnFilter' value='筛选战场'></input> ");aO.append(a2);var aU=$("<input type='button' class='foundation-style button' id='btnCloseFilter' value='关闭筛选'></input> ");aU.hide();aO.append(aU);var aS=$("<input type='button' class='foundation-style button' id='btnDeleteCheckedBattle' value='隐藏选中战场'></input> ");aS.attr("disabled",true);aO.append(aS);var aY=$("<input type='button' class='foundation-style button' id='btnDeleteUncheckedBattle' value='保留选中战场'></input> ");aY.attr("disabled",true);aO.append(aY);var a1=$("<input type='button' class='foundation-style button' id='btnCopyCheckedBattleInfo' value='复制选中战场信息'></input> ");a1.attr("disabled",true);aO.append(a1);aS.click(function(){$("#battlesTable tr:gt(0)").each(function(a7,a9){var a8=$("input:checkbox",a9);if(a8.is(":checked")===true){a9.remove()}})});aY.click(function(){$("#battlesTable tr:gt(0)").each(function(a7,a9){var a8=$("input:checkbox",a9);if(a8.is(":checked")===false){a9.remove()}})});a6.click(function(){$("#battlesTable tr:gt(0)").each(function(a7,ba){var a9=$("a[href*='battle.html']",ba);if(a9==null){return true}var a8=a9.text();if((a8=="Cup tournament")||(a8=="MU Cup")){ba.remove()}})});a2.click(function(){a2.hide();aU.show();var a7=$("<td exid='filter'><input type='checkbox'></input></td>");$("#battlesTable tr:eq(0)").append($("<td exid='filter'><input id='filterSelectAll' type='checkbox'></input>全选</td>"));$("#battlesTable tr:gt(0)").append(a7);aS.attr("disabled",false);aY.attr("disabled",false);a1.attr("disabled",false);$("#filterSelectAll").click(function(){$("#battlesTable tr:gt(0)").each(function(a8,a9){$("input:checkbox",a9).attr("checked",$("#filterSelectAll").is(":checked"))})})});aU.click(function(){a2.show();aU.hide();$("#battlesTable td[exid='filter']").remove();aS.attr("disabled",true);aY.attr("disabled",true);a1.attr("disabled",true)});aX.click(function(){aX.hide();aQ.show();$("#battlesTable tr:eq(0)").append($("<td exid='endTime'>T5时间</td>"));$("#battlesTable tr:gt(0)").each(function(bc,be){var bg=$("a[href*='battle.html']",be);var bi=bg.text();var a7=$("span.is-countdown",be);var bh;if(a7.length!==1){bh=$("<td exid='endTime'>未知</td>")}else{var a8=a7.text().split(":");if(a8.length<3){bh=$("<td exid='endTime'>已过期</td>")}else{var a9=new Date();var bf=parseInt(a8[0])*60*60*1000+parseInt(a8[1])*60*1000+parseInt(a8[2])*1000-5*60*1000;var ba=new Date(a9.getTime()+bf);bh=$("<td exid='endTime'></td>");bh.text(ba.toLocaleTimeString());var bd=bg.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1];var bb=$("<input type='button' class='foundation-style button' id='btnAutoPopup-"+bd+"' value='T5自动打开战场' title='首次使用可能会被浏览器拦截，加入白名单即可' endtime='"+Date.parse(ba)+"'></input> ");bh.append(bb);bb.click(function(){var bl=$(this);var bk=new Date();var bj=new Date(parseInt(bl.attr("endtime")));setTimeout(function(){window.open(bg.attr("href"),"Battle"+bd,"resizable,scrollbars,width=1200,height=600")},bj-bk);console.log("在"+(bj-bk)/1000+"秒后打开"+bg.attr("href"));bl.attr("disabled",true);bl.val("预约成功");bl.attr("title","请勿关闭或刷新该网页")})}}$(be).append(bh)})});aQ.click(function(){aX.show();aQ.hide();$("#battlesTable td[exid='endTime']").remove()});aV.click(function(){aV.hide();a5.show();$("#battlesTable tr:eq(0)").append($("<td exid='battleID'>战场ID</td>"));$("#battlesTable tr:gt(0)").each(function(a7,ba){var a9=$("a[href*='battle.html']",ba);if(a9==null){return true}var a8=a9.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1];$(ba).append($("<td exid='battleID'>"+a8+"</td>"))})});a5.click(function(){aV.show();a5.hide();$("#battlesTable td[exid='battleID']").remove()});a1.click(function(){var a7="";$("#battlesTable tr:gt(0)").each(function(bd,be){var bb=$("input:checkbox",be);if(bb.is(":checked")===true){var bf=$("a[href*='battle.html']",be);var bg=bf.text();var a8=$("span.is-countdown",be);if(a8.length!==1){a7=a7+bf[0].href+"  "+bg+"\r\n"}else{var a9=a8.text().split(":");var ba=new Date();var bc=new Date(ba.getTime()+parseInt(a9[0])*60*60*1000+parseInt(a9[1])*60*1000+parseInt(a9[2])*1000-5*60*1000);a7=a7+bf[0].href+"  "+bg+" T5时间："+bc.toLocaleTimeString()+"\r\n"}}});GM_setClipboard(a7)});var aT=$("<button>",{text:"按结束时间排序","class":"foundation-style button"}).appendTo($("#battlesTable tr:first td:first").empty());aT.click(function(){aT.attr("disabled",true);setTimeout(function(){aT.attr("disabled",false)},1000);var a7=[];$("#battlesTable tr:gt(0)").each(function(a8,bb){var ba=$("a[href*='battle.html']",bb);if(ba==null){return true}var a9=parseInt(ba.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1]);$(this).attr("id","battle-"+a9);var bc=$("span.is-countdown",bb);if(bc.length!==1){return}a7.push(bc.text()+" "+$(this).attr("id"))});a7.sort().reverse();$.each(a7,function(a9,ba){var a8=ba.split(" ").pop();$("#battlesTable #"+a8).insertAfter($("#battlesTable tr:first"))})});var aW=$("#pagination-digg");if(aW.length>0){var aP=$("<button>",{text:"加载其他页的战场","class":"foundation-style button",title:"如果需要加载所有战场，请尽快点击该按钮，否则可能会出现重复战场而导致插件失效"}).appendTo($("#battlesTable tr:first td:first"));aP.click(function(){aP.attr("disabled",true);var a7=$("li.next");var ba=parseInt($("li.active")[0].innerHTML);var a8;if(a7.length>0){a8=parseInt(a7.prev().children().attr("href").split("page=")[1])}else{a8=ba}var a9=a8-1;aP.text("剩余"+a9+"个");for(var bc=1;bc<=a8;bc++){if(bc==ba){continue}var bb=document.URL;if(bb.indexOf("page")>0){bb=bb.substring(0,bb.indexOf("page"))+"page="+bc}else{if(bb.indexOf("?")>0){bb=bb+"&page="+bc}else{bb=bb+"?page="+bc}}$.ajax({url:bb,success:function(bm){if($(".time",bm).length!==2){console.log(citizenId,"抓取错误，重新抓取");$.ajax(this);return}var bn=$("#battlesTable").children("tbody");var bq=bm.split('<table id="battlesTable"')[1];bq=bq.split("</table>")[0];var bp=bq.substring(bq.indexOf("</tr>")+5);var bs=bp.split("<tr>");var be=[];var bo=[];var bf=[];var bg=[];var bd=[];for(var bl=1;bl<bs.length;bl++){var bk=bs[bl].split('<script type="text/javascript">');if(bk.length>1){be[bl]=bk[0];var bi=bk[1].split("<\/script>");be[bl]=be[bl]+bi[1];be[bl]=be[bl].split("</tr>")[0];bo[bl]=bi[0];bd[bl]=be[bl].split("?id=")[1];bd[bl]=bd[bl].substring(0,bd[bl].indexOf('"'));$("<tr>",{id:"battle-"+bd[bl]}).appendTo(bn);$("#battle-"+bd[bl]).html(be[bl]);var bh=bo[bl].split("+");var br=[];for(var bj=1;bj<bh.length;bj++){br[bj]=bh[bj].substring(0,bh[bj].indexOf(")"))}bf[bl]=new Date();bf[bl].setHours(bf[bl].getHours()+parseInt(br[1]));bf[bl].setMinutes(bf[bl].getMinutes()+parseInt(br[2]));bf[bl].setSeconds(bf[bl].getSeconds()+parseInt(br[3]));bg[bl]=$("<span>",{id:"fundraisingTimer"+bd[bl]}).appendTo($("a[href='battle.html?id="+bd[bl]+"']").parent());unsafeWindow.$("#fundraisingTimer"+bd[bl]).countdown({until:bf[bl],compact:true,format:"dHMS",expiryText:"这个回合已经结束"})}else{bd[bl]=bs[bl].split("?id=")[1];bd[bl]=bd[bl].substring(0,bd[bl].indexOf('"'));$("<tr>",{id:"battle-"+bd[bl]}).appendTo(bn);be[bl]=bs[bl].split("</tr>")[0];$("#battle-"+bd[bl]).html(be[bl])}}aP.text("剩余"+(--a9)+"个");if(a9<=0){aP.text("加载完成，共"+a8+"页")}},error:function(bd,be){console.log("抓取错误 (",be,")，重新抓取");$.ajax(this)}})}});var a3=$("<button>",{text:"加载详情","class":"foundation-style button",style:"padding:5px; margin:5px;",title:"加载刷新战场详情功能"}).appendTo($("#battlesTable tr:first td:last").empty());a3.click(function(){a3.attr("disabled",true);a3.remove();aN()})}else{aN()}}function aN(){$("#battlesTable tr:gt(0)").each(function(aY,aQ){if($("div.teamBlack",aQ).length>0){return}var a4=$("span.is-countdown",aQ);if(a4.length!==1){return}var a0=$("a[href*='battle.html']",aQ);var aV=parseInt(a0.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1]);$(this).attr("id","battle-"+aV);var bl=a0.text();if($("~ b",a0).length===1){bl+="起义"}else{bl+="进攻"}var bd=w($("div.xflagsMedium:first",aQ).attr("class")).replace(/-/g," ");var a3=w($("div.xflagsMedium:last",aQ).attr("class")).replace(/-/g," ");var bb=$("div.ui-progressbar-value",aQ);var be=$("<div>",{id:"wall"+aV,style:"text-align:center;"}).insertAfter($("div.ui-progressbar",aQ));if($("div.xflagsMedium",aQ).length<=0){var a2=$("<div>",{id:"defenderBattleHero"+aV,style:"text-align:center;"}).insertAfter($(".muAvatar:first",aQ).parent());var bj=$("<div>",{id:"defenderScore"+aV,style:"text-align:center;"}).insertAfter($(".muAvatar:first",aQ).parent());var bg=$("<div>",{id:"attackerBattleHero"+aV,style:"text-align:center;"}).insertAfter($(".muAvatar:last",aQ).parent());var a6=$("<div>",{id:"attackerScore"+aV,style:"text-align:center;"}).insertAfter($(".muAvatar:last",aQ).parent())}else{var a2=$("<div>",{id:"defenderBattleHero"+aV,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:first",aQ));var bj=$("<div>",{id:"defenderScore"+aV,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:first",aQ));var bg=$("<div>",{id:"attackerBattleHero"+aV,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:last",aQ));var a6=$("<div>",{id:"attackerScore"+aV,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:last",aQ))}var bk=$("<div>",{id:"showSpectators"+aV,text:"Show spectators",style:"color:#3787ea; cursor:pointer;"}).appendTo($("td:first",aQ)).click(function(){a8.children().show();bk.hide();bm.show()}).hide();var bm=$("<div>",{id:"hideSpectators"+aV,text:"Hide spectators",style:"color:#3787ea; cursor:pointer;"}).appendTo($("td:first",aQ)).click(function(){a8.children().hide();bk.show();bm.hide()}).hide();var a8=$("<div>",{id:"spectators"+aV,"class":"battleDiv",style:"width:100%; text-align:center;"}).appendTo($("td:first",aQ));var aZ=$("<div>",{style:"width:33%; border:0; padding:0; margin:0; display:inline-block;",text:" defenders"}).appendTo(a8);var aP=$("<i>",{id:"totaldefenders"+aV,text:"0"}).prependTo(aZ);var aU=$("<div>",{id:"defendersMenu"+aV}).appendTo(aZ);var bc=$("<div>",{style:"width:34%; border:0; padding:0; margin:0; display:inline-block; text-align:center;",text:" spectators"}).appendTo(a8);var aS=$("<i>",{id:"totalspectators"+aV,text:"0"}).prependTo(bc);var aT=$("<div>",{id:"spectatorsMenu"+aV}).appendTo(bc);var aX=$("<div>",{style:"width:33%; border:0; padding:0; margin:0; display:inline-block; text-align:center;",text:" attackers"}).appendTo(a8);var a1=$("<i>",{id:"totalattackers"+aV,text:"0"}).prependTo(aX);var ba=$("<div>",{id:"attackersMenu"+aV}).appendTo(aX);a8.children().hide();var aR=$("<div>",{id:"dsOrHospital"+aV}).appendTo(a4.parent().parent());var bf=$("<img>",{src:$("#userAvatar img").attr("src")}).insertAfter(aR).hide();var bi=$("<div>",{id:"myDamage"+aV}).insertAfter(bf);var bh=$("<button>",{id:"peek"+aV,text:"刷新","class":"foundation-style button",style:"padding:6px; margin:3px;"}).appendTo($("td:eq(3)",aQ));var a5=$("<button>",{id:"copy"+aV,text:"复制","class":"foundation-style button",style:"padding:6px; margin:3px;",title:bl+": "+a0[0].href+"\n"}).appendTo($("td:eq(3)",aQ)).hide();var a7=$("<div>").appendTo($("td:eq(3)",aQ));var aW=$("<span>",{id:"lastPeek"+aV}).appendTo(a7);var a9=$("<span>",{id:"2lastPeek"+aV,text:"秒前更新"}).hide().appendTo(a7);bh.click(function(){bh.attr("disabled",true);$.ajax({url:"battle.html?id="+aV,success:function(bo){if($(".time",bo).length!==2){console.log(aV,"抓取错误，重新抓取");$.ajax(this);return}bj.text($("#defenderScore",bo).text());a6.text($("#attackerScore",bo).text());var bn=parseInt($("#defenderScore",bo).text().replace(/,/g,"").replace(/\xA0/g,""))-parseInt($("#attackerScore",bo).text().replace(/,/g,"").replace(/\xA0/g,""));if(bn===0){be.text("");be.attr("title",bj===0?"双方无伤害":"双方伤害相同")}else{if(bn>0){be.text(">> "+bn.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>");be.attr("title",bd+" 领先 "+a3+" "+(bn/1000000).toFixed(2)+"M")}else{be.text("<< "+(-bn).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<");be.attr("title",a3+" 领先 "+bd+" "+((-bn)/1000000).toFixed(2)+"M")}}bb.attr("style","width:"+$("#leftStat",bo).text().replace(" ","")+"; margin:0;");a2.html($("#topDefender1 > div",bo).attr("style","width:100%;"));bg.html($("#topAttacker1 > div",bo).attr("style","width:100%;"));if(bg.height()<a2.height()){bg.parent().height(a2.parent().height())}if($("td:first > div:first",aQ).children().length==4){$("td:first > div:first >div:last",aQ).hide()}if($("div.product",bo).length>0){aR.empty().append($("div.product",bo))}var bp=$("#topPlayerHit",bo).text();if(bp!=="0"){bf.show();bi.text(bp)}if($("#userAvatar span.premiumStar").length===1){aP.text($("#totaldefenders",bo).text());aU.html($("#defendersMenu",bo).html());aS.text($("#totalspectators",bo).text());aT.html($("#spectatorsMenu",bo).html());a1.text($("#totalattackers",bo).text());ba.html($("#attackersMenu",bo).html());if(!bm.is(":visible")){bk.show()}}aW.text("0");a9.show();bh.attr("disabled",false);a5.show()},error:function(bn,bo){console.log("战场",aV,"抓取错误 (",bo,")");$.ajax(this)}})});a5.click(function(){GM_setClipboard(a5.attr("title")+a4.text()+", "+be.attr("title")+" ("+a7.text()+")")})});setInterval(function(){$("span[id^='lastPeek']").each(function(){var aP=parseInt($(this).text());if(!isNaN(aP)){$(this).text(aP+1)}})},1000);var aO=$("<button>",{text:"刷新全部","class":"foundation-style button",style:"padding:5px; margin:5px;"}).appendTo($("#battlesTable tr:first td:eq(3)").empty());aO.click(function(){aO.attr("disabled",true);$("#battlesTable tr:gt(0) button[id^='peek']").click();setTimeout(function(){aO.attr("disabled",false)},10000)})}function ah(){var aZ=20;var aT=[0.1,1,5,12,35,100,400];var aX=$(".time").first().text().split(" ")[0];var aR=aX.split(":")[0];var aP=aZ>aR?(aZ-aR+24):(aZ-aR+48);console.log("距离波兰时间",aZ,"点还有约",aP,"小时");console.log("各等级装备的起价是 ",aT);var a0=$(".equipmentInStorage");for(i=0;i<a0.length;++i){var aS=$(".equipmentActions",a0[i])[0];var aY=$(aS).children()[4];aY=$(aY).children()[0];var aQ=$(aY).attr("title");if(aQ==null){var aV=5}else{var aV=parseInt($(aY).attr("title").substring(1))-1}var aO=$(aS).children()[2];var aU=$("input",$(aO));var aW=$(aS).children();for(a=0;a<aW.length;++a){if(aW[a].outerHTML=="<hr>"){aS.removeChild(aW[a])}}for(j=0;j<aU.length;++j){switch(aU[j].name){case"price":aU[j].setAttribute("value",aT[aV]);aU[j].setAttribute("type","text");aU[j].setAttribute("style","width:30px");aU.eq(j).before("起价: ");aU.eq(j).after("<div></div>");break;case"length":aU[j].setAttribute("value",aP);aU[j].setAttribute("type","text");aU[j].setAttribute("style","width:30px");aU.eq(j).before("时间: ");aU.eq(j).after("<i></i>");break;default:break}}}}function t(){var bs=[0.1,0.2,0.4,0.6,0.8,1.1];var bG=[0.2,0.4,0.6,0.8,1.1,1.4];var bV=[0.5,1,1.5,2,3,4];var a5=[1,1.5,2,3,4,5.5];var a7=[0,1.5,3,4.5,6,7.5];var bk=[1.5,3,4.5,6,7.5,9];var bR=[0,1,2,3,4,6];var a4=[1,2,3,4,6,8];var bb=[0,1,2,3,4,6];var bm=[1,2,3,4,6,8];var aT=[0,1,2,3,4,6];var be=[1,2,3,4,6,8];var bH=[0,2,4,6,8,12];var aU=[2,4,6,8,12,16];var bo=[10,16,20,24,28,40];var bE=[16,20,24,28,40,60];var bi=[20,40,50,60,70,90];var bw=[40,50,60,70,90,130];var bM=[3,4,5,6,7,8];var aZ=[4,5,6,7,8,10];var aR=[2,2.5,3,3.5,4,4.5];var bc=[2.5,3,3.5,4,4.5,5];var bt=[1,1,1,1,1,1,1,0,0,0,0];var bv=[1,1,1,1,1,1,1,0,0,0,0];var bI=[1,1,1,1,1,1,1,0,0,0,0];var bx=[1,1,1,1,1,1,1,0,1,0,0];var bA=[1,1,1,1,1,1,1,0,1,0,0];var bN=[1,1,1,1,1,1,1,0,0,0,0];var bf=[1,1,1,1,1,1,1,0,0,0,0];var bq=[1,1,0,0,1,0,0,1,1,0,0];var bB=[1,0,1,1,1,0,0,1,0,0,0];var bP=[1,0,1,1,1,0,0,0,0,0,0];var a8=[1,0,1,1,1,0,0,1,0,0,0];var aY=[1,0,1,1,1,0,0,0,0,0,0];var a1=[1,0,1,1,1,0,0,0,0,0,0];var a0=[1,1,1,1,1,0,0,0,0,0,0];var aX=[1,1,1,1,1,0,0,0,0,0,0];var bl=[1,1,0,0,1,0,0,1,1,0,0];var bu=[0,1,1,0,0,1,1,0,0,0,1];var bF=[1,1,1,0,0,1,1,0,0,0,1];var bX=[0,1,1,0,0,1,1,0,0,0,1];var bJ=[0,1,1,0,0,1,1,0,0,0,1];var bK=[0,1,1,0,0,1,1,0,0,0,1];var aQ=[0,1,1,1,0,1,1,0,0,0,1];var aP=[0,1,1,1,0,1,1,0,0,0,1];var bg=[1,1,0,0,1,0,0,1,1,0,0];var bp=[1,1,1,1,1,0,0,0,1,1,0];var bz=[1,1,1,1,1,0,0,0,1,1,0];var ba=[1,1,1,1,1,0,0,0,1,1,0];var a2=[1,1,1,1,1,0,0,1,1,1,0];var a3=[1,1,1,1,1,0,0,0,1,1,0];var bS=[1,1,1,1,1,1,1,0,1,1,0];var bd=[1,1,1,1,1,1,1,0,1,1,0];var bD=[1,1,0,0,1,0,0,1,1,0,0];var aV=[0,1,1,0,1,0,0,0,0,1,1];var a9=[0,1,1,0,1,0,0,1,0,1,1];var aS=[0,1,1,0,1,0,0,0,0,1,1];var bU=[0,1,1,0,1,0,0,0,0,1,1];var bW=[0,1,1,0,1,0,0,0,0,1,1];var bj=[0,1,1,0,1,0,0,1,0,1,1];var by=[0,1,1,0,1,0,0,1,0,1,1];var bL=[1,1,0,0,1,0,0,1,1,0,0];var bh=["pirate","postapo","future","ee"];var a6=["helmet","vision","armor","pants","shoes","weapon","offhand","charm"];var bT=["Reduce miss chance","Increase critical chance","Increase maximum damage","Increase damage","Increase chance to avoid damage","Increase strength","Increase hit","Increase economy skill","Increase chance for free flight","Increase chance to use less weapons for Berserk","Increase chance to find a weapon"];bQ();bn();function bY(b0){var b3=b0.split(" by ");var b4=b3[0].trim();var b2=b3[1].trim();if(b2.substring(b2.length-1)=="%"){b2=b2.substring(0,b2.length-1).trim()}var b1=[0,0];for(var bZ=0;bZ<bT.length;bZ++){if(b4==bT[bZ]){b1[0]=bZ;break}}b1[1]=parseFloat(b2);return b1}function bO(b1,b0){var bZ=[0,0];switch(b1){case 0:bZ[0]=a7[b0];bZ[1]=bk[b0];return bZ;case 1:bZ[0]=bR[b0];bZ[1]=a4[b0];return bZ;case 2:bZ[0]=bH[b0];bZ[1]=aU[b0];return bZ;case 3:bZ[0]=aT[b0];bZ[1]=be[b0];return bZ;case 4:bZ[0]=bb[b0];bZ[1]=bm[b0];return bZ;case 5:bZ[0]=bo[b0];bZ[1]=bE[b0];return bZ;case 6:bZ[0]=bi[b0];bZ[1]=bw[b0];return bZ;case 7:bZ[0]=bs[b0];bZ[1]=bG[b0];return bZ;case 8:bZ[0]=bV[b0];bZ[1]=a5[b0];return bZ;case 9:bZ[0]=bM[b0];bZ[1]=aZ[b0];return bZ;case 10:bZ[0]=aR[b0];bZ[1]=bc[b0];return bZ;default:console.log("获取装备属性数值范围时parameter越界："+b1);bZ[0]=0;bZ[1]=0;return bZ}}function bQ(){var b0=$(".equipmentBack",$(".testDivblue")).attr("class");b0=parseInt(b0.substring(b0.length-1))-1;var bZ=$("h4");bZ.each(function(){var b2=this.innerText;var b3=bY(b2);var b1=bO(b3[0],b0);var b5=(b1[1]-b3[1])/3;var b4=(b1[1]-b1[0])*0.9+b1[0];if(b3[1]<b4){this.append("（强化+"+b5.toFixed(2)+"）")}else{this.append("（无法强化）")}})}function aO(b0,bZ){if(b0==0){if(bZ==0){return bt}if(bZ==1){return bv}if(bZ==2){return bI}if(bZ==3){return bx}if(bZ==4){return bA}if(bZ==5){return bN}if(bZ==6){return bf}if(bZ==7){return bq}return[0,0,0,0,0,0,0,0,0,0,0]}if(b0==1){if(bZ==0){return bB}if(bZ==1){return bP}if(bZ==2){return a8}if(bZ==3){return aY}if(bZ==4){return a1}if(bZ==5){return a0}if(bZ==6){return aX}if(bZ==7){return bl}return[0,0,0,0,0,0,0,0,0,0,0]}if(b0==2){if(bZ==0){return bu}if(bZ==1){return bF}if(bZ==2){return bX}if(bZ==3){return bJ}if(bZ==4){return bK}if(bZ==5){return aQ}if(bZ==6){return aP}if(bZ==7){return bg}return[0,0,0,0,0,0,0,0,0,0,0]}if(b0==3){if(bZ==0){return bp}if(bZ==1){return bz}if(bZ==2){return ba}if(bZ==3){return a2}if(bZ==4){return a3}if(bZ==5){return bS}if(bZ==6){return bd}if(bZ==7){return bD}return[0,0,0,0,0,0,0,0,0,0,0]}if(b0==4){if(bZ==0){return aV}if(bZ==1){return a9}if(bZ==2){return aS}if(bZ==3){return bU}if(bZ==4){return bW}if(bZ==5){return bj}if(bZ==6){return by}if(bZ==7){return bL}return[0,0,0,0,0,0,0,0,0,0,0]}return[0,0,0,0,0,0,0,0,0,0,0]}function aW(bZ){switch(bZ){case 0:return"miss";case 1:return"暴击";case 2:return"大伤";case 3:return"小伤";case 4:return"免体";case 5:return"力量";case 6:return"伤害点";case 7:return"经济技能";case 8:return"免费飞行";case 9:return"减少连击消耗";case 10:return"捡到手枪";default:return"[未知属性]"}}function br(bZ){for(var b0=0;b0<bh.length;b0++){if(bZ==bh[b0]){return b0+1}}return -1}function bC(b0){for(var bZ=0;bZ<a6.length;bZ++){if(b0==a6[bZ]){return bZ}}return -1}function bn(){var b0=$(".equipmentBack",$(".testDivblue")).children().attr("class");b0=b0.split(" ")[1];b0=b0.substring(0,b0.length-1);var b5=b0.split("_");var b6,b3;if(b5.length==1){b6=0;b3=bC(b5[0])}else{b6=br(b5[0]);b3=bC(b5[1])}var b4=aO(b6,b3);var bZ="可以刷出的属性：";for(var b2=0;b2<b4.length;b2++){if(b4[b2]>0){bZ=bZ+aW(b2)+"、"}}var b1=$(".dashedLine :eq(1)");b1.before("<br />");b1.before(bZ)}}function B(){var aT=$(".statisticsTable");var aO=$("tr",aT);var aS=aO.eq(0);aS.append('<td><button class="foundation-style" id="ehShowAll">查看所有</button></td>');$("#ehShowAll").click(function(){$(this).attr("disabled","disabled");setTimeout(function(){$("#ehShowAll").attr("disabled",false)},10000);$('[id^="ehShow_"]').click()});function aR(aX){var aW=parseInt(aX.replace(/,/g,"").replace(/\xA0/g,""));return aW>1000000?((aW/1000000).toFixed(1)+"M"):aX}for(var aQ=1;aQ<aO.length;++aQ){var aU=aO.eq(aQ);$("td:eq(5)",aU).text(aR($("td:eq(5)",aU).text()));$("td:eq(6)",aU).text(aR($("td:eq(6)",aU).text()));var aV=$('a[href^="militaryUnit.html?id="]',aU).attr("href").replace("militaryUnit.html?id=","");var aP=$('<button style="padding:10px;" class="foundation-style" id="ehShow_'+aV+'">查看军令</button>');aU.append($("<td>").append(aP));aP.click(function(){$(this).attr("disabled","disabled");var aW=$(this).attr("id").replace("ehShow_","");$.ajax({url:"militaryUnit.html?id="+aW,timeout:9000,success:function(aZ){var a5=$("#ehShow_"+aW);var a4=$('img[src="//cdn.e-sim.org//img/newOnline.png"]',aZ).prev();var a1=a4.prev();var a6=a1.prev();var aY=$("td:eq(3)",a5.parent().parent());aY.append('<b title="统计在线的人数">('+a4.length+"人在线)</b>");for(var a0=0;a0<a4.length;++a0){aY.append($("<div>",{style:"text-align:left;"}).append(a6.eq(a0),a1.eq(a0),a4.eq(a0)))}if($("#pagination-digg",aZ).length>0){$.ajax({url:"militaryUnit.html?id="+aW+"&page=2",success:function(bc){var bb=$('img[src="//cdn.e-sim.org//img/newOnline.png"]',bc).prev();var ba=bb.prev();var a7=ba.prev();var a8=parseInt(aY.find("b:eq(1)").text().replace(/[^0-9]/g,""));a8+=bb.length;aY.find("b:eq(1)").text("("+a8.toString()+"人在线)");for(var a9=0;a9<bb.length;++a9){aY.append($("<div>",{style:"text-align:left;"}).append(a7.eq(a9),ba.eq(a9),bb.eq(a9)))}},error:function(a7,a8){$.ajax(this)}})}var a3=$('div.battleDiv a[href^="battle.html"]',aZ).parent();var aX=$("div.xflagsMedium",$("div.battleDiv",aZ).parent().parent());if(aX.length!=3){a5.after("无军令");a5.remove();return}if(aX.eq(0).attr("class")===aX.eq(2).attr("class")){aX.eq(0).attr("style","vertical-align:middle;");var a2=w(aX.eq(1).attr("class"));aX.eq(1).attr("class","xflagsSmall xflagsSmall-"+a2);aX.eq(1).attr("style","vertical-align:middle;")}else{aX.eq(1).attr("style","vertical-align:middle;");var a2=w(aX.eq(0).attr("class"));aX.eq(0).attr("class","xflagsSmall xflagsSmall-"+a2);aX.eq(0).attr("style","vertical-align:middle;")}a5.after(a3,aX.eq(0),"vs",aX.eq(1));a5.remove()},error:function(aX,aY){console.log(url,"抓取错误 (",aY,")");$("#ehShow_"+aW).click()}})})}}function q(aT){if(config.fetchCurrencyDisabled){return}if($(".dataTable:first tr:eq(1) td",aT).length===1){return}var aP=w($(".dataTable:first tr:eq(1) td:eq(1) div.xflagsSmall",aT).attr("class"));var aR=parseFloat($(".dataTable:first tr:eq(1) td:eq(2) b",aT).text().replace(",","."));var aQ=w($(".dataTable:first tr:eq(1) td:eq(2) div.xflagsSmall",aT).attr("class"));if(aQ==="Gold"){var aS=countryInfo[aP].id;if(currencyRatio[aS]===undefined){currencyRatio[aS]={}}var aO=currencyRatio[aS];if(aO.buy===undefined){aO.buy={}}aO.buy.ratio=1/aR;ar(aO.buy);localStorage.setItem("currencyRatio",JSON.stringify(currencyRatio))}else{var aS=countryInfo[aQ].id;if(currencyRatio[aS]===undefined){currencyRatio[aS]={}}var aO=currencyRatio[aS];if(aO.sell===undefined){aO.sell={}}aO.sell.ratio=aR;ar(aO.sell);localStorage.setItem("currencyRatio",JSON.stringify(currencyRatio))}}function ao(){$("div.xflagsSmall + b").each(function(){var aU=$(this);if(isNaN(aU.text())){return}var aR=w(aU.prev().attr("class"));var aV=countryInfo[aR]&&countryInfo[aR].id;if(!aV||!currencyRatio[aV]||!currencyRatio[aV].sell||!currencyRatio[aV].buy){return}var aZ=countryInfo[aV]&&countryInfo[aV].currencyName;if(aU.parent().text().indexOf(aU.text()+" "+aZ)===-1){return}var aO=parseFloat(aU.text());var aW=(currencyRatio[aV].sell.ratio);var aP=aO/aW;var aQ=(currencyRatio[aV].buy.ratio);var aX=aO/aQ;var aY=Math.abs(aP-aX)<0.01;var aT=((aW+aQ)/2).toPrecision(4);var aS=((aP+aX)/2).toPrecision(4);aP=aP.toPrecision(4);aX=aX.toPrecision(4);if(aY){if(aU.next().length===1){aU.next().before("(",$("<b>",{text:aS,title:""+aT+" "+aZ+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{aU.parent().append("(",$("<b>",{text:aS,title:""+aT+" "+aZ+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}}else{if(aU.next().length===1){aU.next().before("(",$("<b>",{text:aX+" 或 "+aP,title:"用 "+aX+" Gold买 "+aO+" "+aZ+"，或用 "+aO+" "+aZ+"卖 "+aP+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{aU.parent().append("(",$("<b>",{text:aX+" 或 "+aP,title:"用 "+aX+" Gold买 "+aO+" "+aZ+"，或用 "+aO+" "+aZ+"卖 "+aP+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}}});$("td b").each(function(){var aQ=$(this).text().trim().split(" ");if(aQ.length!==2||isNaN(aQ[0])||!countryInfo[aQ[1]]){return}var aU=parseFloat(aQ[0]);var aZ=aQ[1];var aV=countryInfo[aZ]&&countryInfo[aZ].id;if(!aV||!currencyRatio[aV]||!currencyRatio[aV].sell||!currencyRatio[aV].buy){return}var aO=parseFloat(aQ[1]);var aW=(currencyRatio[aV].sell.ratio);var aP=aO/aW;var aR=(currencyRatio[aV].buy.ratio);var aX=aO/aR;var aY=Math.abs(aP-aX)<0.1;var aT=((aW+aR)/2).toPrecision(4);var aS=((aP+aX)/2).toPrecision(4);aP=aP.toPrecision(4);aX=aX.toPrecision(4);if(aY){$(this).after(" (",$("<b>",{text:aS,title:""+aT+" "+aZ+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{$(this).after(" (",$("<b>",{text:aX+" 或 "+aP,title:"用 "+aX+" Gold买 "+aO+" "+aZ+"，或用 "+aO+" "+aZ+"卖 "+aP+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}})}function W(){clipWithFlag=false;$("#battleHeaderImage").attr("style","height:85px; background-color:#222");$("#battleHeaderImage img").remove();var aO=$(".small-2").eq(1);aO.attr("id","ehPanel");aO.prev().attr("class",aO.prev().attr("class").replace("small-4","small-2"));aO.next().attr("class",aO.next().attr("class").replace("small-4","small-2"));aO.attr("class",aO.attr("class").replace("small-2","small-3"));aO.after($("<div>",{"class":aO.attr("class"),id:"ehRefresh"}));aO.empty();var aZ=[["调试","Debug","bug"],["飞行","Flight","airplane"],["统计","Statistics","stocks"],["特殊","Special","uniF00F"],["观战","Spectator","eye"],["详细","SpectatorDetail","users"],["闹钟","Alarm","uptime"],["高级","Advanced","uniF478"]];var aY="padding:6px 2px 6px 2px;";var aS=aY+" color:orange;";for(var aU=0;aU<aZ.length;++aU){var aW=$('<button class="small button foundation-style" style="'+aY+'" id="ehButton'+aZ[aU][1]+'"> <i class="icon-'+aZ[aU][2]+'"></i>'+aZ[aU][0]+"</button> ");var aP=$("<div>",{"class":"foundation-radius fightContainer foundation-base-font",style:"display:none;",id:"ehDiv"+aZ[aU][1]});aW.click(function(){if(this.getAttribute("style")==aY){$("[id^=ehButton]").attr("style",aY);$("[id^=ehDiv]").attr("style","display:none;");this.setAttribute("style",aS);$("#"+this.getAttribute("id").replace("Button","Div")).attr("style","display:block;")}else{$("[id^=ehButton]").attr("style",aY);$("[id^=ehDiv]").attr("style","display:none;")}});aO.append(aW);var a0=localStorage.getItem("battleEnhanceDivPlacement");if(a0==null||a0!="true"){aO.parent().after(aP)}else{$("#battleSelectable:first").before(aP)}}h();ak();C();F();ai();L();ab();D();V();at();P();Q();v();x();aI();var aR=localStorage.getItem("battleBorderless");if(aR==="true"){aC()}$("#recentDefenders").parent().parent().prependTo($("#recentDefenders").parent().parent().parent().parent());$("#minimalChatpanel").remove();var aX=localStorage.getItem("addEmptyRecentRecord");if(aX==="true"){var a1=$("#recentDefenders");var aQ=$("#recentAttackers");for(var aT=1;aT<=5;aT++){if($("#recentDefender"+aT).length<=0){$('<span style="display:block" id="recentDefender'+aT+'">插件预置栏位</span>').appendTo(a1)}}for(var aV=1;aV<=5;aV++){if($("#recentAttacker"+aV).length<=0){$('<span style="display:block" id="recentAttacker'+aV+'">插件预置栏位</span>').appendTo(aQ)}}}}function aC(){GM_addStyle("#newFightView .fightContainer { margin: 0em!important;padding: .3em!important;border-style:none;}");GM_addStyle("#newFightView .fightContainer .topPlayer { padding-top: 0px!important;}");GM_addStyle("#newFightView .fightContainer .topPlayer a img { margin: 0px auto!important;}");GM_addStyle("#newFightView .fightContainer .fightRounds { margin: 0em!important;}");GM_addStyle("#newFightView .fightContainer #roundCountdown { font-size: 2.4em!important;margin:0 0!important;}");GM_addStyle("#battleSelectable #selectable4, #battleSelectable #selectable5, #battleSelectable #selectable6 { height: 30px!important;}");GM_addStyle("#battleSelectable #selectable4 li, #battleSelectable #selectable5 li, #battleSelectable #selectable6 li { height: 30px!important;}");GM_addStyle(".laurelssprite { height: 90px!important;}");$("i.icon-bread.ui-selectee").remove();$("i.icon-gift-2.ui-selectee").remove();$("i.icon-uniF470.ui-selectee").remove();$("i.icon-tank.ui-selectee").remove();var aP=$(".topPlayer").children();for(var aO=0;aO<aP.length;++aO){if(aP[aO].outerHTML=="<br>"){$(".topPlayer")[0].removeChild(aP[aO])}}$("#moreBattleStats").parent().remove()}function aI(){var aP=$("#medkitForm");if(aP.length>0){var aO=$("<button>",{id:"sendMedkitRequest","class":"button smallhelp foundation-style",text:"无需确认直接使用医疗包（当前页面不会刷新额度显示）"}).prependTo(aP.parent());aO.click(function(){aO.attr({disabled:true});var aQ="item=MEDKIT&storageType=SPECIAL_ITEM&action=USE";$.ajax({type:"POST",url:"storage.html",data:aQ,success:function(){aO.attr({disabled:false});console.log("使用医疗包：成功响应")},error:function(aR,aS){console.log("使用医疗包时发生错误")}})})}}function X(){if(isNaN(endEpoch)){endEpoch=(new Date().getTime())+o()*1000}var aO=parseInt((endEpoch-new Date().getTime())/1000)-timeBias;return aO<0?0:aO}function o(){var aO=$("#roundCountdown");hmsArray=aO.text().split(/:| /);return parseInt(hmsArray[0])*3600+parseInt(hmsArray[1])*60+parseInt(hmsArray[2])}function O(aP){var aO=(parseInt(aP/60))%60;var aQ=aP%60;return"0"+parseInt(aP/3600)+(aO<10?":0":":")+aO+(aQ<10?":0":":")+aQ}function h(){$("#ehDivDebug").append($("<div>",{style:"text-align:left;"}));var aQ=$('a[href^="region.html?id="][href!="region.html?id="]');userId=parseInt($("#userName").attr("href").replace("profile.html?id=",""));userName=$("#userName").text();userLocationId=parseInt(aQ.first().attr("href").replace("region.html?id=",""));userLocationName=aQ.first().text();userCitizenshipId=parseInt($('li > a[href^="battles.html?countryId="][href$="&sorting=BY_TOTAL_DAMAGE&_substidedOnly=on"]').attr("href").match(/.+?countryId=([0-9]+).+?/)[1]);battleId=parseInt($('a[href^="battleStatistics.html?id="]').attr("href").replace("battleStatistics.html?id=",""));battleName=$("#fightName a[class=fightFont]").text().trim();battleLocationId=parseInt(aQ.length==1?-1:aQ.last().attr("href").replace("region.html?id=",""));battleLocationName=battleLocationId==-1?"无":battleName;isResistance=($("#fightName div").length>0);roundId=parseInt($("span.fightFont").text().match("[0-9]+$")[0]);battleRoundId=parseInt($("#battleRoundId").val());if($(".xflagsBig").length>0){defenderName=$(".xflagsBig:first").attr("class").split(" ").pop();defenderName=defenderName.substring(defenderName.indexOf("-")+1);attackerName=$(".xflagsBig:last").attr("class").split(" ").pop();attackerName=attackerName.substring(attackerName.indexOf("-")+1)}else{if($(".flags-big").length>0){defenderName=$(".flags-big:first").attr("class").split(" ").pop();attackerName=$(".flags-big:last").attr("class").split(" ").pop()}else{if($(".muAvatar").length>0){defenderName=$(".alliesList.leftList.fightFont").text().trim();attackerName=$(".alliesList.rightList.fightFont").text().trim()}else{defenderName="未知";attackerName="未知"}}}defenderId=countryInfo[defenderName]&&countryInfo[defenderName].id;attackerId=countryInfo[attackerName]&&countryInfo[attackerName].id;defenderScore=$('img[src$="/img/blue_ball.png"]').length;attackerScore=$('img[src$="/img/red_ball.png"]').length;defenderDescription=battleName+", "+defenderName+"方";attackerDescription=battleName+", "+attackerName+"方";isActive=roundId>(defenderScore+attackerScore);isPremium=$("#totalspectators").length>0;d("玩家id=",userId,", 玩家名字=",userName,", 国籍=",userCitizenshipId,", 会员=",isPremium,", 当前位置=",userLocationName," (",userLocationId,")");d("战斗id=",battleId,", 战斗名字=",battleName,", 战斗地点=",battleLocationName," (",battleLocationId,")");d("起义战=",isResistance,", 局数=",roundId,", battleRoundId=",battleRoundId,", 战斗中=",isActive);d(defenderName," v.s. ",attackerName,", 比分",defenderScore,":",attackerScore);timeBias=0;endEpoch=(new Date().getTime())+7200*1000;if(clipWithFlag){defenderNameOrFlag="/"+defenderName.slice(0,5);attackerNameOrFlag="/"+attackerName.slice(0,5)}else{defenderNameOrFlag=defenderName;attackerNameOrFlag=attackerName}if(battleLocationId==-1){document.title=battleName}else{var aO=countryInfo[defenderName].shortName;var aP=countryInfo[attackerName].shortName;if(defenderName=="Kekistan"){aO="KK"}if(attackerName=="Kekistan"){aP="KK"}document.title=aO+" vs "+aP+" @"+battleName}}function d(){var aO=$("#ehDivDebug > div");aO.append($(".time").first().text().split(" ")[0].slice(0,-1),": ");for(var aP=0;aP<arguments.length;aP++){aO.append(arguments[aP].toString()," ")}aO.append("<br />")}function P(){var aV=$(".fightButton").length;var aX,aW,aQ,aO,aR,aP,aS;if(aV===2){aX=$("#fightButtonBerserk1").parent();aS=$("#fightButtonBerserk1").attr("name");aX.append("<br />");aQ=$("<a id='foodWithFight1' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' href='#' title='' value='Berserk' name='"+aS+"'> Hit & food</a>");aX.append(aQ);aR=$("<a id='giftWithFight1' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' href='#' title='' value='Berserk' name='"+aS+"'>Hit & gift</a>");aX.append(aR)}else{if(aV===4){aX=$("#fightButtonBerserk1").parent();aS=$("#fightButtonBerserk1").attr("name");aX.append("<br />");aQ=$("<a id='foodWithFight1' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aS+"'> Hit & food</a>");aX.append(aQ);aR=$("<a id='giftWithFight1' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aS+"'>Hit & gift</a>");aX.append(aR);aW=$("#fightButtonBerserk2").parent();aS=$("#fightButtonBerserk2").attr("name");aW.append("<br />");aO=$("<a id='foodWithFight2' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aS+"'> Hit & food</a>");aW.append(aO);aP=$("<a id='giftWithFight2' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aS+"'>Hit & gift</a>");aW.append(aP);aO.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)");aP.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)")}}if(aV!==0){aQ.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)");aR.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)")}unsafeWindow.$(".fightButton").unbind("click");$(".fightButton").click(function(a1){a1.preventDefault();a1.stopPropagation();var aZ=$(this)[0].name;var a0=$(this).attr("value");K(aZ,a0);return false});$(".foodWithFight").click(function(a1){a1.preventDefault();a1.stopPropagation();if(parseFloat($("#actualHealth").html())<=51||(o()%5)==0){aT()}var aZ=$(this)[0].name;var a0=$(this).attr("value");K(aZ,a0);return false});$(".giftWithFight").click(function(a1){a1.preventDefault();a1.stopPropagation();if(parseFloat($("#actualHealth").html())<=51||(o()%5)==0){aY()}var aZ=$(this)[0].name;var a0=$(this).attr("value");K(aZ,a0);return false});function aT(){var a0="quality="+$("#foodQuality").val();if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"eat.html",data:a0,success:function(a1){aU(a1)}})}else{var aZ=$.ajax({type:"POST",url:"eat.html",timeout:varBattleAjaxTimeout*1000,data:a0,success:function(a1){aU(a1)},error:function(a1,a3,a2){if(a3=="timeout"){aZ.abort()}}})}}function aY(){var aZ="quality="+$("#giftQuality").val();if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"gift.html",data:aZ,success:function(a1){aU(a1)}})}else{var a0=$.ajax({type:"POST",url:"gift.html",timeout:varBattleAjaxTimeout*1000,data:aZ,success:function(a1){aU(a1)},error:function(a1,a3,a2){if(a3=="timeout"){a0.abort()}}})}}function aU(a0){var aZ=jQuery.parseJSON(a0);$("#foodLimit").html(aZ.foodLimit);$("#giftLimit").html(aZ.giftLimit);$("#foodLimit2").html(aZ.foodLimit);$("#giftLimit2").html(aZ.giftLimit);$("#wellness").html(aZ.wellness);$("#healthBar").html(aZ.wellness);$("#healthProgress .ui-progressbar-value").animate({width:aZ.wellness+"%"},{queue:false});$("#actualHealth").html(aZ.wellness);$("#foodQ1").html("<b>Q1</b><br>"+aZ.q1FoodStorage);$("#foodQ2").html("<b>Q2</b><br>"+aZ.q2FoodStorage);$("#foodQ3").html("<b>Q3</b><br>"+aZ.q3FoodStorage);$("#foodQ4").html("<b>Q4</b><br>"+aZ.q4FoodStorage);$("#foodQ5").html("<b>Q5</b><br>"+aZ.q5FoodStorage);$("#giftQ1").html("<b>Q1</b><br>"+aZ.q1GiftStorage);$("#giftQ2").html("<b>Q2</b><br>"+aZ.q2GiftStorage);$("#giftQ3").html("<b>Q3</b><br>"+aZ.q3GiftStorage);$("#giftQ4").html("<b>Q4</b><br>"+aZ.q4GiftStorage);$("#giftQ5").html("<b>Q5</b><br>"+aZ.q5GiftStorage);$("#sfoodQ1").html("<b>Q1</b><br>"+aZ.q1FoodStorage);$("#sfoodQ2").html("<b>Q2</b><br>"+aZ.q2FoodStorage);$("#sfoodQ3").html("<b>Q3</b><br>"+aZ.q3FoodStorage);$("#sfoodQ4").html("<b>Q4</b><br>"+aZ.q4FoodStorage);$("#sfoodQ5").html("<b>Q5</b><br>"+aZ.q5FoodStorage);$("#sgiftQ1").html("<b>Q1</b><br>"+aZ.q1GiftStorage);$("#sgiftQ2").html("<b>Q2</b><br>"+aZ.q2GiftStorage);$("#sgiftQ3").html("<b>Q3</b><br>"+aZ.q3GiftStorage);$("#sgiftQ4").html("<b>Q4</b><br>"+aZ.q4GiftStorage);$("#sgiftQ5").html("<b>Q5</b><br>"+aZ.q5GiftStorage)}}function K(aO,aR){var aP="weaponQuality="+$("#weaponQuality").attr("value")+"&battleRoundId="+$("#battleRoundId").val()+"&side="+aO+"&value="+aR;if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"fight.html",data:aP,success:function(aU){$("#fightResponse > div").replaceWith(aU);aD($(aU));var aT=$("#healthUpdate",aU).text();if(aT!==""){var aS=aT.substr(0,aT.length-3);if(aS<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:aS+"%"},{queue:false});$("#healthProgress").attr("title",aS+" / 100");$("#actualHealth").html(aS)}},error:function(aT,aX,aV){if(aT.status=="404"){var aW=window.location.protocol;var aS=window.location.href;if(aW=="http:"){aS="https:"+aS.substring(5);alert("404错误！点击“确认”立刻切换协议为：https！\r\n建议删除cookie以解决此问题。");location=aS}else{if(aW=="https:"){aS="http:"+aS.substring(6);alert("404错误！点击“确认”立刻切换协议为：http！\r\n建议删除cookie以解决此问题。");location=aS}else{alert("404错误！请立刻切换协议！\r\n建议删除cookie以解决此问题。")}}}else{var aU=$("#showMsg");aU.text("错误："+aT.status);aU.show();aU.fadeOut(2000)}}})}else{var aQ=$.ajax({type:"POST",url:"fight.html",timeout:varBattleAjaxTimeout*1000,data:aP,success:function(aU){$("#fightResponse > div").replaceWith(aU);aD($(aU));var aT=$("#healthUpdate",aU).text();if(aT!==""){var aS=aT.substr(0,aT.length-3);if(aS<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:aS+"%"},{queue:false});$("#healthProgress").attr("title",aS+" / 100");$("#actualHealth").html(aS)}},error:function(aT,aX,aV){if(aT.status=="404"){var aW=window.location.protocol;var aS=window.location.href;if(aW=="http:"){aS="https:"+aS.substring(5);alert("404错误！点击“确认”立刻切换协议为：https！\r\n建议删除cookie以解决此问题。");location=aS}else{if(aW=="https:"){aS="http:"+aS.substring(6);alert("404错误！点击“确认”立刻切换协议为：http！\r\n建议删除cookie以解决此问题。");location=aS}else{alert("404错误！请立刻切换协议！\r\n建议删除cookie以解决此问题。")}}}else{if(aX=="timeout"){aQ.abort();var aU=$("#showMsg");aU.text("请求超时");aU.show();aU.fadeOut(2000)}else{var aU=$("#showMsg");aU.text("错误："+aT.status);aU.show();aU.fadeOut(2000)}}}})}}function aD(aV){function aP(a6){a6+="";var a4=a6.split(".");var a5=/(\d{1,3})(?=(\d{3})+$)/g;return a4[0].replace(a5,"$1,")+(a4.length==2?"."+a4[1]:"")}var a2=$("#showMsg");a2.text("");a2.show();var aR=$("#DamageDone",aV);if(aR.length>0){var a0=parseInt(aR.text().replace(/,/g,"").replace(/\xA0/g,""));var a3=$(".fightsprite",aR.parent().parent());var aW={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var aX={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var aU=0;aU<a3.length;++aU){var a1=a3.eq(aU).attr("class").split(" ").pop();if(a1 in aX){var aQ=aX[a1];aW[aQ[0]]=aQ[1]}}var aS="";var aT=aW.xp;delete aW.xp;for(aU in aW){aS='<i style="color:'+aW[aU][0]+';" class="icon-'+aU+'" title="'+aW[aU][1]+'"></i>'+aS}aS+='<b title="'+aT+'次攻击">x'+aT+"</b>";var aO=$("#fightHistory");var aZ=$("div[class^=foundation-style]",aO);if(aZ.length===6){$("#ehHistoryExpand").show()}aZ.slice(0,2).attr("style","opacity:0.6;");aZ.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){aZ.slice(4,6).hide()}var aY=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(aY){aO.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:aS}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:aR.text()}))}else{aO.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:aS}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:aR.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+aT);$("#ehTotalDamage").text(aP(parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+a0))}else{a2.text($("#fightResponse").text().trim());a2.fadeOut(2000)}}function F(){if(!isActive||battleLocationId==-1){$("#ehButtonFlight").attr("disabled",true);return}var a2=$("#ehDivFlight");var aX=$("<div>");var aR=$("<td>",{id:"defenderRegions",style:"text-align:left; font-size:9px; width:280px"});var a3=$("<td>",{id:"attackerRegions",style:"text-align:right; font-size:9px; width:280px"});var a6=$("<td>",{style:"text-align:center; width:250px"});aX.append(aR,a6,a3);a2.append(aX);var aU=$("<select>",{id:"ticketQuality",name:"ticketQuality",style:"padding:3px; margin:3px"});for(var a1=1;a1<=5;++a1){aU.append($('<option value="'+a1+'">Q'+a1+"</option>"))}var aQ=localStorage.getItem("ticketSelectQuality");if(aQ!==null){aU.val(aQ)}aU.change(function(){localStorage.setItem("ticketSelectQuality",aU.val())});var aY=$("<button>",{text:"飞行","class":"small button foundation-style",style:"padding:5px; margin:3px;"});var aZ=$("<input>",{type:"checkbox",id:"newFightFrameCheckbox"});var a0=$("<label>",{"class":"checkboxlabel","for":"newFightFrameCheckbox",text:"刷新攻击框 ",title:"飞行后不刷新网页，只刷新攻击框"});var aO=localStorage.getItem("newFightFrame");if(aO==null){localStorage.setItem("newFightFrame","false")}else{aZ.attr("checked",aO=="true")}aZ.click(function(){$("input[type='radio']:disabled",aX).removeAttr("disabled");if(aZ.is(":checked")){localStorage.setItem("newFightFrame",true)}else{localStorage.setItem("newFightFrame",false)}});var aS=$("<div>");a6.append(aU,aY,aS);var aT=$("<b>",{text:"强制刷新",style:"text-align:right;color:#0066cc;text-decoration:underline;cursor:pointer"});aT.click(function(){aS.text("正在更新...");a5(location)});a6.append(aZ,a0,aT);var a4=$("form[action='travel.html']");if(a4.length>0){var aP=a4.children(".foundation-text-center").children("select#ticketQuality");var aW;for(var a1=1;a1<=5;++a1){var aV=aP.find("option[value="+a1+"]");if(aV.length<1){aW=0}else{aW=aV.text().split("(")[1].split(")")[0];if(aW.indexOf(",")>0){aW=aW.split(",")[0]}}if(aW!==""){$("#ticketQuality option[value='"+a1+"']").text("Q"+a1+" ("+aW+")")}else{$("#ticketQuality option[value='"+a1+"']").text("Q"+a1+" (0)")}}}else{$.ajax({url:"travel.html",success:function(ba){console.log("获取机票数量成功");var bb=$("select#ticketQuality",ba);var a7;for(var a8=1;a8<=5;++a8){var a9=bb.find("option[value="+a8+"]");if(a9.length<1){a7=0}else{a7=a9.text().split("(")[1].split(")")[0];if(a7.indexOf(",")>0){a7=a7.split(",")[0]}}if(a7!==""){$("#ticketQuality option[value='"+a8+"']").text("Q"+a8+" ("+a7+")")}else{$("#ticketQuality option[value='"+a8+"']").text("Q"+a8+" (0)")}}},error:function(a7,a8){console.log("获取机票数量失败 (",a8,")，重新抓取");$.ajax(this)}})}R();if(aO=="true"){$("input[type='radio']:disabled",aX).removeAttr("disabled")}aY.click(function(){var a7=$("input[type='radio']:checked",aX);if(a7.length===0){aS.text("请选择地区");return}var a9=parseInt(aU.val());var a8=parseInt(a7.attr("countryId"));var ba=parseInt(a7.val());aS.text("使用Q"+a9+"机票飞往 "+countryInfo[a8].name+" 的 "+regionInfo[ba].name);$.ajax({url:"travel.html",type:"POST",data:{countryId:a8,regionId:ba,ticketQuality:a9},success:function(bb){if($("#newFightFrameCheckbox").is(":checked")===true){var bc=$("div.testDivred",bb);if(bc.length===1){aS.text("飞行失败："+bc.text().trim())}else{aS.text("飞行成功！更新攻击框中……");a5(location)}}else{var bc=$("div.testDivred",bb);if(bc.length===1){aS.text("飞行失败："+bc.text().trim())}else{aS.text("飞行成功！");if($("#fightButtonBerserk1").length===0){location=location}}}},error:function(bb,bc){console.log("飞行错误 (",bc,")")}})});function a5(a7){$.ajax({url:a7,success:function(bb){var a8=$("link[href='//cdn.e-sim.org//css/fight.css']",bb).parent();if($("#fightLeft").length>0){$("#fightRight").empty();$("#fightRight").append(a8.children());var be=$("[id^=fightButton]");var bf=be.parent().parent();$("[id^=fightButton] > i",bf).remove()}else{$("link[href='//cdn.e-sim.org//css/fight.css'] :first").parent().replaceWith(a8);at()}var a9=parseFloat($("#actualHealth",bb).html());$("#healthProgress .ui-progressbar-value").animate({width:a9+"%"},{queue:false});$("#healthProgress").attr("title",a9+" / 100");$("#actualHealth").html(a9);P();v();E("advancedFightChooseTable");var ba=$('a[href^="region.html?id="][href!="region.html?id="]');var bg=ba.first().parent();var bc=$('a[href^="region.html?id="][href!="region.html?id="]',bb);var bd=bc.first().parent();bg.replaceWith(bd);aS.text("更新完毕！")}})}}function Q(){if(!isActive){return}if(defenderId==allies[0]){$(".xflagsBig-"+defenderName).after('<div class="fightFont">祖国</div>')}else{if(allies.indexOf(defenderId)>0){$(".xflagsBig-"+defenderName).after('<div class="fightFont">盟国</div>')}else{if(enemies.indexOf(defenderId)!==-1){$(".xflagsBig-"+defenderName).after('<div class="fightFont">敌国</div>')}else{if(coalitionMembers.indexOf(defenderId)>0){$(".xflagsBig-"+defenderName).after('<div class="fightFont">联盟成员国</div>')}}}}if(attackerId==allies[0]){$(".xflagsBig-"+attackerName).after('<div class="fightFont">祖国</div>')}else{if(allies.indexOf(attackerId)>0){$(".xflagsBig-"+attackerName).after('<div class="fightFont">盟国</div>')}else{if(enemies.indexOf(attackerId)!==-1){$(".xflagsBig-"+attackerName).after('<div class="fightFont">敌国</div>')}else{if(coalitionMembers.indexOf(attackerId)>0){$(".xflagsBig-"+attackerName).after('<div class="fightFont">联盟成员国</div>')}}}}if(allies.indexOf(defenderId)!==-1&&allies.indexOf(attackerId)===-1){var aO=defenderId==allies[0]?"祖国":"盟国";$(".flags-medium."+defenderName).after('<b style="color:lightgreen"><i class="icon-uniF479" />帮助'+aO+"</b>");$(".flags-medium."+attackerName).after('<b style="color:pink"><i class="icon-uniF478" />打反'+aO+"</b>")}else{if(allies.indexOf(defenderId)===-1&&allies.indexOf(attackerId)!==-1){var aO=attackerId==allies[0]?"祖国":"盟国";$(".flags-medium."+attackerName).after('<b style="color:lightgreen"><i class="icon-uniF479" />帮助'+aO+"</b>");$(".flags-medium."+defenderName).after('<b style="color:pink"><i class="icon-uniF478" />打反'+aO+"</b>");$("#copySideAttacker").attr("checked",true)}else{if(enemies.indexOf(defenderId)!==-1&&enemies.indexOf(attackerId)===-1){$(".flags-medium."+attackerName).after('<b style="color:lightgreen"><i class="icon-uniF479" />攻击敌国</b>');$(".flags-medium."+defenderName).after('<b style="color:pink"><i class="icon-uniF478" />帮助敌国</b>');$("#copySideAttacker").attr("checked",true)}else{if(enemies.indexOf(defenderId)===-1&&enemies.indexOf(attackerId)!==-1){$(".flags-medium."+defenderName).after('<b style="color:lightgreen"><i class="icon-uniF479" />攻击敌国</b>');$(".flags-medium."+attackerName).after('<b style="color:pink"><i class="icon-uniF478" />帮助敌国</b>')}else{}}}}}function v(){$(".flags-medium."+defenderName).attr("class","xflagsMedium xflagsMedium-"+defenderName);$(".flags-medium."+attackerName).attr("class","xflagsMedium xflagsMedium-"+attackerName)}function R(){function aT(bk,bi){var bh=[];for(var bg=0;bg<regionInfo[bk].neighbours.length;++bg){var bj=regionInfo[bk].neighbours[bg];if(regionInfo[bj].occupantId==bi){bh.push(bj)}}return bh}function aS(bh,bj,bk){var bl=[];var bq=[bh];var bn=bk;var bo=false;bn.push(bh);while(bq.length>0){var bg=bq.pop();bl.push(bg);if(regionInfo[bg].homeCountry==bj){bo=true}var bp=aT(bg,bj);for(var bm=0;bm<bp.length;++bm){var bi=bp[bm];if(bn.indexOf(bi)==-1){bq.push(bi);bn.push(bi)}}}return[bl,bo]}function be(bh,bl,bk){var bg=regionInfo[bl].name;var bi=$("<input>",{type:"radio",name:"regionId",id:"rR"+bh.selector.substring(1,2)+"-"+bl,value:bl,countryId:regionInfo[bl].occupantId});var bj='<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bl].occupantId].flagName+'" />';if(regionInfo[bl].occupantId!=regionInfo[bl].homeCountry){bj+='(<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bl].homeCountry].flagName+'" />)'}bj+='<label for="rR'+bh.selector.substring(1,2)+"-"+bl+'"> '+regionInfo[bl].name+"</label>";if(regionInfo[bl].battle){bj+=' <i title="'+regionInfo[bl].name+'正在被攻击" class="icon-cannon"></i> '}if(!bk){bj+=" (被包围)";bg+="(被包围)"}if((userLocationId==bl)&&bi.attr("disabled","disabled")){bj+=" (你在这里)"}bh.append(bi,bj,"<br />");return bg}function a5(bh,bk){var bg=regionInfo[bk].name;var bi=$("<input>",{type:"radio",name:"regionId",id:"rR"+bh.selector.substring(1,2)+"-"+bk,value:bk,countryId:regionInfo[bk].occupantId});var bj='<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bk].occupantId].flagName+'" />';if(regionInfo[bk].occupantId!=regionInfo[bk].homeCountry){bj+='(<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bk].homeCountry].flagName+'" />)'}bj+='<label for="rR'+bh.selector.substring(1,2)+"-"+bk+'"> '+regionInfo[bk].name+"</label>";if(regionInfo[bk].battle){bj+=' <i title="'+regionInfo[bk].name+'正在被攻击" class="icon-cannon"></i> '}bj+=" (断路)";bg+="(断路)";if((userLocationId==bk)&&bi.attr("disabled","disabled")){bj+=" (你在这里)"}bh.append(bi,bj,"<br />");return bg}defenderId=countryInfo[defenderName].id;attackerId=countryInfo[attackerName].id;var aP=aS(battleLocationId,defenderId,[]);var a9=aP[1];aP=aP[0];d("防守方被包围：",!a9);isAttackerLinkage=false;isDefenderLinkage=false;var aX=aT(battleLocationId,defenderId);if(aX.length===0){isDefenderLinkage=false;d(battleName,"不与防守方其它地区相连，所以",battleName,"不是守方连接地")}else{var bf=aS(aX[0],defenderId,[battleLocationId]);var aW=bf[1];bf=bf[0];if(bf.length==aP.length-1){d(battleName,"丢掉后，防守方现在相连的地区仍相连，所以",battleName,"不是守方连接地")}else{if(!aW){isDefenderLinkage=true;d(battleName,"丢掉后，防守方现在相连的地区被切断，且",regionInfo[aX[0]].name,"不与本土相连，因此",battleName,"是守方连接地")}else{for(var a8=1;a8<aX.length;++a8){if(bf.indexOf(aX[a8])!=-1){continue}var aV=aS(aX[a8],defenderId,[battleLocationId])[1];if(aV){isDefenderLinkage=false;d(battleName,"丢掉后，防守方现在相连的地区被切断，但都与本土相连，因此",battleName,"不是守方连接地")}else{isDefenderLinkage=true;d(battleName,"丢掉后，防守方现在相连的地区被切断，且",regionInfo[aX[a8]].name,"不与本土相连，因此",battleName,"是守方连接地")}}}}}defenderLocationText=be($("#defenderRegions"),battleLocationId,a9);attackerLocationText="";if(isResistance){attackerLocationText=be($("#attackerRegions"),battleLocationId,true)}var aQ=aT(battleLocationId,defenderId);var aU=[];var bb=false;for(var ba=0;ba<aQ.length;++ba){aU=aS(aQ[ba],defenderId,[]);bb=aU[1];defenderLocationText+=(defenderLocationText!==""?" 或 ":"")+be($("#defenderRegions"),aQ[ba],bb)}var a3=aT(battleLocationId,attackerId);var a6=[];var aZ=[];var a1=false;var a7=false;var a0=null;for(var ba=0;ba<a3.length;++ba){var a2=a3[ba];if(a6.indexOf(a2)!=-1){continue}a7=ba>0;aZ=aS(a3[ba],attackerId,[]);a1=aZ[1];if(!a1){a0=a3[ba]}aZ=aZ[0];for(var a8=0;a8<a3.length;++a8){if(aZ.indexOf(a3[a8])!=-1){if(!isResistance){attackerLocationText+=(attackerLocationText!==""?" 或 ":"")+be($("#attackerRegions"),a3[a8],a1)}a6.push(a3[a8])}}}if(a3.length<=0){for(var a2=1;a2<parseInt(localStorage.getItem("maxRegionCount"));a2++){if(regionInfo[a2]!=undefined){if(regionInfo[a2].occupantId==attackerId){a5($("#attackerRegions"),a2)}}}}if(!a7){isAttackerLinkage=false;d(battleName,"攻克后，进攻方没连接新的地区，因此",battleName,"不是夺回连接地")}else{if(a0===null){isAttackerLinkage=false;d(battleName,"攻克后，进攻方的两组地区连成一片，但它们已与本土相连，因此",battleName,"不是夺回连接地")}else{isAttackerLinkage=true;d(battleName,"攻克后，进攻方被包围的"+regionInfo[a0].name+"将与另一地区相连，因此",battleName,"是夺回连接地")}}var aO=' <div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[battleLocationId].homeCountry].flagName+'" />';var a4=battleLocationName;if(regionInfo[battleLocationId].capital){aO+='<img style="height:16px" src="https://cdn.e-sim.org/img/map/house.png"> ';a4+=" (首都)"}if(regionInfo[battleLocationId].rawRichness==="HIGH"){var aR=regionInfo[battleLocationId].raw.toLowerCase();aR=aR.charAt(0).toUpperCase()+aR.slice(1);aO+='<img style="height:16px" src="http://cdn.e-sim.org/img/productIcons/'+aR+'.png"> ';a4+=" ("+aR+")"}if(isDefenderLinkage){aO+=' (<div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+defenderName+'" />防守连接地) '}if(isAttackerLinkage){aO+=' (<div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+attackerName+'" />收复连接地) '}$("#fightName a[class=fightFont]").append(aO);var aY=(isResistance?4:0)+(isDefenderLinkage?2:0)+(isAttackerLinkage?1:0);var bc=[defenderNameOrFlag+" 在 "+a4+"防守"+attackerNameOrFlag,defenderNameOrFlag+" 防守 "+a4+", 保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 在连接地 "+a4+"防守"+attackerNameOrFlag,defenderNameOrFlag+" 防守连接地 "+a4+", 并保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 镇压 "+attackerNameOrFlag+" 在 "+a4+" 的起义",defenderNameOrFlag+" 镇压 "+a4+" 的起义, 保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 镇压 "+attackerNameOrFlag+" 在连接地 "+a4+" 的起义",defenderNameOrFlag+" 镇压连接地 "+a4+" 的起义, 并保持"+attackerNameOrFlag+"断路"];var bd=[attackerNameOrFlag+" 进攻 "+defenderNameOrFlag+" 的 "+a4,attackerNameOrFlag+" 进攻 "+defenderNameOrFlag+", 收复连接地 "+a4,attackerNameOrFlag+" 进攻 "+a4+", 使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 收复连接地 "+a4+", 同时使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 在 "+a4+" 起义反抗 "+defenderNameOrFlag,attackerNameOrFlag+" 在 "+a4+" 起义反抗 "+defenderNameOrFlag+", 收复连接地",attackerNameOrFlag+" 在 "+a4+" 发起起义, 使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 在 "+a4+" 发起起义, 收复连接地并使"+defenderNameOrFlag+"断路"];defenderDescription=bc[aY];attackerDescription=bd[aY];d(defenderDescription);d(attackerDescription)}function ak(){$("#battleProgressStats").append('<div id="wallStat"></div>');function aP(){var aR=defenderHistoryClutch.length-1;if(aR<=1){return}var aU=aR-1;while(aU>0&&defenderHistoryClutch[aU][0]>defenderHistoryClutch[aR][0]-15){aU--}if(aU<aR-1){}aU++;var aS=defenderHistoryClutch[aR][0]-defenderHistoryClutch[aU][0];var aT=(defenderHistoryClutch[aR][1]-defenderHistoryClutch[aU][1])/aS;var aQ=(attackerHistoryClutch[aR][1]-attackerHistoryClutch[aU][1])/aS;$("#defenderFirepower").text((aT*15/1000000).toFixed(1));$("#attackerFirepower").text((aQ*15/1000000).toFixed(1))}function aO(){var aS=X();$("#ehCountdown").text(O(aS));var aQ=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aR=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aT=aQ-aR;if(aT===0){$("#wallStat").text("")}else{if(aT>0){$("#wallStat").text(">> "+aT.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>")}else{$("#wallStat").text("<< "+(-aT).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<")}}if($("#autoCopy").is(":checked")){aq()}if(aS>0&&aS<clutchStandard){if(defenderHistoryClutch.length<=1){lastUpdatedSeconds=aS;defenderHistoryClutch.push([-aS,aQ]);attackerHistoryClutch.push([-aS,aR])}else{if(defenderHistoryClutch[defenderHistoryClutch.length-1][1]<aQ||attackerHistoryClutch[attackerHistoryClutch.length-1][1]<aR){lastUpdatedSeconds=aS;defenderHistoryClutch.push([-aS,aQ]);attackerHistoryClutch.push([-aS,aR])}}$("#wallStat").append(' <b style="font-size:12px;">('+(lastUpdatedSeconds-aS)+"秒前更新)</b>");if(lastUpdatedSeconds<=aS){aP();if($("#ehDivStatistics").attr("style").indexOf("display:block")!=-1){az()}}}}endEpoch=(new Date().getTime())+o()*1000;window.setInterval(aO,1000)}function C(){var a0=$("#ehRefresh");var aZ=$("<div>");var aR=$("<button>",{type:"button","class":"small button foundation-style",id:"manualRefresh",style:"padding:6px;",html:'<i class="icon-search"></i>刷新',title:"刷新双方的总伤害"});var aQ=$("<input>",{type:"checkbox","class":"foundation-style",id:"autoRefresh",text:"自动"});var a1=$("<input>",{type:"radio",id:"copySideDefender",name:"copySide",value:"defender",checked:"checked"});var a4=$("#fightName a[class=fightFont]").text().trim();if($(".fightFlagDefender").length>0){var a2=$(".fightFlagDefender").attr("class").split(" ").pop();var aT=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a2.substring(a2.indexOf("-")+1)})}else{if($(".xflagsBig").length>0){var a2=$(".xflagsBig:first").attr("class").split(" ").pop();var aT=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a2.substring(a2.indexOf("-")+1)})}else{if($(".flags-big").length>0){var aT=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+$("div.fightFlag.flags-big").first().attr("class").split(" ")[2]})}else{var aT=$("<span>",{style:"vertical-align:middle;","class":"icon-uniF472"})}}}aZ.append(aR,aQ,"自动",a1,aT);var aY=$("<div>");var aS=$("<button>",{type:"button","class":"small button foundation-style",id:"manualCopy",style:"padding:6px;",html:'<i class="icon-comment2"></i>复制',title:"复制战场状态到剪贴板"});var aU=$("<input>",{type:"checkbox","class":"foundation-style",id:"autoCopy",text:"自动"});var aV=$("<input>",{type:"radio",id:"copySideAttacker",name:"copySide",value:"attacker"});if($(".fightFlagAttacker").length>0){var a3=$(".fightFlagAttacker").attr("class").split(" ").pop();var aX=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a3.substring(a3.indexOf("-")+1)})}else{if($(".xflagsBig").length>0){var a3=$(".xflagsBig:last").attr("class").split(" ").pop();var aX=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a3.substring(a3.indexOf("-")+1)})}else{if($(".flags-big").length>0){var aX=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+$("div.fightFlag.flags-big").last().attr("class").split(" ")[2]})}else{var aX=$("<span>",{style:"vertical-align:middle;","class":"icon-uniF473"})}}}aY.append(aS,aU,"自动",aV,aX);a0.append(aZ,aY);$("#defenderScore").after('<div title="防守方即时输出，仅在自动刷新时显示">防守火力: <b id="defenderFirepower" style="color:lightblue">?</b> M/15秒</div>');$("#attackerScore").after('<div title="进攻方即时输出，仅在自动刷新时显示">进攻火力: <b id="attackerFirepower" style="color:pink">?</b> M/15秒</div>');$("#manualRefresh").click(T);$("#manualCopy").click(aq);var aW=0;$("#autoRefresh").click(function(){if($(this).is(":checked")){if(X()>0){aW=window.setInterval(T,7000)}$("#manualRefresh").attr("disabled",true)}else{window.clearInterval(aW);$("#manualRefresh").attr("disabled",false)}});$("#autoCopy").click(function(){if($(this).is(":checked")){$("#manualCopy").attr("disabled",true)}else{$("#manualCopy").attr("disabled",false)}});if(typeof(unsafeWindow.sendUpdateRequest)=="function"){var aP=unsafeWindow.sendUpdateRequest.toString().replace(/dataString \+\= \'&at\=.+?;/,";").replace(/dataString \+\= \'&ci\=.+?;/,";").replace(/\s+/g,"");var aO=1075;if(isPremium){aO=1100}if(aP.length===aO){d("sendUpdateRequest已检查，无变化（字数："+aO+"）")}else{alert("页面中的 sendUpdateRequest 函数有更新，请联系e-sim helper的开发者。刷新功能暂时禁用。\n");$("#autoRefresh").attr("disabled",true);$("#manualRefresh").attr("disabled",true);d("sendUpdateRequest已检查，有变化")}}else{d("sendUpdateRequest未检查")}if(!isActive){$("#autoRefresh").attr("disabled",true);$("#manualRefresh").attr("disabled",true);$("#autoCopy").attr("disabled",true);$("#manualCopy").attr("disabled",true);$("#copySideAttacker").attr("disabled",true);$("#copySideDefender").attr("disabled",true)}}function aq(){function aV(aX,aZ){var aY=aX.toString()+":"+aZ.toString();if(aX===aZ){return aY}if(aX>aZ){return aY+(aX===8?"获胜":"领先")}else{return aY+(aZ===8?"失利":"落后")}}var aW=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aQ=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aT=((aW-aQ)/1000000).toFixed(2);var aR=X();var aU="";if(aR>=120||aR%5===0){var aS=document.URL.match(/.+?battle.html\?id=[0-9]+/).toString();if(aS.indexOf("https")>=0){aU+=aS+"\n";aU+=aS.replace(/https/,"http")+"\n"}else{if(aS.indexOf("http")>=0){aU+=aS.replace(/http/,"https")+"\n";aU+=aS+"\n"}else{aU+=document.URL.match(/.+?battle.html\?id=[0-9]+/)+"\n"}}}if(aR>=120){if($("#copySideDefender").is(":checked")){aU+="第"+roundId+"局(总比分"+aV(defenderScore,attackerScore)+"), t"+parseInt(aR/60)+"墙高"+aT.toString()+"M\n"+defenderDescription+(battleLocationId==-1?"":"\n加成地点"+defenderLocationText)}else{aU+="第"+roundId+"局(总比分"+aV(attackerScore,defenderScore)+"), t"+parseInt(aR/60)+"墙高"+(-aT).toString()+"M\n"+attackerDescription+(battleLocationId==-1?"":"\n加成地点"+attackerLocationText)}}else{if(aR>0){aU+=aR.toString()+"秒, ";var aO=parseFloat($("#defenderFirepower").text());var aP=parseFloat($("#attackerFirepower").text());if($("#copySideDefender").is(":checked")){aU+=aT.toString()+"M ("+(lastUpdatedSeconds-aR)+"秒前更新)";if(!isNaN(aO)){aU+=", "+defenderNameOrFlag+"火力 "+aO+(aO<aP?"M < ":"M ≥ ")+aP+"M"}}else{aU+=(-aT).toString()+"M ("+(lastUpdatedSeconds-aR)+"秒前更新)";if(!isNaN(aO)){aU+=", "+attackerNameOrFlag+"火力 "+aP+(aP<aO?"M < ":"M ≥ ")+aO+"M"}}}else{aU+=battleName+"第"+roundId+"局结束, ";if($("#copySideDefender").is(":checked")){if(aW>=aQ){aU+="防守方"+defenderNameOrFlag+"获胜("+aT.toString()+"M), 总比分"+aV(defenderScore+1,attackerScore)}else{aU+="防守方"+defenderNameOrFlag+"失利("+aT.toString()+"M), 总比分"+aV(defenderScore,attackerScore+1)}}else{if(aQ>=aW){aU+="进攻方"+attackerNameOrFlag+"获胜("+(-aT).toString()+"M), 总比分"+aV(attackerScore+1,defenderScore)}else{aU+="进攻方"+attackerNameOrFlag+"失利("+(-aT).toString()+"M), 总比分"+aV(attackerScore,defenderScore+1)}}}}GM_setClipboard(aU)}function ad(aP){var aO=X();var aQ=timeBias;if(aP<aO){timeBias+=(aO-aP)}else{if(timeBias>0&&aO%6===0){timeBias--}}console.log("实际时间≤"+aP+", 页面时间="+o()+", eh计时="+aO+", 修正值="+aQ,"->",timeBias)}function T(aO){var aP="id="+battleRoundId;aP+="&at="+userId;aP+="&ci="+userCitizenshipId;if(isPremium||aO===true){d("以高级会员身份抓取数据");aP+="&premium=1"}$.ajax({type:"GET",url:"battleScore.html",data:aP,dataType:"json",success:function(aR){historyLen=defenderHistoryClutch.length;if(historyLen>0){if(defenderHistoryClutch[historyLen-1][1]>parseInt(aR.defenderScore.replace(/,/g,"").replace(/\xA0/g,""))||attackerHistoryClutch[historyLen-1][1]>parseInt(aR.attackerScore.replace(/,/g,"").replace(/\xA0/g,""))){return}}aR=cloneInto(aR,unsafeWindow);unsafeWindow.updateStatus(aR.attackerScore,aR.defenderScore,aR.remainingTimeInSeconds,aR.percentAttackers);ad(aR.remainingTimeInSeconds);if(aR.remainingTimeInSeconds<=clutchStandard){lastUpdatedSeconds=aR.remainingTimeInSeconds<0?0:aR.remainingTimeInSeconds;defenderHistoryClutch.push([-lastUpdatedSeconds,parseInt(aR.defenderScore.replace(/,/g,"").replace(/\xA0/g,""))]);attackerHistoryClutch.push([-lastUpdatedSeconds,parseInt(aR.attackerScore.replace(/,/g,"").replace(/\xA0/g,""))]);if(lastUpdatedSeconds>0&&$("#ehDivStatistics").attr("style").indexOf("display:block")!=-1){az()}}unsafeWindow.updateBattleHeros(aR.topAttackers,aR.topDefenders);unsafeWindow.updateTop10(aR.top10Attackers,aR.top10Defenders);if(!isPremium&&aO===false){unsafeWindow.updateBattleMonitor(aR)}else{$("#ehTotaldefenders").html(aR.defendersOnline);$("#ehTotalattackers").html(aR.attackersOnline);$("#ehTotalspectators").html(aR.spectatorsOnline);$("#ehDefendersMenu").html(aR.defendersByCountries);$("#ehAttackersMenu").html(aR.attackersByCountries);$("#ehSpectatorsMenu").html(aR.spectatorsByCountries);$(".countryNameTranslated").attr("onclick","window.open('citizensOnline.html?countryId=' + countryInfo[this.innerText].id);")}unsafeWindow.updatePlace(aR.yourPlace);unsafeWindow.updateTotalDamage(aR.totalPlayerDamage);for(var aQ=0;aQ<aR.recentAttackers.length;aQ++){if(aR.recentAttackers[aQ].id==unsafeWindow.latestAttackerId){aR.recentAttackers=cloneInto(aR.recentAttackers.slice(0,aQ),unsafeWindow);break}}for(aQ=0;aQ<aR.recentDefenders.length;aQ++){if(aR.recentDefenders[aQ].id==unsafeWindow.latestDefenderId){aR.recentDefenders=cloneInto(aR.recentDefenders.slice(0,aQ),unsafeWindow);break}}if(aR.recentAttackers.length!==0){unsafeWindow.latestAttackerId=aR.recentAttackers[0].id;unsafeWindow.attackerHits=aR.recentAttackers}if(aR.recentDefenders.length!==0){unsafeWindow.latestDefenderId=aR.recentDefenders[0].id;unsafeWindow.defenderHits=aR.recentDefenders}}})}function l(aO){return aO.slice(6,10)+"/"+aO.slice(3,5)+"/"+aO.slice(0,2)+aO.slice(10,aO.indexOf(":")+6)}function s(ba){var aY=JSON.parse(ba);var aX=new Date(l(aY[aY.length-1].time));var aR=new Date(l(aY[0].time));$("<div>",{text:"服务器时间 "+aX.toLocaleString()+" - "+aR.toLocaleString()}).prependTo($("#ehBattleDescription"));aX=aX.getTime();var a1=parseInt((aR.getTime()-aX)/(60*1000));if(a1<10){aX=aR-600*1000;a1=10}else{if(a1<120){aX=aR-7200*1000;a1=120}}var aP={"true":[],"false":[]};for(var a2=0;a2<=a1;++a2){aP["true"][a2]=0;aP["false"][a2]=0}var a4={"true":{},"false":{}};var a9={"true":{},"false":{}};var a5={"true":{},"false":{}};var aT=0;for(a2=0;a2<aY.length;++a2){var a3=aY[a2];aT+=a3.berserk?5:1;var aW=parseInt((Date.parse(l(a3.time))-aX)/(60*1000));aP[a3.defenderSide][aW]=aP[a3.defenderSide][aW]+a3.damage;var a0=a3.citizenship;a4[a3.defenderSide][a0]=(a4[a3.defenderSide][a0])?(a4[a3.defenderSide][a0]+a3.damage):a3.damage;var aS=a3.citizenId;a5[a3.defenderSide][aS]=(a5[a3.defenderSide][aS])?(a5[a3.defenderSide][aS]+a3.damage):a3.damage;var aZ=a3.militaryUnit;if(aZ){a9[a3.defenderSide][aZ]=(a9[a3.defenderSide][aZ])?(a9[a3.defenderSide][aZ]+a3.damage):a3.damage}}$("<div>",{text:"本局掉落Q5装备"+(aT/30000).toFixed(2)+"件，Q4装备"+(aT/10000).toFixed(2)+"件"}).prependTo($("#ehBattleDescription"));var a7=new Array(a1+1);var a8=new Array(a1+1);a7[0]=aP["true"][0];a8[0]=aP["false"][0];for(a2=1;a2<=a1;++a2){a7[a2]=a7[a2-1]+aP["true"][a2];a8[a2]=a8[a2-1]+aP["false"][a2]}var a6=Math.pow(10,Math.floor(Math.log10(Math.max(a7[a1],a8[a1]))));$.jqplot("ehChart120m",[a7,a8],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"时间 (分钟)",max:a1,min:0,tickOptions:{formatString:"%d"}},yaxis:{min:0,tickInterval:a6,pad:1.1,tickOptions:{formatString:"%'d"}}}});var aU=180;aP={"true":[],"false":[]};for(a2=0;a2<=aU;++a2){aP["true"][a2]=0;aP["false"][a2]=0}var a5={"true":{},"false":{}};for(a2=0;a2<aY.length;++a2){var a3=aY[a2];var aW=parseInt((aR-Date.parse(l(a3.time)))/1000);aW=aW>=aU?aU:aW;aP[a3.defenderSide][aW]=aP[a3.defenderSide][aW]+a3.damage;if(aW<aU){var aS=a3.citizenId;if(a5[a3.defenderSide][aS]){a5[a3.defenderSide][aS].damage+=a3.damage;a5[a3.defenderSide][aS].hitNumber[a3.weapon]+=a3.berserk?5:1;a5[a3.defenderSide][aS].first=aW}else{a5[a3.defenderSide][aS]={};a5[a3.defenderSide][aS].citizenId=aS;a5[a3.defenderSide][aS].damage=a3.damage;a5[a3.defenderSide][aS].hitNumber=[0,0,0,0,0,0];a5[a3.defenderSide][aS].hitNumber[a3.weapon]=a3.berserk?5:1;a5[a3.defenderSide][aS].citizenship=a3.citizenship;a5[a3.defenderSide][aS].militaryUnit=a3.militaryUnit;a5[a3.defenderSide][aS].first=aW;a5[a3.defenderSide][aS].last=aW}}}var aO=aP["true"][aU];var aQ=aP["false"][aU];a7=[[-aU,aO]];a8=[[-aU,aQ]];for(a2=aU-1;a2>=0;--a2){aO+=aP["true"][a2];aQ+=aP["false"][a2];a7.push([-a2,aO]);a8.push([-a2,aQ])}$.jqplot("ehChartClutch",[a7,a8],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"时间 (秒)",max:0,min:-aU,tickOptions:{formatString:"%d"}},yaxis:{min:0,tickInterval:a6,pad:1.1,tickOptions:{formatString:"%'d"}}}});aV(a5["true"],$("#ehTableClutchDefenders"));aV(a5["false"],$("#ehTableClutchAttackers"));function aV(bb,bd){var bc=Object.keys(bb).map(function(bh){return bb[bh]});bc.sort(function(bi,bh){return bh.damage-bi.damage});var bg=$("<div>",{style:"text-align: left; margin:1em 1.6em 1em 1em; font-size:.9em;"}).appendTo(bd);var be=$("<table>",{style:"width:100%;"}).appendTo(bg);var bf=$("<tr>").appendTo(be).append($("<td>",{text:"玩家",style:"text-align:center;"}),$("<td>",{colspan:2,text:"时段",style:"text-align:center;"}),$("<td>",{text:"次数",style:"text-align:right;"}),$("<td>",{text:"Q5",style:"text-align:right;"}),$("<td>",{text:"伤害值",style:"text-align:right;"}));$.each(bc,function(bi,bj){var bh=$("<tr>").appendTo(be);var bl=$("<td>").appendTo(bh);$("<b>",{style:"float:left;padding: 0 .5em 0 0",text:bi+1}).appendTo(bl);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bj.citizenship].flagName}).appendTo(bl);if(citizenPage[bj.citizenId]){$("<img>",{align:"absmiddle","class":"smallAvatar",src:citizenPage[bj.citizenId].avatar.replace("normal","small")}).appendTo(bl)}else{$("<img>",{align:"absmiddle","class":"smallAvatar",src:"//cdn.e-sim.org/img/blank-avatar.png"}).appendTo(bl)}$("<a>",{"class":"profileLink",href:"profile.html?id="+bj.citizenId,text:citizenInfo[bj.citizenId]?citizenInfo[bj.citizenId].login:"???"}).appendTo(bl);$("<td>",{style:"text-align:right;",text:bj.first+"~"}).appendTo(bh);$("<td>",{style:"text-align:right;",text:bj.last+"s"}).appendTo(bh);var bk=0;$.each(bj.hitNumber,function(bm,bn){bk+=bn});$("<td>",{style:"text-align:right;",text:bk}).appendTo(bh);$("<td>",{style:"text-align:right;",text:bj.hitNumber[5]}).appendTo(bh);$("<td>",{style:"text-align:right;",text:bj.damage.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).appendTo(bh)})}}function az(){if(X()>=clutchStandard){$("#ehChartClutch").text("压秒趋势图仅在战场结束前"+clutchStandard+"秒内显示");return}$("#ehChartClutch").text("");console.log(X(),"重绘压秒趋势图");if(chartClutch){chartClutch.destroy()}chartClutch=$.jqplot("ehChartClutch",[defenderHistoryClutch,attackerHistoryClutch],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"倒计时",max:0,pad:1.1,tickOptions:{formatString:"%d"}},yaxis:{min:0,pad:1.1,tickOptions:{formatString:"%'d"}}}})}function ai(){if(!isActive){$("#ehButtonStatistics").click();$("#ehDivStatistics").append($("<div>",{id:"ehBattleDescription"}));$("#ehDivStatistics").append('<br /> <div style="font-size:24px;"> 全场趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChart120m",style:"height:300px;width:750px;"}));$("<table>",{id:"ehTable120m"}).hide().appendTo($("#ehDivStatistics"));$("#ehDivStatistics").append('<br /> <br /> <br /> <div style="font-size:24px;"> 压秒趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChartClutch",style:"height:300px;width:750px;"}));$("<div>",{id:"ehTableClutchDefenders","class":"foundation-style small-5 columns"}).appendTo($("#ehDivStatistics"));$("<div>",{id:"ehTableClutchAttackers","class":"foundation-style small-5 columns"}).appendTo($("#ehDivStatistics"));$.ajax({url:"apiFights.html?battleId="+battleId+"&roundId="+roundId,timeout:5000,success:s,error:function(aO,aP){d("战斗记录抓取错误 (",aP,")，重新抓取");$.ajax(this)}})}else{$("#ehDivStatistics").append('<br /> <div style="font-size:24px;"> 压秒趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChartClutch",style:"height:300px;width:750px;"}));defenderHistoryClutch=[[]];attackerHistoryClutch=[[]];chartClutch=null;clutchStandard=300;lastUpdatedSeconds=X();$("#ehButtonStatistics").click(az)}}function L(){var aX=$("#ehDivSpecial");var aQ=$("<table>",{style:"width:100%;line-height:1px;"}).appendTo(aX);var aV=$("<tr>").appendTo(aQ);var aR=$("<td>").appendTo(aV);var aW=$("<p>",{"class":"AjaxStat",text:"准备中……"}).appendTo(aR);function aP(){var aY=G.length;for(var aZ=0;aZ<aY;aZ++){if((G[aZ].readyState==4)||(G[aZ].readyState==0)){G.splice(aZ,1);aZ=aZ-1;aY=aY-1}}aY=G.length;if(aY<=0){aW.text("当前网页共有"+aY+"个未完成请求，网络畅通。")}else{if(aY<6){aW.text("当前网页共有"+aY+"个未完成请求，网络畅通。")}else{aW.text("当前网页共有"+aY+"个未完成请求，网络堵塞，后续请求无法立即响应。");if(($("#AutoAbortAllAjax").is(":checked"))&&(aY>10)){Z()}}}}setInterval(aP,3000);aV=$("<tr>").appendTo(aQ);aR=$("<td>").appendTo(aV);var aU=$("<button>",{text:"终止所有未完成请求","class":"small button foundation-style"}).appendTo(aR);aU.click(function(){Z()});aa(aR,"AutoAbortAllAjax","自动清理请求","AutoAbortAllAjax",false);$("<p>发送到Discord</p>").appendTo(aX);aQ=$("<table>",{style:"width:100%;line-height:1px;"}).appendTo(aX);aV=$("<tr>").appendTo(aQ);aR=$("<td>").appendTo(aV);aV=$("<tr>").appendTo(aQ);aR=$("<td>").appendTo(aV);$("<p>登录网页版discord，开启F12控制台的Network页，在discord频道里</p><p>发送一条信息，点击控制台Network里出现的messages，在右边往下</p><p>找到Request Headers的authorization：右边内容复制到这里</p>").appendTo(aR);aR=$("<td>").appendTo(aV);$("<p>",{text:"右击discord频道，选择复制ID粘贴进来"}).appendTo(aR);aV=$("<tr>").appendTo(aQ);aR=$("<td>").appendTo(aV);$("<span>",{text:"authToken："}).appendTo(aR);Y(aR,300,"discordAuthToken","");aR=$("<td>").appendTo(aV);$("<span>",{text:"channelID："}).appendTo(aR);Y(aR,200,"discordChannelID","");aV=$("<tr>").appendTo(aQ);aR=$("<td>").appendTo(aV);aa(aR,"diyMessageToDiscord","自定义发送消息","diyMessageToDiscord",false);Y(aR,200,"diyMessageToDiscordText","");aR=$("<td>").appendTo(aV);var aO=$("<button>",{text:"发送到Discord",id:"sendToDiscordButton","class":"small button foundation-style"}).appendTo(aR);aO.click(function(){if($("#diyMessageToDiscord").is(":checked")){aT($("#diyMessageToDiscordText").val(),localStorage.getItem("discordAuthToken"),localStorage.getItem("discordChannelID"))}else{aT(aS(),localStorage.getItem("discordAuthToken"),localStorage.getItem("discordChannelID"))}});aa(aR,"autoSendMessageToDiscord","T5自动发送(不用记得去掉)","autoSendMessageToDiscord",false);function aS(){function a2(a5,a7){var a6=a5.toString()+":"+a7.toString();if(a5===a7){return a6}if(a5>a7){return a6+(a5===8?"获胜":"领先")}else{return a6+(a7===8?"失利":"落后")}}var aZ=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var a0=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var a1=((aZ-a0)/1000000).toFixed(2);var a3=X();var aY="";var a4=document.URL.match(/.+?battle.html\?id=[0-9]+/).toString();if(a4.indexOf("https")>=0){aY+=a4+"\n";aY+=a4.replace(/https/,"http")+"\n"}else{if(a4.indexOf("http")>=0){aY+=a4.replace(/http/,"https")+"\n";aY+=a4+"\n"}else{aY+=document.URL.match(/.+?battle.html\?id=[0-9]+/)+"\n"}}if(a3>0){if($("#copySideDefender").is(":checked")){aY+="第"+roundId+"局(总比分"+a2(defenderScore,attackerScore)+"), t"+parseInt(a3/60)+"墙高"+a1.toString()+"M\n"+defenderDescription}else{aY+="第"+roundId+"局(总比分"+a2(attackerScore,defenderScore)+"), t"+parseInt(a3/60)+"墙高"+(-a1).toString()+"M\n"+attackerDescription}}else{aY+=battleName+"第"+roundId+"局结束, ";if($("#copySideDefender").is(":checked")){if(aZ>=a0){aY+="防守方"+defenderNameOrFlag+"获胜("+a1.toString()+"M), 总比分"+a2(defenderScore+1,attackerScore)}else{aY+="防守方"+defenderNameOrFlag+"失利("+a1.toString()+"M), 总比分"+a2(defenderScore,attackerScore+1)}}else{if(a0>=aZ){aY+="进攻方"+attackerNameOrFlag+"获胜("+(-a1).toString()+"M), 总比分"+a2(attackerScore+1,defenderScore)}else{aY+="进攻方"+attackerNameOrFlag+"失利("+(-a1).toString()+"M), 总比分"+a2(attackerScore,defenderScore+1)}}}return aY}function aT(a0,aY,aZ){if((a0!="")&&(aY!="")&&(aZ!="")){$.ajax({type:"POST",url:"https://discordapp.com/api/channels/"+aZ+"/messages",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US","Content-Type":"application/json",Authorization:aY},data:JSON.stringify({content:a0})})}else{alert("发送失败：缺少参数")}}}var f=false;function E(a0){var a2=$("."+a0);if(a2.length>0){a2.remove()}var aT="defender";var a9="attacker";var aV="side";var aX="undefined";var a6="Berserk";var a8=$("<table>",{"class":a0,style:"width:100%;line-height:1px;"});var aP=$("<tr>",{style:"background-color:DarkSlateGray;",height:"30px"}).appendTo(a8);var aY=$("<td>").appendTo(aP);$("<span>输出选择：</span>").appendTo(aY);if($("#fightButton2").length>0){aY=$("<td>").appendTo(aP);$("<span>防守方：</span>").appendTo(aY);var aQ=$("<input>",{type:"radio",id:"AFHitStyleLeftHit",name:"AFHitStyle","data-AFSide":aT,"data-AFValue":aX}).appendTo(aY);var aR=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleLeftHit",text:"打一下"}).appendTo(aY);var a7=$("<input>",{type:"radio",id:"AFHitStyleLeftBerserk",name:"AFHitStyle","data-AFSide":aT,"data-AFValue":a6}).appendTo(aY);var aW=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleLeftBerserk",text:"打五下"}).appendTo(aY);aY=$("<td>").appendTo(aP);$("<span>进攻方：</span>").appendTo(aY);var aU=$("<input>",{type:"radio",id:"AFHitStyleRightHit",name:"AFHitStyle","data-AFSide":a9,"data-AFValue":aX}).appendTo(aY);var a5=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleRightHit",text:"打一下"}).appendTo(aY);var aZ=$("<input>",{type:"radio",id:"AFHitStyleRightBerserk",name:"AFHitStyle","data-AFSide":a9,"data-AFValue":a6}).appendTo(aY);var aS=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleRightBerserk",text:"打五下"}).appendTo(aY)}else{if($("#fightButton1").length>0){aY=$("<td>").appendTo(aP);var a3=$("<input>",{type:"radio",id:"AFHitStyleHit",name:"AFHitStyle","data-AFSide":aV,"data-AFValue":aX}).appendTo(aY);var aO=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleHit",text:"打一下"}).appendTo(aY);var a4=$("<input>",{type:"radio",id:"AFHitStyleBerserk",name:"AFHitStyle",checked:"checked","data-AFSide":aV,"data-AFValue":a6}).appendTo(aY);var a1=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleBerserk",text:"打五下"}).appendTo(aY)}else{aY=$("<td>").appendTo(aP);$("<span>当前所在地无法输出</span>").appendTo(aY)}}$(".setupAdvancedTable").after(a8)}function x(){var aY=$("#ehDivAdvanced");if(localStorage.getItem("EnableAutoFight")!=="true"){$("<p>",{"class":"advancedStat",text:"未启用自动打枪。"}).appendTo(aY);return}var a1=$("<p>",{"class":"advancedStat",text:"使用自动打枪有可能受到封号惩罚。使用前你必须清楚其原理作用和可能产生的后果。"}).appendTo(aY);function aX(ba){a1.text(ba)}var aS=false;var a7;var aZ=0;var aP=0;var a5=0;var a0;function a8(){aZ=0;aP=0;a5=0}function aT(bd,ba){var bc=ba-bd;var bb=Math.random()*bc+bd;bb=parseInt(bb,10);return bb}var aR=[];a4();function a4(){var be=$("<div>",{"class":"foundation-style small-10 columns foundation-text-center"}).appendTo(aY);var bb=$("<table>",{align:"right"}).appendTo(be);var bj=$("<button>",{type:"button","class":"small button foundation-style",id:"AFManualStart",text:"开始自动打枪"}).appendTo(bb);bj.attr("disabled",true);var bq=$("<button>",{type:"button","class":"small button foundation-style",id:"AFStopButton",text:"停止自动打枪"}).appendTo(bb);bq.attr("disabled",true);var bn=$("<table>",{"class":"setupAdvancedTable",style:"width:100%;line-height:1px;height:200px;"}).appendTo(aY);var bm;var bf;bm=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bn);bf=$("<td>",{width:"25%"}).appendTo(bm);$("<span>补充额度顺序：</span>").appendTo(bf);bf=$("<td>",{width:"25%"}).appendTo(bm);g(bf,"优先：",[0,1,2],["无","食物","礼物"],"AFRestoreHealth1",2);bf=$("<td>",{width:"25%"}).appendTo(bm);g(bf,"其次：",[0,1,2],["无","食物","礼物"],"AFRestoreHealth2",1);$("<td>",{width:"25%"}).appendTo(bm);bm=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bn);bf=$("<td>").appendTo(bm);aa(bf,"AFRestrictHitCount","限制攻击次数：","AFRestrictHitCount",false);$("<span>最多</span>").appendTo(bf);Y(bf,60,"AFRestrictHitCountTextbox","15");$("<span>次攻击</span>").appendTo(bf);bf=$("<td>").appendTo(bm);aa(bf,"AFRestrictDamage","限制伤害：","AFRestrictDamage",false);$("<span>总伤害超过</span>").appendTo(bf);Y(bf,60,"AFRestrictDamageTextbox","1000000");$("<span>后停止</span>").appendTo(bf);bf=$("<td>").appendTo(bm);aa(bf,"AFRestrictTime","限制时间：","AFRestrictTime",false);$("<span>自动打枪</span>").appendTo(bf);Y(bf,60,"AFRestrictTimeTextbox","10");$("<span>秒后停止</span>").appendTo(bf);bf=$("<td>").appendTo(bm);bm=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bn);bf=$("<td>").appendTo(bm);var bg=$("<input>",{type:"radio",id:"AFStartModeAuto",name:"AFSelectStartMode","data-startmode":"auto"}).appendTo(bf);var bd=$("<label>",{"class":"checkboxlabel","for":"AFStartModeAuto",text:"自动开始："}).appendTo(bf);$("<span>在S</span>").appendTo(bf);Y(bf,40,"AFStartModeAutoStartTextbox","15");$("<span>到S</span>").appendTo(bf);Y(bf,40,"AFStartModeAutoEndTextbox","10");$("<span>之间任意时间</span>").appendTo(bf);bf=$("<td>").appendTo(bm);var bh=$("<input>",{type:"radio",id:"AFStartModeManual",name:"AFSelectStartMode","data-startmode":"manual"}).appendTo(bf);var bc=$("<label>",{"class":"checkboxlabel","for":"AFStartModeManual",text:"手动开始"}).appendTo(bf);var bl=localStorage.getItem("AFStartModeSettings");if(bl===null){localStorage.setItem("AFStartModeSettings","1");bh.attr("checked",true)}else{if(bl=="0"){bg.attr("checked",true)}else{bh.attr("checked",true)}}bg.change(function(){if(bg.is(":checked")){localStorage.setItem("AFStartModeSettings","0")}else{localStorage.setItem("AFStartModeSettings","1")}});bh.change(function(){if(bh.is(":checked")){localStorage.setItem("AFStartModeSettings","1")}else{localStorage.setItem("AFStartModeSettings","0")}});bf=$("<td>").appendTo(bm);bf=$("<td>").appendTo(bm);bm=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bn);bf=$("<td>").appendTo(bm);$("<span>每次攻击间隔（毫秒）：</span>").appendTo(bf);bf=$("<td>").appendTo(bm);Y(bf,60,"AFIntervalStart","500");$("<span>到</span>").appendTo(bf);Y(bf,60,"AFIntervalEnd","1500");bf=$("<td>").appendTo(bm);$("<span>未响应请求允许数量：</span>").appendTo(bf);bf=$("<td>").appendTo(bm);Y(bf,60,"AFMaxNotRespondRequest","12");var bo=$("<table>",{align:"right"}).appendTo(aY);bm=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bf=$("<td>").appendTo(bm);$("<span>总伤害： </span>").appendTo(bf);var bp=$("<span>",{id:"AFNowTotalDamage"}).appendTo(bf);bf=$("<td>").appendTo(bm);$("<span>攻击次数： </span>").appendTo(bf);var bi=$("<span>",{id:"AFNowHitCount"}).appendTo(bf);$("<span> 次</span>").appendTo(bf);bf=$("<td>").appendTo(bm);$("<span>攻击用时： </span>").appendTo(bf);var ba=$("<span>",{id:"AFNowSpendTime"}).appendTo(bf);$("<span> 秒</span>").appendTo(bf);bf=$("<td>").appendTo(bm);$("<span>未完成请求：</span>").appendTo(bf);var bk=$("<span>",{id:"AFAjaxCount"}).appendTo(bf);$("<span> 次</span>").appendTo(bf);E("advancedFightChooseTable");bj.attr("disabled",false);bj.click(function(){var bs=$("input[name='AFSelectStartMode']:checked");if(bs.length<=0){aX("未选择开始方式")}else{bj.attr("disabled",true);bq.attr("disabled",false);if(bs.attr("data-startmode")=="auto"){var br=aT(parseInt($("#AFStartModeAutoStartTextbox").val()),parseInt($("#AFStartModeAutoEndTextbox").val()));if(X()<=br){aX("当前时间已经超过预定时间");bj.attr("disabled",false);bq.attr("disabled",true)}else{aX("预订于剩余 "+br+" 秒时开始自动攻击");a7=setInterval(function(){if(X()<=br){clearInterval(a7);a0=new Date();aS=true;a8();aU(parseInt($("#AFIntervalStart").val()),parseInt($("#AFIntervalEnd").val()))}},1000)}}else{a0=new Date();aS=true;a8();aU(parseInt($("#AFIntervalStart").val()),parseInt($("#AFIntervalEnd").val()))}}});bq.click(function(){bj.attr("disabled",false);bq.attr("disabled",true);var br=$("input[name='AFSelectStartMode']:checked");if(br.attr("data-startmode")=="auto"){if(a7!=undefined){aX("停止计时");clearInterval(a7)}else{aX("停止攻击");aS=false}}else{aX("停止攻击");aS=false}})}function aU(bb,be){$("#AFNowTotalDamage").text(aZ);$("#AFNowHitCount").text(aP);a5=parseInt(new Date()-a0)/1000;$("#AFNowSpendTime").text(a5);var ba=aR.length;for(var bd=0;bd<ba;bd++){if((aR[bd].readyState==4)||(aR[bd].readyState==0)){aR.splice(bd,1);bd=bd-1;ba=ba-1}}$("#AFAjaxCount").text(aR.length);if(ba>parseInt($("#AFMaxNotRespondRequest").val())){Z();aR=[]}if(aS==true){if(X()<=0){aX("回合结束，停止攻击");aS=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictHitCount").is(":checked")&&(aP>=parseInt($("#AFRestrictHitCountTextbox").val()))){aX("攻击次数超限，停止攻击");aS=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictDamage").is(":checked")&&(aZ>=parseInt($("#AFRestrictDamageTextbox").val()))){aX("总伤害超限，停止攻击");aS=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictTime").is(":checked")&&(a5>=parseInt($("#AFRestrictTimeTextbox").val()))){aX("时间超限，停止攻击");aS=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if(a2()==false){aS=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}var bc=aT(bb,be);aX(bc+"毫秒后输出");setTimeout(function(){aU(bb,be)},bc)}else{$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}}function a6(bh){function bb(bs){bs+="";var bq=bs.split(".");var br=/(\d{1,3})(?=(\d{3})+$)/g;return bq[0].replace(br,"$1,")+(bq.length==2?"."+bq[1]:"")}var bo=$("#showMsg");bo.text("");bo.show();var bd=$("#DamageDone",bh);if(bd.length>0){var bm=parseInt(bd.text().replace(/,/g,"").replace(/\xA0/g,""));aZ+=bm;var bp=$(".fightsprite",bd.parent().parent());var bi={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var bj={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var bg=0;bg<bp.length;++bg){var bn=bp.eq(bg).attr("class").split(" ").pop();if(bn in bj){var bc=bj[bn];bi[bc[0]]=bc[1]}}var be="";var bf=bi.xp;delete bi.xp;for(bg in bi){be='<i style="color:'+bi[bg][0]+';" class="icon-'+bg+'" title="'+bi[bg][1]+'"></i>'+be}be+='<b title="'+bf+'次攻击">x'+bf+"</b>";aP+=bf;var ba=$("#fightHistory");var bl=$("div[class^=foundation-style]",ba);if(bl.length===6){$("#ehHistoryExpand").show()}bl.slice(0,2).attr("style","opacity:0.6;");bl.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){bl.slice(4,6).hide()}var bk=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(bk){ba.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:be}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:bd.text()}))}else{ba.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:be}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:bd.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+bf);$("#ehTotalDamage").text(bb(parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+bm))}else{bo.text($("#fightResponse").text().trim());bo.fadeOut(2000)}}function a9(bb){var ba=jQuery.parseJSON(bb);$("#foodLimit").html(ba.foodLimit);$("#giftLimit").html(ba.giftLimit);$("#foodLimit2").html(ba.foodLimit);$("#giftLimit2").html(ba.giftLimit);$("#wellness").html(ba.wellness);$("#healthBar").html(ba.wellness);$("#healthProgress .ui-progressbar-value").animate({width:ba.wellness+"%"},{queue:false});$("#actualHealth").html(ba.wellness);$("#foodQ1").html("<b>Q1</b><br>"+ba.q1FoodStorage);$("#foodQ2").html("<b>Q2</b><br>"+ba.q2FoodStorage);$("#foodQ3").html("<b>Q3</b><br>"+ba.q3FoodStorage);$("#foodQ4").html("<b>Q4</b><br>"+ba.q4FoodStorage);$("#foodQ5").html("<b>Q5</b><br>"+ba.q5FoodStorage);$("#giftQ1").html("<b>Q1</b><br>"+ba.q1GiftStorage);$("#giftQ2").html("<b>Q2</b><br>"+ba.q2GiftStorage);$("#giftQ3").html("<b>Q3</b><br>"+ba.q3GiftStorage);$("#giftQ4").html("<b>Q4</b><br>"+ba.q4GiftStorage);$("#giftQ5").html("<b>Q5</b><br>"+ba.q5GiftStorage);$("#sfoodQ1").html("<b>Q1</b><br>"+ba.q1FoodStorage);$("#sfoodQ2").html("<b>Q2</b><br>"+ba.q2FoodStorage);$("#sfoodQ3").html("<b>Q3</b><br>"+ba.q3FoodStorage);$("#sfoodQ4").html("<b>Q4</b><br>"+ba.q4FoodStorage);$("#sfoodQ5").html("<b>Q5</b><br>"+ba.q5FoodStorage);$("#sgiftQ1").html("<b>Q1</b><br>"+ba.q1GiftStorage);$("#sgiftQ2").html("<b>Q2</b><br>"+ba.q2GiftStorage);$("#sgiftQ3").html("<b>Q3</b><br>"+ba.q3GiftStorage);$("#sgiftQ4").html("<b>Q4</b><br>"+ba.q4GiftStorage);$("#sgiftQ5").html("<b>Q5</b><br>"+ba.q5GiftStorage)}function aQ(ba,bd){var bb="weaponQuality="+$("#weaponQuality").attr("value")+"&battleRoundId="+$("#battleRoundId").val()+"&side="+ba+"&value="+bd;var bc=$.ajax({type:"POST",url:"fight.html",data:bb,success:function(bg){$("#fightResponse > div").replaceWith(bg);a6($(bg));var bf=$("#healthUpdate",bg).text();if(bf!==""){var be=bf.substr(0,bf.length-3);if(be<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:be+"%"},{queue:false});$("#healthProgress").attr("title",be+" / 100");$("#actualHealth").html(be)}},error:function(be,bh,bg){var bf=$("#showMsg");bf.text("错误："+be.status);bf.show();bf.fadeOut(2000)}});aR.push(bc)}function aO(){var ba="quality="+$("#foodQuality").val();var bb=$.ajax({type:"POST",url:"eat.html",data:ba,success:function(bc){a9(bc)}});aR.push(bb)}function aV(){var ba="quality="+$("#giftQuality").val();var bb=$.ajax({type:"POST",url:"gift.html",data:ba,success:function(bc){a9(bc)}});aR.push(bb)}function aW(bg){if(bg){var bb=parseInt($("#foodLimit2").text());if(bb>0){var bd=parseInt($("#foodQuality").val());var bf=parseInt($("span#sfoodQ"+bd)[0].childNodes[2].nodeValue);if(bf>0){aO();return true}else{aX("食物不足");return false}}else{aX("食物额度不足");return false}}else{var be=parseInt($("#giftLimit2").text());if(be>0){var bc=parseInt($("#giftQuality").val());var ba=parseInt($("span#sgiftQ"+bc)[0].childNodes[2].nodeValue);if(ba>0){aV();return true}else{aX("礼物不足");return false}}else{aX("礼物额度不足");return false}}}function a3(){var bb=$("#AFRestoreHealth1").val();var ba=$("#AFRestoreHealth2").val();if(bb==1){if(!aW(true)){if(ba==2){return aW(false)}else{return false}}else{return true}}else{if(bb==2){if(!aW(false)){if(ba==1){return aW(true)}else{return false}}else{return true}}else{aX("补充体力选择错误");return false}}}function a2(){if(parseFloat($("#actualHealth").html())<=50){if(!a3()){return false}}var bb=parseInt($("#weaponQuality").val());if(bb>0){var bd=parseInt($("span#Q"+bb+"WeaponStock").text());if(bd<=0){aX("武器不足");return false}}var ba=$("input[name='AFHitStyle']:checked");if(ba.length<=0){aX("未选择输出方");return false}var bc=ba.attr("data-AFSide");var be=ba.attr("data-AFValue");aQ(bc,be)}}function ab(){if(!isActive){$("#ehButtonSpectator").attr("disabled",true);return}if(isPremium){$(".battleMonitorDiv").remove();var aP=$("#ehDivSpectator");aP.append($("<button>",{type:"button","class":"small button foundation-style",id:"showSpectator",text:"刷新观战玩家",style:"height:20px;width:100px;",click:function(){T(true)}}));var aO=$("<div>");aP.append(aO);aO.append('<div class="foundation-style small-3 columns">  <b>Total defenders online:</b> <i id="ehTotaldefenders"  style="display: inline;">0</i>  <br> <div align="center" id="ehDefendersMenu" >No one <br> </div>  </div>');aO.append('<div class="foundation-style small-4 columns">  <b>Total spectators online:</b><i id="ehTotalspectators"                         >0</i>  <br> <div align="center" id="ehSpectatorsMenu">No one <br> </div>  </div>');aO.append('<div class="foundation-style small-3 columns">  <b>Total attackers online:</b> <i id="ehTotalattackers"  style="display: inline;">0</i>  <br> <div align="center" id="ehAttackersMenu" >No one <br> </div>  </div>')}else{var aP=$("#ehDivSpectator");aP.append($("<div>",{style:"font-color:red; font-size:24px;",text:"此功能利用了e-sim的小漏洞，有一定危险性，请自行承担后果"}));aP.append($("<button>",{type:"button","class":"small button foundation-style",id:"showSpectator",text:"我知道了，还是想看！",click:function(){T(true)}}));var aO=$("<div>");aP.append(aO);aO.append('<div class="foundation-style small-3 columns">  <b>Total defenders online:</b> <i id="ehTotaldefenders"  style="display: inline;">0</i>  <br> <div align="center" id="ehDefendersMenu" >No one <br> </div>  </div>');aO.append('<div class="foundation-style small-4 columns">  <b>Total spectators online:</b><i id="ehTotalspectators"                         >0</i>  <br> <div align="center" id="ehSpectatorsMenu">No one <br> </div>  </div>');aO.append('<div class="foundation-style small-3 columns">  <b>Total attackers online:</b> <i id="ehTotalattackers"  style="display: inline;">0</i>  <br> <div align="center" id="ehAttackersMenu" >No one <br> </div>  </div>')}}function D(){if(!isActive){$("#ehButtonAlarm").attr("disabled",true);return}var aX=X();var aT=$("<div>");var aP=$("<input>",{type:"checkbox",id:"PopupCheckbox"}).appendTo(aT);var aQ=$("<label>",{"class":"checkboxlabel","for":"PopupCheckbox",text:"自动弹窗（首次使用可能会被浏览器拦截，加入白名单即可）"}).appendTo(aT);var aV=localStorage.getItem("battlePopup");if(aV==null){localStorage.setItem("battlePopup","false")}else{aP.attr("checked",aV=="true")}aP.click(function(){if(aP.is(":checked")){localStorage.setItem("battlePopup",true)}else{localStorage.setItem("battlePopup",false)}});var aS=$("<button>",{type:"button","class":"small button foundation-style",id:"testNotification",text:"测试",click:function(){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"：测试")}}}).appendTo(aT);$("#ehDivAlarm").append(aT);var aR=$("<div>",{"class":"foundation-style small-2 columns"});aR.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aR.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable10",value:10})," t10提醒");var aW=$("<div>",{"class":"foundation-style small-3 columns"});aW.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aW.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable5",value:5})," t5提醒");var aO=$("<div>",{"class":"foundation-style small-3 columns"});aO.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aO.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable2",value:2})," t2提醒");var aU=$("<div>",{"class":"foundation-style small-2 columns"});aU.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aU.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable1",value:1})," t1提醒");$("#ehDivAlarm").append(aR,aW,aO,aU);if(aX<=10*60){$("#alarmEnable10").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable10").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时10分钟")}}$("#alarmEnable10").attr("disabled",true)},(aX-10*60)*1000)}if(aX<=5*60){$("#alarmEnable5").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable5").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时5分钟")}}if(localStorage.getItem("autoSendMessageToDiscord")=="true"){var aY=$("#sendToDiscordButton");if(aY.length==1){aY.click()}}$("#alarmEnable5").attr("disabled",true)},(aX-5*60)*1000)}if(aX<=2*60){$("#alarmEnable2").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable2").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时2分钟")}}$("#alarmEnable2").attr("disabled",true)},(aX-2*60)*1000)}if(aX<=1*60){$("#alarmEnable1").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable1").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时1分钟")}}$("#alarmEnable1").attr("disabled",true)},(aX-1*60)*1000)}setInterval(au,1000)}function au(){var aP=X();if(document.title.indexOf("：")!=-1){var aQ=document.title.split("：")[1]}else{var aQ=document.title}if(aP>99){var aO="T"+parseInt(aP/60).toString()}else{var aO="S"+aP.toString()}document.title=aO+"："+aQ}function at(){var aU=$("[id^=fightButton]");if(aU.length===0){return}var aR=".critical { color:red; }";GM_addStyle(aR);var aV=aU.parent().parent();$("[id^=fightButton] > i",aV).remove();var aS=$("<div>",{id:"fightLeft","class":"foundation-style small-3 columns",style:"font-size:12px;"});var aP=$("<div>",{id:"fightRight","class":"foundation-style small-7 columns foundation-text-center"});aP.append(aV.children());aV.append(aS,aP);var aX=$("<div>",{"class":"foundation-style small-5 columns foundation-text-left",html:'<b id="ehCountdown">00:00:00</b>',title:"点击刷新按钮可校准"});var aQ=$("<div>",{"class":"foundation-style small-1 columns foundation-text-right",html:'x<b id="ehHitsNumber">0</b>',title:"在当前页面上攻击的次数, 刷新页面会清零"});var aT=$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",html:'<div id="ehTotalDamage">0</div>',title:"在当前页面上攻击的总伤害, 刷新页面会清零"});var aO=$("<div>",{id:"fightHistory"});var aW=$("<div>",{html:'<b id="showMsg"></b>'});aS.append(aX,aQ,aT,aO,aW);aO.append('<div id="ehHistoryExpand" class="small-6"><i class="icon-uniF475" title="展开所有伤害记录"></i></div>','<div id="ehHistoryContract" class="small-6"><i class="icon-uniF474" title="收起输出伤害"></i></div>');$("#ehHistoryExpand").hide().click(function(){$("#fightHistory > div").slice(6).show();$(this).hide()});$("#ehHistoryContract").hide().click(function(){$("#fightHistory > div").slice(6).hide();$("#ehHistoryExpand").show()});$(".pico-content").livequery(function(){var aY=$("#DamageDone",$(this));if(aY.length>0){var a7=parseInt(aY.text().replace(/,/g,"").replace(/\xA0/g,""));var a9=$(".fightsprite",aY.parent().parent());var a3={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var a4={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var a2=0;a2<a9.length;++a2){var a8=a9.eq(a2).attr("class").split(" ").pop();if(a8 in a4){var aZ=a4[a8];a3[aZ[0]]=aZ[1]}}var a0="";var a1=a3.xp;delete a3.xp;for(a2 in a3){a0='<i style="color:'+a3[a2][0]+';" class="icon-'+a2+'" title="'+a3[a2][1]+'"></i>'+a0}a0+='<b title="'+a1+'次攻击">x'+a1+"</b>";var a6=$("div[class^=foundation-style]",aO);if(a6.length===6){$("#ehHistoryExpand").show()}a6.slice(0,2).attr("style","opacity:0.6;");a6.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){a6.slice(4,6).hide()}var a5=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(a5){aO.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:a0}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:aY.text()}))}else{aO.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:a0}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:aY.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+a1);$("#ehTotalDamage").text((parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+a7).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}})}function af(){$.ajax({url:"/apiOnlinePlayers.html?countryId=0",success:function(aO){var aP=JSON.parse(aO);var aQ=[];$.each(aP,function(aR,aS){aQ.push(JSON.parse(aS))});console.log(aQ)},error:function(aO,aP){console.log("apiOnlinePlayers抓取错误 (",aP,")，该服可能不支持该API")}})}function V(){var aQ=$("#ehDivSpectatorDetail");var aT=$("<button>",{id:"eh2ShowSpectatorDetail",text:"推测观战玩家（必须先查看过观战人员）","class":"foundation-style button",style:"padding:10px; margin:5px;"}).appendTo($("<div>").appendTo(aQ));var aU=$("<button>",{id:"eh2ShowSpectatorBuff",text:"显示玩家状态","class":"foundation-style button",style:"padding:10px; margin:5px;",disabled:true}).insertAfter(aT);var aW=$("<INPUT TYPE='checkbox' id='eh2CheckCoalition'>按联盟分类玩家</INPUT>").insertAfter(aU);var aP=$("<div>",{id:"eh2Defenders",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:33%;",text:"可能的防御者"}).appendTo(aQ));var aS=$("<div>",{id:"eh2Strangers",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:34%;",text:"其他人"}).appendTo(aQ));var aV=$("<div>",{id:"eh2Attackers",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:33%;",text:"可能的进攻者"}).appendTo(aQ));var a0={defenderRegions:[],attackerRegions:[]};$("#defenderRegions input").each(function(){a0.defenderRegions.push(parseInt($(this).attr("value")))});$("#attackerRegions input").each(function(){a0.attackerRegions.push(parseInt($(this).attr("value")))});aT.click(function(){aT.attr("disabled",true);aU.attr("disabled",true);aX();aO();if($("#eh2CheckCoalition").is(":checked")){aY()}else{aR()}});function aX(){var a2=$("#ehSpectatorsMenu").text().replace(/-[ \n\r]*/g,"- ").replace(/[\n\r]+ +/g,"\n").trim().split("\n");var a3=[];var a1=a2.length;$.each(a2,function(a4,a6){var a7=a6.split(" - ");var a8=a7[0];var a5=countryInfo[a7[1]]&&countryInfo[a7[1]].id;if(!a5){if(--a1===0){a0.onlineCitizens=a3;console.log("相关国家的在线玩家扫描完毕");aZ()}return}$.ajax({url:"citizensOnline.html?countryId="+a5,success:function(bb){var ba=$("table.dataTable:last tr:gt(0)",bb);var a9=ba.length;console.log(countryInfo[a5].name,"共有"+a9+"名在线玩家");ba.each(function(){if($("td",$(this)).length===1){console.log(countryInfo[a5].name,"没有玩家");return false}var be=parseInt($("td:first a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var bd=parseInt($("td:last a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var bc=a3.push({citizenId:be,locationId:bd,countryId:a5,a:a8,b:a9,profile:$("td:first a",$(this)),avatar:$("td:first img",$(this)).attr("class","smallAvatar").attr("style","").attr("align","absmiddle")});if(--a1===0){a0.onlineCitizens=a3;console.log("相关国家的在线玩家扫描完毕");aZ()}})},error:function(a9,ba){console.log("抓取错误 (",ba,")，重新抓取");$.ajax(this)}})})}function aO(){$.ajax({url:"battleUnitsStats.html?id="+battleId,success:function(a6){var a7=$("div.small-5:eq(-2) a",a6);var a3=a7.length;if(a3===0){console.log("防御方没有军团");a0.defenderMus=[];aZ()}else{var a2=[];a7.each(function(){var a8=parseInt($(this).attr("href").match(/([0-9]+)$/)[1]);a2.push(a8);I(a8,function(){if(--a3===0){a0.defenderMus=a2;console.log("防御方军团玩家扫描完毕");aZ()}})})}var a5=$("div.small-5:last a",a6);var a4=a5.length;if(a4===0){console.log("进攻方没有军团");a0.attackerMus=[];aZ()}else{var a1=[];a5.each(function(){var a8=parseInt($(this).attr("href").match(/([0-9]+)$/)[1]);a1.push(a8);I(a8,function(){if(--a4===0){a0.attackerMus=a1;console.log("进攻方军团玩家扫描完毕");aZ()}})})}},error:function(a1,a2){console.log("抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}function aR(){if(!defenderId){a0.defenderAllies=[]}else{if(defenderId===allies[0]){a0.defenderAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+defenderId,success:function(a3){console.log(countryInfo[defenderId].name,"盟友抓取成功");var a1=[defenderId];var a2=$("div.xflagsMedium",$("table.dataTable:last",a3));a2.each(function(){var a4=$(this).attr("class").split(" ").pop();a4=a4.substring(a4.indexOf("-")+1);console.log("防守方盟友："+a4);a1.push(countryInfo[a4].id)});a0.defenderAllies=a1;aZ()},error:function(a1,a2){console.log(countryInfo[defenderId].name,"盟友抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}}if(!attackerId){a0.attackerAllies=[]}else{if(attackerId===allies[0]){a0.attackerAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+attackerId,success:function(a3){console.log(countryInfo[attackerId].name,"盟友抓取成功");var a1=[attackerId];var a2=$("div.xflagsMedium",$("table.dataTable:last",a3));a2.each(function(){var a4=$(this).attr("class").split(" ").pop();a4=a4.substring(a4.indexOf("-")+1);console.log("进攻方盟友："+a4);a1.push(countryInfo[a4].id)});a0.attackerAllies=a1;aZ()},error:function(a1,a2){console.log(countryInfo[attackerId].name,"盟友抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}}}function aY(){if(!defenderId){a0.defenderAllies=[]}else{if(defenderId===allies[0]){a0.defenderAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+defenderId,success:function(a7){console.log(countryInfo[defenderId].name,"盟友及联盟抓取成功");var a5=[defenderId];var a6=$("div.xflagsMedium",$("table.dataTable:last",a7));a6.each(function(){var a8=$(this).attr("class").split(" ").pop();a8=a8.substring(a8.indexOf("-")+1);console.log("防守方盟友："+a8);a5.push(countryInfo[a8].id)});var a2=$("h2",a7);var a4;if(a2.length>4){a4=a2[2]}else{a4=a2[1]}if(a4.innerText.split(" ")[0]!="Coalition"){console.log("防守方没有联盟")}else{console.log("防守方属于联盟 "+a4.innerText.split(" ")[1]);var a1=$(a4,a7).nextAll("div.xflagsSmall");a1.each(function(){var a8=$(this).attr("class").split(" ").pop();a8=a8.substring(a8.indexOf("-")+1);if(countryInfo[defenderId].flagName!=a8){console.log("防守方联盟成员国："+a8);a5.push(countryInfo[a8].id)}})}var a3=$.unique(a5.sort());a0.defenderAllies=a3;aZ()},error:function(a1,a2){console.log(countryInfo[defenderId].name,"盟友及联盟抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}}if(!attackerId){a0.attackerAllies=[]}else{if(attackerId===allies[0]){a0.attackerAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+attackerId,success:function(a7){console.log(countryInfo[attackerId].name,"盟友及联盟抓取成功");var a5=[attackerId];var a6=$("div.xflagsMedium",$("table.dataTable:last",a7));a6.each(function(){var a8=$(this).attr("class").split(" ").pop();a8=a8.substring(a8.indexOf("-")+1);console.log("进攻方盟友："+a8);a5.push(countryInfo[a8].id)});var a2=$("h2",a7);var a4;if(a2.length>4){a4=a2[2]}else{a4=a2[1]}if(a4.innerText.split(" ")[0]!="Coalition"){console.log("进攻方没有联盟")}else{console.log("进攻方属于联盟 "+a4.innerText.split(" ")[1]);var a1=$(a4,a7).nextAll("div.xflagsSmall");a1.each(function(){var a8=$(this).attr("class").split(" ").pop();a8=a8.substring(a8.indexOf("-")+1);if(countryInfo[attackerId].flagName!=a8){console.log("进攻方联盟成员国："+a8);a5.push(countryInfo[a8].id)}})}var a3=$.unique(a5.sort());a0.attackerAllies=a3;aZ()},error:function(a1,a2){console.log(countryInfo[attackerId].name,"盟友及联盟抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}}}function aZ(){if(!a0.onlineCitizens||!a0.defenderMus||!a0.attackerMus||!a0.defenderAllies||!a0.attackerAllies){return}aP.empty();aV.empty();aS.empty();var a1=[];$.each(a0.onlineCitizens,function(a8,a9){var a5=a9.citizenId;var a2=citizenInfo[a5];var a6=aS;var a4=a9.a*100/a9.b;var a3=$("<div>",{id:"citizen"+a5,style:"font-size:12px;"});var ba=$("<i>",{"class":"icon-bookmark"}).appendTo(a3);if(a2&&$.inArray(a2.militaryUnitId,a0.defenderMus)!==-1){a6=aP;ba.attr("style","color:SkyBlue;")}else{if(a2&&$.inArray(a2.militaryUnitId,a0.attackerMus)!==-1){a6=aV;ba.attr("style","color:Crimson;")}else{ba.attr("style","color:rgb(77, 77, 77);");a4-=0.0001}}if(a0.defenderRegions.length!==0){var a7=$("<i>",{"class":"icon-airplane"}).appendTo(a3);if($.inArray(a9.locationId,a0.defenderRegions)!==-1){if($.inArray(a9.locationId,a0.attackerRegions)!==-1){a7.attr("style","color:SeaGreen;")}else{if(a6===aS){a6=aP}a7.attr("style","color:SkyBlue;")}}else{if($.inArray(a9.locationId,a0.attackerRegions)!==-1){a7.attr("style","color:Crimson;");if(a6===aS){a6=aV}}else{a7.attr("style","color:rgb(77, 77, 77);");a4-=0.0002}}}a3.append($("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[a9.countryId].flagName}),a9.avatar,a9.profile," ("+parseInt(a9.a*100/a9.b)+"%)");if(a6===aS){if($.inArray(a9.countryId,a0.defenderAllies)!==-1){a6=aP}else{if($.inArray(a9.countryId,a0.attackerAllies)!==-1){a6=aV}else{a4-=0.0004}}}a1.push([a4,a3,a6])});a1.sort(function(a3,a2){return a2[0]-a3[0]});$.each(a1,function(a2,a3){if(isResistance&&$(".icon-airplane",a3[1]).attr("style")==="color:SeaGreen;"){if(a3[2]===aP){$(".icon-airplane",a3[1]).attr("style","color:SkyBlue;")}else{if(a3[2]===aV){$(".icon-airplane",a3[1]).attr("style","color:Crimson;")}}}a3[1].appendTo(a3[2])});aT.attr("disabled",false);aU.attr("disabled",false)}aU.click(function(){aT.attr("disabled",true);aU.attr("disabled",true);aP.parent().attr("class","foundation-style column small-5");aV.parent().attr("class","foundation-style column small-5");aS.parent().attr("style","width:100%;").insertAfter(aV.parent());aS.attr("style","width:50%; margin:0 auto; text-align:left;");var a1="rgb(139, 139, 139);; rgb(177, 11, 11);; rgb(242, 160, 27);; rgb(177, 182, 6);; rgb(33, 157, 33);; rgb(169, 34, 156);; rgb(0, 211, 211);".split("; ");var a5="帽 镜 甲 裤 鞋 符 武 副".split(" ");var a4="头盔, 眼镜, 盔甲, 作战裤, 作战靴, 幸运符, 武器配件, 副手".split(", ");var a2=$("div[id^='citizen']",aQ);var a3=a2.length;a2.each(function(){var a7=$(this);var a6=parseInt(a7.attr("id").match(/([0-9]+)$/)[1]);H(a6,false,function(){if(citizenPage[a6].equipments.length===0){a7.remove();return true}var a8=[];$.each(citizenPage[a6].equipments,function(ba,bb){bb=parseInt(bb[1]);a8.push($("<span>",{style:"color:"+a1[bb],text:a5[ba],title:"Q"+bb+" "+a4[ba]}))});a7.prepend(a8);var a9=[];$.each(citizenPage[a6].buffIcons,function(bb,ba){a9.push($("<img>",{src:ba,style:"width:18px; vertical-align:middle;"}))});$.each(citizenPage[a6].debuffIcons,function(bb,ba){a9.push($("<img>",{src:ba,style:"width:18px; vertical-align:middle;"}))});a7.append(a9);if(--a3===0){aT.attr("disabled",false);localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}})})})}function J(){var aP=$("div > a.fbShare2").closest("div.columns").empty();console.log(aP);var aO=$("<button>",{"class":"foundation-style button",text:"显示所有局"}).appendTo(aP);var aQ=$("#battleProgress:first");aO.click(function(){var aW=aP.closest("div.fightContainer ");var aU=$('a[href^="battle.html"]').attr("href");var aV=$('img[src$="blue_ball.png"]').length+$('img[src$="red_ball.png"]').length;for(var aT=aV;aT>0;--aT){var aS=$("<div>",{"class":"foundation-radius fightContainer oldRound",id:"ehRound"+aT,roundId:aT}).insertAfter(aW).hide();$("<div>",{"class":"foundation-style small-2 columns topDefenders",id:"defenderBH"}).appendTo(aS);var aR=$("<div>",{"class":"foundation-style small-6 columns",id:"middle"}).appendTo(aS);aQ.clone().appendTo(aR);$("<div>",{"class":"foundation-radius fightContainer foundation-base-font",id:"scores"}).appendTo(aR);$("<div>",{"class":"foundation-style small-2 columns topAttackers",id:"attackerBH"}).appendTo(aS)}$("div.oldRound").each(function(){var aY=$(this);var aX=$("#middle",aY);var aZ=$("#scores",aX);var a0=aY.attr("roundId");$.ajax({url:aU+"&round="+a0,success:function(a4){$("#topDefender1",a4).children().appendTo($("#defenderBH",aY));$("#topAttacker1",a4).children().appendTo($("#attackerBH",aY));var a3=$("#leftStat",a4).text().match(/^([\d\.]+)/)[1];$("#battleProgress",aY).attr("aria-valuenow",a3);$("#battleProgress > div.ui-progressbar-value",aY).attr("style","width: "+a3+"%");var a5=$("#battleProgressStats",a4).insertAfter($("#battleProgress",aY));var a1=$("<div>").appendTo(a5);var a2=parseInt($("#defenderScore",a4).text().replace(/,/g,"").replace(/\xA0/g,""))-parseInt($("#attackerScore",a4).text().replace(/,/g,"").replace(/\xA0/g,""));if(a2===0){a1.text("")}else{if(a2>0){a1.text(">> "+a2.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>")}else{a1.text("<< "+(-a2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<")}}$("#defenderScore",a4).closest("div").appendTo(aZ);$("<a>",{"class":"foundation-style small-2 columns",href:aU+"&round="+a0,text:"Round "+a0}).appendTo(aZ);$("#attackerScore",a4).closest("div").appendTo(aZ);aY.show()},error:function(a1,a2){console.log("第",a0,"局伤害抓取错误 (",a2,")，重新抓取");$.ajax(this)}})})});k()}function k(){var a5=[];var bz=[];var be=[];var bA=[];var a0=[];var aZ=[];var aY=[];var aX=[];var aV=[];var aU=[];var aW=[];var bn=[];var bk=[];var bF=[];var aR=[];var aQ=[];var aO=[];var bH=[];var bE=[];var bD=[];var a4=[];var bq=[];var bm=[];var a3=[];var bx=[];var bw=[];var bv=[];var bu=[];var bt=[];var br=[];var a9=[];var by=[];var bp;function bh(){var bI=window.navigator.userAgent;if(bI.indexOf("MSIE")>=0){return"ie"}else{if(bI.indexOf("Firefox")>=0){return"Firefox"}else{if(bI.indexOf("Chrome")>=0){return"Chrome"}else{if(bI.indexOf("Opera")>=0){return"Opera"}else{if(bI.indexOf("Safari")>=0){return"Safari"}}}}}}function aP(bK){if(bh()=="ie"){var bI=document.getElementById(bK);var bN=new ActiveXObject("Excel.Application");var bJ=bN.Workbooks.Add();var bM=bJ.Worksheets(1);var bL=document.body.createTextRange();bL.moveToElementText(bI);bL.select();bL.execCommand("Copy");bM.Paste();bN.Visible=true;try{var bP=bN.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(bO){print("Nested catch caught "+bO)}finally{bJ.SaveAs(bP);bJ.Close(savechanges=false);bN.Quit();bN=null;bp=window.setInterval("Cleanup();",1)}}else{bd(bK)}}function bG(){window.clearInterval(bp);CollectGarbage()}var bd=(function(){var bK="data:application/vnd.ms-excel;base64,",bJ='<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',bI=function(bM){return window.btoa(unescape(encodeURIComponent(bM)))},bL=function(bM,bN){return bM.replace(/{(\w+)}/g,function(bO,bP){return bN[bP]})};return function(bO,bN){if(!bO.nodeType){bO=document.getElementById(bO)}var bM={worksheet:bN||"Worksheet",table:bO.innerHTML};window.location.href=bK+bI(bL(bJ,bM))}})();bc();function a2(bQ,bM,bP,bO,bL,bN,bJ){var bK=$("<tr>",{id:"CBCCountry"+bQ,"class":"CBCCountry",style:"background-color:#3d6571;"}).appendTo($("#CBCCountryResultTbody"));var bI=$("<td>",{text:countryInfo[bQ].name,CBCCountryId:bQ}).appendTo(bK);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bQ].flagName,style:"vertical-align:middle;"}).prependTo(bI);for(i=1;i<=bM;++i){$("<td>",{text:bP[i],"class":"CBCTableRoundsTd",sortPoint:bO[i]}).appendTo(bK)}$("<td>",{text:bL[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bL[0]}).appendTo(bK);$("<td>",{text:bL[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bL[1]}).appendTo(bK);$("<td>",{text:bL[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bL[2]}).appendTo(bK);$("<td>",{text:bL[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bL[3]}).appendTo(bK);$("<td>",{text:bL[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bL[4]}).appendTo(bK);$("<td>",{text:bL[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bL[5]}).appendTo(bK);$("<td>",{text:bN[0],"class":"CBCTableTotalDmgTd",sortPoint:bN[0]}).appendTo(bK);$("<td>",{text:bN[1],"class":"CBCTableTotalDmgTd",sortPoint:bN[1]}).appendTo(bK);$("<td>",{text:bN[2],"class":"CBCTableTotalDmgTd",sortPoint:bN[2]}).appendTo(bK);$("<td>",{text:bJ,"class":"CBCTableTotalDmgTd",sortPoint:bJ}).appendTo(bK)}function bs(bI,bL,bK,bJ){}function bl(bK,bN,bQ,bP,bL,bO,bJ){var bI=$("<tr>",{id:"CBCMu"+bK,"class":"CBCMu",style:"background-color:#3d6571;"}).appendTo($("#CBCMuResultTbody"));var bM=$("<td>",{CBCMuId:bK}).appendTo(bI);bM.attr("GetAPI","false");$("<a>",{href:"militaryUnit.html?id="+bK,target:"_blank",text:"("+bK+")"}).appendTo(bM);for(i=1;i<=bN;++i){$("<td>",{text:bQ[i],"class":"CBCTableRoundsTd",sortPoint:bP[i]}).appendTo(bI)}$("<td>",{text:bL[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bL[0]}).appendTo(bI);$("<td>",{text:bL[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bL[1]}).appendTo(bI);$("<td>",{text:bL[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bL[2]}).appendTo(bI);$("<td>",{text:bL[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bL[3]}).appendTo(bI);$("<td>",{text:bL[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bL[4]}).appendTo(bI);$("<td>",{text:bL[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bL[5]}).appendTo(bI);$("<td>",{text:bO[0],"class":"CBCTableTotalDmgTd",sortPoint:bO[0]}).appendTo(bI);$("<td>",{text:bO[1],"class":"CBCTableTotalDmgTd",sortPoint:bO[1]}).appendTo(bI);$("<td>",{text:bO[2],"class":"CBCTableTotalDmgTd",sortPoint:bO[2]}).appendTo(bI);$("<td>",{text:bJ,"class":"CBCTableTotalDmgTd",sortPoint:bJ}).appendTo(bI)}function bb(bI,bL,bK,bJ){}function bg(bL,bM,bQ,bO,bK,bN,bI){var bJ=$("<tr>",{id:"CBCCitizen"+bL,"class":"CBCCitizen",style:"background-color:#3d6571;"}).appendTo($("#CBCCitizenResultTbody"));var bP=$("<td>",{CBCCitizenId:bL}).appendTo(bJ);if(typeof(citizenInfo[bL])=="undefined"){bP.attr("GetAPI","false");$("<a>",{href:"profile.html?id="+bL,target:"_blank",text:"("+bL+")"}).appendTo(bP)}else{bP.attr("GetAPI","true");$("<a>",{href:"profile.html?id="+bL,target:"_blank",text:citizenInfo[bL].login}).appendTo(bP);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[citizenInfo[bL].citizenshipId].flagName,style:"vertical-align:middle;"}).prependTo(bP)}for(i=1;i<=bM;++i){$("<td>",{text:bQ[i],"class":"CBCTableRoundsTd",sortPoint:bO[i]}).appendTo(bJ)}$("<td>",{text:bK[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bK[0]}).appendTo(bJ);$("<td>",{text:bK[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bK[1]}).appendTo(bJ);$("<td>",{text:bK[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bK[2]}).appendTo(bJ);$("<td>",{text:bK[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bK[3]}).appendTo(bJ);$("<td>",{text:bK[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bK[4]}).appendTo(bJ);$("<td>",{text:bK[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bK[5]}).appendTo(bJ);$("<td>",{text:bN[0],"class":"CBCTableTotalDmgTd",sortPoint:bN[0]}).appendTo(bJ);$("<td>",{text:bN[1],"class":"CBCTableTotalDmgTd",sortPoint:bN[1]}).appendTo(bJ);$("<td>",{text:bN[2],"class":"CBCTableTotalDmgTd",sortPoint:bN[2]}).appendTo(bJ);$("<td>",{text:bI,"class":"CBCTableTotalDmgTd",sortPoint:bI}).appendTo(bJ)}function a1(bI,bL,bK,bJ){}function a6(bI,bL){if(bL>=bI.length){return}var bK=$(bI[bL]);var bJ=bK.attr("CBCMuId");$.ajax({url:"apiMilitaryUnitById.html?id="+bJ,success:function(bM){var bN=JSON.parse(bM);bK.empty();bK.attr("GetAPI","true");$("<a>",{href:"militaryUnit.html?id="+bJ,target:"_blank",text:bN.name}).appendTo(bK);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bN.countryId].flagName,style:"vertical-align:middle;"}).prependTo(bK);setTimeout(function(){a6(bI,bL+1)},200)},error:function(bM,bN){console.log("获取军团API错误 (",bN,")")}})}function bB(bJ,bI){if(bI>=bJ.length){return}var bL=$(bJ[bI]);var bK=bL.attr("CBCCitizenId");$.ajax({url:"apiCitizenById.html?id="+bK,success:function(bM){var bN=JSON.parse(bM);bL.empty();bL.attr("GetAPI","true");$("<a>",{href:"profile.html?id="+bK,target:"_blank",text:bN.login}).appendTo(bL);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bN.citizenshipId].flagName,style:"vertical-align:middle;"}).prependTo(bL);setTimeout(function(){bB(bJ,bI+1)},200)},error:function(bM,bN){console.log("获取玩家API错误 (",bN,")")}})}function bo(bV,bI,bR){var b0;$("<p>国家消耗统计</p>").appendTo(bV);var b4=$("<table>",{id:"CBCCountryResult",style:"width:100%;font-size:12px;"}).appendTo(bV);var bX=$("<thead>").appendTo(b4);var bN=$("<tfoot>",{id:"CBCCountryResultTfoot"}).appendTo(b4);var b3=$("<tbody>",{id:"CBCCountryResultTbody"}).appendTo(b4);var bZ=$("<tr>",{id:"CBCCountryResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bX);var b7=$("<td>",{text:"国家"}).appendTo(bZ);for(b0=1;b0<=bI;++b0){$("<td>",{text:b0,"class":"CBCTableRoundsTd"}).appendTo(bZ)}if(bR==false){$("<td>",{text:(bI+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(bZ)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(bZ);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(bZ);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(bZ);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(bZ);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(bZ);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(bZ);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(bZ);var b8=$('<button type="button">导出</button>').appendTo(bV);b8.click(function(){aP("CBCCountryResult")});$("#CBCCountryResultTheadTr").children(":gt(0)").each(function(ca,cb){$(cb).click(function(){a7("CBCCountry",ca+1)})});$("<p>军团消耗统计</p>").appendTo(bV);var bU=$("<table>",{id:"CBCMuResult",style:"width:100%;font-size:12px;"}).appendTo(bV);var bK=$("<thead>").appendTo(bU);var b6=$("<tfoot>",{id:"CBCMuResultTfoot"}).appendTo(bU);var bS=$("<tbody>",{id:"CBCMuResultTbody"}).appendTo(bU);var bY=$("<tr>",{id:"CBCMuResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bK);var bO=$("<td>",{text:"军团"}).appendTo(bY);var bJ=$('<button type="button">获取军团名</button>').appendTo(bO);bJ.click(function(){var ca=$("[CBCMuId][getapi=false]");a6(ca,0)});for(b0=1;b0<=bI;++b0){$("<td>",{text:b0,"class":"CBCTableRoundsTd"}).appendTo(bY)}if(bR==false){$("<td>",{text:(bI+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(bY)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(bY);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(bY);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(bY);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(bY);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(bY);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(bY);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bY);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bY);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bY);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(bY);var b5=$('<button type="button">导出</button>').appendTo(bV);b5.click(function(){aP("CBCMuResult")});$("#CBCMuResultTheadTr").children(":gt(0)").each(function(ca,cb){$(cb).click(function(){a7("CBCMu",ca+1)})});$("<p>个人消耗统计</p>").appendTo(bV);var bP=$("<table>",{id:"CBCCitizenResult",style:"width:100%;font-size:12px;"}).appendTo(bV);var bW=$("<thead>").appendTo(bP);var bM=$("<tfoot>",{id:"CBCCitizenResultTfoot"}).appendTo(bP);var b2=$("<tbody>",{id:"CBCCitizenResultTbody"}).appendTo(bP);var bQ=$("<tr>",{id:"CBCCitizenResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bW);var b1=$("<td>",{text:"玩家"}).appendTo(bQ);var bT=$('<button type="button">获取玩家名</button>').appendTo(b1);bT.click(function(){var ca=$("[CBCCitizenId][getapi=false]");bB(ca,0)});for(b0=1;b0<=bI;++b0){$("<td>",{text:b0,"class":"CBCTableRoundsTd"}).appendTo(bQ)}if(bR==false){$("<td>",{text:(bI+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(bQ)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(bQ);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(bQ);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(bQ);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(bQ);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(bQ);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(bQ);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bQ);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bQ);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bQ);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(bQ);var bL=$('<button type="button">导出</button>').appendTo(bV);bL.click(function(){aP("CBCCitizenResult")});$("#CBCCitizenResultTheadTr").children(":gt(0)").each(function(ca,cb){$(cb).click(function(){a7("CBCCitizen",ca+1)})});var b9=$('<button type="button">复制自己的消耗记录</button>').appendTo(bV);b9.click(function(){var cf=$("a[href^='profile.html']",$("#userAvatar"));var cc=cf.text();var ca=cf.attr("href").replace("profile.html?id=","");var ch=$("[cbccitizenid="+ca+"]").parent();var cg=cc+"的战场消耗：\r\n";var ci=location.origin+"/battle.html?id="+n("id")+"&round=";var cb;var cj;if(bR==true){cj=bI}else{cj=bI+1}for(var ce=0;ce<cj;ce++){cb=ch.children("td:eq("+(ce+1)+")").text();if(cb!=""){cg=cg+ci+$(".CBCTableRoundsTd :eq("+ce+")").text()+"    "+cb+"\r\n"}}cg=cg+"------------------------------------------------------------\r\n总计： ";for(var cd=0;cd<=5;cd++){cb=ch.children("td:eq("+(ch.children("td").length-10+cd)+")").text();if(cb!="0"){cg=cg+cb+" Q"+cd+"  |  "}}GM_setClipboard(cg)})}function bc(){var bJ=$("div.foundation-radius.fightContainer.foundation-base-font :last");var bK=bJ.clone().insertAfter(bJ);bK.empty();var bS=$("<button>",{"class":"foundation-style button",text:"统计战场消耗"}).appendTo(bK);bS.click(function(){bS.attr("disabled",true);var bU=$('a[href^="battle.html"]').attr("href").split("?id=")[1];var bX=$('img[src$="red_ball.png"]').length;var bY=$('img[src$="blue_ball.png"]').length;var bV=bX+bY;var bW=bV;var bT=true;if((bX<8)&&(bY<8)){bT=false;bW=bW+1}bo(bK,bV,bT);aT(bS,bU,1,bW)});var bP=$("<input>",{type:"checkbox",id:"HideRoundsCheckbox"}).appendTo(bK);var bQ=$("<label>",{"class":"checkboxlabel","for":"HideRoundsCheckbox",text:"隐藏回合"}).appendTo(bK);bP.click(function(){if(bP.is(":checked")){$(".CBCTableRoundsTd").hide()}else{$(".CBCTableRoundsTd").show()}});var bL=$("<input>",{type:"checkbox",id:"HideTotalCheckbox"}).appendTo(bK);var bR=$("<label>",{"class":"checkboxlabel","for":"HideTotalCheckbox",text:"隐藏消耗总计"}).appendTo(bK);bL.click(function(){if(bL.is(":checked")){$(".CBCTableTotalTd").hide()}else{$(".CBCTableTotalTd").show()}});var bO=$("<input>",{type:"checkbox",id:"HideTotalSpecialQualityCheckbox"}).appendTo(bK);var bN=$("<label>",{"class":"checkboxlabel","for":"HideTotalSpecialQualityCheckbox",text:"仅保留Q1和Q5消耗总计"}).appendTo(bK);bO.click(function(){if(bO.is(":checked")){$(".CBCTableTotalTd[quality!=1][quality!=5]").hide()}else{$(".CBCTableTotalTd[quality!=1][quality!=5]").show()}});var bI=$("<input>",{type:"checkbox",id:"HideTotalDmgCheckbox"}).appendTo(bK);var bM=$("<label>",{"class":"checkboxlabel","for":"HideTotalDmgCheckbox",text:"隐藏伤害总计"}).appendTo(bK);bI.click(function(){if(bI.is(":checked")){$(".CBCTableTotalDmgTd").hide()}else{$(".CBCTableTotalDmgTd").show()}})}function a8(bJ,bK){var bI=JSON.parse(bJ);for(i=0;i<bI.length;++i){if(bI[i].weapon==0){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(bx[bK][bI[i].citizenId])=="undefined"){bx[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{bx[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(a0[bK][bI[i].citizenship])=="undefined"){a0[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{a0[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(aR[bK][bI[i].militaryUnit])=="undefined"){aR[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{aR[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}else{if(bI[i].weapon==1){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(bw[bK][bI[i].citizenId])=="undefined"){bw[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{bw[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(aZ[bK][bI[i].citizenship])=="undefined"){aZ[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{aZ[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(aQ[bK][bI[i].militaryUnit])=="undefined"){aQ[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{aQ[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}else{if(bI[i].weapon==2){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(bv[bK][bI[i].citizenId])=="undefined"){bv[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{bv[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(aY[bK][bI[i].citizenship])=="undefined"){aY[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{aY[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(aO[bK][bI[i].militaryUnit])=="undefined"){aO[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{aO[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}else{if(bI[i].weapon==3){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(bu[bK][bI[i].citizenId])=="undefined"){bu[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{bu[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(aX[bK][bI[i].citizenship])=="undefined"){aX[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{aX[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(bH[bK][bI[i].militaryUnit])=="undefined"){bH[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{bH[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}else{if(bI[i].weapon==4){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(bt[bK][bI[i].citizenId])=="undefined"){bt[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{bt[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(aV[bK][bI[i].citizenship])=="undefined"){aV[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{aV[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(bE[bK][bI[i].militaryUnit])=="undefined"){bE[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{bE[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}else{if(bI[i].weapon==5){if(be.indexOf(bI[i].citizenId)<0){be.push(bI[i].citizenId)}if(typeof(br[bK][bI[i].citizenId])=="undefined"){br[bK][bI[i].citizenId]=1+4*bI[i].berserk}else{br[bK][bI[i].citizenId]+=1+4*bI[i].berserk}if(a5.indexOf(bI[i].citizenship)<0){a5.push(bI[i].citizenship)}if(typeof(aU[bK][bI[i].citizenship])=="undefined"){aU[bK][bI[i].citizenship]=1+4*bI[i].berserk}else{aU[bK][bI[i].citizenship]+=1+4*bI[i].berserk}if(typeof(bI[i].militaryUnit)!="undefined"){if(bz.indexOf(bI[i].militaryUnit)<0){bz.push(bI[i].militaryUnit)}if(typeof(bD[bK][bI[i].militaryUnit])=="undefined"){bD[bK][bI[i].militaryUnit]=1+4*bI[i].berserk}else{bD[bK][bI[i].militaryUnit]+=1+4*bI[i].berserk}}}}}}}}if(bI[i].defenderSide==true){if(typeof(by[bI[i].citizenId])=="undefined"){by[bI[i].citizenId]=bI[i].damage}else{by[bI[i].citizenId]+=bI[i].damage}if(typeof(bn[bI[i].citizenship])=="undefined"){bn[bI[i].citizenship]=bI[i].damage}else{bn[bI[i].citizenship]+=bI[i].damage}}if(bI[i].defenderSide==false){if(typeof(a9[bI[i].citizenId])=="undefined"){a9[bI[i].citizenId]=bI[i].damage}else{a9[bI[i].citizenId]+=bI[i].damage}if(typeof(aW[bI[i].citizenship])=="undefined"){aW[bI[i].citizenship]=bI[i].damage}else{aW[bI[i].citizenship]+=bI[i].damage}}if(typeof(bI[i].militaryUnit)!="undefined"){if(bI[i].defenderSide==true){if(typeof(bq[bI[i].militaryUnit])=="undefined"){bq[bI[i].militaryUnit]=bI[i].damage}else{bq[bI[i].militaryUnit]+=bI[i].damage}}if(bI[i].defenderSide==false){if(typeof(a4[bI[i].militaryUnit])=="undefined"){a4[bI[i].militaryUnit]=bI[i].damage}else{a4[bI[i].militaryUnit]+=bI[i].damage}}}}}function bj(bS,bI){function bR(bV,bW){var bU=[0,0,0,0,0,0];if(typeof(a0[bW][bV])=="undefined"){bU[0]=0}else{bU[0]=a0[bW][bV]}if(typeof(aZ[bW][bV])=="undefined"){bU[1]=0}else{bU[1]=aZ[bW][bV]}if(typeof(aY[bW][bV])=="undefined"){bU[2]=0}else{bU[2]=aY[bW][bV]}if(typeof(aX[bW][bV])=="undefined"){bU[3]=0}else{bU[3]=aX[bW][bV]}if(typeof(aV[bW][bV])=="undefined"){bU[4]=0}else{bU[4]=aV[bW][bV]}if(typeof(aU[bW][bV])=="undefined"){bU[5]=0}else{bU[5]=aU[bW][bV]}return bU}var bT=[];var bL=["","","","","","","","","","","","","","","",""];var bO=[];var bP=[0,0,0,0,0,0];var bN=[];var bQ;var bK;for(var bM=1;bM<=bI;bM++){bT[bM]=bR(bS,bM);bO[bM]=0;for(var bJ=0;bJ<6;bJ++){if(bT[bM][bJ]!=0){bL[bM]+=(bT[bM][bJ]+" q"+bJ+" ");bP[bJ]+=bT[bM][bJ];bO[bM]+=((bJ+1)*bT[bM][bJ])}}}if(typeof(bn[bS])=="undefined"){bN[0]=0}else{bN[0]=bn[bS]}if(typeof(aW[bS])=="undefined"){bN[1]=0}else{bN[1]=aW[bS]}bN[2]=bN[0]+bN[1];bQ=bP[0]*0.5+bP[1]*1.2+bP[2]*1.4+bP[3]*1.6+bP[4]*1.8+bP[5]*2;if(bQ==0){bQ=1}bK=parseInt(bN[2]/bQ);a2(bS,bI,bL,bO,bP,bN,bK)}function bi(bP,bI){function bS(bV,bW){var bU=[0,0,0,0,0,0];if(typeof(aR[bW][bV])=="undefined"){bU[0]=0}else{bU[0]=aR[bW][bV]}if(typeof(aQ[bW][bV])=="undefined"){bU[1]=0}else{bU[1]=aQ[bW][bV]}if(typeof(aO[bW][bV])=="undefined"){bU[2]=0}else{bU[2]=aO[bW][bV]}if(typeof(bH[bW][bV])=="undefined"){bU[3]=0}else{bU[3]=bH[bW][bV]}if(typeof(bE[bW][bV])=="undefined"){bU[4]=0}else{bU[4]=bE[bW][bV]}if(typeof(bD[bW][bV])=="undefined"){bU[5]=0}else{bU[5]=bD[bW][bV]}return bU}var bT=[];var bL=["","","","","","","","","","","","","","","",""];var bO=[];var bQ=[0,0,0,0,0,0];var bN=[];var bR;var bK;for(var bM=1;bM<=bI;bM++){bT[bM]=bS(bP,bM);bO[bM]=0;for(var bJ=0;bJ<6;bJ++){if(bT[bM][bJ]!=0){bL[bM]+=(bT[bM][bJ]+" q"+bJ+" ");bQ[bJ]+=bT[bM][bJ];bO[bM]+=((bJ+1)*bT[bM][bJ])}}}if(typeof(bq[bP])=="undefined"){bN[0]=0}else{bN[0]=bq[bP]}if(typeof(a4[bP])=="undefined"){bN[1]=0}else{bN[1]=a4[bP]}bN[2]=bN[0]+bN[1];bR=bQ[0]*0.5+bQ[1]*1.2+bQ[2]*1.4+bQ[3]*1.6+bQ[4]*1.8+bQ[5]*2;if(bR==0){bR=1}bK=parseInt(bN[2]/bR);bl(bP,bI,bL,bO,bQ,bN,bK)}function ba(bQ,bI){function bM(bW,bV){var bU=[0,0,0,0,0,0];if(typeof(bx[bV][bW])=="undefined"){bU[0]=0}else{bU[0]=bx[bV][bW]}if(typeof(bw[bV][bW])=="undefined"){bU[1]=0}else{bU[1]=bw[bV][bW]}if(typeof(bv[bV][bW])=="undefined"){bU[2]=0}else{bU[2]=bv[bV][bW]}if(typeof(bu[bV][bW])=="undefined"){bU[3]=0}else{bU[3]=bu[bV][bW]}if(typeof(bt[bV][bW])=="undefined"){bU[4]=0}else{bU[4]=bt[bV][bW]}if(typeof(br[bV][bW])=="undefined"){bU[5]=0}else{bU[5]=br[bV][bW]}return bU}var bT=[];var bL=["","","","","","","","","","","","","","","",""];var bP=[];var bR=[0,0,0,0,0,0];var bO=[];var bS;var bK;for(var bN=1;bN<=bI;bN++){bT[bN]=bM(bQ,bN);bP[bN]=0;for(var bJ=0;bJ<6;bJ++){if(bT[bN][bJ]!=0){bL[bN]+=(bT[bN][bJ]+" q"+bJ+" ");bR[bJ]+=bT[bN][bJ];bP[bN]+=((bJ+1)*bT[bN][bJ])}}}if(typeof(by[bQ])=="undefined"){bO[0]=0}else{bO[0]=by[bQ]}if(typeof(a9[bQ])=="undefined"){bO[1]=0}else{bO[1]=a9[bQ]}bO[2]=bO[0]+bO[1];bS=bR[0]*0.5+bR[1]*1.2+bR[2]*1.4+bR[3]*1.6+bR[4]*1.8+bR[5]*2;if(bS==0){bS=1}bK=parseInt(bO[2]/bS);bg(bQ,bI,bL,bP,bR,bO,bK)}function aS(bL){for(var bJ=0;bJ<a5.length;bJ++){bj(a5[bJ],bL)}for(var bI=0;bI<bz.length;bI++){bi(bz[bI],bL)}for(var bK=0;bK<be.length;bK++){ba(be[bK],bL)}}function bf(bI,bJ){return(Array(bJ).join(0)+bI).slice(-bJ)}function bC(bN,bM){var bL=[];var bJ=[];var bK;var bI;$("."+bN).each(function(bO,bP){bJ[0]=parseInt($(this).children("td:eq("+(bM+1)+")").text());bJ[1]=parseInt($(this).children("td:eq("+(bM+2)+")").text());bJ[2]=parseInt($(this).children("td:eq("+(bM+3)+")").text());bJ[3]=parseInt($(this).children("td:eq("+(bM+4)+")").text());bJ[4]=parseInt($(this).children("td:eq("+(bM+5)+")").text());bJ[5]=parseInt($(this).children("td:eq("+(bM+6)+")").text());bK=bJ[1]+bJ[2]*2+bJ[3]*3+bJ[4]*4+bJ[5]*5;bI=bf(bK,6);bL.push(bI+" "+$(this).attr("id"))});bL.sort();$.each(bL,function(bP,bQ){var bO=bQ.split(" ").pop();$("#"+bO).prependTo($("#"+bN+"ResultTbody"))})}function a7(bL,bJ){var bK=[];var bI;$("."+bL).each(function(bM,bN){bI=$(this).children("td:eq("+bJ+")").attr("sortPoint");bI=bf(bI,15);bK.push(bI+" "+$(this).attr("id"))});bK.sort();$.each(bK,function(bN,bO){var bM=bO.split(" ").pop();$("#"+bM).prependTo($("#"+bL+"ResultTbody"))})}function aT(bI,bJ,bL,bK){$.ajax({url:"apiFights.html?battleId="+bJ+"&roundId="+bL,success:function(bM){a0[bL]=[];aZ[bL]=[];aY[bL]=[];aX[bL]=[];aV[bL]=[];aU[bL]=[];aR[bL]=[];aQ[bL]=[];aO[bL]=[];bH[bL]=[];bE[bL]=[];bD[bL]=[];bx[bL]=[];bw[bL]=[];bv[bL]=[];bu[bL]=[];bt[bL]=[];br[bL]=[];a8(bM,bL);bI.text("剩余"+(bK-bL)+"个");if(bL>=bK){bI.text("获取成功");aS(bK);bC("CBCCountry",bK);bC("CBCMu",bK);bC("CBCCitizen",bK)}else{aT(bI,bJ,bL+1,bK)}},error:function(bM,bN){console.log("抓取错误 (",bN,")，重新抓取");$.ajax(this)}})}}function A(){if($("td",$("table.dataTable tr:gt(0)")).length===1){return}aO();aR();aP();aQ();function aR(){var a3=$(".dataTable :first").parent();var a6=$("<div class='foundation-style columns'></div>");a3.before(a6);var a0=$("<b>",{text:"默认使用武器：",title:"不开坦克buff的情况下该服务器大多数玩家使用的武器"}).appendTo(a6);var a1=$("<select>",{id:"DefaultWeapon",style:"padding:3px; margin:3px;"}).appendTo(a6);$("<option>",{value:1,text:"Q1"}).appendTo(a1);$("<option>",{value:5,text:"Q5"}).appendTo(a1);var a5=localStorage.getItem("CitizensOnlineDefaultWeapon");if(a5===null){localStorage.setItem("CitizensOnlineDefaultWeapon",1);a1.val(1)}else{a1.val(a5)}a1.change(function(){localStorage.setItem("CitizensOnlineDefaultWeapon",a1.val())});var a8=$("<input>",{type:"checkbox",id:"DefaultMuBonus"}).appendTo(a6);var a9=$("<label>",{"class":"checkboxlabel","for":"DefaultMuBonus",text:"军令加成",title:"默认精英军团（20%加成）"}).appendTo(a6);var a7=localStorage.getItem("CitizensOnlineDefaultMuBonus");if(a7===null){localStorage.setItem("CitizensOnlineDefaultMuBonus",true);a8.attr("checked",true)}else{a8.attr("checked",a7=="true")}a8.click(function(){if(a8.is(":checked")){localStorage.setItem("CitizensOnlineDefaultMuBonus",true)}else{localStorage.setItem("CitizensOnlineDefaultMuBonus",false)}});var aS=$("<span>",{text:"    更多伤害："}).appendTo(a6);var aY=$("<select>",{id:"MoreDamage",style:"padding:3px; margin:3px;"}).appendTo(a6);for(var a2=0;a2<=40;a2++){$("<option>",{value:(a2*10),text:(a2*10).toString()+"%"}).appendTo(aY)}var aX=localStorage.getItem("CitizensOnlineMoreDamage");if(aX===null){localStorage.setItem("CitizensOnlineMoreDamage",0);aY.val(0)}else{aY.val(aX)}aY.change(function(){localStorage.setItem("CitizensOnlineMoreDamage",aY.val())});var aV=$("<span>",{text:"更多暴击："}).appendTo(a6);var a4=$("<select>",{id:"MoreCritical",style:"padding:3px; margin:3px;"}).appendTo(a6);for(var a2=0;a2<=20;a2++){$("<option>",{value:(a2*10),text:(a2*10).toString()+"%"}).appendTo(a4)}var aZ=localStorage.getItem("CitizensOnlineMoreCritical");if(aZ===null){localStorage.setItem("CitizensOnlineMoreCritical",0);a4.val(0)}else{a4.val(aZ)}a4.change(function(){localStorage.setItem("CitizensOnlineMoreCritical",a4.val())});var aU=$("<input type='button' class='foundation-style button' value='获取玩家状态'></input> ");a6.append(aU);aU.click(function(){aU.attr("disabled",true);$("table.dataTable tr:eq(0)").append($("<td exid='info'>详细信息</td>"));$("table.dataTable tr:gt(0)").append($('<td exid="info"><span id="buffs">BUFF：</span><br><span id="estBerserkAvg" title="伤害不含建筑加成，默认有本地加成，无被包围加成">连击平均伤害：加载中……</span><br><span id="score1" title="与无装备状态相比">总伤害：加载中……</span><br><span id="score2" title="与无装备状态相比，且不考虑闪避属性(avoid)">爆发力：加载中……</span></td>'));aT()});function aW(bc){bc+="";var ba=bc.split(".");var bb=/(\d{1,3})(?=(\d{3})+$)/g;return ba[0].replace(bb,"$1,")+(ba.length==2?"."+ba[1]:"")}function aT(){var ba=$("table.dataTable:last tr:gt(0)");var bb=ba.length;ba.each(function(){var bd=parseInt($("td:first a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var bc=$(this);H(bd,false,function(){if(citizenPage[bd].equipments.length===0){$("td[exid='info']",bc).html("组织号");return true}var bj=[];$.each(citizenPage[bd].buffIcons,function(bJ,bI){bj.push($("<img>",{src:bI,style:"width:20px; height:20px; vertical-align:middle;"}))});$.each(citizenPage[bd].debuffIcons,function(bJ,bI){bj.push($("<img>",{src:bI,style:"width:20px; height:20px; vertical-align:middle;"}))});if(bj.length>0){$("#buffs",bc).append(bj)}else{$("#buffs",bc).append("无")}var bn;var bl;var bf=0;var bs=0;var by=0;var bm=0;var bD=1;var bu=$("#DefaultWeapon").val();if(bu==0){bD=0.5}else{bD=1+bu*0.2}var br;if($("#DefaultMuBonus").is(":checked")){br=1.2}else{br=1}var bz=1+$("#MoreDamage").val()*0.01;var bE=1+$("#MoreCritical").val()*0.01;var bk=citizenPage[bd].buffIcons;for(var bB=0;bB<citizenPage[bd].debuffIcons.length;bB++){bk.push(citizenPage[bd].debuffIcons[bB])}for(var bA=0;bA<bk.length;bA++){var bF=bk[bA].match(/(steroids|tank|spa|vacations|bunker|resistance|painDealer1h|painDealer10h|painDealer25h)\_(positive|negative)/ig);if(bF===null){break}switch(bF[0]){case"painDealer10h_positive":case"painDealer1h_positive":case"painDealer25h_positive":bf=1;break;case"steroids_positive":bs=1;break;case"steroids_negative":bs=-1;break;case"tank_positive":by=1;bD=2;break;case"tank_negative":by=-1;bD=0.5;break;case"bunker_positive":case"resistance_positive":bm=1;break;case"bunker_negative":case"resistance_negative":bm=1;break;default:break}}var bp=1;var bh=citizenPage[bd].lowHit;var bw=citizenPage[bd].highHit;var bi=citizenPage[bd].critical/100;var be=citizenPage[bd].miss/100;var bt=citizenPage[bd].avoid/100;var bg;var bv=bD;bg=bi;if(bf==1){bg=bg*2}bg=bg*bE;if(bg>0.8){bg=0.8}if(bs==1){bv=bv*1.2}else{if(bs==-1){bv=bv*0.8}}if(by==1){bv=bv*1.2}if(bm==1){bv=bv*1.25}else{if(bm==-1){bv=bv*0.8}}bv=bv*br;bv=bv*1.2;bv=bv*bz;var bx=Math.round(bh*bv*5);var bo=Math.round(bw*bv*5);var bC=(bx+bo)*(1+bg)/10;$("#estBerserkAvg",bc).html("连击平均伤害："+aW(Math.round(bC*5)));var bG=citizenPage[bd].strength;var bq=citizenPage[bd].totalDamage;var bH=[{damageRequired:0,name:"Rookie",damageModifier:1},{damageRequired:250,name:"Private",damageModifier:1.1},{damageRequired:1000,name:"Private First Class",damageModifier:1.2},{damageRequired:3000,name:"Corporal",damageModifier:1.3},{damageRequired:5000,name:"Sergeant",damageModifier:1.4},{damageRequired:10000,name:"Staff Sergeant",damageModifier:1.5},{damageRequired:30000,name:"Sergeant First Class",damageModifier:1.6},{damageRequired:60000,name:"Master Sergeant",damageModifier:1.65},{damageRequired:100000,name:"First Sergeant",damageModifier:1.7},{damageRequired:250000,name:"Sergeant Major",damageModifier:1.75},{damageRequired:500000,name:"Command Sergeant Major",damageModifier:1.8},{damageRequired:750000,name:"Sergeant Major of the Army",damageModifier:1.85},{damageRequired:1000000,name:"Second Lieutenant",damageModifier:1.9},{damageRequired:1500000,name:"First Lieutenant",damageModifier:1.93},{damageRequired:2500000,name:"Captain",damageModifier:1.96},{damageRequired:5000000,name:"Major",damageModifier:2},{damageRequired:10000000,name:"Lieutenant Colonel",damageModifier:2.03},{damageRequired:17000000,name:"Colonel",damageModifier:2.06},{damageRequired:25000000,name:"Brigadier General",damageModifier:2.1},{damageRequired:35000000,name:"Major General",damageModifier:2.13},{damageRequired:45000000,name:"Lieutenant General",damageModifier:2.16},{damageRequired:60000000,name:"General",damageModifier:2.19},{damageRequired:80000000,name:"General of the Army",damageModifier:2.21},{damageRequired:100000000,name:"Marshall",damageModifier:2.24},{damageRequired:125000000,name:"Field Marshall",damageModifier:2.27},{damageRequired:175000000,name:"Supreme Marshall",damageModifier:2.3},{damageRequired:250000000,name:"Generalissimus",damageModifier:2.33},{damageRequired:400000000,name:"Supreme Generalissimuss",damageModifier:2.36},{damageRequired:600000000,name:"Imperial Generalissimus",damageModifier:2.4},{damageRequired:800000000,name:"Legendary Generalissimuss",damageModifier:2.42},{damageRequired:1000000000,name:"Imperator",damageModifier:2.44},{damageRequired:1500000000,name:"Imperator Caesar",damageModifier:2.46},{damageRequired:2500000000,name:"Deus Dimidiam",damageModifier:2.48},{damageRequired:5000000000,name:"Deus",damageModifier:2.5},{damageRequired:7500000000,name:"Summi Deus",damageModifier:2.52},{damageRequired:10000000000,name:"Deus Imperialis",damageModifier:2.54},{damageRequired:15000000000,name:"Deus Fabuloso",damageModifier:2.56},{damageRequired:20000000000,name:"Deus Ultimum",damageModifier:2.58}];for(var bB=0;bB<bH.length;++bB){if(bH[bB]["damageRequired"]>bq){bq=bH[bB-1]["damageModifier"];break}}if(bH[bH.length-1]["damageRequired"]<=bq){bq=bH[bH.length-1]["damageModifier"]}bl=((bh+bw)/2*(1+bg)*(1-be))/(bG*bq*1.125*0.875);bl=bl<1?1:bl;bn=bl*0.95/(1-bt);$("#score1",bc).text("总伤害：+"+((bn-1)*100).toFixed(2)+"%");$("#score2",bc).text("爆发力：+"+((bl-1)*100).toFixed(2)+"%");if(--bb===0){localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}})})}}function aO(){var aT=$("#pagination-digg");if(aT.length>0){var aU=$("<button>",{text:"加载其他页的在线玩家","class":"foundation-style button",title:"如果需要加载所有在线玩家，请尽快点击该按钮，否则可能会出现重复玩家或丢失玩家"}).appendTo($(".dataTable tr:first td:first"));var aS=$("table.dataTable:last");aU.click(function(){aU.attr("disabled",true);var aV=$("li.next");var aY=parseInt($("li.active")[0].innerHTML);var aW;if(aV.length>0){aW=parseInt(aV.prev().children().attr("href").split("page=")[1])}else{aW=aY}var aX=aW-1;aU.text("剩余"+aX+"个");for(var a0=1;a0<=aW;a0++){if(a0==aY){continue}var aZ=document.URL;if(aZ.indexOf("page")>0){aZ=aZ.substring(0,aZ.indexOf("page"))+"page="+a0}else{if(aZ.indexOf("?")>0){aZ=aZ+"&page="+a0}else{aZ=aZ+"?page="+a0}}$.ajax({url:aZ,success:function(a1){if($(".time",a1).length!==2){console.log(citizenId,"抓取错误，重新抓取");$.ajax(this);return}if($("td",$(".dataTable tr:gt(0)",a1)).length===1){return false}var a2=$("tr :gt(0)",$(".dataTable",a1));a2.appendTo(aS);aU.text("剩余"+(--aX)+"个");if(aX<=0){aU.text("加载完成，共"+aW+"页")}},error:function(a1,a2){console.log("抓取错误 (",a2,")，重新抓取");$.ajax(this)}})}})}}function aP(){sortIndex=-1;var aV,aU;var aW=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(1)"));var aX=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(2)"));var aY=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(3)"));var aT=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(4)"));aW.click(function(){aS($("table.dataTable:last tr:gt(0)"),"number",1)});aX.click(function(){aS($("table.dataTable:last tr:gt(0)"),"formatNumber",2)});aY.click(function(){aS($("table.dataTable:last tr:gt(0)"),"formatNumber",3)});aT.click(function(){aS($("table.dataTable:last tr:gt(0)"),"region",4)});function aS(a3,a5,a2){var a6=new Array();a3.each(function(){var a8=$(this).find("td");a6.push(a5+".separator"+$(a8[a2]).html()+".separator"+$(this).html());$(this).html("")});var a4=a6.length;if(a2==sortIndex){a6.reverse()}else{for(var a1=0;a1<a4;a1++){a5=a6[a1].split(".separator")[0];for(var aZ=a1+1;aZ<a4;aZ++){aV=a6[a1].split(".separator")[1];aU=a6[aZ].split(".separator")[1];if(a5=="number"){aV=aV==""?0:parseInt(aV);aU=aU==""?0:parseInt(aU);if(aV<aU){var a7=a6[aZ];a6[aZ]=a6[a1];a6[a1]=a7}}else{if(a5=="formatNumber"){aV=aV==""?0:parseInt(aV.replace(/,/g,"").replace(/\xA0/g,""));aU=aU==""?0:parseInt(aU.replace(/,/g,"").replace(/\xA0/g,""));if(aV<aU){var a7=a6[aZ];a6[aZ]=a6[a1];a6[a1]=a7}}else{if(a5=="region"){aV=aV==""?0:parseInt(aV.match(/id=([0-9]+)/)[1]);aU=aU==""?0:parseInt(aU.match(/id=([0-9]+)/)[1]);if(aV<aU){var a7=a6[aZ];a6[aZ]=a6[a1];a6[a1]=a7}}}}}}}var a0=$("table.dataTable:last").children();for(var a1=0;a1<a4;a1++){$("tr:eq("+(a1+1)+")",a0).html(a6[a1].split(".separator")[2])}sortIndex=a2}}function aQ(){var aT=$("table.dataTable:last");var aZ=$("<div></div>");aZ.insertBefore(aT);var aS=$("<table align='right'></table>");aZ.append(aS);var aW=$("<tr align='right'></tr>");aS.append(aW);var aV=$("<input type='button' id='btnFilter' value='筛选玩家'></input> ");aW.append(aV);var aY=$("<input type='button' id='btnCloseFilter' value='关闭筛选'></input> ");aY.hide();aW.append(aY);var aU=$("<input type='button' id='btnDeleteCheckedCitizen' value='隐藏选中玩家'></input> ");aU.attr("disabled",true);aW.append(aU);var aX=$("<input type='button' id='btnDeleteUncheckedCitizen' value='保留选中玩家'></input> ");aX.attr("disabled",true);aW.append(aX);aV.click(function(){aV.hide();aY.show();var a0=$("<td exid='filter'><input type='checkbox'></input></td>");$("tr:eq(0)",aT).append($("<td exid='filter'><input id='filterSelectAll' type='checkbox'></input>全选</td>"));$("tr:gt(0)",aT).append(a0);aU.attr("disabled",false);aX.attr("disabled",false);$("#filterSelectAll").click(function(){$("tr:gt(0)",aT).each(function(a1,a2){$("input:checkbox",a2).attr("checked",$("#filterSelectAll").is(":checked"))})})});aY.click(function(){aV.show();aY.hide();$("td[exid='filter']",aT).remove();aU.attr("disabled",true);aX.attr("disabled",true)});aU.click(function(){$("tr:gt(0)",aT).each(function(a0,a2){var a1=$("input:checkbox",a2);if(a1.is(":checked")===true){a2.remove()}})});aX.click(function(){$("tr:gt(0)",aT).each(function(a0,a2){var a1=$("input:checkbox",a2);if(a1.is(":checked")===false){a2.remove()}})})}}!function(bE){function bD(bG){bE.jqplot.ElemContainer.call(this),this.name=bG,this._series=[],this.show=!1,this.tickRenderer=bE.jqplot.AxisTickRenderer,this.tickOptions={},this.labelRenderer=bE.jqplot.AxisLabelRenderer,this.labelOptions={},this.label=null,this.showLabel=!0,this.min=null,this.max=null,this.autoscale=!1,this.pad=1.2,this.padMax=null,this.padMin=null,this.ticks=[],this.numberTicks,this.tickInterval,this.renderer=bE.jqplot.LinearAxisRenderer,this.rendererOptions={},this.showTicks=!0,this.showTickMarks=!0,this.showMinorTicks=!0,this.drawMajorGridlines=!0,this.drawMinorGridlines=!1,this.drawMajorTickMarks=!0,this.drawMinorTickMarks=!0,this.useSeriesColor=!1,this.borderWidth=null,this.borderColor=null,this.scaleToHiddenSeries=!1,this._dataBounds={min:null,max:null},this._intervalStats=[],this._offsets={min:null,max:null},this._ticks=[],this._label=null,this.syncTicks=null,this.tickSpacing=75,this._min=null,this._max=null,this._tickInterval=null,this._numberTicks=null,this.__ticks=null,this._options={}}function bC(bG){bE.jqplot.ElemContainer.call(this),this.show=!1,this.location="ne",this.labels=[],this.showLabels=!0,this.showSwatches=!0,this.placement="insideGrid",this.xoffset=0,this.yoffset=0,this.border,this.background,this.textColor,this.fontFamily,this.fontSize,this.rowSpacing="0.5em",this.renderer=bE.jqplot.TableLegendRenderer,this.rendererOptions={},this.preDraw=!1,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null,this.escapeHtml=!1,this._series=[],bE.extend(!0,this,bG)}function bB(bG){bE.jqplot.ElemContainer.call(this),this.text=bG,this.show=!0,this.fontFamily,this.fontSize,this.textAlign,this.textColor,this.renderer=bE.jqplot.DivTitleRenderer,this.rendererOptions={},this.escapeHtml=!1}function bA(bG){bG=bG||{},bE.jqplot.ElemContainer.call(this),this.show=!0,this.xaxis="xaxis",this._xaxis,this.yaxis="yaxis",this._yaxis,this.gridBorderWidth=2,this.renderer=bE.jqplot.LineRenderer,this.rendererOptions={},this.data=[],this.gridData=[],this.label="",this.showLabel=!0,this.color,this.negativeColor,this.lineWidth=2.5,this.lineJoin="round",this.lineCap="round",this.linePattern="solid",this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1.25,this.shadowDepth=3,this.shadowAlpha="0.1",this.breakOnNull=!1,this.markerRenderer=bE.jqplot.MarkerRenderer,this.markerOptions={},this.showLine=!0,this.showMarker=!0,this.index,this.fill=!1,this.fillColor,this.fillAlpha,this.fillAndStroke=!1,this.disableStack=!1,this._stack=!1,this.neighborThreshold=4,this.fillToZero=!1,this.fillToValue=0,this.fillAxis="y",this.useNegativeColors=!0,this._stackData=[],this._plotData=[],this._plotValues={x:[],y:[]},this._intervals={x:{},y:{}},this._prevPlotData=[],this._prevGridData=[],this._stackAxis="y",this._primaryAxis="_xaxis",this.canvas=new bE.jqplot.GenericCanvas,this.shadowCanvas=new bE.jqplot.GenericCanvas,this.plugins={},this._sumy=0,this._sumx=0,this._type="",this.step=!1}function bz(){bE.jqplot.ElemContainer.call(this),this.drawGridlines=!0,this.gridLineColor="#cccccc",this.gridLineWidth=1,this.background="#fffdf6",this.borderColor="#999999",this.borderWidth=2,this.drawBorder=!0,this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1.5,this.shadowWidth=3,this.shadowDepth=3,this.shadowColor=null,this.shadowAlpha="0.07",this._left,this._top,this._right,this._bottom,this._width,this._height,this._axes=[],this.renderer=bE.jqplot.CanvasGridRenderer,this.rendererOptions={},this._offsets={top:null,bottom:null,left:null,right:null}}function by(){function bI(bK){for(var bJ,bP=0;bP<bK.length;bP++){for(var bO,bN=[bK[bP].data,bK[bP]._stackData,bK[bP]._plotData,bK[bP]._prevPlotData],bM=0;4>bM;bM++){if(bO=!0,bJ=bN[bM],"x"==bK[bP]._stackAxis){for(var bL=0;bL<bJ.length;bL++){if("number"!=typeof bJ[bL][1]){bO=!1;break}}bO&&bJ.sort(function(bR,bQ){return bR[1]-bQ[1]})}else{for(var bL=0;bL<bJ.length;bL++){if("number"!=typeof bJ[bL][0]){bO=!1;break}}bO&&bJ.sort(function(bR,bQ){return bR[0]-bQ[0]})}}}}function bH(bR){var bQ,bP,bO=bR.data.plot,bN=bO.eventCanvas._elem.offset(),bM={x:bR.pageX-bN.left,y:bR.pageY-bN.top},bL={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null,yMidAxis:null},bK=["xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"],bJ=bO.axes;for(bQ=11;bQ>0;bQ--){bP=bK[bQ-1],bJ[bP].show&&(bL[bP]=bJ[bP].series_p2u(bM[bP.charAt(0)]))}return{offsets:bN,gridPos:bM,dataPos:bL}}function bG(ci,ch){function cg(ck,cj,co){var cn=(cj[1]-co[1])/(cj[0]-co[0]),cm=cj[1]-cn*cj[0],cl=ck+cj[1];return[(cl-cm)/cn,cl]}var cf,ce,cd,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2,b1,b0,bZ,bY,bX,bW=ch.series;for(cd=ch.seriesStack.length-1;cd>=0;cd--){switch(cf=ch.seriesStack[cd],cc=bW[cf],bZ=cc._highlightThreshold,cc.renderer.constructor){case bE.jqplot.BarRenderer:for(ca=ci.x,b9=ci.y,ce=0;ce<cc._barPoints.length;ce++){if(b0=cc._barPoints[ce],b1=cc.gridData[ce],ca>b0[0][0]&&ca<b0[2][0]&&(b9>b0[2][1]&&b9<b0[0][1]||b9<b0[2][1]&&b9>b0[0][1])){return{seriesIndex:cc.index,pointIndex:ce,gridData:b1,data:cc.data[ce],points:cc._barPoints[ce]}}}break;case bE.jqplot.PyramidRenderer:for(ca=ci.x,b9=ci.y,ce=0;ce<cc._barPoints.length;ce++){if(b0=cc._barPoints[ce],b1=cc.gridData[ce],ca>b0[0][0]+bZ[0][0]&&ca<b0[2][0]+bZ[2][0]&&b9>b0[2][1]&&b9<b0[0][1]){return{seriesIndex:cc.index,pointIndex:ce,gridData:b1,data:cc.data[ce],points:cc._barPoints[ce]}}}break;case bE.jqplot.DonutRenderer:if(b6=cc.startAngle/180*Math.PI,ca=ci.x-cc._center[0],b9=ci.y-cc._center[1],cb=Math.sqrt(Math.pow(ca,2)+Math.pow(b9,2)),ca>0&&-b9>=0?b8=2*Math.PI-Math.atan(-b9/ca):ca>0&&0>-b9?b8=-Math.atan(-b9/ca):0>ca?b8=Math.PI-Math.atan(-b9/ca):0==ca&&-b9>0?b8=3*Math.PI/2:0==ca&&0>-b9?b8=Math.PI/2:0==ca&&0==b9&&(b8=0),b6&&(b8-=b6,0>b8?b8+=2*Math.PI:b8>2*Math.PI&&(b8-=2*Math.PI)),b7=cc.sliceMargin/180*Math.PI,cb<cc._radius&&cb>cc._innerRadius){for(ce=0;ce<cc.gridData.length;ce++){if(b5=ce>0?cc.gridData[ce-1][1]+b7:b7,b4=cc.gridData[ce][1],b8>b5&&b4>b8){return{seriesIndex:cc.index,pointIndex:ce,gridData:[ci.x,ci.y],data:cc.data[ce]}}}}break;case bE.jqplot.PieRenderer:if(b6=cc.startAngle/180*Math.PI,ca=ci.x-cc._center[0],b9=ci.y-cc._center[1],cb=Math.sqrt(Math.pow(ca,2)+Math.pow(b9,2)),ca>0&&-b9>=0?b8=2*Math.PI-Math.atan(-b9/ca):ca>0&&0>-b9?b8=-Math.atan(-b9/ca):0>ca?b8=Math.PI-Math.atan(-b9/ca):0==ca&&-b9>0?b8=3*Math.PI/2:0==ca&&0>-b9?b8=Math.PI/2:0==ca&&0==b9&&(b8=0),b6&&(b8-=b6,0>b8?b8+=2*Math.PI:b8>2*Math.PI&&(b8-=2*Math.PI)),b7=cc.sliceMargin/180*Math.PI,cb<cc._radius){for(ce=0;ce<cc.gridData.length;ce++){if(b5=ce>0?cc.gridData[ce-1][1]+b7:b7,b4=cc.gridData[ce][1],b8>b5&&b4>b8){return{seriesIndex:cc.index,pointIndex:ce,gridData:[ci.x,ci.y],data:cc.data[ce]}}}}break;case bE.jqplot.BubbleRenderer:ca=ci.x,b9=ci.y;var bV=null;if(cc.show){for(var ce=0;ce<cc.gridData.length;ce++){b1=cc.gridData[ce],b2=Math.sqrt((ca-b1[0])*(ca-b1[0])+(b9-b1[1])*(b9-b1[1])),b2<=b1[2]&&(b3>=b2||null==b3)&&(b3=b2,bV={seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]})}if(null!=bV){return bV}}break;case bE.jqplot.FunnelRenderer:ca=ci.x,b9=ci.y;var bU,bT,bS,bR=cc._vertices,bQ=bR[0],bP=bR[bR.length-1];for(bU=cg(b9,bQ[0],bP[3]),bT=cg(b9,bQ[1],bP[2]),ce=0;ce<bR.length;ce++){if(bS=bR[ce],b9>=bS[0][1]&&b9<=bS[3][1]&&ca>=bU[0]&&ca<=bT[0]){return{seriesIndex:cc.index,pointIndex:ce,gridData:null,data:cc.data[ce]}}}break;case bE.jqplot.LineRenderer:if(ca=ci.x,b9=ci.y,cb=cc.renderer,cc.show){if(!(!(cc.fill||cc.renderer.bands.show&&cc.renderer.bands.fill)||ch.plugins.highlighter&&ch.plugins.highlighter.show)){var bO=!1;if(ca>cc._boundingBox[0][0]&&ca<cc._boundingBox[1][0]&&b9>cc._boundingBox[1][1]&&b9<cc._boundingBox[0][1]){for(var bN,bM=cc._areaPoints.length,ce=bM-1,bN=0;bM>bN;bN++){var bL=[cc._areaPoints[bN][0],cc._areaPoints[bN][1]],bK=[cc._areaPoints[ce][0],cc._areaPoints[ce][1]];(bL[1]<b9&&bK[1]>=b9||bK[1]<b9&&bL[1]>=b9)&&bL[0]+(b9-bL[1])/(bK[1]-bL[1])*(bK[0]-bL[0])<ca&&(bO=!bO),ce=bN}}if(bO){return{seriesIndex:cf,pointIndex:null,gridData:cc.gridData,data:cc.data,points:cc._areaPoints}}break}bX=cc.markerRenderer.size/2+cc.neighborThreshold,bY=bX>0?bX:0;for(var ce=0;ce<cc.gridData.length;ce++){if(b1=cc.gridData[ce],cb.constructor==bE.jqplot.OHLCRenderer){if(cb.candleStick){var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._bodyWidth/2&&ca<=b1[0]+cb._bodyWidth/2&&b9>=bJ(cc.data[ce][2])&&b9<=bJ(cc.data[ce][3])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}else{if(cb.hlc){var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._tickLength&&ca<=b1[0]+cb._tickLength&&b9>=bJ(cc.data[ce][1])&&b9<=bJ(cc.data[ce][2])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}else{var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._tickLength&&ca<=b1[0]+cb._tickLength&&b9>=bJ(cc.data[ce][2])&&b9<=bJ(cc.data[ce][3])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}}}else{if(null!=b1[0]&&null!=b1[1]&&(b2=Math.sqrt((ca-b1[0])*(ca-b1[0])+(b9-b1[1])*(b9-b1[1])),bY>=b2&&(b3>=b2||null==b3))){return b3=b2,{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}}}break;default:if(ca=ci.x,b9=ci.y,cb=cc.renderer,cc.show){bX=cc.markerRenderer.size/2+cc.neighborThreshold,bY=bX>0?bX:0;for(var ce=0;ce<cc.gridData.length;ce++){if(b1=cc.gridData[ce],cb.constructor==bE.jqplot.OHLCRenderer){if(cb.candleStick){var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._bodyWidth/2&&ca<=b1[0]+cb._bodyWidth/2&&b9>=bJ(cc.data[ce][2])&&b9<=bJ(cc.data[ce][3])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}else{if(cb.hlc){var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._tickLength&&ca<=b1[0]+cb._tickLength&&b9>=bJ(cc.data[ce][1])&&b9<=bJ(cc.data[ce][2])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}else{var bJ=cc._yaxis.series_u2p;if(ca>=b1[0]-cb._tickLength&&ca<=b1[0]+cb._tickLength&&b9>=bJ(cc.data[ce][2])&&b9<=bJ(cc.data[ce][3])){return{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}}}else{if(b2=Math.sqrt((ca-b1[0])*(ca-b1[0])+(b9-b1[1])*(b9-b1[1])),bY>=b2&&(b3>=b2||null==b3)){return b3=b2,{seriesIndex:cf,pointIndex:ce,gridData:b1,data:cc.data[ce]}}}}}}}return null}this.animate=!1,this.animateReplot=!1,this.axes={xaxis:new bD("xaxis"),yaxis:new bD("yaxis"),x2axis:new bD("x2axis"),y2axis:new bD("y2axis"),y3axis:new bD("y3axis"),y4axis:new bD("y4axis"),y5axis:new bD("y5axis"),y6axis:new bD("y6axis"),y7axis:new bD("y7axis"),y8axis:new bD("y8axis"),y9axis:new bD("y9axis"),yMidAxis:new bD("yMidAxis")},this.baseCanvas=new bE.jqplot.GenericCanvas,this.captureRightClick=!1,this.data=[],this.dataRenderer,this.dataRendererOptions,this.defaults={axesDefaults:{},axes:{xaxis:{},yaxis:{},x2axis:{},y2axis:{},y3axis:{},y4axis:{},y5axis:{},y6axis:{},y7axis:{},y8axis:{},y9axis:{},yMidAxis:{}},seriesDefaults:{},series:[]},this.defaultAxisStart=1,this.drawIfHidden=!1,this.eventCanvas=new bE.jqplot.GenericCanvas,this.fillBetween={series1:null,series2:null,color:null,baseSeries:0,fill:!0},this.fontFamily,this.fontSize,this.grid=new bz,this.legend=new bC,this.noDataIndicator={show:!1,indicator:"Loading Data...",axes:{xaxis:{min:0,max:10,tickInterval:2,show:!0},yaxis:{min:0,max:12,tickInterval:3,show:!0}}},this.negativeSeriesColors=bE.jqplot.config.defaultNegativeColors,this.options={},this.previousSeriesStack=[],this.plugins={},this.series=[],this.seriesStack=[],this.seriesColors=bE.jqplot.config.defaultColors,this.sortData=!0,this.stackSeries=!1,this.syncXTicks=!0,this.syncYTicks=!0,this.target=null,this.targetId=null,this.textColor,this.title=new bB,this._drawCount=0,this._sumy=0,this._sumx=0,this._stackData=[],this._plotData=[],this._width=null,this._height=null,this._plotDimensions={height:null,width:null},this._gridPadding={top:null,right:null,bottom:null,left:null},this._defaultGridPadding={top:10,right:10,bottom:23,left:10},this._addDomReference=bE.jqplot.config.addDomReference,this.preInitHooks=new bE.jqplot.HooksManager,this.postInitHooks=new bE.jqplot.HooksManager,this.preParseOptionsHooks=new bE.jqplot.HooksManager,this.postParseOptionsHooks=new bE.jqplot.HooksManager,this.preDrawHooks=new bE.jqplot.HooksManager,this.postDrawHooks=new bE.jqplot.HooksManager,this.preDrawSeriesHooks=new bE.jqplot.HooksManager,this.postDrawSeriesHooks=new bE.jqplot.HooksManager,this.preDrawLegendHooks=new bE.jqplot.HooksManager,this.addLegendRowHooks=new bE.jqplot.HooksManager,this.preSeriesInitHooks=new bE.jqplot.HooksManager,this.postSeriesInitHooks=new bE.jqplot.HooksManager,this.preParseSeriesOptionsHooks=new bE.jqplot.HooksManager,this.postParseSeriesOptionsHooks=new bE.jqplot.HooksManager,this.eventListenerHooks=new bE.jqplot.EventListenerManager,this.preDrawSeriesShadowHooks=new bE.jqplot.HooksManager,this.postDrawSeriesShadowHooks=new bE.jqplot.HooksManager,this.colorGenerator=new bE.jqplot.ColorGenerator,this.negativeColorGenerator=new bE.jqplot.ColorGenerator,this.canvasManager=new bE.jqplot.CanvasManager,this.themeEngine=new bE.jqplot.ThemeEngine;this.init=function(bU,bT,bS){bS=bS||{};for(var bR=0;bR<bE.jqplot.preInitHooks.length;bR++){bE.jqplot.preInitHooks[bR].call(this,bU,bT,bS)}for(var bR=0;bR<this.preInitHooks.hooks.length;bR++){this.preInitHooks.hooks[bR].call(this,bU,bT,bS)}if(this.targetId="#"+bU,this.target=bE("#"+bU),this._addDomReference&&this.target.data("jqplot",this),this.target.removeClass("jqplot-error"),!this.target.get(0)){throw new Error("No plot target specified")}if("static"==this.target.css("position")&&this.target.css("position","relative"),this.target.hasClass("jqplot-target")||this.target.addClass("jqplot-target"),this.target.height()){this._height=bQ=this.target.height()}else{var bQ;bQ=bS&&bS.height?parseInt(bS.height,10):this.target.attr("data-height")?parseInt(this.target.attr("data-height"),10):parseInt(bE.jqplot.config.defaultHeight,10),this._height=bQ,this.target.css("height",bQ+"px")}if(this.target.width()){this._width=bP=this.target.width()}else{var bP;bP=bS&&bS.width?parseInt(bS.width,10):this.target.attr("data-width")?parseInt(this.target.attr("data-width"),10):parseInt(bE.jqplot.config.defaultWidth,10),this._width=bP,this.target.css("width",bP+"px")}for(var bR=0,bO=a7.length;bO>bR;bR++){this.axes[a7[bR]]=new bD(a7[bR])}if(this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions,this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Canvas dimension not set")}if(bS.dataRenderer&&bE.isFunction(bS.dataRenderer)&&(bS.dataRendererOptions&&(this.dataRendererOptions=bS.dataRendererOptions),this.dataRenderer=bS.dataRenderer,bT=this.dataRenderer(bT,this,this.dataRendererOptions)),bS.noDataIndicator&&bE.isPlainObject(bS.noDataIndicator)&&bE.extend(!0,this.noDataIndicator,bS.noDataIndicator),null==bT||0==bE.isArray(bT)||0==bT.length||0==bE.isArray(bT[0])||0==bT[0].length){if(0==this.noDataIndicator.show){throw new Error("No data specified")}for(var bN in this.noDataIndicator.axes){for(var bM in this.noDataIndicator.axes[bN]){this.axes[bN][bM]=this.noDataIndicator.axes[bN][bM]}}this.postDrawHooks.add(function(){var bV=this.eventCanvas.getHeight(),b0=this.eventCanvas.getWidth(),bZ=bE('<div class="jqplot-noData-container" style="position:absolute;"></div>');this.target.append(bZ),bZ.height(bV),bZ.width(b0),bZ.css("top",this.eventCanvas._offsets.top),bZ.css("left",this.eventCanvas._offsets.left);var bY=bE('<div class="jqplot-noData-contents" style="text-align:center; position:relative; margin-left:auto; margin-right:auto;"></div>');bZ.append(bY),bY.html(this.noDataIndicator.indicator);var bX=bY.height(),bW=bY.width();bY.height(bX),bY.width(bW),bY.css("top",(bV-bX)/2+"px")})}this.data=bE.extend(!0,[],bT),this.parseOptions(bS),this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this.title.init(),this.legend.init(),this._sumy=0,this._sumx=0,this.computePlotData();for(var bR=0;bR<this.series.length;bR++){this.seriesStack.push(bR),this.previousSeriesStack.push(bR),this.series[bR].shadowCanvas._plotDimensions=this._plotDimensions,this.series[bR].canvas._plotDimensions=this._plotDimensions;for(var bL=0;bL<bE.jqplot.preSeriesInitHooks.length;bL++){bE.jqplot.preSeriesInitHooks[bL].call(this.series[bR],bU,this.data,this.options.seriesDefaults,this.options.series[bR],this)}for(var bL=0;bL<this.preSeriesInitHooks.hooks.length;bL++){this.preSeriesInitHooks.hooks[bL].call(this.series[bR],bU,this.data,this.options.seriesDefaults,this.options.series[bR],this)}this.series[bR]._plotDimensions=this._plotDimensions,this.series[bR].init(bR,this.grid.borderWidth,this);for(var bL=0;bL<bE.jqplot.postSeriesInitHooks.length;bL++){bE.jqplot.postSeriesInitHooks[bL].call(this.series[bR],bU,this.data,this.options.seriesDefaults,this.options.series[bR],this)}for(var bL=0;bL<this.postSeriesInitHooks.hooks.length;bL++){this.postSeriesInitHooks.hooks[bL].call(this.series[bR],bU,this.data,this.options.seriesDefaults,this.options.series[bR],this)}this._sumy+=this.series[bR]._sumy,this._sumx+=this.series[bR]._sumx}for(var bK,bJ,bR=0,bO=a7.length;bO>bR;bR++){bK=a7[bR],bJ=this.axes[bK],bJ._plotDimensions=this._plotDimensions,bJ.init(),null==this.axes[bK].borderColor&&("x"!==bK.charAt(0)&&bJ.useSeriesColor===!0&&bJ.show?bJ.borderColor=bJ._series[0].color:bJ.borderColor=this.grid.borderColor)}this.sortData&&bI(this.series),this.grid.init(),this.grid._axes=this.axes,this.legend._series=this.series;for(var bR=0;bR<bE.jqplot.postInitHooks.length;bR++){bE.jqplot.postInitHooks[bR].call(this,bU,this.data,bS)}for(var bR=0;bR<this.postInitHooks.hooks.length;bR++){this.postInitHooks.hooks[bR].call(this,bU,this.data,bS)}},this.resetAxesScale=function(bJ,bO){var bN=bO||{},bM=bJ||this.axes;if(bM===!0&&(bM=this.axes),bE.isArray(bM)){for(var bL=0;bL<bM.length;bL++){this.axes[bM[bL]].resetScale(bN[bM[bL]])}}else{if("object"==typeof bM){for(var bK in bM){this.axes[bK].resetScale(bN[bK])}}}},this.reInitialize=function(bV,bU){for(var bT=bE.extend(!0,{},this.options,bU),bS=this.targetId.substr(1),bR=null==bV?this.data:bV,bQ=0;bQ<bE.jqplot.preInitHooks.length;bQ++){bE.jqplot.preInitHooks[bQ].call(this,bS,bR,bT)}for(var bQ=0;bQ<this.preInitHooks.hooks.length;bQ++){this.preInitHooks.hooks[bQ].call(this,bS,bR,bT)}if(this._height=this.target.height(),this._width=this.target.width(),this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")}this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions;for(var bP,bO,bN,bM,bQ=0,bL=a7.length;bL>bQ;bQ++){bP=a7[bQ],bM=this.axes[bP],bO=bM._ticks;for(var bN=0,bK=bO.length;bK>bN;bN++){var bJ=bO[bN]._elem;bJ&&(bE.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a8&&window.G_vmlCanvasManager.uninitElement(bJ.get(0)),bJ.emptyForce(),bJ=null,bO._elem=null)}bO=null,delete bM.ticks,delete bM._ticks,this.axes[bP]=new bD(bP),this.axes[bP]._plotWidth=this._width,this.axes[bP]._plotHeight=this._height}bV&&(bT.dataRenderer&&bE.isFunction(bT.dataRenderer)&&(bT.dataRendererOptions&&(this.dataRendererOptions=bT.dataRendererOptions),this.dataRenderer=bT.dataRenderer,bV=this.dataRenderer(bV,this,this.dataRendererOptions)),this.data=bE.extend(!0,[],bV)),bU&&this.parseOptions(bT),this.title._plotWidth=this._width,this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this.title.init(),this.legend.init(),this._sumy=0,this._sumx=0,this.seriesStack=[],this.previousSeriesStack=[],this.computePlotData();for(var bQ=0,bL=this.series.length;bL>bQ;bQ++){this.seriesStack.push(bQ),this.previousSeriesStack.push(bQ),this.series[bQ].shadowCanvas._plotDimensions=this._plotDimensions,this.series[bQ].canvas._plotDimensions=this._plotDimensions;for(var bN=0;bN<bE.jqplot.preSeriesInitHooks.length;bN++){bE.jqplot.preSeriesInitHooks[bN].call(this.series[bQ],bS,this.data,this.options.seriesDefaults,this.options.series[bQ],this)}for(var bN=0;bN<this.preSeriesInitHooks.hooks.length;bN++){this.preSeriesInitHooks.hooks[bN].call(this.series[bQ],bS,this.data,this.options.seriesDefaults,this.options.series[bQ],this)}this.series[bQ]._plotDimensions=this._plotDimensions,this.series[bQ].init(bQ,this.grid.borderWidth,this);for(var bN=0;bN<bE.jqplot.postSeriesInitHooks.length;bN++){bE.jqplot.postSeriesInitHooks[bN].call(this.series[bQ],bS,this.data,this.options.seriesDefaults,this.options.series[bQ],this)}for(var bN=0;bN<this.postSeriesInitHooks.hooks.length;bN++){this.postSeriesInitHooks.hooks[bN].call(this.series[bQ],bS,this.data,this.options.seriesDefaults,this.options.series[bQ],this)}this._sumy+=this.series[bQ]._sumy,this._sumx+=this.series[bQ]._sumx}for(var bQ=0,bL=a7.length;bL>bQ;bQ++){bP=a7[bQ],bM=this.axes[bP],bM._plotDimensions=this._plotDimensions,bM.init(),null==bM.borderColor&&("x"!==bP.charAt(0)&&bM.useSeriesColor===!0&&bM.show?bM.borderColor=bM._series[0].color:bM.borderColor=this.grid.borderColor)}this.sortData&&bI(this.series),this.grid.init(),this.grid._axes=this.axes,this.legend._series=this.series;for(var bQ=0,bL=bE.jqplot.postInitHooks.length;bL>bQ;bQ++){bE.jqplot.postInitHooks[bQ].call(this,bS,this.data,bT)}for(var bQ=0,bL=this.postInitHooks.hooks.length;bL>bQ;bQ++){this.postInitHooks.hooks[bQ].call(this,bS,this.data,bT)}},this.quickInit=function(){if(this._height=this.target.height(),this._width=this.target.width(),this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")}this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions;for(var bJ in this.axes){this.axes[bJ]._plotWidth=this._width,this.axes[bJ]._plotHeight=this._height}this.title._plotWidth=this._width,this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this._sumy=0,this._sumx=0,this.computePlotData();for(var bO=0;bO<this.series.length;bO++){"line"===this.series[bO]._type&&this.series[bO].renderer.bands.show&&this.series[bO].renderer.initBands.call(this.series[bO],this.series[bO].renderer.options,this),this.series[bO]._plotDimensions=this._plotDimensions,this.series[bO].canvas._plotDimensions=this._plotDimensions,this._sumy+=this.series[bO]._sumy,this._sumx+=this.series[bO]._sumx}for(var bN,bM=0;12>bM;bM++){bN=a7[bM];for(var bL=this.axes[bN]._ticks,bO=0;bO<bL.length;bO++){var bK=bL[bO]._elem;bK&&(bE.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a8&&window.G_vmlCanvasManager.uninitElement(bK.get(0)),bK.emptyForce(),bK=null,bL._elem=null)}bL=null,this.axes[bN]._plotDimensions=this._plotDimensions,this.axes[bN]._ticks=[]}this.sortData&&bI(this.series),this.grid._axes=this.axes,this.legend._series=this.series},this.computePlotData=function(){this._plotData=[],this._stackData=[];var bU,bT,bS;for(bT=0,bS=this.series.length;bS>bT;bT++){bU=this.series[bT],this._plotData.push([]),this._stackData.push([]);var bR=bU.data;this._plotData[bT]=bE.extend(!0,[],bR),this._stackData[bT]=bE.extend(!0,[],bR),bU._plotData=this._plotData[bT],bU._stackData=this._stackData[bT];var bQ={x:[],y:[]};if(this.stackSeries&&!bU.disableStack){bU._stack=!0;for(var bP="x"===bU._stackAxis?0:1,bO=0,bN=bR.length;bN>bO;bO++){var bM=bR[bO][bP];if(null==bM&&(bM=0),this._plotData[bT][bO][bP]=bM,this._stackData[bT][bO][bP]=bM,bT>0){for(var bL=bT;bL--;){var bK=this._plotData[bL][bO][bP];if(bM*bK>=0){this._plotData[bT][bO][bP]+=bK,this._stackData[bT][bO][bP]+=bK;break}}}}}else{for(var bJ=0;bJ<bU.data.length;bJ++){bQ.x.push(bU.data[bJ][0]),bQ.y.push(bU.data[bJ][1])}this._stackData.push(bU.data),this.series[bT]._stackData=bU.data,this._plotData.push(bU.data),bU._plotData=bU.data,bU._plotValues=bQ}for(bT>0&&(bU._prevPlotData=this.series[bT-1]._plotData),bU._sumy=0,bU._sumx=0,bJ=bU.data.length-1;bJ>-1;bJ--){bU._sumy+=bU.data[bJ][1],bU._sumx+=bU.data[bJ][0]}}},this.populatePlotData=function(bW,bV){this._plotData=[],this._stackData=[],bW._stackData=[],bW._plotData=[];var bU={x:[],y:[]};if(this.stackSeries&&!bW.disableStack){bW._stack=!0;for(var bT,bS,bR,bQ,bP="x"===bW._stackAxis?0:1,bO=bE.extend(!0,[],bW.data),bN=bE.extend(!0,[],bW.data),bM=0;bV>bM;bM++){for(var bL=this.series[bM].data,bK=0;bK<bL.length;bK++){bR=bL[bK],bT=null!=bR[0]?bR[0]:0,bS=null!=bR[1]?bR[1]:0,bO[bK][0]+=bT,bO[bK][1]+=bS,bQ=bP?bS:bT,bW.data[bK][bP]*bQ>=0&&(bN[bK][bP]+=bQ)}}for(var bJ=0;bJ<bN.length;bJ++){bU.x.push(bN[bJ][0]),bU.y.push(bN[bJ][1])}this._plotData.push(bN),this._stackData.push(bO),bW._stackData=bO,bW._plotData=bN,bW._plotValues=bU}else{for(var bJ=0;bJ<bW.data.length;bJ++){bU.x.push(bW.data[bJ][0]),bU.y.push(bW.data[bJ][1])}this._stackData.push(bW.data),this.series[bV]._stackData=bW.data,this._plotData.push(bW.data),bW._plotData=bW.data,bW._plotValues=bU}for(bV>0&&(bW._prevPlotData=this.series[bV-1]._plotData),bW._sumy=0,bW._sumx=0,bJ=bW.data.length-1;bJ>-1;bJ--){bW._sumy+=bW.data[bJ][1],bW._sumx+=bW.data[bJ][0]}},this.getNextSeriesColor=function(bK){var bJ=0,bL=bK.seriesColors;return function(){return bJ<bL.length?bL[bJ++]:(bJ=0,bL[bJ++])}}(this),this.parseOptions=function(bU){for(var bT=0;bT<this.preParseOptionsHooks.hooks.length;bT++){this.preParseOptionsHooks.hooks[bT].call(this,bU)}for(var bT=0;bT<bE.jqplot.preParseOptionsHooks.length;bT++){bE.jqplot.preParseOptionsHooks[bT].call(this,bU)}this.options=bE.extend(!0,{},this.defaults,bU);var bS=this.options;if(this.animate=bS.animate,this.animateReplot=bS.animateReplot,this.stackSeries=bS.stackSeries,bE.isPlainObject(bS.fillBetween)){for(var bR,bQ=["series1","series2","color","baseSeries","fill"],bT=0,bP=bQ.length;bP>bT;bT++){bR=bQ[bT],null!=bS.fillBetween[bR]&&(this.fillBetween[bR]=bS.fillBetween[bR])}}bS.seriesColors&&(this.seriesColors=bS.seriesColors),bS.negativeSeriesColors&&(this.negativeSeriesColors=bS.negativeSeriesColors),bS.captureRightClick&&(this.captureRightClick=bS.captureRightClick),this.defaultAxisStart=bU&&null!=bU.defaultAxisStart?bU.defaultAxisStart:this.defaultAxisStart,this.colorGenerator.setColors(this.seriesColors),this.negativeColorGenerator.setColors(this.negativeSeriesColors),bE.extend(!0,this._gridPadding,bS.gridPadding),this.sortData=null!=bS.sortData?bS.sortData:this.sortData;for(var bT=0;12>bT;bT++){var bO=a7[bT],bN=this.axes[bO];bN._options=bE.extend(!0,{},bS.axesDefaults,bS.axes[bO]),bE.extend(!0,bN,bS.axesDefaults,bS.axes[bO]),bN._plotWidth=this._width,bN._plotHeight=this._height}var bM=function(bV,b0,bZ){var bY,bX,bW=[];if(b0=b0||"vertical",bE.isArray(bV[0])){bE.extend(!0,bW,bV)}else{for(bY=0,bX=bV.length;bX>bY;bY++){"vertical"==b0?bW.push([bZ+bY,bV[bY]]):bW.push([bV[bY],bZ+bY])}}return bW};this.series=[];for(var bT=0;bT<this.data.length;bT++){for(var bL=bE.extend(!0,{index:bT},{seriesColors:this.seriesColors,negativeSeriesColors:this.negativeSeriesColors},this.options.seriesDefaults,this.options.series[bT],{rendererOptions:{animation:{show:this.animate}}}),bQ=new bA(bL),bK=0;bK<bE.jqplot.preParseSeriesOptionsHooks.length;bK++){bE.jqplot.preParseSeriesOptionsHooks[bK].call(bQ,this.options.seriesDefaults,this.options.series[bT])}for(var bK=0;bK<this.preParseSeriesOptionsHooks.hooks.length;bK++){this.preParseSeriesOptionsHooks.hooks[bK].call(bQ,this.options.seriesDefaults,this.options.series[bT])}bE.extend(!0,bQ,bL);var bJ="vertical";switch(bQ.renderer===bE.jqplot.BarRenderer&&bQ.rendererOptions&&"horizontal"==bQ.rendererOptions.barDirection&&(bJ="horizontal",bQ._stackAxis="x",bQ._primaryAxis="_yaxis"),bQ.data=bM(this.data[bT],bJ,this.defaultAxisStart),bQ.xaxis){case"xaxis":bQ._xaxis=this.axes.xaxis;break;case"x2axis":bQ._xaxis=this.axes.x2axis}bQ._yaxis=this.axes[bQ.yaxis],bQ._xaxis._series.push(bQ),bQ._yaxis._series.push(bQ),bQ.show?(bQ._xaxis.show=!0,bQ._yaxis.show=!0):(bQ._xaxis.scaleToHiddenSeries&&(bQ._xaxis.show=!0),bQ._yaxis.scaleToHiddenSeries&&(bQ._yaxis.show=!0)),bQ.label||(bQ.label="Series "+(bT+1).toString()),this.series.push(bQ);for(var bK=0;bK<bE.jqplot.postParseSeriesOptionsHooks.length;bK++){bE.jqplot.postParseSeriesOptionsHooks[bK].call(this.series[bT],this.options.seriesDefaults,this.options.series[bT])}for(var bK=0;bK<this.postParseSeriesOptionsHooks.hooks.length;bK++){this.postParseSeriesOptionsHooks.hooks[bK].call(this.series[bT],this.options.seriesDefaults,this.options.series[bT])}}bE.extend(!0,this.grid,this.options.grid);for(var bT=0,bP=a7.length;bP>bT;bT++){var bO=a7[bT],bN=this.axes[bO];null==bN.borderWidth&&(bN.borderWidth=this.grid.borderWidth)}"string"==typeof this.options.title?this.title.text=this.options.title:"object"==typeof this.options.title&&bE.extend(!0,this.title,this.options.title),this.title._plotWidth=this._width,this.legend.setOptions(this.options.legend);for(var bT=0;bT<bE.jqplot.postParseOptionsHooks.length;bT++){bE.jqplot.postParseOptionsHooks[bT].call(this,bU)}for(var bT=0;bT<this.postParseOptionsHooks.hooks.length;bT++){this.postParseOptionsHooks.hooks[bT].call(this,bU)}},this.destroy=function(){this.canvasManager.freeAllCanvases(),this.eventCanvas&&this.eventCanvas._elem&&this.eventCanvas._elem.unbind(),this.target.empty(),this.target[0].innerHTML=""},this.replot=function(bJ){var bN=bJ||{},bM=bN.data||null,bL=bN.clear===!1?!1:!0,bK=bN.resetAxes||!1;delete bN.data,delete bN.clear,delete bN.resetAxes,this.target.trigger("jqplotPreReplot"),bL&&this.destroy(),bM||!bE.isEmptyObject(bN)?this.reInitialize(bM,bN):this.quickInit(),bK&&this.resetAxesScale(bK,bN.axes),this.draw(),this.target.trigger("jqplotPostReplot")},this.redraw=function(bK){bK=null!=bK?bK:!0,this.target.trigger("jqplotPreRedraw"),bK&&(this.canvasManager.freeAllCanvases(),this.eventCanvas._elem.unbind(),this.target.empty());for(var bJ in this.axes){this.axes[bJ]._ticks=[]}this.computePlotData(),this._sumy=0,this._sumx=0;for(var bM=0,bL=this.series.length;bL>bM;bM++){this._sumy+=this.series[bM]._sumy,this._sumx+=this.series[bM]._sumx}this.draw(),this.target.trigger("jqplotPostRedraw")},this.draw=function(){if(this.drawIfHidden||this.target.is(":visible")){this.target.trigger("jqplotPreDraw");var cb,ca,b9;for(cb=0,b9=bE.jqplot.preDrawHooks.length;b9>cb;cb++){bE.jqplot.preDrawHooks[cb].call(this)}for(cb=0,b9=this.preDrawHooks.hooks.length;b9>cb;cb++){this.preDrawHooks.hooks[cb].apply(this,this.preDrawSeriesHooks.args[cb])}this.target.append(this.baseCanvas.createElement({left:0,right:0,top:0,bottom:0},"jqplot-base-canvas",null,this)),this.baseCanvas.setContext(),this.target.append(this.title.draw()),this.title.pack({top:0,left:0});var b8=this.legend.draw({},this),b7={top:0,left:0,bottom:0,right:0};if("outsideGrid"==this.legend.placement){switch(this.target.append(b8),this.legend.location){case"n":b7.top+=this.legend.getHeight();break;case"s":b7.bottom+=this.legend.getHeight();break;case"ne":case"e":case"se":b7.right+=this.legend.getWidth();break;case"nw":case"w":case"sw":b7.left+=this.legend.getWidth();break;default:b7.right+=this.legend.getWidth()}b8=b8.detach()}var b6,b5=this.axes;for(cb=0;12>cb;cb++){b6=a7[cb],this.target.append(b5[b6].draw(this.baseCanvas._ctx,this)),b5[b6].set()}b5.yaxis.show&&(b7.left+=b5.yaxis.getWidth());var b4,b3=["y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"],b2=[0,0,0,0,0,0,0,0],b1=0;for(b4=0;8>b4;b4++){b5[b3[b4]].show&&(b1+=b5[b3[b4]].getWidth(),b2[b4]=b1)}if(b7.right+=b1,b5.x2axis.show&&(b7.top+=b5.x2axis.getHeight()),this.title.show&&(b7.top+=this.title.getHeight()),b5.xaxis.show&&(b7.bottom+=b5.xaxis.getHeight()),this.options.gridDimensions&&bE.isPlainObject(this.options.gridDimensions)){var b0=parseInt(this.options.gridDimensions.width,10)||0,bZ=parseInt(this.options.gridDimensions.height,10)||0,bY=(this._width-b7.left-b7.right-b0)/2,bX=(this._height-b7.top-b7.bottom-bZ)/2;bX>=0&&bY>=0&&(b7.top+=bX,b7.bottom+=bX,b7.left+=bY,b7.right+=bY)}var bV=["top","bottom","left","right"];for(var b4 in bV){null==this._gridPadding[bV[b4]]&&b7[bV[b4]]>0?this._gridPadding[bV[b4]]=b7[bV[b4]]:null==this._gridPadding[bV[b4]]&&(this._gridPadding[bV[b4]]=this._defaultGridPadding[bV[b4]])}var bT=this._gridPadding;for("outsideGrid"===this.legend.placement&&(bT={top:this.title.getHeight(),left:0,right:0,bottom:0},"s"===this.legend.location&&(bT.left=this._gridPadding.left,bT.right=this._gridPadding.right)),b5.xaxis.pack({position:"absolute",bottom:this._gridPadding.bottom-b5.xaxis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right}),b5.yaxis.pack({position:"absolute",top:0,left:this._gridPadding.left-b5.yaxis.getWidth(),height:this._height},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top}),b5.x2axis.pack({position:"absolute",top:this._gridPadding.top-b5.x2axis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right}),cb=8;cb>0;cb--){b5[b3[cb-1]].pack({position:"absolute",top:0,right:this._gridPadding.right-b2[cb-1]},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top})}var bR=(this._width-this._gridPadding.left-this._gridPadding.right)/2+this._gridPadding.left-b5.yMidAxis.getWidth()/2;b5.yMidAxis.pack({position:"absolute",top:0,left:bR,zIndex:9,textAlign:"center"},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top}),this.target.append(this.grid.createElement(this._gridPadding,this)),this.grid.draw();var bP=this.series,bO=bP.length;for(cb=0,b9=bO;b9>cb;cb++){ca=this.seriesStack[cb],this.target.append(bP[ca].shadowCanvas.createElement(this._gridPadding,"jqplot-series-shadowCanvas",null,this)),bP[ca].shadowCanvas.setContext(),bP[ca].shadowCanvas._elem.data("seriesIndex",ca)}for(cb=0,b9=bO;b9>cb;cb++){ca=this.seriesStack[cb],this.target.append(bP[ca].canvas.createElement(this._gridPadding,"jqplot-series-canvas",null,this)),bP[ca].canvas.setContext(),bP[ca].canvas._elem.data("seriesIndex",ca)}this.target.append(this.eventCanvas.createElement(this._gridPadding,"jqplot-event-canvas",null,this)),this.eventCanvas.setContext(),this.eventCanvas._ctx.fillStyle="rgba(0,0,0,0)",this.eventCanvas._ctx.fillRect(0,0,this.eventCanvas._ctx.canvas.width,this.eventCanvas._ctx.canvas.height),this.bindCustomEvents(),this.legend.preDraw?(this.eventCanvas._elem.before(b8),this.legend.pack(bT),this.legend._elem?this.drawSeries({legendInfo:{location:this.legend.location,placement:this.legend.placement,width:this.legend.getWidth(),height:this.legend.getHeight(),xoffset:this.legend.xoffset,yoffset:this.legend.yoffset}}):this.drawSeries()):(this.drawSeries(),bO&&bE(bP[bO-1].canvas._elem).after(b8),this.legend.pack(bT));for(var cb=0,b9=bE.jqplot.eventListenerHooks.length;b9>cb;cb++){this.eventCanvas._elem.bind(bE.jqplot.eventListenerHooks[cb][0],{plot:this},bE.jqplot.eventListenerHooks[cb][1])}for(var cb=0,b9=this.eventListenerHooks.hooks.length;b9>cb;cb++){this.eventCanvas._elem.bind(this.eventListenerHooks.hooks[cb][0],{plot:this},this.eventListenerHooks.hooks[cb][1])}var bN=this.fillBetween;if("number"==typeof bN.series1){bN.fill&&bN.series1!==bN.series2&&bN.series1<bO&&bN.series2<bO&&"line"===bP[bN.series1]._type&&"line"===bP[bN.series2]._type&&this.doFillBetweenLines()}else{if(null!=bN.series1&&null!=bN.series2){var bM=!1;if(bN.series1.length===bN.series2.length){for(var bL=0,bK=0,bJ=0;bJ<bN.series1.length;bJ++){if(bL=bN.series1[bJ],bK=bN.series2[bJ],!(bL!==bK&&bO>bL&&bO>bK&&"line"===bP[bL]._type&&"line"===bP[bK]._type)){bM=!1;break}bM=!0}}bN.fill&&bM&&this.doFillBetweenLines()}}for(var cb=0,b9=bE.jqplot.postDrawHooks.length;b9>cb;cb++){bE.jqplot.postDrawHooks[cb].call(this)}for(var cb=0,b9=this.postDrawHooks.hooks.length;b9>cb;cb++){this.postDrawHooks.hooks[cb].apply(this,this.postDrawHooks.args[cb])}this.target.is(":visible")&&(this._drawCount+=1);var bW,bU,bS,bQ;for(cb=0,b9=bO;b9>cb;cb++){bW=bP[cb],bU=bW.renderer,bS=".jqplot-point-label.jqplot-series-"+cb,bU.animation&&bU.animation._supported&&bU.animation.show&&(this._drawCount<2||this.animateReplot)&&(bQ=this.target.find(bS),bQ.stop(!0,!0).hide(),bW.canvas._elem.stop(!0,!0).hide(),bW.shadowCanvas._elem.stop(!0,!0).hide(),bW.canvas._elem.jqplotEffect("blind",{mode:"show",direction:bU.animation.direction},bU.animation.speed),bW.shadowCanvas._elem.jqplotEffect("blind",{mode:"show",direction:bU.animation.direction},bU.animation.speed),bQ.fadeIn(0.8*bU.animation.speed))}bQ=null,this.target.trigger("jqplotPostDraw",[this])}},by.prototype.doFillBetweenLines=function(){function bK(b0,bZ){var bY=bQ[b0],bX=bQ[bZ];if(bX.renderer.smooth){var bW=bX.renderer._smoothedData.slice(0).reverse()}else{var bW=bX.gridData.slice(0).reverse()}if(bY.renderer.smooth){var bV=bY.renderer._smoothedData.concat(bW)}else{var bV=bY.gridData.concat(bW)}var bU=null!==bJ.color?bJ.color:bQ[bP].fillColor,bT=null!==bJ.baseSeries?bJ.baseSeries:b0,bS=bQ[bT].renderer.shapeRenderer,bR={fillStyle:bU,fill:!0,closePath:!0};bS.draw(bY.shadowCanvas._ctx,bV,bR)}var bJ=this.fillBetween,bQ=this.series,bP=bJ.series1,bO=bJ.series2,bN=0,bM=0;if("number"==typeof bP&&"number"==typeof bO){bN=bO>bP?bP:bO,bM=bO>bP?bO:bP,bK(bN,bM)}else{for(var bL=0;bL<bP.length;bL++){bN=bP[bL]<bO[bL]?bP[bL]:bO[bL],bM=bO[bL]>bP[bL]?bO[bL]:bP[bL],bK(bN,bM)}}},this.bindCustomEvents=function(){this.eventCanvas._elem.bind("click",{plot:this},this.onClick),this.eventCanvas._elem.bind("dblclick",{plot:this},this.onDblClick),this.eventCanvas._elem.bind("mousedown",{plot:this},this.onMouseDown),this.eventCanvas._elem.bind("mousemove",{plot:this},this.onMouseMove),this.eventCanvas._elem.bind("mouseenter",{plot:this},this.onMouseEnter),this.eventCanvas._elem.bind("mouseleave",{plot:this},this.onMouseLeave),this.captureRightClick?(this.eventCanvas._elem.bind("mouseup",{plot:this},this.onRightClick),this.eventCanvas._elem.get(0).oncontextmenu=function(){return !1}):this.eventCanvas._elem.bind("mouseup",{plot:this},this.onMouseUp)},this.onClick=function(bJ){var bN=bH(bJ),bM=bJ.data.plot,bL=bG(bN.gridPos,bM),bK=bE.Event("jqplotClick");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])},this.onDblClick=function(bJ){var bN=bH(bJ),bM=bJ.data.plot,bL=bG(bN.gridPos,bM),bK=bE.Event("jqplotDblClick");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])},this.onMouseDown=function(bJ){var bN=bH(bJ),bM=bJ.data.plot,bL=bG(bN.gridPos,bM),bK=bE.Event("jqplotMouseDown");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])},this.onMouseUp=function(bJ){var bL=bH(bJ),bK=bE.Event("jqplotMouseUp");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bL.gridPos,bL.dataPos,null,bJ.data.plot])},this.onRightClick=function(bJ){var bN=bH(bJ),bM=bJ.data.plot,bL=bG(bN.gridPos,bM);if(bM.captureRightClick){if(3==bJ.which){var bK=bE.Event("jqplotRightClick");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])}else{var bK=bE.Event("jqplotMouseUp");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])}}},this.onMouseMove=function(bJ){var bN=bH(bJ),bM=bJ.data.plot,bL=bG(bN.gridPos,bM),bK=bE.Event("jqplotMouseMove");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bE(this).trigger(bK,[bN.gridPos,bN.dataPos,bL,bM])},this.onMouseEnter=function(bJ){var bM=bH(bJ),bL=bJ.data.plot,bK=bE.Event("jqplotMouseEnter");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bK.relatedTarget=bJ.relatedTarget,bE(this).trigger(bK,[bM.gridPos,bM.dataPos,null,bL])},this.onMouseLeave=function(bJ){var bM=bH(bJ),bL=bJ.data.plot,bK=bE.Event("jqplotMouseLeave");bK.pageX=bJ.pageX,bK.pageY=bJ.pageY,bK.relatedTarget=bJ.relatedTarget,bE(this).trigger(bK,[bM.gridPos,bM.dataPos,null,bL])},this.drawSeries=function(bJ,bN){var bM,bL,bK;if(bN="number"==typeof bJ&&null==bN?bJ:bN,bJ="object"==typeof bJ?bJ:{},bN!=a8){bL=this.series[bN],bK=bL.shadowCanvas._ctx,bK.clearRect(0,0,bK.canvas.width,bK.canvas.height),bL.drawShadow(bK,bJ,this),bK=bL.canvas._ctx,bK.clearRect(0,0,bK.canvas.width,bK.canvas.height),bL.draw(bK,bJ,this),bL.renderer.constructor==bE.jqplot.BezierCurveRenderer&&bN<this.series.length-1&&this.drawSeries(bN+1)}else{for(bM=0;bM<this.series.length;bM++){bL=this.series[bM],bK=bL.shadowCanvas._ctx,bK.clearRect(0,0,bK.canvas.width,bK.canvas.height),bL.drawShadow(bK,bJ,this),bK=bL.canvas._ctx,bK.clearRect(0,0,bK.canvas.width,bK.canvas.height),bL.draw(bK,bJ,this)}}bJ=bN=bM=bL=bK=null},this.moveSeriesToFront=function(bJ){bJ=parseInt(bJ,10);var bN=bE.inArray(bJ,this.seriesStack);if(-1!=bN){if(bN==this.seriesStack.length-1){return void (this.previousSeriesStack=this.seriesStack.slice(0))}var bM=this.seriesStack[this.seriesStack.length-1],bL=this.series[bJ].canvas._elem.detach(),bK=this.series[bJ].shadowCanvas._elem.detach();this.series[bM].shadowCanvas._elem.after(bK),this.series[bM].canvas._elem.after(bL),this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack.splice(bN,1),this.seriesStack.push(bJ)}},this.moveSeriesToBack=function(bJ){bJ=parseInt(bJ,10);var bN=bE.inArray(bJ,this.seriesStack);if(0!=bN&&-1!=bN){var bM=this.seriesStack[0],bL=this.series[bJ].canvas._elem.detach(),bK=this.series[bJ].shadowCanvas._elem.detach();this.series[bM].shadowCanvas._elem.before(bK),this.series[bM].canvas._elem.before(bL),this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack.splice(bN,1),this.seriesStack.unshift(bJ)}},this.restorePreviousSeriesOrder=function(){var bK,bJ,bO,bN,bM,bL;if(this.seriesStack!=this.previousSeriesStack){for(bK=1;bK<this.previousSeriesStack.length;bK++){bM=this.previousSeriesStack[bK],bL=this.previousSeriesStack[bK-1],bJ=this.series[bM].canvas._elem.detach(),bO=this.series[bM].shadowCanvas._elem.detach(),this.series[bL].shadowCanvas._elem.after(bO),this.series[bL].canvas._elem.after(bJ)}bN=this.seriesStack.slice(0),this.seriesStack=this.previousSeriesStack.slice(0),this.previousSeriesStack=bN}},this.restoreOriginalSeriesOrder=function(){var bK,bJ,bM,bL=[];for(bK=0;bK<this.series.length;bK++){bL.push(bK)}if(this.seriesStack!=bL){for(this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack=bL,bK=1;bK<this.seriesStack.length;bK++){bJ=this.series[bK].canvas._elem.detach(),bM=this.series[bK].shadowCanvas._elem.detach(),this.series[bK-1].shadowCanvas._elem.after(bM),this.series[bK-1].canvas._elem.after(bJ)}}},this.activateTheme=function(bJ){this.themeEngine.activate(this,bJ)}}function bx(bH,bG){return(3.4182054+bG)*Math.pow(bH,-0.3534992)}function bw(bH){var bG=(Math.exp(2*bH)-1)/(Math.exp(2*bH)+1);return bG}function bv(b6){function b5(b8,b7){return b8-b7==0?Math.pow(10,10):b8-b7}var b4=this.renderer.smooth,b3=this.canvas.getWidth(),b2=this._xaxis.series_p2u,b1=this._yaxis.series_p2u,b0=null,bZ=b6.length/b3,bY=[],bX=[];b0=isNaN(parseFloat(b4))?bx(bZ,0.5):parseFloat(b4);for(var bW=[],bV=[],bU=0,bT=b6.length;bT>bU;bU++){bW.push(b6[bU][1]),bV.push(b6[bU][0])}for(var bS,bQ,bO,bN,bM=b6.length-1,bL=1,bK=b6.length;bK>bL;bL++){for(var bJ=[],bI=[],bH=0;2>bH;bH++){var bU=bL-1+bH;0==bU||bU==bM?bJ[bH]=Math.pow(10,10):bW[bU+1]-bW[bU]==0||bW[bU]-bW[bU-1]==0?bJ[bH]=0:(bV[bU+1]-bV[bU])/(bW[bU+1]-bW[bU])+(bV[bU]-bV[bU-1])/(bW[bU]-bW[bU-1])==0?bJ[bH]=0:(bW[bU+1]-bW[bU])*(bW[bU]-bW[bU-1])<0?bJ[bH]=0:bJ[bH]=2/(b5(bV[bU+1],bV[bU])/(bW[bU+1]-bW[bU])+b5(bV[bU],bV[bU-1])/(bW[bU]-bW[bU-1]))}1==bL?bJ[0]=1.5*(bW[1]-bW[0])/b5(bV[1],bV[0])-bJ[1]/2:bL==bM&&(bJ[1]=1.5*(bW[bM]-bW[bM-1])/b5(bV[bM],bV[bM-1])-bJ[0]/2),bI[0]=-2*(bJ[1]+2*bJ[0])/b5(bV[bL],bV[bL-1])+6*(bW[bL]-bW[bL-1])/Math.pow(b5(bV[bL],bV[bL-1]),2),bI[1]=2*(2*bJ[1]+bJ[0])/b5(bV[bL],bV[bL-1])-6*(bW[bL]-bW[bL-1])/Math.pow(b5(bV[bL],bV[bL-1]),2),bN=1/6*(bI[1]-bI[0])/b5(bV[bL],bV[bL-1]),bO=0.5*(bV[bL]*bI[0]-bV[bL-1]*bI[1])/b5(bV[bL],bV[bL-1]),bQ=(bW[bL]-bW[bL-1]-bO*(Math.pow(bV[bL],2)-Math.pow(bV[bL-1],2))-bN*(Math.pow(bV[bL],3)-Math.pow(bV[bL-1],3)))/b5(bV[bL],bV[bL-1]),bS=bW[bL-1]-bQ*bV[bL-1]-bO*Math.pow(bV[bL-1],2)-bN*Math.pow(bV[bL-1],3);for(var bG,bR,bP=(bV[bL]-bV[bL-1])/b0,bH=0,bT=b0;bT>bH;bH++){bG=[],bR=bV[bL-1]+bH*bP,bG.push(bR),bG.push(bS+bQ*bR+bO*Math.pow(bR,2)+bN*Math.pow(bR,3)),bY.push(bG),bX.push([b2(bG[0]),b1(bG[1])])}}return bY.push(b6[bU]),bX.push([b2(b6[bU][0]),b1(b6[bU][1])]),[bY,bX]}function bu(cf){var ce,cd,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2,b1,b0,bZ,bY,bX,bW=this.renderer.smooth,bV=this.renderer.tension,bU=this.canvas.getWidth(),bT=this._xaxis.series_p2u,bS=this._yaxis.series_p2u,bR=null,bQ=null,bP=null,bO=null,bN=null,bM=null,bL=null,bK=cf.length/bU,bJ=[],bI=[];bR=isNaN(parseFloat(bW))?bx(bK,0.5):parseFloat(bW),isNaN(parseFloat(bV))||(bV=parseFloat(bV));for(var bH=0,bG=cf.length-1;bG>bH;bH++){for(null===bV?(bN=Math.abs((cf[bH+1][1]-cf[bH][1])/(cf[bH+1][0]-cf[bH][0])),b1=0.3,b0=0.6,bZ=(b0-b1)/2,bY=2.5,bX=-1.4,bL=bN/bY+bX,bP=bZ*bw(bL)-bZ*bw(bX)+b1,bH>0&&(bM=Math.abs((cf[bH][1]-cf[bH-1][1])/(cf[bH][0]-cf[bH-1][0]))),bL=bM/bY+bX,bO=bZ*bw(bL)-bZ*bw(bX)+b1,bQ=(bP+bO)/2):bQ=bV,ce=0;bR>ce;ce++){cd=ce/bR,cc=(1+2*cd)*Math.pow(1-cd,2),cb=cd*Math.pow(1-cd,2),ca=Math.pow(cd,2)*(3-2*cd),b9=Math.pow(cd,2)*(cd-1),cf[bH-1]?(b8=bQ*(cf[bH+1][0]-cf[bH-1][0]),b7=bQ*(cf[bH+1][1]-cf[bH-1][1])):(b8=bQ*(cf[bH+1][0]-cf[bH][0]),b7=bQ*(cf[bH+1][1]-cf[bH][1])),cf[bH+2]?(b6=bQ*(cf[bH+2][0]-cf[bH][0]),b5=bQ*(cf[bH+2][1]-cf[bH][1])):(b6=bQ*(cf[bH+1][0]-cf[bH][0]),b5=bQ*(cf[bH+1][1]-cf[bH][1])),b4=cc*cf[bH][0]+ca*cf[bH+1][0]+cb*b8+b9*b6,b3=cc*cf[bH][1]+ca*cf[bH+1][1]+cb*b7+b9*b5,b2=[b4,b3],bJ.push(b2),bI.push([bT(b4),bS(b3)])}}return bJ.push(cf[bG]),bI.push([bT(cf[bG][0]),bS(cf[bG][1])]),[bJ,bI]}function bt(bG,bJ,bI){for(var bH=0;bH<this.series.length;bH++){this.series[bH].renderer.constructor==bE.jqplot.LineRenderer&&this.series[bH].highlightMouseOver&&(this.series[bH].highlightMouseDown=!1)}}function bs(){this.plugins.lineRenderer&&this.plugins.lineRenderer.highlightCanvas&&(this.plugins.lineRenderer.highlightCanvas.resetCanvas(),this.plugins.lineRenderer.highlightCanvas=null),this.plugins.lineRenderer.highlightedSeriesIndex=null,this.plugins.lineRenderer.highlightCanvas=new bE.jqplot.GenericCanvas,this.eventCanvas._elem.before(this.plugins.lineRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-lineRenderer-highlight-canvas",this._plotDimensions,this)),this.plugins.lineRenderer.highlightCanvas.setContext(),this.eventCanvas._elem.bind("mouseleave",{plot:this},function(bG){bq(bG.data.plot)})}function br(bH,bG,bM,bL){var bK=bH.series[bG],bJ=bH.plugins.lineRenderer.highlightCanvas;bJ._ctx.clearRect(0,0,bJ._ctx.canvas.width,bJ._ctx.canvas.height),bK._highlightedPoint=bM,bH.plugins.lineRenderer.highlightedSeriesIndex=bG;var bI={fillStyle:bK.highlightColor};"line"===bK.type&&bK.renderer.bands.show&&(bI.fill=!0,bI.closePath=!0),bK.renderer.shapeRenderer.draw(bJ._ctx,bL,bI),bJ=null}function bq(bH){var bG=bH.plugins.lineRenderer.highlightCanvas;bG._ctx.clearRect(0,0,bG._ctx.canvas.width,bG._ctx.canvas.height);for(var bI=0;bI<bH.series.length;bI++){bH.series[bI]._highlightedPoint=null}bH.plugins.lineRenderer.highlightedSeriesIndex=null,bH.target.trigger("jqplotDataUnhighlight"),bG=null}function bp(bH,bG,bN,bM,bL){if(bM){var bK=[bM.seriesIndex,bM.pointIndex,bM.data],bJ=jQuery.Event("jqplotDataMouseOver");if(bJ.pageX=bH.pageX,bJ.pageY=bH.pageY,bL.target.trigger(bJ,bK),bL.series[bK[0]].highlightMouseOver&&bK[0]!=bL.plugins.lineRenderer.highlightedSeriesIndex){var bI=jQuery.Event("jqplotDataHighlight");bI.which=bH.which,bI.pageX=bH.pageX,bI.pageY=bH.pageY,bL.target.trigger(bI,bK),br(bL,bM.seriesIndex,bM.pointIndex,bM.points)}}else{null==bM&&bq(bL)}}function bo(bH,bG,bM,bL,bK){if(bL){var bJ=[bL.seriesIndex,bL.pointIndex,bL.data];if(bK.series[bJ[0]].highlightMouseDown&&bJ[0]!=bK.plugins.lineRenderer.highlightedSeriesIndex){var bI=jQuery.Event("jqplotDataHighlight");bI.which=bH.which,bI.pageX=bH.pageX,bI.pageY=bH.pageY,bK.target.trigger(bI,bJ),br(bK,bL.seriesIndex,bL.pointIndex,bL.points)}}else{null==bL&&bq(bK)}}function bn(bH,bG,bL,bK,bJ){var bI=bJ.plugins.lineRenderer.highlightedSeriesIndex;null!=bI&&bJ.series[bI].highlightMouseDown&&bq(bJ)}function bm(bH,bG,bM,bL,bK){if(bL){var bJ=[bL.seriesIndex,bL.pointIndex,bL.data],bI=jQuery.Event("jqplotDataClick");bI.which=bH.which,bI.pageX=bH.pageX,bI.pageY=bH.pageY,bK.target.trigger(bI,bJ)}}function bl(bH,bG,bN,bM,bL){if(bM){var bK=[bM.seriesIndex,bM.pointIndex,bM.data],bJ=bL.plugins.lineRenderer.highlightedSeriesIndex;null!=bJ&&bL.series[bJ].highlightMouseDown&&bq(bL);var bI=jQuery.Event("jqplotDataRightClick");bI.which=bH.which,bI.pageX=bH.pageX,bI.pageY=bH.pageY,bL.target.trigger(bI,bK)}}function bk(bH){var bG;if(bH=Math.abs(bH),bH>=10){bG="%d"}else{if(bH>1){bG=bH===parseInt(bH,10)?"%d":"%.1f"}else{var bI=-Math.floor(Math.log(bH)/Math.LN10);bG="%."+bI+"f"}}return bG}function bj(bW,bV,bU){for(var bT,bS,bR,bQ,bP,bO,bN,bM=Math.floor(bU/2),bL=Math.ceil(1.5*bU),bK=Number.MAX_VALUE,bJ=bV-bW,bI=bE.jqplot.getSignificantFigures,bH=0,bG=bL-bM+1;bG>bH;bH++){bO=bM+bH,bT=bJ/(bO-1),bS=bI(bT),bT=Math.abs(bU-bO)+bS.digitsRight,bK>bT?(bK=bT,bR=bO,bN=bS.digitsRight):bT===bK&&bS.digitsRight<bN&&(bR=bO,bN=bS.digitsRight)}return bQ=Math.max(bN,Math.max(bI(bW).digitsRight,bI(bV).digitsRight)),bP=0===bQ?"%d":"%."+bQ+"f",bT=bJ/(bR-1),[bW,bV,bR,bP,bT]}function bi(bH,bG){bG=bG||7;var bL,bK=bH/(bG-1),bJ=Math.pow(10,Math.floor(Math.log(bK)/Math.LN10)),bI=bK/bJ;return bL=1>bJ?bI>5?10*bJ:bI>2?5*bJ:bI>1?2*bJ:bJ:bI>5?10*bJ:bI>4?5*bJ:bI>3?4*bJ:bI>2?3*bJ:bI>1?2*bJ:bJ}function bh(bH,bG){bG=bG||1;var bL,bK=Math.floor(Math.log(bH)/Math.LN10),bJ=Math.pow(10,bK),bI=bH/bJ;return bI/=bG,bL=0.38>=bI?0.1:1.6>=bI?0.2:4>=bI?0.5:8>=bI?1:16>=bI?2:5,bL*bJ}function bg(bH,bG){var bM,bL,bK=Math.floor(Math.log(bH)/Math.LN10),bJ=Math.pow(10,bK),bI=bH/bJ;return bI/=bG,bL=0.38>=bI?0.1:1.6>=bI?0.2:4>=bI?0.5:8>=bI?1:16>=bI?2:5,bM=bL*bJ,[bM,bL,bJ]}function bf(bH,bG){return bH-bG}function bd(bH){if(null==bH||"object"!=typeof bH){return bH}var bG=new bH.constructor;for(var bI in bH){bG[bI]=bd(bH[bI])}return bG}function bc(bH,bG){if(null!=bG&&"object"==typeof bG){for(var bI in bG){"highlightColors"==bI&&(bH[bI]=bd(bG[bI])),null!=bG[bI]&&"object"==typeof bG[bI]?(bH.hasOwnProperty(bI)||(bH[bI]={}),bc(bH[bI],bG[bI])):bH[bI]=bG[bI]}}}function bb(bH,bG){if(bG.indexOf){return bG.indexOf(bH)}for(var bJ=0,bI=bG.length;bI>bJ;bJ++){if(bG[bJ]===bH){return bJ}}return -1}function ba(bG){return null===bG?"[object Null]":Object.prototype.toString.call(bG)}function a9(bG,bJ,bI,bH){return bE.isPlainObject(bG)?bG:(bG={effect:bG},bJ===a8&&(bJ={}),bE.isFunction(bJ)&&(bH=bJ,bI=null,bJ={}),("number"===bE.type(bJ)||bE.fx.speeds[bJ])&&(bH=bI,bI=bJ,bJ={}),bE.isFunction(bI)&&(bH=bI,bI=null),bJ&&bE.extend(bG,bJ),bI=bI||bJ.duration,bG.duration=bE.fx.off?0:"number"==typeof bI?bI:bI in bE.fx.speeds?bE.fx.speeds[bI]:bE.fx.speeds._default,bG.complete=bH||bJ.complete,bG)}var a8;bE.fn.emptyForce=function(){for(var bG,bH=0;null!=(bG=bE(this)[bH]);bH++){if(1===bG.nodeType&&bE.cleanData(bG.getElementsByTagName("*")),bE.jqplot.use_excanvas){bG.outerHTML=""}else{for(;bG.firstChild;){bG.removeChild(bG.firstChild)}}bG=null}return bE(this)},bE.fn.removeChildForce=function(bG){for(;bG.firstChild;){this.removeChildForce(bG.firstChild),bG.removeChild(bG.firstChild)}},bE.fn.jqplot=function(){for(var bG=[],bJ=[],bI=0,bH=arguments.length;bH>bI;bI++){bE.isArray(arguments[bI])?bG.push(arguments[bI]):bE.isPlainObject(arguments[bI])&&bJ.push(arguments[bI])}return this.each(function(bR){var bQ,bP,bO,bN,bM=bE(this),bL=bG.length,bK=bJ.length;bO=bL>bR?bG[bR]:bL?bG[bL-1]:null,bN=bK>bR?bJ[bR]:bK?bJ[bK-1]:null,bQ=bM.attr("id"),bQ===a8&&(bQ="jqplot_target_"+bE.jqplot.targetCounter++,bM.attr("id",bQ)),bP=bE.jqplot(bQ,bO,bN),bM.data("jqplot",bP)})},bE.jqplot=function(bG,bN,bM){var bL=null,bK=null;3===arguments.length?(bL=bN,bK=bM):2===arguments.length&&(bE.isArray(bN)?bL=bN:bE.isPlainObject(bN)&&(bK=bN)),null===bL&&null!==bK&&bK.data&&(bL=bK.data);var bJ=new by;if(bE("#"+bG).removeClass("jqplot-error"),!bE.jqplot.config.catchErrors){return bJ.init(bG,bL,bK),bJ.draw(),bJ.themeEngine.init.call(bJ),bJ}try{return bJ.init(bG,bL,bK),bJ.draw(),bJ.themeEngine.init.call(bJ),bJ}catch(bI){var bH=bE.jqplot.config.errorMessage||bI.message;bE("#"+bG).append('<div class="jqplot-error-message">'+bH+"</div>"),bE("#"+bG).addClass("jqplot-error"),document.getElementById(bG).style.background=bE.jqplot.config.errorBackground,document.getElementById(bG).style.border=bE.jqplot.config.errorBorder,document.getElementById(bG).style.fontFamily=bE.jqplot.config.errorFontFamily,document.getElementById(bG).style.fontSize=bE.jqplot.config.errorFontSize,document.getElementById(bG).style.fontStyle=bE.jqplot.config.errorFontStyle,document.getElementById(bG).style.fontWeight=bE.jqplot.config.errorFontWeight}},bE.jqplot.version="1.0.9",bE.jqplot.revision="d96a669",bE.jqplot.targetCounter=1,bE.jqplot.CanvasManager=function(){"undefined"==typeof bE.jqplot.CanvasManager.canvases&&(bE.jqplot.CanvasManager.canvases=[],bE.jqplot.CanvasManager.free=[]);var bG=[];this.getCanvas=function(){var bK,bJ=!0;if(!bE.jqplot.use_excanvas){for(var bI=0,bH=bE.jqplot.CanvasManager.canvases.length;bH>bI;bI++){if(bE.jqplot.CanvasManager.free[bI]===!0){bJ=!1,bK=bE.jqplot.CanvasManager.canvases[bI],bE.jqplot.CanvasManager.free[bI]=!1,bG.push(bI);break}}}return bJ&&(bK=document.createElement("canvas"),bG.push(bE.jqplot.CanvasManager.canvases.length),bE.jqplot.CanvasManager.canvases.push(bK),bE.jqplot.CanvasManager.free.push(!1)),bK},this.initCanvas=function(bH){if(bE.jqplot.use_excanvas){return window.G_vmlCanvasManager.initElement(bH)}var bL=bH.getContext("2d"),bK=1;window.devicePixelRatio>1&&(bL.webkitBackingStorePixelRatio===a8||bL.webkitBackingStorePixelRatio<2)&&(bK=window.devicePixelRatio);var bJ=bH.width,bI=bH.height;return bH.width=bK*bH.width,bH.height=bK*bH.height,bH.style.width=bJ+"px",bH.style.height=bI+"px",bL.save(),bL.scale(bK,bK),bH},this.freeAllCanvases=function(){for(var bH=0,bI=bG.length;bI>bH;bH++){this.freeCanvas(bG[bH])}bG=[]},this.freeCanvas=function(bH){if(bE.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a8){window.G_vmlCanvasManager.uninitElement(bE.jqplot.CanvasManager.canvases[bH]),bE.jqplot.CanvasManager.canvases[bH]=null}else{var bI=bE.jqplot.CanvasManager.canvases[bH];bI.getContext("2d").clearRect(0,0,bI.width,bI.height),bE(bI).unbind().removeAttr("class").removeAttr("style"),bE(bI).css({left:"",top:"",position:""}),bI.width=0,bI.height=0,bE.jqplot.CanvasManager.free[bH]=!0}}},bE.jqplot.log=function(){window.console&&window.console.log.apply(window.console,arguments)},bE.jqplot.config={addDomReference:!1,enablePlugins:!1,defaultHeight:300,defaultWidth:400,UTCAdjust:!1,timezoneOffset:new Date(60000*(new Date).getTimezoneOffset()),errorMessage:"",errorBackground:"",errorBorder:"",errorFontFamily:"",errorFontSize:"",errorFontStyle:"",errorFontWeight:"",catchErrors:!1,defaultTickFormatString:"%.1f",defaultColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc","#c747a3","#cddf54","#FBD178","#26B4E3","#bd70c7"],defaultNegativeColors:["#498991","#C08840","#9F9274","#546D61","#646C4A","#6F6621","#6E3F5F","#4F64B0","#A89050","#C45923","#187399","#945381","#959E5C","#C7AF7B","#478396","#907294"],dashLength:4,gapLength:4,dotGapLength:2.5,srcLocation:"jqplot/src/",pluginLocation:"jqplot/src/plugins/"},bE.jqplot.arrayMax=function(bG){return Math.max.apply(Math,bG)},bE.jqplot.arrayMin=function(bG){return Math.min.apply(Math,bG)},bE.jqplot.enablePlugins=bE.jqplot.config.enablePlugins,bE.jqplot.support_canvas=function(){return"undefined"==typeof bE.jqplot.support_canvas.result&&(bE.jqplot.support_canvas.result=!!document.createElement("canvas").getContext),bE.jqplot.support_canvas.result},bE.jqplot.support_canvas_text=function(){return"undefined"==typeof bE.jqplot.support_canvas_text.result&&(window.G_vmlCanvasManager!==a8&&window.G_vmlCanvasManager._version>887?bE.jqplot.support_canvas_text.result=!0:bE.jqplot.support_canvas_text.result=!(!document.createElement("canvas").getContext||"function"!=typeof document.createElement("canvas").getContext("2d").fillText)),bE.jqplot.support_canvas_text.result},bE.jqplot.use_excanvas=bE.support.boxModel&&bE.support.objectAll&&$support.leadingWhitespace||bE.jqplot.support_canvas()?!1:!0,bE.jqplot.preInitHooks=[],bE.jqplot.postInitHooks=[],bE.jqplot.preParseOptionsHooks=[],bE.jqplot.postParseOptionsHooks=[],bE.jqplot.preDrawHooks=[],bE.jqplot.postDrawHooks=[],bE.jqplot.preDrawSeriesHooks=[],bE.jqplot.postDrawSeriesHooks=[],bE.jqplot.preDrawLegendHooks=[],bE.jqplot.addLegendRowHooks=[],bE.jqplot.preSeriesInitHooks=[],bE.jqplot.postSeriesInitHooks=[],bE.jqplot.preParseSeriesOptionsHooks=[],bE.jqplot.postParseSeriesOptionsHooks=[],bE.jqplot.eventListenerHooks=[],bE.jqplot.preDrawSeriesShadowHooks=[],bE.jqplot.postDrawSeriesShadowHooks=[],bE.jqplot.ElemContainer=function(){this._elem,this._plotWidth,this._plotHeight,this._plotDimensions={height:null,width:null}},bE.jqplot.ElemContainer.prototype.createElement=function(bG,bM,bL,bK,bJ){this._offsets=bM;var bI=bL||"jqplot",bH=document.createElement(bG);return this._elem=bE(bH),this._elem.addClass(bI),this._elem.css(bK),this._elem.attr(bJ),bH=null,this._elem},bE.jqplot.ElemContainer.prototype.getWidth=function(){return this._elem?this._elem.outerWidth(!0):null},bE.jqplot.ElemContainer.prototype.getHeight=function(){return this._elem?this._elem.outerHeight(!0):null},bE.jqplot.ElemContainer.prototype.getPosition=function(){return this._elem?this._elem.position():{top:null,left:null,bottom:null,right:null}},bE.jqplot.ElemContainer.prototype.getTop=function(){return this.getPosition().top},bE.jqplot.ElemContainer.prototype.getLeft=function(){return this.getPosition().left},bE.jqplot.ElemContainer.prototype.getBottom=function(){return this._elem.css("bottom")},bE.jqplot.ElemContainer.prototype.getRight=function(){return this._elem.css("right")},bD.prototype=new bE.jqplot.ElemContainer,bD.prototype.constructor=bD,bD.prototype.init=function(){bE.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.tickOptions.axis=this.name,null==this.tickOptions.showMark&&(this.tickOptions.showMark=this.showTicks),null==this.tickOptions.showMark&&(this.tickOptions.showMark=this.showTickMarks),null==this.tickOptions.showLabel&&(this.tickOptions.showLabel=this.showTicks),null==this.label||""==this.label?this.showLabel=!1:this.labelOptions.label=this.label,0==this.showLabel&&(this.labelOptions.show=!1),0==this.pad&&(this.pad=1),0==this.padMax&&(this.padMax=1),0==this.padMin&&(this.padMin=1),null==this.padMax&&(this.padMax=(this.pad-1)/2+1),null==this.padMin&&(this.padMin=(this.pad-1)/2+1),this.pad=this.padMax+this.padMin-1,(null!=this.min||null!=this.max)&&(this.autoscale=!1),null==this.syncTicks&&this.name.indexOf("y")>-1?this.syncTicks=!0:null==this.syncTicks&&(this.syncTicks=!1),this.renderer.init.call(this,this.rendererOptions)},bD.prototype.draw=function(bH,bG){return this.__ticks&&(this.__ticks=null),this.renderer.draw.call(this,bH,bG)},bD.prototype.set=function(){this.renderer.set.call(this)},bD.prototype.pack=function(bH,bG){this.show&&this.renderer.pack.call(this,bH,bG),null==this._min&&(this._min=this.min,this._max=this.max,this._tickInterval=this.tickInterval,this._numberTicks=this.numberTicks,this.__ticks=this._ticks)},bD.prototype.reset=function(){this.renderer.reset.call(this)},bD.prototype.resetScale=function(bG){bE.extend(!0,this,{min:null,max:null,numberTicks:null,tickInterval:null,_ticks:[],ticks:[]},bG),this.resetDataBounds()},bD.prototype.resetDataBounds=function(){var bO=this._dataBounds;bO.min=null,bO.max=null;for(var bN,bM,bL,bK=this.show?!0:!1,bJ=0;bJ<this._series.length;bJ++){if(bM=this._series[bJ],bM.show||this.scaleToHiddenSeries){bL=bM._plotData,"line"===bM._type&&bM.renderer.bands.show&&"x"!==this.name.charAt(0)&&(bL=[[0,bM.renderer.bands._min],[1,bM.renderer.bands._max]]);var bI=1,bH=1;null!=bM._type&&"ohlc"==bM._type&&(bI=3,bH=2);for(var bG=0,bN=bL.length;bN>bG;bG++){"xaxis"==this.name||"x2axis"==this.name?((null!=bL[bG][0]&&bL[bG][0]<bO.min||null==bO.min)&&(bO.min=bL[bG][0]),(null!=bL[bG][0]&&bL[bG][0]>bO.max||null==bO.max)&&(bO.max=bL[bG][0])):((null!=bL[bG][bI]&&bL[bG][bI]<bO.min||null==bO.min)&&(bO.min=bL[bG][bI]),(null!=bL[bG][bH]&&bL[bG][bH]>bO.max||null==bO.max)&&(bO.max=bL[bG][bH]))}bK&&bM.renderer.constructor!==bE.jqplot.BarRenderer?bK=!1:bK&&this._options.hasOwnProperty("forceTickAt0")&&0==this._options.forceTickAt0?bK=!1:bK&&bM.renderer.constructor===bE.jqplot.BarRenderer&&("vertical"==bM.barDirection&&"xaxis"!=this.name&&"x2axis"!=this.name?(null!=this._options.pad||null!=this._options.padMin)&&(bK=!1):"horizontal"!=bM.barDirection||"xaxis"!=this.name&&"x2axis"!=this.name||(null!=this._options.pad||null!=this._options.padMin)&&(bK=!1))}}bK&&this.renderer.constructor===bE.jqplot.LinearAxisRenderer&&bO.min>=0&&(this.padMin=1,this.forceTickAt0=!0)},bC.prototype=new bE.jqplot.ElemContainer,bC.prototype.constructor=bC,bC.prototype.setOptions=function(bG){if(bE.extend(!0,this,bG),"inside"==this.placement&&(this.placement="insideGrid"),this.xoffset>0){if("insideGrid"==this.placement){switch(this.location){case"nw":case"w":case"sw":null==this.marginLeft&&(this.marginLeft=this.xoffset+"px"),this.marginRight="0px";break;case"ne":case"e":case"se":default:null==this.marginRight&&(this.marginRight=this.xoffset+"px"),this.marginLeft="0px"}}else{if("outside"==this.placement){switch(this.location){case"nw":case"w":case"sw":null==this.marginRight&&(this.marginRight=this.xoffset+"px"),this.marginLeft="0px";break;case"ne":case"e":case"se":default:null==this.marginLeft&&(this.marginLeft=this.xoffset+"px"),this.marginRight="0px"}}}this.xoffset=0}if(this.yoffset>0){if("outside"==this.placement){switch(this.location){case"sw":case"s":case"se":null==this.marginTop&&(this.marginTop=this.yoffset+"px"),this.marginBottom="0px";break;case"ne":case"n":case"nw":default:null==this.marginBottom&&(this.marginBottom=this.yoffset+"px"),this.marginTop="0px"}}else{if("insideGrid"==this.placement){switch(this.location){case"sw":case"s":case"se":null==this.marginBottom&&(this.marginBottom=this.yoffset+"px"),this.marginTop="0px";break;case"ne":case"n":case"nw":default:null==this.marginTop&&(this.marginTop=this.yoffset+"px"),this.marginBottom="0px"}}}this.yoffset=0}},bC.prototype.init=function(){bE.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bC.prototype.draw=function(bG,bI){for(var bH=0;bH<bE.jqplot.preDrawLegendHooks.length;bH++){bE.jqplot.preDrawLegendHooks[bH].call(this,bG)}return this.renderer.draw.call(this,bG,bI)},bC.prototype.pack=function(bG){this.renderer.pack.call(this,bG)},bB.prototype=new bE.jqplot.ElemContainer,bB.prototype.constructor=bB,bB.prototype.init=function(){bE.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bB.prototype.draw=function(bG){return this.renderer.draw.call(this,bG)},bB.prototype.pack=function(){this.renderer.pack.call(this)},bA.prototype=new bE.jqplot.ElemContainer,bA.prototype.constructor=bA,bA.prototype.init=function(bG,bN,bM){this.index=bG,this.gridBorderWidth=bN;var bL,bK,bJ=this.data,bI=[];for(bL=0,bK=bJ.length;bK>bL;bL++){if(this.breakOnNull){bI.push(bJ[bL])}else{if(null==bJ[bL]||null==bJ[bL][0]||null==bJ[bL][1]){continue}bI.push(bJ[bL])}}if(this.data=bI,this.color||(this.color=bM.colorGenerator.get(this.index)),this.negativeColor||(this.negativeColor=bM.negativeColorGenerator.get(this.index)),this.fillColor||(this.fillColor=this.color),this.fillAlpha){var bH=bE.jqplot.normalize2rgb(this.fillColor),bH=bE.jqplot.getColorComponents(bH);this.fillColor="rgba("+bH[0]+","+bH[1]+","+bH[2]+","+this.fillAlpha+")"}bE.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions,bM),this.markerRenderer=new this.markerRenderer,this.markerOptions.color||(this.markerOptions.color=this.color),null==this.markerOptions.show&&(this.markerOptions.show=this.showMarker),this.showMarker=this.markerOptions.show,this.markerRenderer.init(this.markerOptions)},bA.prototype.draw=function(bG,bM,bL){var bK=bM==a8?{}:bM;bG=bG==a8?this.canvas._ctx:bG;var bJ,bI,bH;for(bJ=0;bJ<bE.jqplot.preDrawSeriesHooks.length;bJ++){bE.jqplot.preDrawSeriesHooks[bJ].call(this,bG,bK)}for(this.show&&(this.renderer.setGridData.call(this,bL),bK.preventJqPlotSeriesDrawTrigger||bE(bG.canvas).trigger("jqplotSeriesDraw",[this.data,this.gridData]),bI=[],bI=bK.data?bK.data:this._stack?this._plotData:this.data,bH=bK.gridData||this.renderer.makeGridData.call(this,bI,bL),"line"===this._type&&this.renderer.smooth&&this.renderer._smoothedData.length&&(bH=this.renderer._smoothedData),this.renderer.draw.call(this,bG,bH,bK,bL)),bJ=0;bJ<bE.jqplot.postDrawSeriesHooks.length;bJ++){bE.jqplot.postDrawSeriesHooks[bJ].call(this,bG,bK,bL)}bG=bM=bL=bJ=bI=bH=null},bA.prototype.drawShadow=function(bG,bM,bL){var bK=bM==a8?{}:bM;bG=bG==a8?this.shadowCanvas._ctx:bG;var bJ,bI,bH;for(bJ=0;bJ<bE.jqplot.preDrawSeriesShadowHooks.length;bJ++){bE.jqplot.preDrawSeriesShadowHooks[bJ].call(this,bG,bK)}for(this.shadow&&(this.renderer.setGridData.call(this,bL),bI=[],bI=bK.data?bK.data:this._stack?this._plotData:this.data,bH=bK.gridData||this.renderer.makeGridData.call(this,bI,bL),this.renderer.drawShadow.call(this,bG,bH,bK,bL)),bJ=0;bJ<bE.jqplot.postDrawSeriesShadowHooks.length;bJ++){bE.jqplot.postDrawSeriesShadowHooks[bJ].call(this,bG,bK)}bG=bM=bL=bJ=bI=bH=null},bA.prototype.toggleDisplay=function(bH,bG){var bJ,bI;bJ=bH.data.series?bH.data.series:this,bH.data.speed&&(bI=bH.data.speed),bI?bJ.canvas._elem.is(":hidden")||!bJ.show?(bJ.show=!0,bJ.canvas._elem.removeClass("jqplot-series-hidden"),bJ.shadowCanvas._elem&&bJ.shadowCanvas._elem.fadeIn(bI),bJ.canvas._elem.fadeIn(bI,bG),bJ.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bJ.index).fadeIn(bI)):(bJ.show=!1,bJ.canvas._elem.addClass("jqplot-series-hidden"),bJ.shadowCanvas._elem&&bJ.shadowCanvas._elem.fadeOut(bI),bJ.canvas._elem.fadeOut(bI,bG),bJ.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bJ.index).fadeOut(bI)):bJ.canvas._elem.is(":hidden")||!bJ.show?(bJ.show=!0,bJ.canvas._elem.removeClass("jqplot-series-hidden"),bJ.shadowCanvas._elem&&bJ.shadowCanvas._elem.show(),bJ.canvas._elem.show(0,bG),bJ.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bJ.index).show()):(bJ.show=!1,bJ.canvas._elem.addClass("jqplot-series-hidden"),bJ.shadowCanvas._elem&&bJ.shadowCanvas._elem.hide(),bJ.canvas._elem.hide(0,bG),bJ.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bJ.index).hide())},bz.prototype=new bE.jqplot.ElemContainer,bz.prototype.constructor=bz,bz.prototype.init=function(){bE.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bz.prototype.createElement=function(bH,bG){return this._offsets=bH,this.renderer.createElement.call(this,bG)},bz.prototype.draw=function(){this.renderer.draw.call(this)},bE.jqplot.GenericCanvas=function(){bE.jqplot.ElemContainer.call(this),this._ctx},bE.jqplot.GenericCanvas.prototype=new bE.jqplot.ElemContainer,bE.jqplot.GenericCanvas.prototype.constructor=bE.jqplot.GenericCanvas,bE.jqplot.GenericCanvas.prototype.createElement=function(bG,bL,bK,bJ){this._offsets=bG;var bI="jqplot";bL!=a8&&(bI=bL);var bH;return bH=bJ.canvasManager.getCanvas(),null!=bK&&(this._plotDimensions=bK),bH.width=this._plotDimensions.width-this._offsets.left-this._offsets.right,bH.height=this._plotDimensions.height-this._offsets.top-this._offsets.bottom,this._elem=bE(bH),this._elem.css({position:"absolute",left:this._offsets.left,top:this._offsets.top}),this._elem.addClass(bI),bH=bJ.canvasManager.initCanvas(bH),bH=null,this._elem},bE.jqplot.GenericCanvas.prototype.setContext=function(){return this._ctx=this._elem.get(0).getContext("2d"),this._ctx},bE.jqplot.GenericCanvas.prototype.resetCanvas=function(){this._elem&&(bE.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a8&&window.G_vmlCanvasManager.uninitElement(this._elem.get(0)),this._elem.emptyForce()),this._ctx=null},bE.jqplot.HooksManager=function(){this.hooks=[],this.args=[]},bE.jqplot.HooksManager.prototype.addOnce=function(bH,bG){bG=bG||[];for(var bK=!1,bJ=0,bI=this.hooks.length;bI>bJ;bJ++){this.hooks[bJ]==bH&&(bK=!0)}bK||(this.hooks.push(bH),this.args.push(bG))},bE.jqplot.HooksManager.prototype.add=function(bH,bG){bG=bG||[],this.hooks.push(bH),this.args.push(bG)},bE.jqplot.EventListenerManager=function(){this.hooks=[]},bE.jqplot.EventListenerManager.prototype.addOnce=function(bH,bG){for(var bL,bK,bJ=!1,bK=0,bI=this.hooks.length;bI>bK;bK++){bL=this.hooks[bK],bL[0]==bH&&bL[1]==bG&&(bJ=!0)}bJ||this.hooks.push([bH,bG])},bE.jqplot.EventListenerManager.prototype.add=function(bH,bG){this.hooks.push([bH,bG])};var a7=["yMidAxis","xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];bE.jqplot.computeHighlightColors=function(bG){var bM;if(bE.isArray(bG)){bM=[];for(var bL=0;bL<bG.length;bL++){for(var bK=bE.jqplot.getColorComponents(bG[bL]),bJ=[bK[0],bK[1],bK[2]],bI=bJ[0]+bJ[1]+bJ[2],bH=0;3>bH;bH++){bJ[bH]=bI>660?0.85*bJ[bH]:0.73*bJ[bH]+90,bJ[bH]=parseInt(bJ[bH],10),bJ[bH]>255?255:bJ[bH]}bJ[3]=0.3+0.35*bK[3],bM.push("rgba("+bJ[0]+","+bJ[1]+","+bJ[2]+","+bJ[3]+")")}}else{for(var bK=bE.jqplot.getColorComponents(bG),bJ=[bK[0],bK[1],bK[2]],bI=bJ[0]+bJ[1]+bJ[2],bH=0;3>bH;bH++){bJ[bH]=bI>660?0.85*bJ[bH]:0.73*bJ[bH]+90,bJ[bH]=parseInt(bJ[bH],10),bJ[bH]>255?255:bJ[bH]}bJ[3]=0.3+0.35*bK[3],bM="rgba("+bJ[0]+","+bJ[1]+","+bJ[2]+","+bJ[3]+")"}return bM},bE.jqplot.ColorGenerator=function(bG){bG=bG||bE.jqplot.config.defaultColors;var bH=0;this.next=function(){return bH<bG.length?bG[bH++]:(bH=0,bG[bH++])},this.previous=function(){return bH>0?bG[bH--]:(bH=bG.length-1,bG[bH])},this.get=function(bI){var bJ=bI-bG.length*Math.floor(bI/bG.length);return bG[bJ]},this.setColors=function(bI){bG=bI},this.reset=function(){bH=0},this.getIndex=function(){return bH},this.setIndex=function(bI){bH=bI}},bE.jqplot.hex2rgb=function(bH,bG){bH=bH.replace("#",""),3==bH.length&&(bH=bH.charAt(0)+bH.charAt(0)+bH.charAt(1)+bH.charAt(1)+bH.charAt(2)+bH.charAt(2));var bI;return bI="rgba("+parseInt(bH.slice(0,2),16)+", "+parseInt(bH.slice(2,4),16)+", "+parseInt(bH.slice(4,6),16),bG&&(bI+=", "+bG),bI+=")"},bE.jqplot.rgb2hex=function(bH){for(var bG=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *(?:, *[0-9.]*)?\)/,bL=bH.match(bG),bK="#",bJ=1;4>bJ;bJ++){var bI;-1!=bL[bJ].search(/%/)?(bI=parseInt(255*bL[bJ]/100,10).toString(16),1==bI.length&&(bI="0"+bI)):(bI=parseInt(bL[bJ],10).toString(16),1==bI.length&&(bI="0"+bI)),bK+=bI}return bK},bE.jqplot.normalize2rgb=function(bG,bH){if(-1!=bG.search(/^ *rgba?\(/)){return bG}if(-1!=bG.search(/^ *#?[0-9a-fA-F]?[0-9a-fA-F]/)){return bE.jqplot.hex2rgb(bG,bH)}throw new Error("Invalid color spec")},bE.jqplot.getColorComponents=function(bG){bG=bE.jqplot.colorKeywordMap[bG]||bG;for(var bL=bE.jqplot.normalize2rgb(bG),bK=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *,? *([0-9.]* *)?\)/,bJ=bL.match(bK),bI=[],bH=1;4>bH;bH++){-1!=bJ[bH].search(/%/)?bI[bH-1]=parseInt(255*bJ[bH]/100,10):bI[bH-1]=parseInt(bJ[bH],10)}return bI[3]=parseFloat(bJ[4])?parseFloat(bJ[4]):1,bI},bE.jqplot.colorKeywordMap={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb( 0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb( 0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb( 0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb( 95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb( 0, 255, 255)",darkblue:"rgb( 0, 0, 139)",darkcyan:"rgb( 0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb( 0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb( 85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb( 72, 61, 139)",darkslategray:"rgb( 47, 79, 79)",darkslategrey:"rgb( 47, 79, 79)",darkturquoise:"rgb( 0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb( 0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb( 30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb( 34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb( 0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb( 75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb( 32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb( 0, 255, 0)",limegreen:"rgb( 50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb( 0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb( 60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb( 0, 250, 154)",mediumturquoise:"rgb( 72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb( 25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb( 0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb( 65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb( 46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb( 0, 255, 127)",steelblue:"rgb( 70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb( 0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb( 64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)"},bE.jqplot.AxisLabelRenderer=function(bG){bE.jqplot.ElemContainer.call(this),this.axis,this.show=!0,this.label="",this.fontFamily=null,this.fontSize=null,this.textColor=null,this._elem,this.escapeHTML=!1,bE.extend(!0,this,bG)},bE.jqplot.AxisLabelRenderer.prototype=new bE.jqplot.ElemContainer,bE.jqplot.AxisLabelRenderer.prototype.constructor=bE.jqplot.AxisLabelRenderer,bE.jqplot.AxisLabelRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.AxisLabelRenderer.prototype.draw=function(bG,bH){return this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bE('<div style="position:absolute;" class="jqplot-'+this.axis+'-label"></div>'),Number(this.label)&&this._elem.css("white-space","nowrap"),this.escapeHTML?this._elem.text(this.label):this._elem.html(this.label),this.fontFamily&&this._elem.css("font-family",this.fontFamily),this.fontSize&&this._elem.css("font-size",this.fontSize),this.textColor&&this._elem.css("color",this.textColor),this._elem},bE.jqplot.AxisLabelRenderer.prototype.pack=function(){},bE.jqplot.AxisTickRenderer=function(bG){bE.jqplot.ElemContainer.call(this),this.mark="outside",this.axis,this.showMark=!0,this.showGridline=!0,this.isMinorTick=!1,this.size=4,this.markSize=6,this.show=!0,this.showLabel=!0,this.label=null,this.value=null,this._styles={},this.formatter=bE.jqplot.DefaultTickFormatter,this.prefix="",this.suffix="",this.formatString="",this.fontFamily,this.fontSize,this.textColor,this.escapeHTML=!1,this._elem,this._breakTick=!1,bE.extend(!0,this,bG)},bE.jqplot.AxisTickRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.AxisTickRenderer.prototype=new bE.jqplot.ElemContainer,bE.jqplot.AxisTickRenderer.prototype.constructor=bE.jqplot.AxisTickRenderer,bE.jqplot.AxisTickRenderer.prototype.setTick=function(bH,bG,bI){return this.value=bH,this.axis=bG,bI&&(this.isMinorTick=!0),this},bE.jqplot.AxisTickRenderer.prototype.draw=function(){null===this.label&&(this.label=this.prefix+this.formatter(this.formatString,this.value)+this.suffix);var bG={position:"absolute"};Number(this.label)&&(bG.whitSpace="nowrap"),this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bE(document.createElement("div")),this._elem.addClass("jqplot-"+this.axis+"-tick"),this.escapeHTML?this._elem.text(this.label):this._elem.html(this.label),this._elem.css(bG);for(var bH in this._styles){this._elem.css(bH,this._styles[bH])}return this.fontFamily&&this._elem.css("font-family",this.fontFamily),this.fontSize&&this._elem.css("font-size",this.fontSize),this.textColor&&this._elem.css("color",this.textColor),this._breakTick&&this._elem.addClass("jqplot-breakTick"),this._elem},bE.jqplot.DefaultTickFormatter=function(bG,bH){return"number"==typeof bH?(bG||(bG=bE.jqplot.config.defaultTickFormatString),bE.jqplot.sprintf(bG,bH)):String(bH)},bE.jqplot.PercentTickFormatter=function(bG,bH){return"number"==typeof bH?(bH=100*bH,bG||(bG=bE.jqplot.config.defaultTickFormatString),bE.jqplot.sprintf(bG,bH)):String(bH)},bE.jqplot.AxisTickRenderer.prototype.pack=function(){},bE.jqplot.CanvasGridRenderer=function(){this.shadowRenderer=new bE.jqplot.ShadowRenderer},bE.jqplot.CanvasGridRenderer.prototype.init=function(bG){this._ctx,bE.extend(!0,this,bG);var bH={lineJoin:"miter",lineCap:"round",fill:!1,isarc:!1,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.shadowWidth,closePath:!1,strokeStyle:this.shadowColor};this.renderer.shadowRenderer.init(bH)},bE.jqplot.CanvasGridRenderer.prototype.createElement=function(bG){var bJ;this._elem&&(bE.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a8&&(bJ=this._elem.get(0),window.G_vmlCanvasManager.uninitElement(bJ),bJ=null),this._elem.emptyForce(),this._elem=null),bJ=bG.canvasManager.getCanvas();var bI=this._plotDimensions.width,bH=this._plotDimensions.height;return bJ.width=bI,bJ.height=bH,this._elem=bE(bJ),this._elem.addClass("jqplot-grid-canvas"),this._elem.css({position:"absolute",left:0,top:0}),bJ=bG.canvasManager.initCanvas(bJ),this._top=this._offsets.top,this._bottom=bH-this._offsets.bottom,this._left=this._offsets.left,this._right=bI-this._offsets.right,this._width=this._right-this._left,this._height=this._bottom-this._top,bJ=null,this._elem},bE.jqplot.CanvasGridRenderer.prototype.draw=function(){function b0(b1,b5,b4,b3,b2){bZ.save(),b2=b2||{},(null==b2.lineWidth||0!=b2.lineWidth)&&(bE.extend(!0,bZ,b2),bZ.beginPath(),bZ.moveTo(b1,b5),bZ.lineTo(b4,b3),bZ.stroke(),bZ.restore())}this._ctx=this._elem.get(0).getContext("2d");var bZ=this._ctx,bY=this._axes;bZ.save(),bZ.clearRect(0,0,this._plotDimensions.width,this._plotDimensions.height),bZ.fillStyle=this.backgroundColor||this.background,bZ.fillRect(this._left,this._top,this._width,this._height),bZ.save(),bZ.lineJoin="miter",bZ.lineCap="butt",bZ.lineWidth=this.gridLineWidth,bZ.strokeStyle=this.gridLineColor;for(var bX,bW,bV,bU,bT=["xaxis","yaxis","x2axis","y2axis"],bS=4;bS>0;bS--){var bR=bT[bS-1],bQ=bY[bR],bP=bQ._ticks,bO=bP.length;if(bQ.show){if(bQ.drawBaseline){var bN={};switch(null!==bQ.baselineWidth&&(bN.lineWidth=bQ.baselineWidth),null!==bQ.baselineColor&&(bN.strokeStyle=bQ.baselineColor),bR){case"xaxis":b0(this._left,this._bottom,this._right,this._bottom,bN);break;case"yaxis":b0(this._left,this._bottom,this._left,this._top,bN);break;case"x2axis":b0(this._left,this._bottom,this._right,this._bottom,bN);break;case"y2axis":b0(this._right,this._bottom,this._right,this._top,bN)}}for(var bM=bO;bM>0;bM--){var bL=bP[bM-1];if(bL.show){var bK=Math.round(bQ.u2p(bL.value))+0.5;switch(bR){case"xaxis":if(bL.showGridline&&this.drawGridlines&&(!bL.isMinorTick&&bQ.drawMajorGridlines||bL.isMinorTick&&bQ.drawMinorGridlines)&&b0(bK,this._top,bK,this._bottom),bL.showMark&&bL.mark&&(!bL.isMinorTick&&bQ.drawMajorTickMarks||bL.isMinorTick&&bQ.drawMinorTickMarks)){bV=bL.markSize,bU=bL.mark;var bK=Math.round(bQ.u2p(bL.value))+0.5;switch(bU){case"outside":bX=this._bottom,bW=this._bottom+bV;break;case"inside":bX=this._bottom-bV,bW=this._bottom;break;case"cross":bX=this._bottom-bV,bW=this._bottom+bV;break;default:bX=this._bottom,bW=this._bottom+bV}this.shadow&&this.renderer.shadowRenderer.draw(bZ,[[bK,bX],[bK,bW]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:0.75*this.gridLineWidth,depth:2,fill:!1,closePath:!1}),b0(bK,bX,bK,bW)}break;case"yaxis":if(bL.showGridline&&this.drawGridlines&&(!bL.isMinorTick&&bQ.drawMajorGridlines||bL.isMinorTick&&bQ.drawMinorGridlines)&&b0(this._right,bK,this._left,bK),bL.showMark&&bL.mark&&(!bL.isMinorTick&&bQ.drawMajorTickMarks||bL.isMinorTick&&bQ.drawMinorTickMarks)){bV=bL.markSize,bU=bL.mark;var bK=Math.round(bQ.u2p(bL.value))+0.5;switch(bU){case"outside":bX=this._left-bV,bW=this._left;break;case"inside":bX=this._left,bW=this._left+bV;break;case"cross":bX=this._left-bV,bW=this._left+bV;break;default:bX=this._left-bV,bW=this._left}this.shadow&&this.renderer.shadowRenderer.draw(bZ,[[bX,bK],[bW,bK]],{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b0(bX,bK,bW,bK,{strokeStyle:bQ.borderColor})}break;case"x2axis":if(bL.showGridline&&this.drawGridlines&&(!bL.isMinorTick&&bQ.drawMajorGridlines||bL.isMinorTick&&bQ.drawMinorGridlines)&&b0(bK,this._bottom,bK,this._top),bL.showMark&&bL.mark&&(!bL.isMinorTick&&bQ.drawMajorTickMarks||bL.isMinorTick&&bQ.drawMinorTickMarks)){bV=bL.markSize,bU=bL.mark;var bK=Math.round(bQ.u2p(bL.value))+0.5;switch(bU){case"outside":bX=this._top-bV,bW=this._top;break;case"inside":bX=this._top,bW=this._top+bV;break;case"cross":bX=this._top-bV,bW=this._top+bV;break;default:bX=this._top-bV,bW=this._top}this.shadow&&this.renderer.shadowRenderer.draw(bZ,[[bK,bX],[bK,bW]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:0.75*this.gridLineWidth,depth:2,fill:!1,closePath:!1}),b0(bK,bX,bK,bW)}break;case"y2axis":if(bL.showGridline&&this.drawGridlines&&(!bL.isMinorTick&&bQ.drawMajorGridlines||bL.isMinorTick&&bQ.drawMinorGridlines)&&b0(this._left,bK,this._right,bK),bL.showMark&&bL.mark&&(!bL.isMinorTick&&bQ.drawMajorTickMarks||bL.isMinorTick&&bQ.drawMinorTickMarks)){bV=bL.markSize,bU=bL.mark;var bK=Math.round(bQ.u2p(bL.value))+0.5;switch(bU){case"outside":bX=this._right,bW=this._right+bV;break;case"inside":bX=this._right-bV,bW=this._right;break;case"cross":bX=this._right-bV,bW=this._right+bV;break;default:bX=this._right,bW=this._right+bV}this.shadow&&this.renderer.shadowRenderer.draw(bZ,[[bX,bK],[bW,bK]],{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b0(bX,bK,bW,bK,{strokeStyle:bQ.borderColor})}}}}bL=null}bQ=null,bP=null}bT=["y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];for(var bS=7;bS>0;bS--){var bQ=bY[bT[bS-1]],bP=bQ._ticks;if(bQ.show){var bJ=bP[bQ.numberTicks-1],bI=bP[0],bH=bQ.getLeft(),bG=[[bH,bJ.getTop()+bJ.getHeight()/2],[bH,bI.getTop()+bI.getHeight()/2+1]];this.shadow&&this.renderer.shadowRenderer.draw(bZ,bG,{lineCap:"butt",fill:!1,closePath:!1}),b0(bG[0][0],bG[0][1],bG[1][0],bG[1][1],{lineCap:"butt",strokeStyle:bQ.borderColor,lineWidth:bQ.borderWidth});for(var bM=bP.length;bM>0;bM--){var bL=bP[bM-1];bV=bL.markSize,bU=bL.mark;var bK=Math.round(bQ.u2p(bL.value))+0.5;if(bL.showMark&&bL.mark){switch(bU){case"outside":bX=bH,bW=bH+bV;break;case"inside":bX=bH-bV,bW=bH;break;case"cross":bX=bH-bV,bW=bH+bV;break;default:bX=bH,bW=bH+bV}bG=[[bX,bK],[bW,bK]],this.shadow&&this.renderer.shadowRenderer.draw(bZ,bG,{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b0(bX,bK,bW,bK,{strokeStyle:bQ.borderColor})}bL=null}bI=null}bQ=null,bP=null}if(bZ.restore(),this.shadow){var bG=[[this._left,this._bottom],[this._right,this._bottom],[this._right,this._top]];this.renderer.shadowRenderer.draw(bZ,bG)}0!=this.borderWidth&&this.drawBorder&&(b0(this._left,this._top,this._right,this._top,{lineCap:"round",strokeStyle:bY.x2axis.borderColor,lineWidth:bY.x2axis.borderWidth}),b0(this._right,this._top,this._right,this._bottom,{lineCap:"round",strokeStyle:bY.y2axis.borderColor,lineWidth:bY.y2axis.borderWidth}),b0(this._right,this._bottom,this._left,this._bottom,{lineCap:"round",strokeStyle:bY.xaxis.borderColor,lineWidth:bY.xaxis.borderWidth}),b0(this._left,this._bottom,this._left,this._top,{lineCap:"round",strokeStyle:bY.yaxis.borderColor,lineWidth:bY.yaxis.borderWidth})),bZ.restore(),bZ=null,bY=null},bE.jqplot.DivTitleRenderer=function(){},bE.jqplot.DivTitleRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.DivTitleRenderer.prototype.draw=function(){this._elem&&(this._elem.emptyForce(),this._elem=null);var bG=(this.renderer,document.createElement("div"));if(this._elem=bE(bG),this._elem.addClass("jqplot-title"),this.text){if(this.text){var bI;this.color?bI=this.color:this.textColor&&(bI=this.textColor);var bH={position:"absolute",top:"0px",left:"0px"};this._plotWidth&&(bH.width=this._plotWidth+"px"),this.fontSize&&(bH.fontSize=this.fontSize),"string"==typeof this.textAlign?bH.textAlign=this.textAlign:bH.textAlign="center",bI&&(bH.color=bI),this.paddingBottom&&(bH.paddingBottom=this.paddingBottom),this.fontFamily&&(bH.fontFamily=this.fontFamily),this._elem.css(bH),this.escapeHtml?this._elem.text(this.text):this._elem.html(this.text)}}else{this.show=!1,this._elem.height(0),this._elem.width(0)}return bG=null,this._elem},bE.jqplot.DivTitleRenderer.prototype.pack=function(){};var a6=0.1;bE.jqplot.LinePattern=function(bV,bU){var bT={dotted:[a6,bE.jqplot.config.dotGapLength],dashed:[bE.jqplot.config.dashLength,bE.jqplot.config.gapLength],solid:null};if("string"==typeof bU){if("."===bU[0]||"-"===bU[0]){var bS=bU;bU=[];for(var bR=0,bQ=bS.length;bQ>bR;bR++){if("."===bS[bR]){bU.push(a6)}else{if("-"!==bS[bR]){continue}bU.push(bE.jqplot.config.dashLength)}bU.push(bE.jqplot.config.gapLength)}}else{bU=bT[bU]}}if(!bU||!bU.length){return bV}var bP=0,bO=bU[0],bN=0,bM=0,bL=0,bK=0,bJ=function(bW,bX){bV.moveTo(bW,bX),bN=bW,bM=bX,bL=bW,bK=bX},bI=function(bY,b2){var b1=bV.lineWidth,b0=bY-bN,bZ=b2-bM,bX=Math.sqrt(b0*b0+bZ*bZ);if(bX>0&&b1>0){for(b0/=bX,bZ/=bX;;){var bW=b1*bO;if(!(bX>bW)){bN=bY,bM=b2,0==(1&bP)?bV.lineTo(bN,bM):bV.moveTo(bN,bM),bO-=bX/b1;break}bN+=bW*b0,bM+=bW*bZ,0==(1&bP)?bV.lineTo(bN,bM):bV.moveTo(bN,bM),bX-=bW,bP++,bP>=bU.length&&(bP=0),bO=bU[bP]}}},bH=function(){bV.beginPath()},bG=function(){bI(bL,bK)};return{moveTo:bJ,lineTo:bI,beginPath:bH,closePath:bG}},bE.jqplot.LineRenderer=function(){this.shapeRenderer=new bE.jqplot.ShapeRenderer,this.shadowRenderer=new bE.jqplot.ShadowRenderer},bE.jqplot.LineRenderer.prototype.init=function(bG,bM){bG=bG||{},this._type="line",this.renderer.animation={show:!1,direction:"left",speed:2500,_supported:!0},this.renderer.smooth=!1,this.renderer.tension=null,this.renderer.constrainSmoothing=!0,this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[],this.renderer.bandData=[],this.renderer.bands={show:!1,hiData:[],lowData:[],color:this.color,showLines:!1,fill:!0,fillColor:null,_min:null,_max:null,interval:"3%"};var bL={highlightMouseOver:bG.highlightMouseOver,highlightMouseDown:bG.highlightMouseDown,highlightColor:bG.highlightColor};delete bG.highlightMouseOver,delete bG.highlightMouseDown,delete bG.highlightColor,bE.extend(!0,this.renderer,bG),this.renderer.options=bG,this.renderer.bandData.length>1&&(!bG.bands||null==bG.bands.show)?this.renderer.bands.show=!0:bG.bands&&null==bG.bands.show&&null!=bG.bands.interval&&(this.renderer.bands.show=!0),this.fill&&(this.renderer.bands.show=!1),this.renderer.bands.show&&this.renderer.initBands.call(this,this.renderer.options,bM),this._stack&&(this.renderer.smooth=!1);var bK={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:!1,strokeStyle:this.color,fillStyle:this.fillColor,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};this.renderer.shapeRenderer.init(bK);var bJ=bG.shadowOffset;null==bJ&&(bJ=this.lineWidth>2.5?1.25*(1+0.6*(Math.atan(this.lineWidth/2.5)/0.785398163-1)):1.25*Math.atan(this.lineWidth/2.5)/0.785398163);var bI={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:!1,angle:this.shadowAngle,offset:bJ,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};if(this.renderer.shadowRenderer.init(bI),this._areaPoints=[],this._boundingBox=[[],[]],!this.isTrendline&&this.fill||this.renderer.bands.show){if(this.highlightMouseOver=!0,this.highlightMouseDown=!1,this.highlightColor=null,bL.highlightMouseDown&&null==bL.highlightMouseOver&&(bL.highlightMouseOver=!1),bE.extend(!0,this,{highlightMouseOver:bL.highlightMouseOver,highlightMouseDown:bL.highlightMouseDown,highlightColor:bL.highlightColor}),!this.highlightColor){var bH=this.renderer.bands.show?this.renderer.bands.fillColor:this.fillColor;this.highlightColor=bE.jqplot.computeHighlightColors(bH)}this.highlighter&&(this.highlighter.show=!1)}!this.isTrendline&&bM&&(bM.plugins.lineRenderer={},bM.postInitHooks.addOnce(bt),bM.postDrawHooks.addOnce(bs),bM.eventListenerHooks.addOnce("jqplotMouseMove",bp),bM.eventListenerHooks.addOnce("jqplotMouseDown",bo),bM.eventListenerHooks.addOnce("jqplotMouseUp",bn),bM.eventListenerHooks.addOnce("jqplotClick",bm),bM.eventListenerHooks.addOnce("jqplotRightClick",bl))},bE.jqplot.LineRenderer.prototype.initBands=function(b0,bZ){var bY=b0.bandData||[],bX=this.renderer.bands;bX.hiData=[],bX.lowData=[];var bW=this.data;if(bX._max=null,bX._min=null,2==bY.length){if(bE.isArray(bY[0][0])){for(var bV,bU=0,bT=0,bS=0,bR=bY[0].length;bR>bS;bS++){bV=bY[0][bS],(null!=bV[1]&&bV[1]>bX._max||null==bX._max)&&(bX._max=bV[1]),(null!=bV[1]&&bV[1]<bX._min||null==bX._min)&&(bX._min=bV[1])}for(var bS=0,bR=bY[1].length;bR>bS;bS++){bV=bY[1][bS],(null!=bV[1]&&bV[1]>bX._max||null==bX._max)&&(bX._max=bV[1],bT=1),(null!=bV[1]&&bV[1]<bX._min||null==bX._min)&&(bX._min=bV[1],bU=1)}bT===bU&&(bX.show=!1),bX.hiData=bY[bT],bX.lowData=bY[bU]}else{if(bY[0].length===bW.length&&bY[1].length===bW.length){for(var bQ=bY[0][0]>bY[1][0]?0:1,bP=bQ?0:1,bS=0,bR=bW.length;bR>bS;bS++){bX.hiData.push([bW[bS][0],bY[bQ][bS]]),bX.lowData.push([bW[bS][0],bY[bP][bS]])}}else{bX.show=!1}}}else{if(bY.length>2&&!bE.isArray(bY[0][0])){for(var bQ=bY[0][0]>bY[0][1]?0:1,bP=bQ?0:1,bS=0,bR=bY.length;bR>bS;bS++){bX.hiData.push([bW[bS][0],bY[bS][bQ]]),bX.lowData.push([bW[bS][0],bY[bS][bP]])}}else{var bO=bX.interval,bN=null,bM=null,bL=null,bK=null;if(bE.isArray(bO)?(bN=bO[0],bM=bO[1]):bN=bO,isNaN(bN)?"%"===bN.charAt(bN.length-1)&&(bL="multiply",bN=parseFloat(bN)/100+1):(bN=parseFloat(bN),bL="add"),null!==bM&&isNaN(bM)?"%"===bM.charAt(bM.length-1)&&(bK="multiply",bM=parseFloat(bM)/100+1):null!==bM&&(bM=parseFloat(bM),bK="add"),null!==bN){if(null===bM&&(bM=-bN,bK=bL,"multiply"===bK&&(bM+=2)),bM>bN){var bJ=bN;bN=bM,bM=bJ,bJ=bL,bL=bK,bK=bJ}for(var bS=0,bR=bW.length;bR>bS;bS++){switch(bL){case"add":bX.hiData.push([bW[bS][0],bW[bS][1]+bN]);break;case"multiply":bX.hiData.push([bW[bS][0],bW[bS][1]*bN])}switch(bK){case"add":bX.lowData.push([bW[bS][0],bW[bS][1]+bM]);break;case"multiply":bX.lowData.push([bW[bS][0],bW[bS][1]*bM])}}}else{bX.show=!1}}}for(var bI=bX.hiData,bH=bX.lowData,bS=0,bR=bI.length;bR>bS;bS++){(null!=bI[bS][1]&&bI[bS][1]>bX._max||null==bX._max)&&(bX._max=bI[bS][1])}for(var bS=0,bR=bH.length;bR>bS;bS++){(null!=bH[bS][1]&&bH[bS][1]<bX._min||null==bX._min)&&(bX._min=bH[bS][1])}if(null===bX.fillColor){var bG=bE.jqplot.getColorComponents(bX.color);bG[3]=0.5*bG[3],bX.fillColor="rgba("+bG[0]+", "+bG[1]+", "+bG[2]+", "+bG[3]+")"}},bE.jqplot.LineRenderer.prototype.setGridData=function(bP){var bO=this._xaxis.series_u2p,bN=this._yaxis.series_u2p,bM=this._plotData,bL=this._prevPlotData;this.gridData=[],this._prevGridData=[],this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[];for(var bK=this.renderer.bands,bJ=!1,bI=0,bH=bM.length;bH>bI;bI++){null!=bM[bI][0]&&null!=bM[bI][1]?this.gridData.push([bO.call(this._xaxis,bM[bI][0]),bN.call(this._yaxis,bM[bI][1])]):null==bM[bI][0]?(bJ=!0,this.gridData.push([null,bN.call(this._yaxis,bM[bI][1])])):null==bM[bI][1]&&(bJ=!0,this.gridData.push([bO.call(this._xaxis,bM[bI][0]),null])),null!=bL[bI]&&null!=bL[bI][0]&&null!=bL[bI][1]?this._prevGridData.push([bO.call(this._xaxis,bL[bI][0]),bN.call(this._yaxis,bL[bI][1])]):null!=bL[bI]&&null==bL[bI][0]?this._prevGridData.push([null,bN.call(this._yaxis,bL[bI][1])]):null!=bL[bI]&&null!=bL[bI][0]&&null==bL[bI][1]&&this._prevGridData.push([bO.call(this._xaxis,bL[bI][0]),null])}if(bJ&&(this.renderer.smooth=!1,"line"===this._type&&(bK.show=!1)),"line"===this._type&&bK.show){for(var bI=0,bH=bK.hiData.length;bH>bI;bI++){this.renderer._hiBandGridData.push([bO.call(this._xaxis,bK.hiData[bI][0]),bN.call(this._yaxis,bK.hiData[bI][1])])}for(var bI=0,bH=bK.lowData.length;bH>bI;bI++){this.renderer._lowBandGridData.push([bO.call(this._xaxis,bK.lowData[bI][0]),bN.call(this._yaxis,bK.lowData[bI][1])])}}if("line"===this._type&&this.renderer.smooth&&this.gridData.length>2){var bG;this.renderer.constrainSmoothing?(bG=bv.call(this,this.gridData),this.renderer._smoothedData=bG[0],this.renderer._smoothedPlotData=bG[1],bK.show&&(bG=bv.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bG[0],bG=bv.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bG[0]),bG=null):(bG=bu.call(this,this.gridData),this.renderer._smoothedData=bG[0],this.renderer._smoothedPlotData=bG[1],bK.show&&(bG=bu.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bG[0],bG=bu.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bG[0]),bG=null)}},bE.jqplot.LineRenderer.prototype.makeGridData=function(bP,bO){var bN=this._xaxis.series_u2p,bM=this._yaxis.series_u2p,bL=[];this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[];for(var bK=this.renderer.bands,bJ=!1,bI=0;bI<bP.length;bI++){null!=bP[bI][0]&&null!=bP[bI][1]?(this.step&&bI>0&&bL.push([bN.call(this._xaxis,bP[bI][0]),bM.call(this._yaxis,bP[bI-1][1])]),bL.push([bN.call(this._xaxis,bP[bI][0]),bM.call(this._yaxis,bP[bI][1])])):null==bP[bI][0]?(bJ=!0,bL.push([null,bM.call(this._yaxis,bP[bI][1])])):null==bP[bI][1]&&(bJ=!0,bL.push([bN.call(this._xaxis,bP[bI][0]),null]))}if(bJ&&(this.renderer.smooth=!1,"line"===this._type&&(bK.show=!1)),"line"===this._type&&bK.show){for(var bI=0,bH=bK.hiData.length;bH>bI;bI++){this.renderer._hiBandGridData.push([bN.call(this._xaxis,bK.hiData[bI][0]),bM.call(this._yaxis,bK.hiData[bI][1])])}for(var bI=0,bH=bK.lowData.length;bH>bI;bI++){this.renderer._lowBandGridData.push([bN.call(this._xaxis,bK.lowData[bI][0]),bM.call(this._yaxis,bK.lowData[bI][1])])}}if("line"===this._type&&this.renderer.smooth&&bL.length>2){var bG;this.renderer.constrainSmoothing?(bG=bv.call(this,bL),this.renderer._smoothedData=bG[0],this.renderer._smoothedPlotData=bG[1],bK.show&&(bG=bv.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bG[0],bG=bv.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bG[0]),bG=null):(bG=bu.call(this,bL),this.renderer._smoothedData=bG[0],this.renderer._smoothedPlotData=bG[1],bK.show&&(bG=bu.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bG[0],bG=bu.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bG[0]),bG=null)}return bL},bE.jqplot.LineRenderer.prototype.draw=function(b8,b7,b6,b5){var b4,b3,b2,b1,b0,bZ=bE.extend(!0,{},b6),bY=bZ.shadow!=a8?bZ.shadow:this.shadow,bX=bZ.showLine!=a8?bZ.showLine:this.showLine,bW=bZ.fill!=a8?bZ.fill:this.fill,bV=bZ.fillAndStroke!=a8?bZ.fillAndStroke:this.fillAndStroke;if(b8.save(),b7.length){if(bX){if(bW){if(this.fillToZero){var bU=this.negativeColor;this.useNegativeColors||(bU=bZ.fillStyle);var bS=!1,bQ=bZ.fillStyle;if(bV){var bO=b7.slice(0)}if(0!=this.index&&this._stack){for(var bM=this._prevGridData,b4=bM.length;b4>0;b4--){b7.push(bM[b4-1])}bY&&this.renderer.shadowRenderer.draw(b8,b7,bZ),this._areaPoints=b7,this.renderer.shapeRenderer.draw(b8,b7,bZ)}else{var bL=[],bK=this.renderer.smooth?this.renderer._smoothedPlotData:this._plotData;this._areaPoints=[];var bJ=this._yaxis.series_u2p(this.fillToValue);this._xaxis.series_u2p(this.fillToValue);if(bZ.closePath=!0,"y"==this.fillAxis){bL.push([b7[0][0],bJ]),this._areaPoints.push([b7[0][0],bJ]);for(var b4=0;b4<b7.length-1;b4++){if(bL.push(b7[b4]),this._areaPoints.push(b7[b4]),bK[b4][1]*bK[b4+1][1]<=0){bK[b4][1]<0?(bS=!0,bZ.fillStyle=bU):(bS=!1,bZ.fillStyle=bQ);var bI=b7[b4][0]+(b7[b4+1][0]-b7[b4][0])*(bJ-b7[b4][1])/(b7[b4+1][1]-b7[b4][1]);bL.push([bI,bJ]),this._areaPoints.push([bI,bJ]),bY&&this.renderer.shadowRenderer.draw(b8,bL,bZ),this.renderer.shapeRenderer.draw(b8,bL,bZ),bL=[[bI,bJ]]}}bK[b7.length-1][1]<0?(bS=!0,bZ.fillStyle=bU):(bS=!1,bZ.fillStyle=bQ),bL.push(b7[b7.length-1]),this._areaPoints.push(b7[b7.length-1]),bL.push([b7[b7.length-1][0],bJ]),this._areaPoints.push([b7[b7.length-1][0],bJ])}bY&&this.renderer.shadowRenderer.draw(b8,bL,bZ),this.renderer.shapeRenderer.draw(b8,bL,bZ)}}else{if(bV){var bO=b7.slice(0)}if(0!=this.index&&this._stack){for(var bM=this._prevGridData,b4=bM.length;b4>0;b4--){b7.push(bM[b4-1])}}else{var bH=b8.canvas.height;b7.unshift([b7[0][0],bH]);var bG=b7.length;b7.push([b7[bG-1][0],bH])}this._areaPoints=b7,bY&&this.renderer.shadowRenderer.draw(b8,b7,bZ),this.renderer.shapeRenderer.draw(b8,b7,bZ)}if(bV){var bT=bE.extend(!0,{},bZ,{fill:!1,closePath:!1});if(this.renderer.shapeRenderer.draw(b8,bO,bT),this.markerRenderer.show){for(this.renderer.smooth&&(bO=this.gridData),b4=0;b4<bO.length;b4++){this.markerRenderer.draw(bO[b4][0],bO[b4][1],b8,bZ.markerOptions)}}}}else{if(this.renderer.bands.show){var bR,bP=bE.extend(!0,{},bZ);this.renderer.bands.showLines&&(bR=this.renderer.smooth?this.renderer._hiBandSmoothedData:this.renderer._hiBandGridData,this.renderer.shapeRenderer.draw(b8,bR,bZ),bR=this.renderer.smooth?this.renderer._lowBandSmoothedData:this.renderer._lowBandGridData,this.renderer.shapeRenderer.draw(b8,bR,bP)),this.renderer.bands.fill&&(bR=this.renderer.smooth?this.renderer._hiBandSmoothedData.concat(this.renderer._lowBandSmoothedData.reverse()):this.renderer._hiBandGridData.concat(this.renderer._lowBandGridData.reverse()),this._areaPoints=bR,bP.closePath=!0,bP.fill=!0,bP.fillStyle=this.renderer.bands.fillColor,this.renderer.shapeRenderer.draw(b8,bR,bP))}bY&&this.renderer.shadowRenderer.draw(b8,b7,bZ),this.renderer.shapeRenderer.draw(b8,b7,bZ)}}var b3=b1=b2=b0=null;for(b4=0;b4<this._areaPoints.length;b4++){var bN=this._areaPoints[b4];(b3>bN[0]||null==b3)&&(b3=bN[0]),(b0<bN[1]||null==b0)&&(b0=bN[1]),(b1<bN[0]||null==b1)&&(b1=bN[0]),(b2>bN[1]||null==b2)&&(b2=bN[1])}if("line"===this.type&&this.renderer.bands.show&&(b0=this._yaxis.series_u2p(this.renderer.bands._min),b2=this._yaxis.series_u2p(this.renderer.bands._max)),this._boundingBox=[[b3,b0],[b1,b2]],this.markerRenderer.show&&!bW){for(this.renderer.smooth&&(b7=this.gridData),b4=0;b4<b7.length;b4++){null!=b7[b4][0]&&null!=b7[b4][1]&&this.markerRenderer.draw(b7[b4][0],b7[b4][1],b8,bZ.markerOptions)}}}b8.restore()},bE.jqplot.LineRenderer.prototype.drawShadow=function(bH,bG,bI){},bE.jqplot.LinearAxisRenderer=function(){},bE.jqplot.LinearAxisRenderer.prototype.init=function(bG){this.breakPoints=null,this.breakTickLabel="&asymp;",this.drawBaseline=!0,this.baselineWidth=null,this.baselineColor=null,this.forceTickAt0=!1,this.forceTickAt100=!1,this.tickInset=0,this.minorTicks=0,this.alignTicks=!1,this._autoFormatString="",this._overrideFormatString=!1,this._scalefact=1,bE.extend(!0,this,bG),this.breakPoints&&(bE.isArray(this.breakPoints)?(this.breakPoints.length<2||this.breakPoints[1]<=this.breakPoints[0])&&(this.breakPoints=null):this.breakPoints=null),null!=this.numberTicks&&this.numberTicks<2&&(this.numberTicks=2),this.resetDataBounds()},bE.jqplot.LinearAxisRenderer.prototype.draw=function(bG,bL){if(this.show){this.renderer.createTicks.call(this,bL);if(this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bE(document.createElement("div")),this._elem.addClass("jqplot-axis jqplot-"+this.name),this._elem.css("position","absolute"),"xaxis"==this.name||"x2axis"==this.name?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions),this._label.show){var bK=this._label.draw(bG,bL);bK.appendTo(this._elem),bK=null}for(var bJ,bI=this._ticks,bH=0;bH<bI.length;bH++){bJ=bI[bH],bJ.show&&bJ.showLabel&&(!bJ.isMinorTick||this.showMinorTicks)&&this._elem.append(bJ.draw(bG,bL))}bJ=null,bI=null}return this._elem},bE.jqplot.LinearAxisRenderer.prototype.reset=function(){this.min=this._options.min,this.max=this._options.max,this.tickInterval=this._options.tickInterval,this.numberTicks=this._options.numberTicks,this._autoFormatString="",this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString&&(this.tickOptions.formatString="")},bE.jqplot.LinearAxisRenderer.prototype.set=function(){var bG,bN=0,bM=0,bL=0,bK=null==this._label?!1:this._label.show;if(this.show){for(var bJ,bI=this._ticks,bH=0;bH<bI.length;bH++){bJ=bI[bH],bJ._breakTick||!bJ.show||!bJ.showLabel||bJ.isMinorTick&&!this.showMinorTicks||(bG="xaxis"==this.name||"x2axis"==this.name?bJ._elem.outerHeight(!0):bJ._elem.outerWidth(!0),bG>bN&&(bN=bG))}bJ=null,bI=null,bK&&(bM=this._label._elem.outerWidth(!0),bL=this._label._elem.outerHeight(!0)),"xaxis"==this.name?(bN+=bL,this._elem.css({height:bN+"px",left:"0px",bottom:"0px"})):"x2axis"==this.name?(bN+=bL,this._elem.css({height:bN+"px",left:"0px",top:"0px"})):"yaxis"==this.name?(bN+=bM,this._elem.css({width:bN+"px",left:"0px",top:"0px"}),bK&&this._label.constructor==bE.jqplot.AxisLabelRenderer&&this._label._elem.css("width",bM+"px")):(bN+=bM,this._elem.css({width:bN+"px",right:"0px",top:"0px"}),bK&&this._label.constructor==bE.jqplot.AxisLabelRenderer&&this._label._elem.css("width",bM+"px"))}},bE.jqplot.LinearAxisRenderer.prototype.createTicks=function(cu){var ct,cs,cr,cq,cp=this._ticks,co=this.ticks,cn=this.name,cm=this._dataBounds,cl="x"===this.name.charAt(0)?this._plotDimensions.width:this._plotDimensions.height,ck=this.min,cj=this.max,ci=this.numberTicks,ch=this.tickInterval,cg=30;if(this._scalefact=(Math.max(cl,cg+1)-cg)/300,co.length){for(cq=0;cq<co.length;cq++){var cf=co[cq],ce=new this.tickRenderer(this.tickOptions);bE.isArray(cf)?(ce.value=cf[0],this.breakPoints?cf[0]==this.breakPoints[0]?(ce.label=this.breakTickLabel,ce._breakTick=!0,ce.showGridline=!1,ce.showMark=!1):cf[0]>this.breakPoints[0]&&cf[0]<=this.breakPoints[1]?(ce.show=!1,ce.showGridline=!1,ce.label=cf[1]):ce.label=cf[1]:ce.label=cf[1],ce.setTick(cf[0],this.name),this._ticks.push(ce)):bE.isPlainObject(cf)?(bE.extend(!0,ce,cf),ce.axis=this.name,this._ticks.push(ce)):(ce.value=cf,this.breakPoints&&(cf==this.breakPoints[0]?(ce.label=this.breakTickLabel,ce._breakTick=!0,ce.showGridline=!1,ce.showMark=!1):cf>this.breakPoints[0]&&cf<=this.breakPoints[1]&&(ce.show=!1,ce.showGridline=!1)),ce.setTick(cf,this.name),this._ticks.push(ce))}this.numberTicks=co.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{cl="xaxis"==cn||"x2axis"==cn?this._plotDimensions.width:this._plotDimensions.height;var cd=this.numberTicks;this.alignTicks&&("x2axis"===this.name&&cu.axes.xaxis.show?cd=cu.axes.xaxis.numberTicks:"y"===this.name.charAt(0)&&"yaxis"!==this.name&&"yMidAxis"!==this.name&&cu.axes.yaxis.show&&(cd=cu.axes.yaxis.numberTicks)),ct=null!=this.min?this.min:cm.min,cs=null!=this.max?this.max:cm.max;var cc,cb,ca,b9=cs-ct;if(null!=this.tickOptions&&this.tickOptions.formatString||(this._overrideFormatString=!0),null==this.min||null==this.max&&null==this.tickInterval&&!this.autoscale){this.forceTickAt0&&(ct>0&&(ct=0),0>cs&&(cs=0)),this.forceTickAt100&&(ct>100&&(ct=100),100>cs&&(cs=100));var b8=!1,b7=!1;null!=this.min?b8=!0:null!=this.max&&(b7=!0);var b6=bE.jqplot.LinearTickGenerator(ct,cs,this._scalefact,cd,b8,b7),b5=null!=this.min?ct:ct+b9*(this.padMin-1),b4=null!=this.max?cs:cs-b9*(this.padMax-1);(b5>ct||cs>b4)&&(b5=null!=this.min?ct:ct-b9*(this.padMin-1),b4=null!=this.max?cs:cs+b9*(this.padMax-1),b6=bE.jqplot.LinearTickGenerator(b5,b4,this._scalefact,cd,b8,b7)),this.min=b6[0],this.max=b6[1],this.numberTicks=b6[2],this._autoFormatString=b6[3],this.tickInterval=b6[4]}else{if(ct==cs){var b3=0.05;ct>0&&(b3=Math.max(Math.log(ct)/Math.LN10,0.05)),ct-=b3,cs+=b3}if(this.autoscale&&null==this.min&&null==this.max){for(var b2,b1,b0,bZ=!1,bY=!1,cq=0;cq<this._series.length;cq++){var bX=this._series[cq],bW="x"==bX.fillAxis?bX._xaxis.name:bX._yaxis.name;if(this.name==bW){for(var bV=bX._plotValues[bX.fillAxis],bU=bV[0],bT=bV[0],bS=1;bS<bV.length;bS++){bV[bS]<bU?bU=bV[bS]:bV[bS]>bT&&(bT=bV[bS])}var bR=(bT-bU)/bT;bX.renderer.constructor==bE.jqplot.BarRenderer?bU>=0&&(bX.fillToZero||bR>0.1)?bZ=!0:(bZ=!1,bY=bX.fill&&bX.fillToZero&&0>bU&&bT>0?!0:!1):bX.fill?bU>=0&&(bX.fillToZero||bR>0.1)?bZ=!0:0>bU&&bT>0&&bX.fillToZero?(bZ=!1,bY=!0):(bZ=!1,bY=!1):0>bU&&(bZ=!1)}}if(bZ){this.numberTicks=2+Math.ceil((cl-(this.tickSpacing-1))/this.tickSpacing),this.min=0,ck=0,b1=cs/(this.numberTicks-1),ca=Math.pow(10,Math.abs(Math.floor(Math.log(b1)/Math.LN10))),b1/ca==parseInt(b1/ca,10)&&(b1+=ca),this.tickInterval=Math.ceil(b1/ca)*ca,this.max=this.tickInterval*(this.numberTicks-1)}else{if(bY){this.numberTicks=2+Math.ceil((cl-(this.tickSpacing-1))/this.tickSpacing);var bQ=Math.ceil(Math.abs(ct)/b9*(this.numberTicks-1)),bP=this.numberTicks-1-bQ;b1=Math.max(Math.abs(ct/bQ),Math.abs(cs/bP)),ca=Math.pow(10,Math.abs(Math.floor(Math.log(b1)/Math.LN10))),this.tickInterval=Math.ceil(b1/ca)*ca,this.max=this.tickInterval*bP,this.min=-this.tickInterval*bQ}else{null==this.numberTicks&&(this.tickInterval?this.numberTicks=3+Math.ceil(b9/this.tickInterval):this.numberTicks=2+Math.ceil((cl-(this.tickSpacing-1))/this.tickSpacing)),null==this.tickInterval?(b1=b9/(this.numberTicks-1),ca=1>b1?Math.pow(10,Math.abs(Math.floor(Math.log(b1)/Math.LN10))):1,this.tickInterval=Math.ceil(b1*ca*this.pad)/ca):ca=1/this.tickInterval,b2=this.tickInterval*(this.numberTicks-1),b0=(b2-b9)/2,null==this.min&&(this.min=Math.floor(ca*(ct-b0))/ca),null==this.max&&(this.max=this.min+b2)}}var bO,bN=bE.jqplot.getSignificantFigures(this.tickInterval);if(bN.digitsLeft>=bN.significantDigits){bO="%d"}else{var ca=Math.max(0,5-bN.digitsLeft);ca=Math.min(ca,bN.digitsRight),bO="%."+ca+"f"}this._autoFormatString=bO}else{cc=null!=this.min?this.min:ct-b9*(this.padMin-1),cb=null!=this.max?this.max:cs+b9*(this.padMax-1),b9=cb-cc,null==this.numberTicks&&(null!=this.tickInterval?this.numberTicks=Math.ceil((cb-cc)/this.tickInterval)+1:cl>100?this.numberTicks=parseInt(3+(cl-100)/75,10):this.numberTicks=2),null==this.tickInterval&&(this.tickInterval=b9/(this.numberTicks-1)),null==this.max&&(cb=cc+this.tickInterval*(this.numberTicks-1)),null==this.min&&(cc=cb-this.tickInterval*(this.numberTicks-1));var bO,bN=bE.jqplot.getSignificantFigures(this.tickInterval);if(bN.digitsLeft>=bN.significantDigits){bO="%d"}else{var ca=Math.max(0,5-bN.digitsLeft);ca=Math.min(ca,bN.digitsRight),bO="%."+ca+"f"}this._autoFormatString=bO,this.min=cc,this.max=cb}if(this.renderer.constructor==bE.jqplot.LinearAxisRenderer&&""==this._autoFormatString){b9=this.max-this.min;var bM=new this.tickRenderer(this.tickOptions),bL=bM.formatString||bE.jqplot.config.defaultTickFormatString,bL=bL.match(bE.jqplot.sprintf.regex)[0],bK=0;if(bL){if(bL.search(/[fFeEgGpP]/)>-1){var bJ=bL.match(/\%\.(\d{0,})?[eEfFgGpP]/);bK=bJ?parseInt(bJ[1],10):6}else{bL.search(/[di]/)>-1&&(bK=0)}var bI=Math.pow(10,-bK);if(this.tickInterval<bI&&null==ci&&null==ch){if(this.tickInterval=bI,null==cj&&null==ck){this.min=Math.floor(this._dataBounds.min/bI)*bI,this.min==this._dataBounds.min&&(this.min=this._dataBounds.min-this.tickInterval),this.max=Math.ceil(this._dataBounds.max/bI)*bI,this.max==this._dataBounds.max&&(this.max=this._dataBounds.max+this.tickInterval);var bH=(this.max-this.min)/this.tickInterval;bH=bH.toFixed(11),bH=Math.ceil(bH),this.numberTicks=bH+1}else{if(null==cj){var bH=(this._dataBounds.max-this.min)/this.tickInterval;bH=bH.toFixed(11),this.numberTicks=Math.ceil(bH)+2,this.max=this.min+this.tickInterval*(this.numberTicks-1)}else{if(null==ck){var bH=(this.max-this._dataBounds.min)/this.tickInterval;bH=bH.toFixed(11),this.numberTicks=Math.ceil(bH)+2,this.min=this.max-this.tickInterval*(this.numberTicks-1)}else{this.numberTicks=Math.ceil((cj-ck)/this.tickInterval)+1,this.min=Math.floor(ck*Math.pow(10,bK))/Math.pow(10,bK),this.max=Math.ceil(cj*Math.pow(10,bK))/Math.pow(10,bK),this.numberTicks=Math.ceil((this.max-this.min)/this.tickInterval)+1}}}}}}}this._overrideFormatString&&""!=this._autoFormatString&&(this.tickOptions=this.tickOptions||{},this.tickOptions.formatString=this._autoFormatString);for(var ce,bG,cq=0;cq<this.numberTicks;cq++){if(cr=this.min+cq*this.tickInterval,ce=new this.tickRenderer(this.tickOptions),ce.setTick(cr,this.name),this._ticks.push(ce),cq<this.numberTicks-1){for(var bS=0;bS<this.minorTicks;bS++){cr+=this.tickInterval/(this.minorTicks+1),bG=bE.extend(!0,{},this.tickOptions,{name:this.name,value:cr,label:"",isMinorTick:!0}),ce=new this.tickRenderer(bG),this._ticks.push(ce)}}ce=null}}this.tickInset&&(this.min=this.min-this.tickInset*this.tickInterval,this.max=this.max+this.tickInset*this.tickInterval),cp=null},bE.jqplot.LinearAxisRenderer.prototype.resetTickValues=function(bG){if(bE.isArray(bG)&&bG.length==this._ticks.length){for(var bI,bH=0;bH<bG.length;bH++){bI=this._ticks[bH],bI.value=bG[bH],bI.label=bI.formatter(bI.formatString,bG[bH]),bI.label=bI.prefix+bI.label,bI._elem.html(bI.label)}bI=null,this.min=bE.jqplot.arrayMin(bG),this.max=bE.jqplot.arrayMax(bG),this.pack()}},bE.jqplot.LinearAxisRenderer.prototype.pack=function(bX,bW){bX=bX||{},bW=bW||this._offsets;var bV=this._ticks,bU=this.max,bT=this.min,bS=bW.max,bR=bW.min,bQ=null==this._label?!1:this._label.show;for(var bP in bX){this._elem.css(bP,bX[bP])}this._offsets=bW;var bO=bS-bR,bN=bU-bT;if(this.breakPoints?(bN=bN-this.breakPoints[1]+this.breakPoints[0],this.p2u=function(bY){return(bY-bR)*bN/bO+bT},this.u2p=function(bY){return bY>this.breakPoints[0]&&bY<this.breakPoints[1]&&(bY=this.breakPoints[0]),bY<=this.breakPoints[0]?(bY-bT)*bO/bN+bR:(bY-this.breakPoints[1]+this.breakPoints[0]-bT)*bO/bN+bR},"x"==this.name.charAt(0)?(this.series_u2p=function(bY){return bY>this.breakPoints[0]&&bY<this.breakPoints[1]&&(bY=this.breakPoints[0]),bY<=this.breakPoints[0]?(bY-bT)*bO/bN:(bY-this.breakPoints[1]+this.breakPoints[0]-bT)*bO/bN},this.series_p2u=function(bY){return bY*bN/bO+bT}):(this.series_u2p=function(bY){return bY>this.breakPoints[0]&&bY<this.breakPoints[1]&&(bY=this.breakPoints[0]),bY>=this.breakPoints[1]?(bY-bU)*bO/bN:(bY+this.breakPoints[1]-this.breakPoints[0]-bU)*bO/bN},this.series_p2u=function(bY){return bY*bN/bO+bU})):(this.p2u=function(bY){return(bY-bR)*bN/bO+bT},this.u2p=function(bY){return(bY-bT)*bO/bN+bR},"xaxis"==this.name||"x2axis"==this.name?(this.series_u2p=function(bY){return(bY-bT)*bO/bN},this.series_p2u=function(bY){return bY*bN/bO+bT}):(this.series_u2p=function(bY){return(bY-bU)*bO/bN},this.series_p2u=function(bY){return bY*bN/bO+bU})),this.show){if("xaxis"==this.name||"x2axis"==this.name){for(var bM=0;bM<bV.length;bM++){var bL=bV[bM];if(bL.show&&bL.showLabel){var bK;if(bL.constructor==bE.jqplot.CanvasAxisTickRenderer&&bL.angle){var bJ="xaxis"==this.name?1:-1;switch(bL.labelPosition){case"auto":bK=bJ*bL.angle<0?-bL.getWidth()+bL._textRenderer.height*Math.sin(-bL._textRenderer.angle)/2:-bL._textRenderer.height*Math.sin(bL._textRenderer.angle)/2;break;case"end":bK=-bL.getWidth()+bL._textRenderer.height*Math.sin(-bL._textRenderer.angle)/2;break;case"start":bK=-bL._textRenderer.height*Math.sin(bL._textRenderer.angle)/2;break;case"middle":bK=-bL.getWidth()/2+bL._textRenderer.height*Math.sin(-bL._textRenderer.angle)/2;break;default:bK=-bL.getWidth()/2+bL._textRenderer.height*Math.sin(-bL._textRenderer.angle)/2}}else{bK=-bL.getWidth()/2}var bI=this.u2p(bL.value)+bK+"px";bL._elem.css("left",bI),bL.pack()}}if(bQ){var bH=this._label._elem.outerWidth(!0);this._label._elem.css("left",bR+bO/2-bH/2+"px"),"xaxis"==this.name?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack()}}else{for(var bM=0;bM<bV.length;bM++){var bL=bV[bM];if(bL.show&&bL.showLabel){var bK;if(bL.constructor==bE.jqplot.CanvasAxisTickRenderer&&bL.angle){var bJ="yaxis"==this.name?1:-1;switch(bL.labelPosition){case"auto":case"end":bK=bJ*bL.angle<0?-bL._textRenderer.height*Math.cos(-bL._textRenderer.angle)/2:-bL.getHeight()+bL._textRenderer.height*Math.cos(bL._textRenderer.angle)/2;break;case"start":bK=bL.angle>0?-bL._textRenderer.height*Math.cos(-bL._textRenderer.angle)/2:-bL.getHeight()+bL._textRenderer.height*Math.cos(bL._textRenderer.angle)/2;break;case"middle":bK=-bL.getHeight()/2;break;default:bK=-bL.getHeight()/2}}else{bK=-bL.getHeight()/2}var bI=this.u2p(bL.value)+bK+"px";bL._elem.css("top",bI),bL.pack()}}if(bQ){var bG=this._label._elem.outerHeight(!0);this._label._elem.css("top",bS-bO/2-bG/2+"px"),"yaxis"==this.name?this._label._elem.css("left","0px"):this._label._elem.css("right","0px"),this._label.pack()}}}bV=null};bE.jqplot.LinearTickGenerator=function(bU,bT,bS,bR,bQ,bP){if(bQ=null===bQ?!1:bQ,bP=null===bP||bQ?!1:bP,bU===bT&&(bT=bT?0:1),bS=bS||1,bU>bT){var bO=bT;bT=bU,bU=bO}var bN=[],bM=bh(bT-bU,bS),bL=bE.jqplot.getSignificantFigures;if(null==bR){if(bQ||bP){if(bQ){bN[0]=bU,bN[2]=Math.ceil((bT-bU)/bM+1),bN[1]=bU+(bN[2]-1)*bM;var bK=bL(bU).digitsRight,bJ=bL(bM).digitsRight;bJ>bK?bN[3]=bk(bM):bN[3]="%."+bK+"f",bN[4]=bM}else{if(bP){bN[1]=bT,bN[2]=Math.ceil((bT-bU)/bM+1),bN[0]=bT-(bN[2]-1)*bM;var bI=bL(bT).digitsRight,bJ=bL(bM).digitsRight;bJ>bI?bN[3]=bk(bM):bN[3]="%."+bI+"f",bN[4]=bM}}}else{bN[0]=Math.floor(bU/bM)*bM,bN[1]=Math.ceil(bT/bM)*bM,bN[2]=Math.round((bN[1]-bN[0])/bM+1),bN[3]=bk(bM),bN[4]=bM}}else{var bH=[];if(bH[0]=Math.floor(bU/bM)*bM,bH[1]=Math.ceil(bT/bM)*bM,bH[2]=Math.round((bH[1]-bH[0])/bM+1),bH[3]=bk(bM),bH[4]=bM,bH[2]===bR){bN=bH}else{var bG=bi(bH[1]-bH[0],bR);bN[0]=bH[0],bN[2]=bR,bN[4]=bG,bN[3]=bk(bG),bN[1]=bN[0]+(bN[2]-1)*bN[4]}}return bN},bE.jqplot.LinearTickGenerator.bestLinearInterval=bh,bE.jqplot.LinearTickGenerator.bestInterval=bi,bE.jqplot.LinearTickGenerator.bestLinearComponents=bg,bE.jqplot.LinearTickGenerator.bestConstrainedInterval=bj,bE.jqplot.MarkerRenderer=function(bG){this.show=!0,this.style="filledCircle",this.lineWidth=2,this.size=9,this.color="#666666",this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1,this.shadowDepth=3,this.shadowAlpha="0.07",this.shadowRenderer=new bE.jqplot.ShadowRenderer,this.shapeRenderer=new bE.jqplot.ShapeRenderer,bE.extend(!0,this,bG)},bE.jqplot.MarkerRenderer.prototype.init=function(bG){bE.extend(!0,this,bG);var bI={angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,lineWidth:this.lineWidth,depth:this.shadowDepth,closePath:!0};-1!=this.style.indexOf("filled")&&(bI.fill=!0),-1!=this.style.indexOf("ircle")&&(bI.isarc=!0,bI.closePath=!1),this.shadowRenderer.init(bI);var bH={fill:!1,isarc:!1,strokeStyle:this.color,fillStyle:this.color,lineWidth:this.lineWidth,closePath:!0};-1!=this.style.indexOf("filled")&&(bH.fill=!0),-1!=this.style.indexOf("ircle")&&(bH.isarc=!0,bH.closePath=!1),this.shapeRenderer.init(bH)},bE.jqplot.MarkerRenderer.prototype.drawDiamond=function(bO,bN,bM,bL,bK){var bJ=1.2,bI=this.size/2/bJ,bH=this.size/2*bJ,bG=[[bO-bI,bN],[bO,bN+bH],[bO+bI,bN],[bO,bN-bH]];this.shadow&&this.shadowRenderer.draw(bM,bG),this.shapeRenderer.draw(bM,bG,bK)},bE.jqplot.MarkerRenderer.prototype.drawPlus=function(bQ,bP,bO,bN,bM){var bL=1,bK=this.size/2*bL,bJ=this.size/2*bL,bI=[[bQ,bP-bJ],[bQ,bP+bJ]],bH=[[bQ+bK,bP],[bQ-bK,bP]],bG=bE.extend(!0,{},this.options,{closePath:!1});this.shadow&&(this.shadowRenderer.draw(bO,bI,{closePath:!1}),this.shadowRenderer.draw(bO,bH,{closePath:!1})),this.shapeRenderer.draw(bO,bI,bG),this.shapeRenderer.draw(bO,bH,bG)},bE.jqplot.MarkerRenderer.prototype.drawX=function(bQ,bP,bO,bN,bM){var bL=1,bK=this.size/2*bL,bJ=this.size/2*bL,bI=bE.extend(!0,{},this.options,{closePath:!1}),bH=[[bQ-bK,bP-bJ],[bQ+bK,bP+bJ]],bG=[[bQ-bK,bP+bJ],[bQ+bK,bP-bJ]];this.shadow&&(this.shadowRenderer.draw(bO,bH,{closePath:!1}),this.shadowRenderer.draw(bO,bG,{closePath:!1})),this.shapeRenderer.draw(bO,bH,bI),this.shapeRenderer.draw(bO,bG,bI)},bE.jqplot.MarkerRenderer.prototype.drawDash=function(bH,bG,bN,bM,bL){var bK=1,bJ=this.size/2*bK,bI=(this.size/2*bK,[[bH-bJ,bG],[bH+bJ,bG]]);this.shadow&&this.shadowRenderer.draw(bN,bI),this.shapeRenderer.draw(bN,bI,bL)},bE.jqplot.MarkerRenderer.prototype.drawLine=function(bH,bG,bL,bK,bJ){var bI=[bH,bG];this.shadow&&this.shadowRenderer.draw(bL,bI),this.shapeRenderer.draw(bL,bI,bJ)},bE.jqplot.MarkerRenderer.prototype.drawSquare=function(bO,bN,bM,bL,bK){var bJ=1,bI=this.size/2/bJ,bH=this.size/2*bJ,bG=[[bO-bI,bN-bH],[bO-bI,bN+bH],[bO+bI,bN+bH],[bO+bI,bN-bH]];this.shadow&&this.shadowRenderer.draw(bM,bG),this.shapeRenderer.draw(bM,bG,bK)},bE.jqplot.MarkerRenderer.prototype.drawCircle=function(bH,bG,bN,bM,bL){var bK=this.size/2,bJ=2*Math.PI,bI=[bH,bG,bK,0,bJ,!0];this.shadow&&this.shadowRenderer.draw(bN,bI),this.shapeRenderer.draw(bN,bI,bL)},bE.jqplot.MarkerRenderer.prototype.draw=function(bH,bG,bJ,bI){if(bI=bI||{},null==bI.show||0!=bI.show){switch(bI.color&&!bI.fillStyle&&(bI.fillStyle=bI.color),bI.color&&!bI.strokeStyle&&(bI.strokeStyle=bI.color),this.style){case"diamond":this.drawDiamond(bH,bG,bJ,!1,bI);break;case"filledDiamond":this.drawDiamond(bH,bG,bJ,!0,bI);break;case"circle":this.drawCircle(bH,bG,bJ,!1,bI);break;case"filledCircle":this.drawCircle(bH,bG,bJ,!0,bI);break;case"square":this.drawSquare(bH,bG,bJ,!1,bI);break;case"filledSquare":this.drawSquare(bH,bG,bJ,!0,bI);break;case"x":this.drawX(bH,bG,bJ,!0,bI);break;case"plus":this.drawPlus(bH,bG,bJ,!0,bI);break;case"dash":this.drawDash(bH,bG,bJ,!0,bI);break;case"line":this.drawLine(bH,bG,bJ,!1,bI);break;default:this.drawDiamond(bH,bG,bJ,!1,bI)}}},bE.jqplot.ShadowRenderer=function(bG){this.angle=45,this.offset=1,this.alpha=0.07,this.lineWidth=1.5,this.lineJoin="miter",this.lineCap="round",this.closePath=!1,this.fill=!1,this.depth=3,this.strokeStyle="rgba(0,0,0,0.1)",this.isarc=!1,bE.extend(!0,this,bG)},bE.jqplot.ShadowRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.ShadowRenderer.prototype.draw=function(bV,bU,bT){bV.save();var bS=null!=bT?bT:{},bR=null!=bS.fill?bS.fill:this.fill,bQ=null!=bS.fillRect?bS.fillRect:this.fillRect,bP=null!=bS.closePath?bS.closePath:this.closePath,bO=null!=bS.offset?bS.offset:this.offset,bN=null!=bS.alpha?bS.alpha:this.alpha,bM=null!=bS.depth?bS.depth:this.depth,bL=null!=bS.isarc?bS.isarc:this.isarc,bK=null!=bS.linePattern?bS.linePattern:this.linePattern;bV.lineWidth=null!=bS.lineWidth?bS.lineWidth:this.lineWidth,bV.lineJoin=null!=bS.lineJoin?bS.lineJoin:this.lineJoin,bV.lineCap=null!=bS.lineCap?bS.lineCap:this.lineCap,bV.strokeStyle=bS.strokeStyle||this.strokeStyle||"rgba(0,0,0,"+bN+")",bV.fillStyle=bS.fillStyle||this.fillStyle||"rgba(0,0,0,"+bN+")";for(var bJ=0;bM>bJ;bJ++){var bI=bE.jqplot.LinePattern(bV,bK);if(bV.translate(Math.cos(this.angle*Math.PI/180)*bO,Math.sin(this.angle*Math.PI/180)*bO),bI.beginPath(),bL){bV.arc(bU[0],bU[1],bU[2],bU[3],bU[4],!0)}else{if(bQ){bQ&&bV.fillRect(bU[0],bU[1],bU[2],bU[3])}else{if(bU&&bU.length){for(var bH=!0,bG=0;bG<bU.length;bG++){null!=bU[bG][0]&&null!=bU[bG][1]?bH?(bI.moveTo(bU[bG][0],bU[bG][1]),bH=!1):bI.lineTo(bU[bG][0],bU[bG][1]):bH=!0}}}}bP&&bI.closePath(),bR?bV.fill():bV.stroke()}bV.restore()},bE.jqplot.ShapeRenderer=function(bG){this.lineWidth=1.5,this.linePattern="solid",this.lineJoin="miter",this.lineCap="round",this.closePath=!1,this.fill=!1,this.isarc=!1,this.fillRect=!1,this.strokeRect=!1,this.clearRect=!1,this.strokeStyle="#999999",this.fillStyle="#999999",bE.extend(!0,this,bG)},bE.jqplot.ShapeRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.ShapeRenderer.prototype.draw=function(bT,bS,bR){bT.save();var bQ=null!=bR?bR:{},bP=null!=bQ.fill?bQ.fill:this.fill,bO=null!=bQ.closePath?bQ.closePath:this.closePath,bN=null!=bQ.fillRect?bQ.fillRect:this.fillRect,bM=null!=bQ.strokeRect?bQ.strokeRect:this.strokeRect,bL=null!=bQ.clearRect?bQ.clearRect:this.clearRect,bK=null!=bQ.isarc?bQ.isarc:this.isarc,bJ=null!=bQ.linePattern?bQ.linePattern:this.linePattern,bI=bE.jqplot.LinePattern(bT,bJ);if(bT.lineWidth=bQ.lineWidth||this.lineWidth,bT.lineJoin=bQ.lineJoin||this.lineJoin,bT.lineCap=bQ.lineCap||this.lineCap,bT.strokeStyle=bQ.strokeStyle||bQ.color||this.strokeStyle,bT.fillStyle=bQ.fillStyle||this.fillStyle,bT.beginPath(),bK){return bT.arc(bS[0],bS[1],bS[2],bS[3],bS[4],!0),bO&&bT.closePath(),bP?bT.fill():bT.stroke(),void bT.restore()}if(bL){return bT.clearRect(bS[0],bS[1],bS[2],bS[3]),void bT.restore()}if(bN||bM){if(bN&&bT.fillRect(bS[0],bS[1],bS[2],bS[3]),bM){return bT.strokeRect(bS[0],bS[1],bS[2],bS[3]),void bT.restore()}}else{if(bS&&bS.length){for(var bH=!0,bG=0;bG<bS.length;bG++){null!=bS[bG][0]&&null!=bS[bG][1]?bH?(bI.moveTo(bS[bG][0],bS[bG][1]),bH=!1):bI.lineTo(bS[bG][0],bS[bG][1]):bH=!0}bO&&bI.closePath(),bP?bT.fill():bT.stroke()}}bT.restore()},bE.jqplot.TableLegendRenderer=function(){},bE.jqplot.TableLegendRenderer.prototype.init=function(bG){bE.extend(!0,this,bG)},bE.jqplot.TableLegendRenderer.prototype.addrow=function(bP,bO,bN,bM){var bL,bK,bJ,bI,bH,bG=bN?this.rowSpacing+"px":"0px";bJ=document.createElement("tr"),bL=bE(bJ),bL.addClass("jqplot-table-legend"),bJ=null,bM?bL.prependTo(this._elem):bL.appendTo(this._elem),this.showSwatches&&(bK=bE(document.createElement("td")),bK.addClass("jqplot-table-legend jqplot-table-legend-swatch"),bK.css({textAlign:"center",paddingTop:bG}),bI=bE(document.createElement("div")),bI.addClass("jqplot-table-legend-swatch-outline"),bH=bE(document.createElement("div")),bH.addClass("jqplot-table-legend-swatch"),bH.css({backgroundColor:bO,borderColor:bO}),bL.append(bK.append(bI.append(bH)))),this.showLabels&&(bK=bE(document.createElement("td")),bK.addClass("jqplot-table-legend jqplot-table-legend-label"),bK.css("paddingTop",bG),bL.append(bK),this.escapeHtml?bK.text(bP):bK.html(bP)),bK=null,bI=null,bH=null,bL=null,bJ=null},bE.jqplot.TableLegendRenderer.prototype.draw=function(){if(this._elem&&(this._elem.emptyForce(),this._elem=null),this.show){var bQ=this._series,bP=document.createElement("table");this._elem=bE(bP),this._elem.addClass("jqplot-table-legend");var bO={position:"absolute"};this.background&&(bO.background=this.background),this.border&&(bO.border=this.border),this.fontSize&&(bO.fontSize=this.fontSize),this.fontFamily&&(bO.fontFamily=this.fontFamily),this.textColor&&(bO.textColor=this.textColor),null!=this.marginTop&&(bO.marginTop=this.marginTop),null!=this.marginBottom&&(bO.marginBottom=this.marginBottom),null!=this.marginLeft&&(bO.marginLeft=this.marginLeft),null!=this.marginRight&&(bO.marginRight=this.marginRight);for(var bN,bM=!1,bL=!1,bK=0;bK<bQ.length;bK++){if(bN=bQ[bK],(bN._stack||bN.renderer.constructor==bE.jqplot.BezierCurveRenderer)&&(bL=!0),bN.show&&bN.showLabel){var bJ=this.labels[bK]||bN.label.toString();if(bJ){var bI=bN.color;bL&&bK<bQ.length-1?bM=!0:bL&&bK==bQ.length-1&&(bM=!1),this.renderer.addrow.call(this,bJ,bI,bM,bL),bM=!0}for(var bH=0;bH<bE.jqplot.addLegendRowHooks.length;bH++){var bG=bE.jqplot.addLegendRowHooks[bH].call(this,bN);bG&&(this.renderer.addrow.call(this,bG.label,bG.color,bM),bM=!0)}bJ=null}}}return this._elem},bE.jqplot.TableLegendRenderer.prototype.pack=function(bH){if(this.show){if("insideGrid"==this.placement){switch(this.location){case"nw":var bG=bH.left,bI=bH.top;this._elem.css("left",bG),this._elem.css("top",bI);break;case"n":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2,bI=bH.top;this._elem.css("left",bG),this._elem.css("top",bI);break;case"ne":var bG=bH.right,bI=bH.top;this._elem.css({right:bG,top:bI});break;case"e":var bG=bH.right,bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({right:bG,top:bI});break;case"se":var bG=bH.right,bI=bH.bottom;this._elem.css({right:bG,bottom:bI});break;case"s":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2,bI=bH.bottom;this._elem.css({left:bG,bottom:bI});break;case"sw":var bG=bH.left,bI=bH.bottom;this._elem.css({left:bG,bottom:bI});break;case"w":var bG=bH.left,bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({left:bG,top:bI});break;default:var bG=bH.right,bI=bH.bottom;this._elem.css({right:bG,bottom:bI})}}else{if("outside"==this.placement){switch(this.location){case"nw":var bG=this._plotDimensions.width-bH.left,bI=bH.top;this._elem.css("right",bG),this._elem.css("top",bI);break;case"n":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2,bI=this._plotDimensions.height-bH.top;this._elem.css("left",bG),this._elem.css("bottom",bI);break;case"ne":var bG=this._plotDimensions.width-bH.right,bI=bH.top;this._elem.css({left:bG,top:bI});break;case"e":var bG=this._plotDimensions.width-bH.right,bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({left:bG,top:bI});break;case"se":var bG=this._plotDimensions.width-bH.right,bI=bH.bottom;this._elem.css({left:bG,bottom:bI});break;case"s":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2,bI=this._plotDimensions.height-bH.bottom;this._elem.css({left:bG,top:bI});break;case"sw":var bG=this._plotDimensions.width-bH.left,bI=bH.bottom;this._elem.css({right:bG,bottom:bI});break;case"w":var bG=this._plotDimensions.width-bH.left,bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({right:bG,top:bI});break;default:var bG=bH.right,bI=bH.bottom;this._elem.css({right:bG,bottom:bI})}}else{switch(this.location){case"nw":this._elem.css({left:0,top:bH.top});break;case"n":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2;this._elem.css({left:bG,top:bH.top});break;case"ne":this._elem.css({right:0,top:bH.top});break;case"e":var bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({right:bH.right,top:bI});break;case"se":this._elem.css({right:bH.right,bottom:bH.bottom});break;case"s":var bG=(bH.left+(this._plotDimensions.width-bH.right))/2-this.getWidth()/2;this._elem.css({left:bG,bottom:bH.bottom});break;case"sw":this._elem.css({left:bH.left,bottom:bH.bottom});break;case"w":var bI=(bH.top+(this._plotDimensions.height-bH.bottom))/2-this.getHeight()/2;this._elem.css({left:bH.left,top:bI});break;default:this._elem.css({right:bH.right,bottom:bH.bottom})}}}}},bE.jqplot.ThemeEngine=function(){this.themes={},this.activeTheme=null},bE.jqplot.ThemeEngine.prototype.init=function(){var bG,bM,bL,bK=new bE.jqplot.Theme({_name:"Default"});for(bG in bK.target){"textColor"==bG?bK.target[bG]=this.target.css("color"):bK.target[bG]=this.target.css(bG)}if(this.title.show&&this.title._elem){for(bG in bK.title){"textColor"==bG?bK.title[bG]=this.title._elem.css("color"):bK.title[bG]=this.title._elem.css(bG)}}for(bG in bK.grid){bK.grid[bG]=this.grid[bG]}if(null==bK.grid.backgroundColor&&null!=this.grid.background&&(bK.grid.backgroundColor=this.grid.background),this.legend.show&&this.legend._elem){for(bG in bK.legend){"textColor"==bG?bK.legend[bG]=this.legend._elem.css("color"):bK.legend[bG]=this.legend._elem.css(bG)}}var bJ;for(bM=0;bM<this.series.length;bM++){bJ=this.series[bM],bJ.renderer.constructor==bE.jqplot.LineRenderer?bK.series.push(new a2):bJ.renderer.constructor==bE.jqplot.BarRenderer?bK.series.push(new a0):bJ.renderer.constructor==bE.jqplot.PieRenderer?bK.series.push(new aZ):bJ.renderer.constructor==bE.jqplot.DonutRenderer?bK.series.push(new aY):bJ.renderer.constructor==bE.jqplot.FunnelRenderer?bK.series.push(new aX):bJ.renderer.constructor==bE.jqplot.MeterGaugeRenderer?bK.series.push(new aW):bK.series.push({});for(bG in bK.series[bM]){bK.series[bM][bG]=bJ[bG]}}var bI,bH;for(bG in this.axes){if(bH=this.axes[bG],bI=bK.axes[bG]=new a5,bI.borderColor=bH.borderColor,bI.borderWidth=bH.borderWidth,bH._ticks&&bH._ticks[0]){for(bL in bI.ticks){bH._ticks[0].hasOwnProperty(bL)?bI.ticks[bL]=bH._ticks[0][bL]:bH._ticks[0]._elem&&(bI.ticks[bL]=bH._ticks[0]._elem.css(bL))}}if(bH._label&&bH._label.show){for(bL in bI.label){bH._label[bL]?bI.label[bL]=bH._label[bL]:bH._label._elem&&("textColor"==bL?bI.label[bL]=bH._label._elem.css("color"):bI.label[bL]=bH._label._elem.css(bL))}}}this.themeEngine._add(bK),this.themeEngine.activeTheme=this.themeEngine.themes[bK._name]},bE.jqplot.ThemeEngine.prototype.get=function(bG){return bG?this.themes[bG]:this.activeTheme},bE.jqplot.ThemeEngine.prototype.getThemeNames=function(){var bH=[];for(var bG in this.themes){bH.push(bG)}return bH.sort(bf)},bE.jqplot.ThemeEngine.prototype.getThemes=function(){var bH=[],bG=[];for(var bJ in this.themes){bH.push(bJ)}bH.sort(bf);for(var bI=0;bI<bH.length;bI++){bG.push(this.themes[bH[bI]])}return bG},bE.jqplot.ThemeEngine.prototype.activate=function(bV,bU){var bT=!1;if(!bU&&this.activeTheme&&this.activeTheme._name&&(bU=this.activeTheme._name),!this.themes.hasOwnProperty(bU)){throw new Error("No theme of that name")}var bS=this.themes[bU];this.activeTheme=bS;var bR,bQ=["xaxis","x2axis","yaxis","y2axis"];for(bH=0;bH<bQ.length;bH++){var bP=bQ[bH];null!=bS.axesStyles.borderColor&&(bV.axes[bP].borderColor=bS.axesStyles.borderColor),null!=bS.axesStyles.borderWidth&&(bV.axes[bP].borderWidth=bS.axesStyles.borderWidth)}for(var bO in bV.axes){var bN=bV.axes[bO];if(bN.show){var bM=bS.axes[bO]||{},bL=bS.axesStyles,bK=bE.jqplot.extend(!0,{},bM,bL);if(bR=null!=bS.axesStyles.borderColor?bS.axesStyles.borderColor:bK.borderColor,null!=bK.borderColor&&(bN.borderColor=bK.borderColor,bT=!0),bR=null!=bS.axesStyles.borderWidth?bS.axesStyles.borderWidth:bK.borderWidth,null!=bK.borderWidth&&(bN.borderWidth=bK.borderWidth,bT=!0),bN._ticks&&bN._ticks[0]){for(var bJ in bK.ticks){bR=bK.ticks[bJ],null!=bR&&(bN.tickOptions[bJ]=bR,bN._ticks=[],bT=!0)}}if(bN._label&&bN._label.show){for(var bJ in bK.label){bR=bK.label[bJ],null!=bR&&(bN.labelOptions[bJ]=bR,bT=!0)}}}}for(var bI in bS.grid){null!=bS.grid[bI]&&(bV.grid[bI]=bS.grid[bI])}if(bT||bV.grid.draw(),bV.legend.show){for(bI in bS.legend){null!=bS.legend[bI]&&(bV.legend[bI]=bS.legend[bI])}}if(bV.title.show){for(bI in bS.title){null!=bS.title[bI]&&(bV.title[bI]=bS.title[bI])}}var bH;for(bH=0;bH<bS.series.length;bH++){var bG={};for(bI in bS.series[bH]){bR=null!=bS.seriesStyles[bI]?bS.seriesStyles[bI]:bS.series[bH][bI],null!=bR&&(bG[bI]=bR,"color"==bI?(bV.series[bH].renderer.shapeRenderer.fillStyle=bR,bV.series[bH].renderer.shapeRenderer.strokeStyle=bR,bV.series[bH][bI]=bR):"lineWidth"==bI||"linePattern"==bI?(bV.series[bH].renderer.shapeRenderer[bI]=bR,bV.series[bH][bI]=bR):"markerOptions"==bI?(bc(bV.series[bH].markerOptions,bR),bc(bV.series[bH].markerRenderer,bR)):bV.series[bH][bI]=bR,bT=!0)}}bT&&(bV.target.empty(),bV.draw());for(bI in bS.target){null!=bS.target[bI]&&bV.target.css(bI,bS.target[bI])}},bE.jqplot.ThemeEngine.prototype._add=function(bH,bG){if(bG&&(bH._name=bG),bH._name||(bH._name=Date.parse(new Date)),this.themes.hasOwnProperty(bH._name)){throw new Error("jqplot.ThemeEngine Error: Theme already in use")}this.themes[bH._name]=bH},bE.jqplot.ThemeEngine.prototype.remove=function(bG){return"Default"==bG?!1:delete this.themes[bG]},bE.jqplot.ThemeEngine.prototype.newTheme=function(bG,bI){"object"==typeof bG&&(bI=bI||bG,bG=null),bG=bI&&bI._name?bI._name:bG||Date.parse(new Date);var bH=this.copy(this.themes.Default._name,bG);return bE.jqplot.extend(bH,bI),bH},bE.jqplot.clone=bd,bE.jqplot.merge=bc,bE.jqplot.extend=function(){var bG,bN=arguments[0]||{},bM=1,bL=arguments.length,bK=!1;for("boolean"==typeof bN&&(bK=bN,bN=arguments[1]||{},bM=2),"object"!=typeof bN&&"[object Function]"===!toString.call(bN)&&(bN={});bL>bM;bM++){if(null!=(bG=arguments[bM])){for(var bJ in bG){var bI=bN[bJ],bH=bG[bJ];bN!==bH&&(bK&&bH&&"object"==typeof bH&&!bH.nodeType?bN[bJ]=bE.jqplot.extend(bK,bI||(null!=bH.length?[]:{}),bH):bH!==a8&&(bN[bJ]=bH))}}}return bN},bE.jqplot.ThemeEngine.prototype.rename=function(bH,bG){if("Default"==bH||"Default"==bG){throw new Error("jqplot.ThemeEngine Error: Cannot rename from/to Default")}if(this.themes.hasOwnProperty(bG)){throw new Error("jqplot.ThemeEngine Error: New name already in use.")}if(this.themes.hasOwnProperty(bH)){var bI=this.copy(bH,bG);return this.remove(bH),bI}throw new Error("jqplot.ThemeEngine Error: Old name or new name invalid")},bE.jqplot.ThemeEngine.prototype.copy=function(bG,bK,bJ){if("Default"==bK){throw new Error("jqplot.ThemeEngine Error: Cannot copy over Default theme")}if(!this.themes.hasOwnProperty(bG)){var bI="jqplot.ThemeEngine Error: Source name invalid";throw new Error(bI)}if(this.themes.hasOwnProperty(bK)){var bI="jqplot.ThemeEngine Error: Target name invalid";throw new Error(bI)}var bH=bd(this.themes[bG]);return bH._name=bK,bE.jqplot.extend(!0,bH,bJ),this._add(bH),bH},bE.jqplot.Theme=function(bG,bH){"object"==typeof bG&&(bH=bH||bG,bG=null),bG=bG||Date.parse(new Date),this._name=bG,this.target={backgroundColor:null},this.legend={textColor:null,fontFamily:null,fontSize:null,border:null,background:null},this.title={textColor:null,fontFamily:null,fontSize:null,textAlign:null},this.seriesStyles={},this.series=[],this.grid={drawGridlines:null,gridLineColor:null,gridLineWidth:null,backgroundColor:null,borderColor:null,borderWidth:null,shadow:null},this.axesStyles={label:{},ticks:{}},this.axes={},"string"==typeof bH?this._name=bH:"object"==typeof bH&&bE.jqplot.extend(!0,this,bH)};var a5=function(){this.borderColor=null,this.borderWidth=null,this.ticks=new a4,this.label=new a3},a4=function(){this.show=null,this.showGridline=null,this.showLabel=null,this.showMark=null,this.size=null,this.textColor=null,this.whiteSpace=null,this.fontSize=null,this.fontFamily=null},a3=function(){this.textColor=null,this.whiteSpace=null,this.fontSize=null,this.fontFamily=null,this.fontWeight=null},a2=function(){this.color=null,this.lineWidth=null,this.linePattern=null,this.shadow=null,this.fillColor=null,this.showMarker=null,this.markerOptions=new a1},a1=function(){this.show=null,this.style=null,this.lineWidth=null,this.size=null,this.color=null,this.shadow=null},a0=function(){this.color=null,this.seriesColors=null,this.lineWidth=null,this.shadow=null,this.barPadding=null,this.barMargin=null,this.barWidth=null,this.highlightColors=null},aZ=function(){this.seriesColors=null,this.padding=null,this.sliceMargin=null,this.fill=null,this.shadow=null,this.startAngle=null,this.lineWidth=null,this.highlightColors=null},aY=function(){this.seriesColors=null,this.padding=null,this.sliceMargin=null,this.fill=null,this.shadow=null,this.startAngle=null,this.lineWidth=null,this.innerDiameter=null,this.thickness=null,this.ringMargin=null,this.highlightColors=null},aX=function(){this.color=null,this.lineWidth=null,this.shadow=null,this.padding=null,this.sectionMargin=null,this.seriesColors=null,this.highlightColors=null},aW=function(){this.padding=null,this.backgroundColor=null,this.ringColor=null,this.tickColor=null,this.ringWidth=null,this.intervalColors=null,this.intervalInnerRadius=null,this.intervalOuterRadius=null,this.hubRadius=null,this.needleThickness=null,this.needlePad=null};bE.fn.jqplotChildText=function(){return bE(this).contents().filter(function(){return 3==this.nodeType}).text()},bE.fn.jqplotGetComputedFontStyle=function(){for(var bH=window.getComputedStyle?window.getComputedStyle(this[0],""):this[0].currentStyle,bG=bH["font-style"]?["font-style","font-weight","font-size","font-family"]:["fontStyle","fontWeight","fontSize","fontFamily"],bK=[],bJ=0;bJ<bG.length;++bJ){var bI=String(bH[bG[bJ]]);bI&&"normal"!=bI&&bK.push(bI)}return bK.join(" ")},bE.fn.jqplotToImageCanvas=function(b1){function b0(b2){var b3=parseInt(bE(b2).css("line-height"),10);return isNaN(b3)&&(b3=1.2*parseInt(bE(b2).css("font-size"),10)),b3}function bZ(ch,cg,cf,ce,cd,cc){for(var cb=b0(ch),ca=bE(ch).innerWidth(),b9=(bE(ch).innerHeight(),cf.split(/\s+/)),b8=b9.length,b7="",b6=[],b5=cd,b4=ce,b3=0;b8>b3;b3++){b7+=b9[b3],cg.measureText(b7).width>ca&&b7.length>b9[b3].length&&(b6.push(b3),b7="",b3--)}if(0===b6.length){"center"===bE(ch).css("textAlign")&&(b4=ce+(cc-cg.measureText(b7).width)/2-bK),cg.fillText(cf,b4,cd)}else{b7=b9.slice(0,b6[0]).join(" "),"center"===bE(ch).css("textAlign")&&(b4=ce+(cc-cg.measureText(b7).width)/2-bK),cg.fillText(b7,b4,b5),b5+=cb;for(var b3=1,b2=b6.length;b2>b3;b3++){b7=b9.slice(b6[b3-1],b6[b3]).join(" "),"center"===bE(ch).css("textAlign")&&(b4=ce+(cc-cg.measureText(b7).width)/2-bK),cg.fillText(b7,b4,b5),b5+=cb}b7=b9.slice(b6[b3-1],b9.length).join(" "),"center"===bE(ch).css("textAlign")&&(b4=ce+(cc-cg.measureText(b7).width)/2-bK),cg.fillText(b7,b4,b5)}}function bY(cb,ca,b9){var b8=cb.tagName.toLowerCase(),b7=bE(cb).position(),b6=window.getComputedStyle?window.getComputedStyle(cb,""):cb.currentStyle,b5=ca+b7.left+parseInt(b6.marginLeft,10)+parseInt(b6.borderLeftWidth,10)+parseInt(b6.paddingLeft,10),b4=b9+b7.top+parseInt(b6.marginTop,10)+parseInt(b6.borderTopWidth,10)+parseInt(b6.paddingTop,10),b3=bQ.width;if("div"!=b8&&"span"!=b8||bE(cb).hasClass("jqplot-highlighter-tooltip")){if("table"===b8&&bE(cb).hasClass("jqplot-table-legend")){bG.strokeStyle=bE(cb).css("border-top-color"),bG.fillStyle=bE(cb).css("background-color"),bG.fillRect(b5,b4,bE(cb).innerWidth(),bE(cb).innerHeight()),parseInt(bE(cb).css("border-top-width"),10)>0&&bG.strokeRect(b5,b4,bE(cb).innerWidth(),bE(cb).innerHeight()),bE(cb).find("div.jqplot-table-legend-swatch-outline").each(function(){var cc=bE(this);bG.strokeStyle=cc.css("border-top-color");var ch=b5+cc.position().left,cg=b4+cc.position().top;bG.strokeRect(ch,cg,cc.innerWidth(),cc.innerHeight()),ch+=parseInt(cc.css("padding-left"),10),cg+=parseInt(cc.css("padding-top"),10);var cf=cc.innerHeight()-2*parseInt(cc.css("padding-top"),10),ce=cc.innerWidth()-2*parseInt(cc.css("padding-left"),10),cd=cc.children("div.jqplot-table-legend-swatch");bG.fillStyle=cd.css("background-color"),bG.fillRect(ch,cg,ce,cf)}),bE(cb).find("td.jqplot-table-legend-label").each(function(){var cc=bE(this),ce=b5+cc.position().left,cd=b4+cc.position().top+parseInt(cc.css("padding-top"),10);bG.font=cc.jqplotGetComputedFontStyle(),bG.fillStyle=cc.css("color"),bZ(cc,bG,cc.text(),ce,cd,b3)})}else{"canvas"==b8&&bG.drawImage(cb,b5,b4)}}else{bE(cb).children().each(function(){bY(this,b5,b4)});var b2=bE(cb).jqplotChildText();b2&&(bG.font=bE(cb).jqplotGetComputedFontStyle(),bG.fillStyle=bE(cb).css("color"),bZ(cb,bG,b2,b5,b4,b3))}}b1=b1||{};var bX=null==b1.x_offset?0:b1.x_offset,bW=null==b1.y_offset?0:b1.y_offset,bV=null==b1.backgroundColor?"rgb(255,255,255)":b1.backgroundColor;if(0==bE(this).width()||0==bE(this).height()){return null}if(bE.jqplot.use_excanvas){return null}for(var bU,bT,bS,bR,bQ=document.createElement("canvas"),bP=bE(this).outerHeight(!0),bO=bE(this).outerWidth(!0),bN=bE(this).offset(),bM=bN.left,bL=bN.top,bK=0,bJ=0,bI=["jqplot-table-legend","jqplot-xaxis-tick","jqplot-x2axis-tick","jqplot-yaxis-tick","jqplot-y2axis-tick","jqplot-y3axis-tick","jqplot-y4axis-tick","jqplot-y5axis-tick","jqplot-y6axis-tick","jqplot-y7axis-tick","jqplot-y8axis-tick","jqplot-y9axis-tick","jqplot-xaxis-label","jqplot-x2axis-label","jqplot-yaxis-label","jqplot-y2axis-label","jqplot-y3axis-label","jqplot-y4axis-label","jqplot-y5axis-label","jqplot-y6axis-label","jqplot-y7axis-label","jqplot-y8axis-label","jqplot-y9axis-label"],bH=0;bH<bI.length;bH++){bE(this).find("."+bI[bH]).each(function(){bU=bE(this).offset().top-bL,bT=bE(this).offset().left-bM,bR=bT+bE(this).outerWidth(!0)+bK,bS=bU+bE(this).outerHeight(!0)+bJ,-bK>bT&&(bO=bO-bK-bT,bK=-bT),-bJ>bU&&(bP=bP-bJ-bU,bJ=-bU),bR>bO&&(bO=bR),bS>bP&&(bP=bS)})}bQ.width=bO+Number(bX),bQ.height=bP+Number(bW);var bG=bQ.getContext("2d");return bG.save(),bG.fillStyle=bV,bG.fillRect(0,0,bQ.width,bQ.height),bG.restore(),bG.translate(bK,bJ),bG.textAlign="left",bG.textBaseline="top",bE(this).children().each(function(){bY(this,bX,bW)}),bQ},bE.fn.jqplotToImageStr=function(bG){var bH=bE(this).jqplotToImageCanvas(bG);return bH?bH.toDataURL("image/png"):null},bE.fn.jqplotToImageElem=function(bG){var bI=document.createElement("img"),bH=bE(this).jqplotToImageStr(bG);return bI.src=bH,bI},bE.fn.jqplotToImageElemStr=function(bG){var bH="<img src="+bE(this).jqplotToImageStr(bG)+" />";return bH},bE.fn.jqplotSaveImage=function(){var bG=bE(this).jqplotToImageStr({});bG&&(window.location.href=bG.replace("image/png","image/octet-stream"))},bE.fn.jqplotViewImage=function(){var bG=bE(this).jqplotToImageElemStr({});bE(this).jqplotToImageStr({});if(bG){var bH=window.open("");bH.document.open("image/png"),bH.document.write(bG),bH.document.close(),bH=null}};var aV=function(){switch(this.syntax=aV.config.syntax,this._type="jsDate",this.proxy=new Date,this.options={},this.locale=aV.regional.getLocale(),this.formatString="",this.defaultCentury=aV.config.defaultCentury,arguments.length){case 0:break;case 1:if("[object Object]"==ba(arguments[0])&&"jsDate"!=arguments[0]._type){var bH=this.options=arguments[0];this.syntax=bH.syntax||this.syntax,this.defaultCentury=bH.defaultCentury||this.defaultCentury,this.proxy=aV.createDate(bH.date)}else{this.proxy=aV.createDate(arguments[0])}break;default:for(var bG=[],bI=0;bI<arguments.length;bI++){bG.push(arguments[bI])}this.proxy=new Date,this.proxy.setFullYear.apply(this.proxy,bG.slice(0,3)),bG.slice(3).length&&this.proxy.setHours.apply(this.proxy,bG.slice(3))}};aV.config={defaultLocale:"en",syntax:"perl",defaultCentury:1900},aV.prototype.add=function(bH,bG){var bI=aS[bG]||aS.day;return"number"==typeof bI?this.proxy.setTime(this.proxy.getTime()+bI*bH):bI.add(this,bH),this},aV.prototype.clone=function(){return new aV(this.proxy.getTime())},aV.prototype.getUtcOffset=function(){return 60000*this.proxy.getTimezoneOffset()},aV.prototype.diff=function(bH,bG,bK){if(bH=new aV(bH),null===bH){return null}var bJ=aS[bG]||aS.day;if("number"==typeof bJ){var bI=(this.proxy.getTime()-bH.proxy.getTime())/bJ}else{var bI=bJ.diff(this.proxy,bH.proxy)}return bK?bI:Math[bI>0?"floor":"ceil"](bI)},aV.prototype.getAbbrDayName=function(){return aV.regional[this.locale].dayNamesShort[this.proxy.getDay()]},aV.prototype.getAbbrMonthName=function(){return aV.regional[this.locale].monthNamesShort[this.proxy.getMonth()]},aV.prototype.getAMPM=function(){return this.proxy.getHours()>=12?"PM":"AM"},aV.prototype.getAmPm=function(){return this.proxy.getHours()>=12?"pm":"am"},aV.prototype.getCentury=function(){return parseInt(this.proxy.getFullYear()/100,10)},aV.prototype.getDate=function(){return this.proxy.getDate()},aV.prototype.getDay=function(){return this.proxy.getDay()},aV.prototype.getDayOfWeek=function(){var bG=this.proxy.getDay();return 0===bG?7:bG},aV.prototype.getDayOfYear=function(){var bH=this.proxy,bG=bH-new Date(""+bH.getFullYear()+"/1/1 GMT");return bG+=60000*bH.getTimezoneOffset(),bH=null,parseInt(bG/60000/60/24,10)+1},aV.prototype.getDayName=function(){return aV.regional[this.locale].dayNames[this.proxy.getDay()]},aV.prototype.getFullWeekOfYear=function(){var bH=this.proxy,bG=this.getDayOfYear(),bJ=6-bH.getDay(),bI=parseInt((bG+bJ)/7,10);return bI},aV.prototype.getFullYear=function(){return this.proxy.getFullYear()},aV.prototype.getGmtOffset=function(){var bH=this.proxy.getTimezoneOffset()/60,bG=0>bH?"+":"-";return bH=Math.abs(bH),bG+aT(Math.floor(bH),2)+":"+aT(bH%1*60,2)},aV.prototype.getHours=function(){return this.proxy.getHours()},aV.prototype.getHours12=function(){var bG=this.proxy.getHours();return bG>12?bG-12:0==bG?12:bG},aV.prototype.getIsoWeek=function(){var bH=this.proxy,bG=this.getWeekOfYear(),bJ=new Date(""+bH.getFullYear()+"/1/1").getDay(),bI=bG+(bJ>4||1>=bJ?0:1);return 53==bI&&new Date(""+bH.getFullYear()+"/12/31").getDay()<4?bI=1:0===bI&&(bH=new aV(new Date(""+(bH.getFullYear()-1)+"/12/31")),bI=bH.getIsoWeek()),bH=null,bI},aV.prototype.getMilliseconds=function(){return this.proxy.getMilliseconds()},aV.prototype.getMinutes=function(){return this.proxy.getMinutes()},aV.prototype.getMonth=function(){return this.proxy.getMonth()},aV.prototype.getMonthName=function(){return aV.regional[this.locale].monthNames[this.proxy.getMonth()]},aV.prototype.getMonthNumber=function(){return this.proxy.getMonth()+1},aV.prototype.getSeconds=function(){return this.proxy.getSeconds()},aV.prototype.getShortYear=function(){return this.proxy.getYear()%100},aV.prototype.getTime=function(){return this.proxy.getTime()},aV.prototype.getTimezoneAbbr=function(){return this.proxy.toString().replace(/^.*\(([^)]+)\)$/,"$1")},aV.prototype.getTimezoneName=function(){var bG=/(?:\((.+)\)$| ([A-Z]{3}) )/.exec(this.toString());return bG[1]||bG[2]||"GMT"+this.getGmtOffset()},aV.prototype.getTimezoneOffset=function(){return this.proxy.getTimezoneOffset()},aV.prototype.getWeekOfYear=function(){var bH=this.getDayOfYear(),bG=7-this.getDayOfWeek(),bI=parseInt((bH+bG)/7,10);return bI},aV.prototype.getUnix=function(){return Math.round(this.proxy.getTime()/1000,0)},aV.prototype.getYear=function(){return this.proxy.getYear()},aV.prototype.next=function(bG){return bG=bG||"day",this.clone().add(1,bG)},aV.prototype.set=function(){switch(arguments.length){case 0:this.proxy=new Date;break;case 1:if("[object Object]"==ba(arguments[0])&&"jsDate"!=arguments[0]._type){var bH=this.options=arguments[0];this.syntax=bH.syntax||this.syntax,this.defaultCentury=bH.defaultCentury||this.defaultCentury,this.proxy=aV.createDate(bH.date)}else{this.proxy=aV.createDate(arguments[0])}break;default:for(var bG=[],bI=0;bI<arguments.length;bI++){bG.push(arguments[bI])}this.proxy=new Date,this.proxy.setFullYear.apply(this.proxy,bG.slice(0,3)),bG.slice(3).length&&this.proxy.setHours.apply(this.proxy,bG.slice(3))}return this},aV.prototype.setDate=function(bG){return this.proxy.setDate(bG),this},aV.prototype.setFullYear=function(){return this.proxy.setFullYear.apply(this.proxy,arguments),this},aV.prototype.setHours=function(){return this.proxy.setHours.apply(this.proxy,arguments),this},aV.prototype.setMilliseconds=function(bG){return this.proxy.setMilliseconds(bG),this},aV.prototype.setMinutes=function(){return this.proxy.setMinutes.apply(this.proxy,arguments),this},aV.prototype.setMonth=function(){return this.proxy.setMonth.apply(this.proxy,arguments),this},aV.prototype.setSeconds=function(){return this.proxy.setSeconds.apply(this.proxy,arguments),this},aV.prototype.setTime=function(bG){return this.proxy.setTime(bG),this},aV.prototype.setYear=function(){return this.proxy.setYear.apply(this.proxy,arguments),this},aV.prototype.strftime=function(bG){return bG=bG||this.formatString||aV.regional[this.locale].formatString,aV.strftime(this,bG,this.syntax)},aV.prototype.toString=function(){return this.proxy.toString()},aV.prototype.toYmdInt=function(){return 10000*this.proxy.getFullYear()+100*this.getMonthNumber()+this.proxy.getDate()},aV.regional={en:{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],formatString:"%Y-%m-%d %H:%M:%S"},fr:{monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],formatString:"%Y-%m-%d %H:%M:%S"},de:{monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],formatString:"%Y-%m-%d %H:%M:%S"},es:{monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],dayNamesShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},ru:{monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],formatString:"%Y-%m-%d %H:%M:%S"},ar:{monthNames:["كانون الثاني","شباط","آذار","نيسان","آذار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["السبت","الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة"],dayNamesShort:["سبت","أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة"],formatString:"%Y-%m-%d %H:%M:%S"},pt:{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},"pt-BR":{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},pl:{monthNames:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthNamesShort:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"],dayNames:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],dayNamesShort:["Ni","Pn","Wt","Śr","Cz","Pt","Sb"],formatString:"%Y-%m-%d %H:%M:%S"},nl:{monthNames:["Januari","Februari","Maart","April","Mei","Juni","July","Augustus","September","Oktober","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:",".Zaterdag,dayNamesShort:["Zo","Ma","Di","Wo","Do","Vr","Za"],formatString:"%Y-%m-%d %H:%M:%S"},sv:{monthNames:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],monthNamesShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayNames:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],dayNamesShort:["sön","mån","tis","ons","tor","fre","lör"],formatString:"%Y-%m-%d %H:%M:%S"},it:{monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Lunedi","Martedi","Mercoledi","Giovedi","Venerdi","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],formatString:"%d-%m-%Y %H:%M:%S"}},aV.regional["en-US"]=aV.regional["en-GB"]=aV.regional.en,aV.regional.getLocale=function(){var bG=aV.config.defaultLocale;return document&&document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang&&(bG=document.getElementsByTagName("html")[0].lang,aV.regional.hasOwnProperty(bG)||(bG=aV.config.defaultLocale)),bG};var aU=86400000,aT=function(bH,bG){bH=String(bH);var bJ=bG-bH.length,bI=String(Math.pow(10,bJ)).slice(1);return bI.concat(bH)},aS={millisecond:1,second:1000,minute:60000,hour:3600000,day:aU,week:7*aU,month:{add:function(bH,bG){aS.year.add(bH,Math[bG>0?"floor":"ceil"](bG/12));var bI=bH.getMonth()+bG%12;12==bI?(bI=0,bH.setYear(bH.getFullYear()+1)):-1==bI&&(bI=11,bH.setYear(bH.getFullYear()-1)),bH.setMonth(bI)},diff:function(bH,bG){var bK=bH.getFullYear()-bG.getFullYear(),bJ=bH.getMonth()-bG.getMonth()+12*bK,bI=bH.getDate()-bG.getDate();return bJ+bI/30}},year:{add:function(bH,bG){bH.setYear(bH.getFullYear()+Math[bG>0?"floor":"ceil"](bG))},diff:function(bH,bG){return aS.month.diff(bH,bG)/12}}};for(var aR in aS){"s"!=aR.substring(aR.length-1)&&(aS[aR+"s"]=aS[aR])}var aQ=function(bH,bG,bK){if(aV.formats[bK].shortcuts[bG]){return aV.strftime(bH,aV.formats[bK].shortcuts[bG],bK)}var bJ=(aV.formats[bK].codes[bG]||"").split("."),bI=bH["get"+bJ[0]]?bH["get"+bJ[0]]():"";return bJ[1]&&(bI=aT(bI,bJ[1])),bI};aV.strftime=function(bO,bN,bM,bL){var bK="perl",bJ=aV.regional.getLocale();bM&&aV.formats.hasOwnProperty(bM)?bK=bM:bM&&aV.regional.hasOwnProperty(bM)&&(bJ=bM),bL&&aV.formats.hasOwnProperty(bL)?bK=bL:bL&&aV.regional.hasOwnProperty(bL)&&(bJ=bL),("[object Object]"!=ba(bO)||"jsDate"!=bO._type)&&(bO=new aV(bO),bO.locale=bJ),bN||(bN=bO.formatString||aV.regional[bJ].formatString);for(var bI,bH=bN||"%Y-%m-%d",bG="";bH.length>0;){(bI=bH.match(aV.formats[bK].codes.matcher))?(bG+=bH.slice(0,bI.index),bG+=(bI[1]||"")+aQ(bO,bI[2],bK),bH=bH.slice(bI.index+bI[0].length)):(bG+=bH,bH="")}return bG},aV.formats={ISO:"%Y-%m-%dT%H:%M:%S.%N%G",SQL:"%Y-%m-%d %H:%M:%S"},aV.formats.perl={codes:{matcher:/()%(#?(%|[a-z]))/i,Y:"FullYear",y:"ShortYear.2",m:"MonthNumber.2","#m":"MonthNumber",B:"MonthName",b:"AbbrMonthName",d:"Date.2","#d":"Date",e:"Date",A:"DayName",a:"AbbrDayName",w:"Day",H:"Hours.2","#H":"Hours",I:"Hours12.2","#I":"Hours12",p:"AMPM",M:"Minutes.2","#M":"Minutes",S:"Seconds.2","#S":"Seconds",s:"Unix",N:"Milliseconds.3","#N":"Milliseconds",O:"TimezoneOffset",Z:"TimezoneName",G:"GmtOffset"},shortcuts:{F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",D:"%m/%d/%y","#c":"%a %b %e %H:%M:%S %Y",v:"%e-%b-%Y",R:"%H:%M",r:"%I:%M:%S %p",t:"	",n:"\n","%":"%"}},aV.formats.php={codes:{matcher:/()%((%|[a-z]))/i,a:"AbbrDayName",A:"DayName",d:"Date.2",e:"Date",j:"DayOfYear.3",u:"DayOfWeek",w:"Day",U:"FullWeekOfYear.2",V:"IsoWeek.2",W:"WeekOfYear.2",b:"AbbrMonthName",B:"MonthName",m:"MonthNumber.2",h:"AbbrMonthName",C:"Century.2",y:"ShortYear.2",Y:"FullYear",H:"Hours.2",I:"Hours12.2",l:"Hours12",p:"AMPM",P:"AmPm",M:"Minutes.2",S:"Seconds.2",s:"Unix",O:"TimezoneOffset",z:"GmtOffset",Z:"TimezoneAbbr"},shortcuts:{D:"%m/%d/%y",F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",R:"%H:%M",r:"%I:%M:%S %p",t:"	",n:"\n","%":"%"}},aV.createDate=function(bR){function bQ(b1,b0){var bZ,bY,bX,bW,bV=parseFloat(b0[1]),bU=parseFloat(b0[2]),bT=parseFloat(b0[3]),bS=aV.config.defaultCentury;return bV>31?(bY=bT,bX=bU,bZ=bS+bV):(bY=bU,bX=bV,bZ=bS+bT),bW=bX+"/"+bY+"/"+bZ,b1.replace(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})/,bW)}if(null==bR){return new Date}if(bR instanceof Date){return bR}if("number"==typeof bR){return new Date(bR)}var bP=String(bR).replace(/^\s*(.+)\s*$/g,"$1");bP=bP.replace(/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,4})/,"$1/$2/$3"),bP=bP.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{4})/i,"$1 $2 $3");var bO=bP.match(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i);if(bO&&bO.length>3){var bN=parseFloat(bO[3]),bM=aV.config.defaultCentury+bN;bM=String(bM),bP=bP.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i,bO[1]+" "+bO[2]+" "+bM)}bO=bP.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})[^0-9]/),bO&&bO.length>3&&(bP=bQ(bP,bO));var bO=bP.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})$/);bO&&bO.length>3&&(bP=bQ(bP,bO));for(var bL,bK,bJ,bI=0,bH=aV.matchers.length,bG=bP;bH>bI;){if(bK=Date.parse(bG),!isNaN(bK)){return new Date(bK)}if(bL=aV.matchers[bI],"function"==typeof bL){if(bJ=bL.call(aV,bG),bJ instanceof Date){return bJ}}else{bG=bP.replace(bL[0],bL[1])}bI++}return NaN},aV.daysInMonth=function(bH,bG){return 2==bG?29==new Date(bH,1,29).getDate()?29:28:[a8,31,a8,31,30,31,30,31,31,30,31,30,31][bG]},aV.matchers=[[/(3[01]|[0-2]\d)\s*\.\s*(1[0-2]|0\d)\s*\.\s*([1-9]\d{3})/,"$2/$1/$3"],[/([1-9]\d{3})\s*-\s*(1[0-2]|0\d)\s*-\s*(3[01]|[0-2]\d)/,"$2/$3/$1"],function(bH){var bG=bH.match(/^(?:(.+)\s+)?([012]?\d)(?:\s*\:\s*(\d\d))?(?:\s*\:\s*(\d\d(\.\d*)?))?\s*(am|pm)?\s*$/i);if(bG){if(bG[1]){var bJ=this.createDate(bG[1]);if(isNaN(bJ)){return}}else{var bJ=new Date;bJ.setMilliseconds(0)}var bI=parseFloat(bG[2]);return bG[6]&&(bI="am"==bG[6].toLowerCase()?12==bI?0:bI:12==bI?12:bI+12),bJ.setHours(bI,parseInt(bG[3]||0,10),parseInt(bG[4]||0,10),1000*(parseFloat(bG[5]||0)||0)),bJ}return bH},function(bH){var bG=bH.match(/^(?:(.+))[T|\s+]([012]\d)(?:\:(\d\d))(?:\:(\d\d))(?:\.\d+)([\+\-]\d\d\:\d\d)$/i);if(bG){if(bG[1]){var bJ=this.createDate(bG[1]);if(isNaN(bJ)){return}}else{var bJ=new Date;bJ.setMilliseconds(0)}var bI=parseFloat(bG[2]);return bJ.setHours(bI,parseInt(bG[3],10),parseInt(bG[4],10),1000*parseFloat(bG[5])),bJ}return bH},function(bO){var bN=bO.match(/^([0-3]?\d)\s*[-\/.\s]{1}\s*([a-zA-Z]{3,9})\s*[-\/.\s]{1}\s*([0-3]?\d)$/);if(bN){var bM,bL,bK,bJ=new Date,bI=aV.config.defaultCentury,bH=parseFloat(bN[1]),bG=parseFloat(bN[3]);bH>31?(bL=bG,bM=bI+bH):(bL=bH,bM=bI+bG);var bK=bb(bN[2],aV.regional[aV.regional.getLocale()].monthNamesShort);return -1==bK&&(bK=bb(bN[2],aV.regional[aV.regional.getLocale()].monthNames)),bJ.setFullYear(bM,bK,bL),bJ.setHours(0,0,0,0),bJ}return bO}],bE.jsDate=aV,bE.jqplot.sprintf=function(){function bG(bP,bO,bS,bR){var bQ=bP.length>=bO?"":Array(1+bO-bP.length>>>0).join(bS);return bR?bP+bQ:bQ+bP}function bN(bO){for(var bQ=new String(bO),bP=10;bP>0&&bQ!=(bQ=bQ.replace(/^(\d+)(\d{3})/,"$1"+bE.jqplot.sprintf.thousandsSeparator+"$2"));bP--){}return bQ}function bM(bO,bV,bU,bT,bS,bR){var bQ=bT-bO.length;if(bQ>0){var bP=" ";bR&&(bP="&nbsp;"),bO=bU||!bS?bG(bO,bT,bP,bU):bO.slice(0,bV.length)+bG("",bQ,"0",!0)+bO.slice(bV.length)}return bO}function bL(bW,bV,bU,bT,bS,bR,bQ,bP){var bO=bW>>>0;return bU=bU&&bO&&{2:"0b",8:"0",16:"0x"}[bV]||"",bW=bU+bG(bO.toString(bV),bR||0,"0",!1),bM(bW,bU,bT,bS,bQ,bP)}function bK(bP,bO,bT,bS,bR,bQ){return null!=bS&&(bP=bP.slice(0,bS)),bM(bP,"",bO,bT,bR,bQ)}var bJ=arguments,bI=0,bH=bJ[bI++];return bH.replace(bE.jqplot.sprintf.regex,function(cc,cb,ca,b9,b8,b7,b6){if("%%"==cc){return"%"}for(var b5=!1,b3="",b1=!1,bZ=!1,bX=!1,bV=!1,bT=0;ca&&bT<ca.length;bT++){switch(ca.charAt(bT)){case" ":b3=" ";break;case"+":b3="+";break;case"-":b5=!0;break;case"0":b1=!0;break;case"#":bZ=!0;break;case"&":bX=!0;break;case"'":bV=!0}}if(b9=b9?"*"==b9?+bJ[bI++]:"*"==b9.charAt(0)?+bJ[b9.slice(1,-1)]:+b9:0,0>b9&&(b9=-b9,b5=!0),!isFinite(b9)){throw new Error("$.jqplot.sprintf: (minimum-)width must be finite")}b7=b7?"*"==b7?+bJ[bI++]:"*"==b7.charAt(0)?+bJ[b7.slice(1,-1)]:+b7:"fFeE".indexOf(b6)>-1?6:"d"==b6?0:void 0;var bR=cb?bJ[cb.slice(0,-1)]:bJ[bI++];switch(b6){case"s":return null==bR?"":bK(String(bR),b5,b9,b7,b1,bX);case"c":return bK(String.fromCharCode(+bR),b5,b9,b7,b1,bX);case"b":return bL(bR,2,bZ,b5,b9,b7,b1,bX);case"o":return bL(bR,8,bZ,b5,b9,b7,b1,bX);case"x":return bL(bR,16,bZ,b5,b9,b7,b1,bX);case"X":return bL(bR,16,bZ,b5,b9,b7,b1,bX).toUpperCase();case"u":return bL(bR,10,bZ,b5,b9,b7,b1,bX);case"i":var bQ=parseInt(+bR,10);if(isNaN(bQ)){return""}var bP=0>bQ?"-":b3,bO=bV?bN(String(Math.abs(bQ))):String(Math.abs(bQ));return bR=bP+bG(bO,b7,"0",!1),bM(bR,bP,b5,b9,b1,bX);case"d":var bQ=Math.round(+bR);if(isNaN(bQ)){return""}var bP=0>bQ?"-":b3,bO=bV?bN(String(Math.abs(bQ))):String(Math.abs(bQ));return bR=bP+bG(bO,b7,"0",!1),bM(bR,bP,b5,b9,b1,bX);case"e":case"E":case"f":case"F":case"g":case"G":var bQ=+bR;if(isNaN(bQ)){return""}var bP=0>bQ?"-":b3,b4=["toExponential","toFixed","toPrecision"]["efg".indexOf(b6.toLowerCase())],b2=["toString","toUpperCase"]["eEfFgG".indexOf(b6)%2],bO=Math.abs(bQ)[b4](b7),b0=bO.toString().split(".");b0[0]=bV?bN(b0[0]):b0[0],bO=b0.join(bE.jqplot.sprintf.decimalMark),bR=bP+bO;var bY=bM(bR,bP,b5,b9,b1,bX)[b2]();return bY;case"p":case"P":var bQ=+bR;if(isNaN(bQ)){return""}var bP=0>bQ?"-":b3,b0=String(Number(Math.abs(bQ)).toExponential()).split(/e|E/),bW=-1!=b0[0].indexOf(".")?b0[0].length-1:String(bQ).length,bU=b0[1]<0?-b0[1]-1:0;if(Math.abs(bQ)<1){bR=b7>=bW+bU?bP+Math.abs(bQ).toPrecision(bW):b7-1>=bW?bP+Math.abs(bQ).toExponential(bW-1):bP+Math.abs(bQ).toExponential(b7-1)}else{var bS=b7>=bW?bW:b7;bR=bP+Math.abs(bQ).toPrecision(bS)}var b2=["toString","toUpperCase"]["pP".indexOf(b6)%2];return bM(bR,bP,b5,b9,b1,bX)[b2]();case"n":return"";default:return cc}})},bE.jqplot.sprintf.thousandsSeparator=",",bE.jqplot.sprintf.decimalMark=".",bE.jqplot.sprintf.regex=/%%|%(\d+\$)?([-+#0&\' ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([nAscboxXuidfegpEGP])/g,bE.jqplot.getSignificantFigures=function(bH){var bG=String(Number(Math.abs(bH)).toExponential()).split(/e|E/),bM=-1!=bG[0].indexOf(".")?bG[0].length-1:bG[0].length,bL=bG[1]<0?-bG[1]-1:0,bK=parseInt(bG[1],10),bJ=bK+1>0?bK+1:0,bI=bJ>=bM?0:bM-bK-1;return{significantDigits:bM,digitsLeft:bJ,digitsRight:bI,zeros:bL,exponent:bK}},bE.jqplot.getPrecision=function(bG){return bE.jqplot.getSignificantFigures(bG).digitsRight};var aP=bE.uiBackCompat!==!1;bE.jqplot.effects={effect:{}};var aO="jqplot.storage.";bE.extend(bE.jqplot.effects,{version:"1.9pre",save:function(bH,bG){for(var bI=0;bI<bG.length;bI++){null!==bG[bI]&&bH.data(aO+bG[bI],bH[0].style[bG[bI]])}},restore:function(bH,bG){for(var bI=0;bI<bG.length;bI++){null!==bG[bI]&&bH.css(bG[bI],bH.data(aO+bG[bI]))}},setMode:function(bH,bG){return"toggle"===bG&&(bG=bH.is(":hidden")?"show":"hide"),bG},createWrapper:function(bG){if(bG.parent().is(".ui-effects-wrapper")){return bG.parent()}var bK={width:bG.outerWidth(!0),height:bG.outerHeight(!0),"float":bG.css("float")},bJ=bE("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),bI={width:bG.width(),height:bG.height()},bH=document.activeElement;return bG.wrap(bJ),(bG[0]===bH||bE.contains(bG[0],bH))&&bE(bH).focus(),bJ=bG.parent(),"static"===bG.css("position")?(bJ.css({position:"relative"}),bG.css({position:"relative"})):(bE.extend(bK,{position:bG.css("position"),zIndex:bG.css("z-index")}),bE.each(["top","left","bottom","right"],function(bL,bM){bK[bM]=bG.css(bM),isNaN(parseInt(bK[bM],10))&&(bK[bM]="auto")}),bG.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),bG.css(bI),bJ.css(bK).show()},removeWrapper:function(bG){var bH=document.activeElement;return bG.parent().is(".ui-effects-wrapper")&&(bG.parent().replaceWith(bG),(bG[0]===bH||bE.contains(bG[0],bH))&&bE(bH).focus()),bG}}),bE.fn.extend({jqplotEffect:function(bP,bO,bN,bM){function bL(bQ){function bU(){bE.isFunction(bS)&&bS.call(bT[0]),bE.isFunction(bQ)&&bQ()}var bT=bE(this),bS=bK.complete,bR=bK.mode;(bT.is(":hidden")?"hide"===bR:"show"===bR)?bU():bH.call(bT[0],bK,bU)}var bK=a9.apply(this,arguments),bJ=bK.mode,bI=bK.queue,bH=bE.jqplot.effects.effect[bK.effect],bG=!bH&&aP&&bE.jqplot.effects[bK.effect];return bE.fx.off||!bH&&!bG?bJ?this[bJ](bK.duration,bK.complete):this.each(function(){bK.complete&&bK.complete.call(this)}):bH?bI===!1?this.each(bL):this.queue(bI||"fx",bL):bG.call(this,{options:bK,duration:bK.duration,callback:bK.complete,mode:bK.mode})}});var be=/up|down|vertical/,bF=/up|left|vertical|horizontal/;bE.jqplot.effects.effect.blind=function(bU,bT){var bS,bR,bQ,bP=bE(this),bO=["position","top","bottom","left","right","height","width"],bN=bE.jqplot.effects.setMode(bP,bU.mode||"hide"),bM=bU.direction||"up",bL=be.test(bM),bK=bL?"height":"width",bJ=bL?"top":"left",bI=bF.test(bM),bH={},bG="show"===bN;bP.parent().is(".ui-effects-wrapper")?bE.jqplot.effects.save(bP.parent(),bO):bE.jqplot.effects.save(bP,bO),bP.show(),bQ=parseInt(bP.css("top"),10),bS=bE.jqplot.effects.createWrapper(bP).css({overflow:"hidden"}),bR=bL?bS[bK]()+bQ:bS[bK](),bH[bK]=bG?String(bR):"0",bI||(bP.css(bL?"bottom":"right",0).css(bL?"top":"left","").css({position:"absolute"}),bH[bJ]=bG?"0":String(bR)),bG&&(bS.css(bK,0),bI||bS.css(bJ,bR)),bS.animate(bH,{duration:bU.duration,easing:bU.easing,queue:!1,complete:function(){"hide"===bN&&bP.hide(),bE.jqplot.effects.restore(bP,bO),bE.jqplot.effects.removeWrapper(bP),bT()}})}}(jQuery)

