// ==UserScript==
// @name         e-sim助手
// @namespace    esim
// @version      2.5.7.15-release
// @description  e-sim增强功能，本版本为功能测试版，使用中可能会出现问题，如果影响正常使用可以换回之前版本。
// @author       E-sim插件开发组
// @match        http://*.e-sim.org/*
// @match        https://*.e-sim.org/*
// @require      http://cdn.e-sim.org/js/jquery-1.8.3.min.js
// @grant        GM_setClipboard
// @grant        GM_addStyle
// @grant        unsafewindow
// ==/UserScript==

// 前排提醒：如果你发现网页显示有问题，请先自行尝试 Ctrl+F5 刷新，如果问题依旧再来向开发组求助
// 前排提醒：如果战场输出或补充体力时出现404错误，请删除cookies并重新登录（chrome可以进入 chrome://settings/siteData 搜索服务器名，点▶进去，除了本地存储和数据库存储外全删）
// 前排提醒：如果你需要在游戏内截图并分享给国外玩家，请先关闭esim插件再截图

// 招人：E-sim插件开发组长期招收程序设计、编写、测试、优化、女装人员，要求：是活人就行
// 插件开发群：462288323 ，各位大佬进来拿插件也行呀

// ChangeLog
// 2.5.7.*：修正已知bug：初次使用插件加载国家失败、战场页原打枪按钮未绑定插件功能；预置最近输出；新的战场消耗统计；快捷设置军令；
// 2.5.7版本：发送战况到discord；简单的自动攻击；战斗显示网络错误信息；战场页终止请求；战斗方国旗修正；特殊道具页快捷菜单；在线玩家页增强功能；装备属性刷新和升级提示；请求超时设定；一些细节改进；
// 2.5.6版本：删除语音闹钟功能；修正国旗问题（请不要再使用其他修正国旗错位插件）；预约战场；快捷站点；个人消耗统计；记录玩家暴击和免体buff；修正战场飞行结果判断问题；一些优化和改进；
// 2.5.5版本：紧凑式战场界面；战场列表筛选、复制战场信息、显示T5时间；分解确认；观战列表点击国家可以查看在线玩家；在线玩家详细信息；存储战场飞行设置；替换会员原观战框；
// 2.5.4版本：添加显示全部战场功能；添加战场消耗统计功能；战场飞行可以在原网页刷新攻击框；攻击返回404时切换协议；战场飞行显示机票数量；应对profile界面更改；一些优化和改进；更新jqplot
// 2.5.3版本：插件内所有后生成的国旗均使用新国旗样式；更改本地加成地区判断；添加对联盟成员国的显示；添加桌面通知战场提醒；给闹钟加音效（大文件会有延迟）；上调“直接使用医疗包”按钮位置；修正Kekistan的国家缩写；战场界面功能框下移；会员上移观战框；修正一些小问题；稍微更改界面；
// 2.5.2版本：修正非起义战的防守方本地加成地区；添加国旗选择列的清空和锁定功能；添加战场中无需确认使用医疗包的功能；战场页面修改网页标题
// 2.5.1版本：修正从2.4.8版本以来因页面样式更新导致的各种功能失效的问题；添加显示货币市场玩家国籍的功能；在战场推测观战玩家中添加根据联盟分类玩家的功能；添加隐藏首页左上角提醒框的功能
//------------2.4.8及之前版本开发者：c*******, z*****，之后版本均由E-sim插件开发组维护------------

var G=[];var aH=unsafeWindow.$.ajax;var M=$.ajax;unsafeWindow.$.ajax=function(){var aP=Array.prototype.slice.call(arguments);var aQ=aH.apply(this,aP);G.push(aQ);return aQ};$.ajax=function(){var aP=Array.prototype.slice.call(arguments);var aQ=M.apply(this,aP);G.push(aQ);return aQ};function Z(){$.each(G,function(aP,aQ){aQ.abort()});G=[]};!function(aP){"function"==typeof define&&define.amd?define(["jquery"],aP):"object"==typeof exports?aP(require("jquery")):aP(jQuery)}(function(aQ,aP){function aS(aU,aT,aW,aV){return !(aU.selector!=aT.selector||aU.context!=aT.context||aW&&aW.$lqguid!=aT.fn.$lqguid||aV&&aV.$lqguid!=aT.fn2.$lqguid)}aQ.extend(aQ.fn,{livequery:function(aT,aW){var aV,aU=this;return aQ.each(aR.queries,function(aX,aY){return aS(aU,aY,aT,aW)?(aV=aY)&&!1:void 0}),aV=aV||new aR(aU.selector,aU.context,aT,aW),aV.stopped=!1,aV.run(),aU},expire:function(aT,aV){var aU=this;return aQ.each(aR.queries,function(aW,aX){aS(aU,aX,aT,aV)&&!aU.stopped&&aR.stop(aX.id)}),aU}});var aR=aQ.livequery=function(aT,aX,aW,aV){var aU=this;return aU.selector=aT,aU.context=aX,aU.fn=aW,aU.fn2=aV,aU.elements=aQ([]),aU.stopped=!1,aU.id=aR.queries.push(aU)-1,aW.$lqguid=aW.$lqguid||aR.guid++,aV&&(aV.$lqguid=aV.$lqguid||aR.guid++),aU};aR.prototype={stop:function(){var aT=this;aT.stopped||(aT.fn2&&aT.elements.each(aT.fn2),aT.elements=aQ([]),aT.stopped=!0)},run:function(){var aT=this;if(!aT.stopped){var aX=aT.elements,aW=aQ(aT.selector,aT.context),aV=aW.not(aX),aU=aX.not(aW);aT.elements=aW,aV.each(aT.fn),aT.fn2&&aU.each(aT.fn2)}}},aQ.extend(aR,{guid:0,queries:[],queue:[],running:!1,timeout:null,registered:[],checkQueue:function(){if(aR.running&&aR.queue.length){for(var aT=aR.queue.length;aT--;){aR.queries[aR.queue.shift()].run()}}},pause:function(){aR.running=!1},play:function(){aR.running=!0,aR.run()},registerPlugin:function(){aQ.each(arguments,function(aT,aV){if(aQ.fn[aV]&&!(aQ.inArray(aV,aR.registered)>0)){var aU=aQ.fn[aV];aQ.fn[aV]=function(){var aW=aU.apply(this,arguments);return aR.run(),aW},aR.registered.push(aV)}})},run:function(aT){aT!==aP?aQ.inArray(aT,aR.queue)<0&&aR.queue.push(aT):aQ.each(aR.queries,function(aU){aQ.inArray(aU,aR.queue)<0&&aR.queue.push(aU)}),aR.timeout&&clearTimeout(aR.timeout),aR.timeout=setTimeout(aR.checkQueue,20)},stop:function(aT){aT!==aP?aR.queries[aT].stop():aQ.each(aR.queries,aR.prototype.stop)}}),aR.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove","html","prop","removeProp"),aQ(function(){aR.play()})});ax();function ax(){aP();function aQ(aR){var aU=[];for(var aT=0;aT<aR.length;aT++){aU.push(aS(aR[aT]))}return aU;function aS(a3){if(a3==""){return""}var a2="EsimHelper";if(a3==undefined||a3.length<8){return""}var a6="";for(var aZ=0;aZ<a2.length;aZ++){a6+=a2.charCodeAt(aZ).toString()}var a4=Math.floor(a6.length/5),aY=parseInt(a6.charAt(a4)+a6.charAt(a4*2)+a6.charAt(a4*3)+a6.charAt(a4*4)+a6.charAt(a4*5)),aW=Math.round(a2.length/2),a5=Math.pow(2,31)-1,a0=parseInt(a3.substring(a3.length-8,a3.length),16);a3=a3.substring(0,a3.length-8);a6+=a0;while(a6.length>10){a6=(parseInt(a6.substring(0,10))+parseInt(a6.substring(10,a6.length))).toString()}a6=(aY*a6+aW)%a5;var aV="",aX="";for(var aZ=0,a1=a3.length;aZ<a1;aZ+=2){aV=parseInt(parseInt(a3.substring(aZ,aZ+2),16)^Math.floor((a6/a5)*255));aX+=String.fromCharCode(aV);a6=(aY*a6+aW)%a5}return decodeURIComponent(aX)}}function aP(){if(location.pathname=="/maintenance.html"){setTimeout(function(){location.pathname="/index.html"},10000);return}var aU=[];var aR=aQ(aU);var aT=$("a[href^='profile.html']",$("#userAvatar")).attr("href");var aS=window.location.host.split(".")[0].toLowerCase()+aT.replace("profile.html?id=","");if($.inArray(aS,aR)>=0){return false}else{return r()}}}function r(){if($(".time").length!==2){console.log("未登录，e-sim助手停止运行");return}if($(".time:first").text().match(/-/g).length!=2){console.log("官方脚本还未执行，e-sim助手等待0.5秒");setTimeout(r,500);return}if($("#ehIcon2").length>0){console.log("已运行e-sim助手");return}aK();u();an();aN();y();ao();al();e();if(document.URL.search("html")!=-1){var aP=document.URL.match("/([a-zA-Z0-9]+).html")[1];document.title="e-Sim - "+location.host.split(".")[0]+" - "+aP;switch(aP){case"index":S();break;case"profile":var aQ=parseInt(document.URL.match("/profile.html[?]id=([0-9]+)")[1]);U(aQ,$("body"));N(aQ);break;case"citizensOnline":A();break;case"militaryUnitCompanies":case"companies":m();break;case"myMilitaryUnit":case"militaryUnit":ap();break;case"statistics":ae();break;case"storage":ag();break;case"monetaryMarket":q($("body"));ac();break;case"battle":W();break;case"battles":aG();break;case"battleStatistics":J();break;case"showEquipment":t();break;case"companyAllWorkers":az();break;default:console.log(aP);break}}else{S()}}function S(){var aP=$("#frontPagePushQuestion");if(aP.length>0){aP.hide()}}function e(){GM_addStyle(".xflagsSmall{display:inline-block;vertical-align:bottom;margin:1px!important;padding:0!important;} .xflagsMedium{display:inline-block;} .xflagsBig{display:inline-block;} ")}function w(aR){try{var aP=aR.split(" ")[1];return aP.substring(aP.indexOf("-")+1)}catch(aQ){return"未知"}}function b(){return parseInt($("#time2").text())}function aC(aT,aP){var aR=aP.split(":");var aQ=aT.split("-");var aS=new Date(aQ[2],parseInt(aQ[1])-1,aQ[0],aR[0],aR[1],aR[2],0);return Date.parse(aS)}function av(aQ,aR){var aP=b();if(aP-aQ<aR*1000){return false}return true}function aI(aP,aQ){if(aP&&"date" in aP){return av(aP.date,aQ)}return true}function aM(aP,aR){var aQ=JSON.parse(localStorage.getItem(aP));return aI(aQ,aR)}function ar(aP){aP.date=b()}function aj(aS){var aT=parseInt(aS/(24*3600*1000));aS-=aT*24*3600*1000;var aR=parseInt(aS/(3600*1000));aS-=aR*3600*1000;var aP=parseInt(aS/(60*1000));var aQ="";if(aT>0){aQ+=aT+"d"}if(aR>0){aQ+=aR+"h"}if(aP>0){aQ+=aP+"m"}return aQ?aQ:"0m"}function p(aS){var aT=parseInt(aS/(24*3600*1000));aS-=aT*24*3600*1000;var aR=parseInt(aS/(3600*1000));aS-=aR*3600*1000;var aP=parseInt(aS/(60*1000));var aQ="";if(aT>0){aQ=aT+"d"}else{if(aR>0){aQ=aR+"h"}else{if(aP>0){aQ=aP+"m"}else{aQ="0m"}}}return aQ}function aa(aW,aV,aR,aS,aQ){var aU=$("<input>",{type:"checkbox",id:aV});var aT=$("<label>",{"class":"checkboxlabel","for":aV,text:aR});var aP=localStorage.getItem(aS);if(aP===null){localStorage.setItem(aS,aQ);aU.attr("checked",aQ=="true")}else{aU.attr("checked",aP=="true")}aW.append(aU,aT);aU.click(function(){if(aU.is(":checked")){localStorage.setItem(aS,true)}else{localStorage.setItem(aS,false)}})}function g(aU,aY,aV,aP,aQ,aW){var aS=$("<p>",{style:"padding:3px; margin:3px",text:aY});var aT=$("<select>",{style:"padding:3px; margin:3px",id:aQ}).appendTo(aS);for(var aR=0;aR<aV.length;aR++){$("<option>",{value:aV[aR],text:aP[aR]}).appendTo(aT)}var aX=localStorage.getItem(aQ);if(aX===null){localStorage.setItem(aQ,aW);aT.val(aW)}else{aT.val(aX)}aU.append(aS);aT.change(function(){localStorage.setItem(aQ,aT.val())})}function Y(aT,aS,aR,aQ){var aU=$("<input>",{type:"text",id:aR,style:"vertical-align:5px;width:"+aS+"px;"}).appendTo(aT);var aP=localStorage.getItem(aR);if(aP===null){localStorage.setItem(aR,aQ);aU.val(aQ)}else{aU.val(aP)}aT.append(aU);aU.focus(function(){aU.css("background-color","#FFFFFF")});aU.blur(function(){if(aU.val()===""){aU.val(aQ)}aU.css("background-color","#79FF79");localStorage.setItem(aR,aU.val())})}function an(){config={};allies=JSON.parse(localStorage.getItem("allies"));enemies=JSON.parse(localStorage.getItem("enemies"));if(allies===null||enemies===null){allies=[];enemies=[]}coalitionMembers=JSON.parse(localStorage.getItem("coalitionMembers"));if(coalitionMembers===null){coalitionMembers=[]}currencyRatio=JSON.parse(localStorage.getItem("currencyRatio"));currencyRatio=currencyRatio===null?{}:currencyRatio;topCountryIds=JSON.parse(localStorage.getItem("topCountryIds"));topCountryIds=topCountryIds===null?[]:topCountryIds;var aY=$("<li>",{id:"ehIcon2"}).insertBefore($("#userAvatar"));var a9=$("<a>",{"data-dropdown":"contentDropEh",style:"padding:0 5px;",href:"#"}).appendTo(aY);var ba=$("<img>",{align:"absmiddle","class":"smallAvatar",style:"height:36px; width:36px;",src:"https://suna.e-sim.org:3000/avatars/140351_small"}).appendTo(a9);var aX=$("#contentDrop").clone().attr("id","contentDropEh").empty().insertBefore($("#contentDrop"));$("<b>",{text:"e-sim助手 版本 "+GM_info.script.version+" "}).appendTo(aX);$("<div>",{style:"text-align:left;line-height:30px;",text:"使用此脚本造成的一切后果（包括但不限于封号、经济损失）与作者无关"}).appendTo(aX);var a5=$("<table>",{id:"Eh2Config",style:"width:100%;"}).appendTo(aX);var aQ=$("<tr>",{style:"line-height:30px;"}).appendTo(a5);var aU;var a0=[["fetchCurrency","统计汇率 ","统计汇率和常用物资的价格",["currencyRatio","topCountryIds"],"扫描大国"],["fetchCitizen","统计玩家 ","估算玩家buff时间等",["citizenInfo","citizenPage","muInfo"],"扫描本页"]];for(var a3=0;a3<a0.length;++a3){aU=$("<td>",{style:"text-align:left; background-color:SlateGray;"}).appendTo(aQ);var aW=$("<label>",{"class":"checkboxlabel","for":a0[a3][0]+"Checkbox",text:a0[a3][1]}).appendTo(aU);var aZ=$("<input>",{id:a0[a3][0]+"Checkbox",type:"checkbox",style:"vertical-align:5px;",text:" "}).prependTo(aW);var aP=$("<button>",{id:a0[a3][0]+"ClearButton","class":"foundation-style",style:"padding:5px; margin:5px",target:a0[a3][3].join(" "),text:"清除"}).appendTo(aU);var a7=$("<button>",{id:a0[a3][0]+"Scan","class":"foundation-style",style:"padding:5px; margin:5px",text:a0[a3][4]}).appendTo(aU);aZ.click(function(){var bb=$(this).attr("id")+"Disabled";if($(this).is(":checked")){localStorage.removeItem(bb)}else{localStorage.setItem(bb,"1")}});if(localStorage.getItem(a0[a3][0]+"CheckboxDisabled")){config[a0[a3][0]+"Disabled"]=true;aZ.attr("checked",false)}else{config[a0[a3][0]+"Disabled"]=false;aZ.attr("checked",true)}aP.click(function(){var bb=$(this).attr("target").split(" ");for(var bc=0;bc<bb.length;++bc){console.log("清除",bb[bc]);localStorage.removeItem(bb[bc])}})}if(config.fetchCitizenDisabled){$("#fetchCitizenScan").hide()}else{$("#fetchCitizenScan").click(function(){$(this).attr("disabled",true);var bb=[];$("a[href*='profile.html'").each(function(){var be=parseInt($(this).attr("href").match(/profile\.html[?]id=([0-9]+)/)[1]);if($.inArray(be,bb)===-1){bb.push(be)}});var bd=bb.length;$(this).text("剩余"+bd+"个");function bc(be,bf){if(bf>=be.length){return}$.ajax({url:"profile.html?id="+be[bf],success:function(bg){if($(".time",bg).length!==2){console.log(be[bf],"抓取错误，重新抓取");$.ajax(this);return}else{U(be[bf],bg);$("#fetchCitizenScan").text("剩余"+(--bd)+"个");if(bd==0){$("#fetchCitizenScan").text("扫描完成")}else{setTimeout(function(){bc(be,bf+1)},200)}}},error:function(bg,bh){console.log("抓取错误 (",bh,")，重新抓取");$.ajax(this);return}})}bc(bb,0)})}a5=$("<table>",{style:"width:100%; text-align:left;"}).insertBefore($("#Eh2Config"));aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>",{id:"Eh2Homeland",text:"祖国: "}).appendTo(aQ);var a1=$("<select>",{style:"padding:3px; margin:3px",id:"Eh2HomelandSelect"}).appendTo(aU);for(var a3=0;a3<countryIds.length;++a3){$("<option>",{value:countryIds[a3],text:countryInfo[countryIds[a3]].name}).appendTo(a1)}var aS=$("option",a1).sort(function(bc,bb){return $(bc).text().localeCompare($(bb).text())});a1.html(aS);a1.change(a2);var a6=$("<button>",{id:"refreshAlliesAndEnemies","class":"foundation-style",style:"padding:5px; margin:5px",text:"更新盟国和敌国"}).appendTo(aU);a6.click(a2);aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>",{text:"盟国: "}).appendTo(aQ);var a8=$("<b>",{id:"Eh2Allies",text:"更新中..."}).appendTo(aU);aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>",{text:"敌国: "}).appendTo(aQ);a8=$("<b>",{id:"Eh2Enemies",text:"更新中..."}).appendTo(aU);aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>",{text:"联盟成员国: "}).appendTo(aQ);a8=$("<b>",{id:"Eh2CoalitionMembers",text:"更新中..."}).appendTo(aU);if(allies.length===0){a1[0].selectedIndex=0;a2()}else{a1.val(allies[0]);aR()}function a2(){var bb=parseInt(a1.val());a1.attr("disabled",true);a6.attr("disabled",true);$("~ div.xflagsSmall",a1).remove();$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bb].flagName,style:"vertical-align:middle;",value:bb,title:countryInfo[bb].name}).insertAfter(a1);console.log("正在更新"+countryInfo[bb].name+"的盟国和敌国信息");allies=[bb];enemies=[];coalitionMembers=[];$("#Eh2Allies").html("更新中...");$("#Eh2Enemies").html("更新中...");$("#Eh2CoalitionMembers").html("更新中...");$.ajax({url:"countryPoliticalStatistics.html?countryId="+bb,success:function(bh){var bg=$("div.xflagsMedium",$("table.dataTable:last",bh));bg.each(function(){var bj=$(this);var bi=bj.attr("class").split(" ").pop();bi=bi.substring(bi.indexOf("-")+1);allies.push(countryInfo[bi].id)});var be=$("div.xflagsMedium",$("table.dataTable:eq(-2)",bh));be.each(function(){var bj=$(this);var bi=w(bj.attr("class"));if(countryInfo[bi].id!==bb){enemies.push(countryInfo[bi].id)}});var bd=$("h2",bh);var bf;if(bd.length>4){bf=bd[2]}else{bf=bd[1]}if(bf.innerText.split(" ")[0]=="Coalition"){var bc=$(bf,bh).nextAll("div.xflagsSmall");bc.each(function(){var bi=$(this).attr("class").split(" ").pop();bi=bi.substring(bi.indexOf("-")+1);coalitionMembers.push(countryInfo[bi].id)})}localStorage.setItem("allies",JSON.stringify(allies));localStorage.setItem("enemies",JSON.stringify(enemies));localStorage.setItem("coalitionMembers",JSON.stringify(coalitionMembers));aR();a1.attr("disabled",false);a6.attr("disabled",false)},error:function(bc,bd){console.log("抓取错误 (",bd,")，重新抓取");$.ajax(this)}})}function aR(){$("~ div.xflagsSmall",a1).remove();$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[allies[0]].flagName,style:"vertical-align:middle;",value:allies[0],title:countryInfo[allies[0]].name}).insertAfter(a1);$("#Eh2Allies").text("");$("#Eh2Enemies").text("");$("#Eh2CoalitionMembers").text("");for(var bb=1;bb<allies.length;++bb){countryId=allies[bb];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2Allies"))}for(var bb=0;bb<enemies.length;++bb){countryId=enemies[bb];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2Enemies"))}for(var bb=0;bb<coalitionMembers.length;++bb){countryId=coalitionMembers[bb];$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[countryId].flagName,style:"vertical-align:middle;",title:countryInfo[countryId].name}).appendTo($("#Eh2CoalitionMembers"))}}if(config.fetchCurrencyDisabled){$("#fetchCurrencyScan").hide()}else{var a5=$("<table>",{id:"Eh2CurrencyRatios",style:"width:100%;"}).appendTo(aX);if(topCountryIds.length===0){console.log("查看人口和生产力前5的国家");$.ajax({url:"countryStatistics.html?statisticType=PRODUCTIVITY",success:function(bb){$("div.xflagsMedium:lt(5)",bb).each(function(){var bc=$(this).attr("class").split(" ").pop();bc=bc.substring(bc.indexOf("-")+1);topCountryIds.push(bc)});if(topCountryIds.length===10){aT()}},error:function(bb,bc){console.log("抓取错误 (",bc,")，重新抓取");$.ajax(this)}});$.ajax({url:"countryStatistics.html?statisticType=CITIZENS",success:function(bb){$("div.xflagsMedium:lt(5)",bb).each(function(){var bc=$(this).attr("class").split(" ").pop();bc=bc.substring(bc.indexOf("-")+1);topCountryIds.push(bc)});if(topCountryIds.length===10){aT()}},error:function(bb,bc){console.log(name,"抓取错误 (",bc,")，重新抓取");$.ajax(this)}})}else{aT()}}function aT(){if(config.fetchCurrencyDisabled){return}var bn=[parseInt($("#Eh2HomelandSelect").val())];for(var be=0;be<topCountryIds.length;++be){if(topCountryIds[be]&&countryInfo[topCountryIds[be]]){var bc=countryInfo[topCountryIds[be]].id;if($.inArray(bc,bn)===-1){bn.push(bc)}}}topCountryIds=bn;localStorage.setItem("topCountryIds",JSON.stringify(topCountryIds));a5=$("#Eh2CurrencyRatios");a5.empty();var bi=$("<tr>",{style:"line-height:30px;"}).appendTo(a5);var bb=$("<td>",{style:"background-color:DarkSlateGray;",text:"货币"}).appendTo(bi);var bd=$("<tr>",{style:"line-height:30px;"}).appendTo(a5);var bm=$("<td>",{style:"background-color:DarkSlateGray;",html:"买 1<div class='xflagsSmall xflagsSmall-Gold' style='vertical-align:middle;' />"}).appendTo(bd);var bh=$("<tr>",{style:"line-height:30px;"}).appendTo(a5);var bg=$("<td>",{style:"background-color:DarkSlateGray;",html:"卖 1<div class='xflagsSmall xflagsSmall-Gold' style='vertical-align:middle;' />"}).appendTo(bh);for(var be=0;be<topCountryIds.length;++be){var bk=topCountryIds[be];var bl=bb.clone().text("").insertAfter(bb);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bk].flagName,style:"vertical-align:middle;"}).appendTo(bl);bl=bm.clone().text("").insertAfter(bm);var bj=$("<a>",{href:"monetaryMarket.html?buyerCurrencyId=0&sellerCurrencyId="+bk,text:"???"}).appendTo(bl);if(currencyRatio[bk]!==undefined&&currencyRatio[bk].sell!==undefined){bj.html(""+parseFloat(currencyRatio[bk].sell.ratio).toFixed(2)).after($("<div>",{style:"font-size:10px;",text:p(b()-currencyRatio[bk].sell.date)}))}bl=bg.clone().text("").insertAfter(bg);bj=$("<a>",{href:"monetaryMarket.html?buyerCurrencyId="+bk+"&sellerCurrencyId=0",text:"???"}).appendTo(bl);if(currencyRatio[bk]!==undefined&&currencyRatio[bk].buy!==undefined){bj.html(""+parseFloat(currencyRatio[bk].buy.ratio).toFixed(2)).after($("<div>",{style:"font-size:10px;",text:p(b()-currencyRatio[bk].buy.date)}))}}var bf=$("#fetchCurrencyScan");bf.click(function(){var bp=$("a",$("#Eh2CurrencyRatios"));var bq=bp.length;$(this).attr("disabled",true).text("剩余"+bq+"个");function bo(bs,br){if(br>=bs.length){return}$.ajax({url:$(bs[br]).attr("href"),success:function(bt){if($(".time",bt).length!==2){console.log("汇率抓取错误，重新抓取");$.ajax(this);return}else{q(bt);bf.text("剩余"+(--bq)+"个");if(bq===0){$("#fetchCurrencyScan").text("扫描完成");aT()}else{setTimeout(function(){bo(bs,br+1)},200)}}},error:function(bt,bu){console.log("抓取错误 (",bu,")，重新抓取");$.ajax(this)}})}bo(bp,0)})}a5=$("<table>",{style:"width:100%; text-align:left;"}).insertBefore($("#Eh2Config"));aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>",{id:"FavoriteCountriesConfig"}).appendTo(aQ);var aV=$("<button>",{id:"clearFavoriteCountries","class":"foundation-style",style:"padding:5px; margin:5px",text:"清空国旗选择列"}).appendTo(aU);aV.click(function(){$(this).attr("disabled",true);localStorage.removeItem("favoriteCountries")});aa(aU,"lockFavoriteCountries","锁定国旗选择列","lockFavoriteCountries",false);aQ=$("<tr>",{style:"background-color:DarkSlateGray;line-height:30px;"}).appendTo(a5);aU=$("<td>").appendTo(aQ);var a4=$("<button>",{id:"btnBattleSettings","class":"foundation-style",style:"padding:5px; margin:5px",text:"战场设置"}).appendTo(aU);a4.click(function(){a4.attr({disabled:true});aL()});varEnableBattleAjaxTimeout=localStorage.getItem("enableBattleAjaxTimeout");if(varEnableBattleAjaxTimeout!="true"){varEnableBattleAjaxTimeout=false}else{varEnableBattleAjaxTimeout=true}varBattleAjaxTimeout=parseInt(localStorage.getItem("battleAjaxTimeout"));if(varBattleAjaxTimeout<0){varBattleAjaxTimeout=5}return}function ac(){var aR=$("table.dataTable:first");var aP=$("<div class='testDivblue'></div>");aR.before(aP);var aS=$("<table></table>");aP.append(aS);var aQ=$("<input type='button' id='gcbtn' value='检查卖家国籍'></input> ");aS.append(aQ);aS.append("检查需要等待一段时间");$("#gcbtn").click(function(){aP.remove();var aT=$("a.profileLink");aw(aT,1)})}function aw(aP,aR){if(aR>=aP.length){return}var aQ=$(aP[aR]).attr("href").split("=")[1];$.ajax({url:"apiCitizenById.html?id="+aQ,success:function(aT){var aU=JSON.parse(aT);console.log("用户",aQ,"API抓取成功");var aS=aU.citizenshipId;$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[aS].flagName,style:"vertical-align:middle;"}).insertBefore($(aP[aR]));setTimeout(function(){aw(aP,aR+1)},200)},error:function(aS,aT){console.log("用户",aQ,"API抓取错误 (",aT,")，重新抓取");$.ajax(this)}})}function n(aP){var aQ=new RegExp("(^|&)"+aP+"=([^&]*)(&|$)");var aR=window.location.search.substr(1).match(aQ);if(aR!=null){return unescape(aR[2])}return null}function ag(){var aP=n("storageType");if(aP=="EQUIPMENT"){am()}else{if(aP=="SPECIAL_ITEM"||aP=="SPECIAL_ITEMS"){aB();c()}}}function am(){var aP=$("#mergeItem");var aR=$("<input type='button' style='display:inline-block;' id='eeqbtn' value='自定义拍卖'></input> ");aR.prependTo(aP);$("#eeqbtn").click(function(){ah();$("#eeqbtn").attr({disabled:true});$("#eeqbtn").remove()});var aQ=$("<input type='button' style='display:inline-block;' id='eembtn' value='批量合成'></input> ");aQ.prependTo(aP);$("#eembtn").click(function(){ay();$("#eembtn").attr({disabled:true});$("#eembtn").remove()})}function ae(){var aP=n("selectedSite");if(aP=="MILITARY_UNIT"){B()}}function aK(){countryIds=JSON.parse(localStorage.getItem("countryIds"));countryInfo=JSON.parse(localStorage.getItem("countryInfo"));regionInfo=JSON.parse(localStorage.getItem("regionInfo"));muInfo=JSON.parse(localStorage.getItem("muInfo"))||{};var aV=[["apiCountries.html",3600*24],["apiRegions.html",3600*24],["apiMap.html",600]];var aQ=aV.length;for(var aU=0;aU<aV.length;++aU){var aT=aV[aU][0];var aW=aV[aU][1];var aS=localStorage.getItem(aT+".date");if(av(aS,aW)){aR(aT)}else{aQ--}}function aR(aX){$.ajax({url:aX,success:function(aY){localStorage.setItem(aX,aY);localStorage.setItem(aX+".date",b());console.log(aX,"抓取成功");if(--aQ===0){aP()}},error:function(aY,aZ){console.log(aX,"抓取错误 (",aZ,")，重新抓取",aX);$.ajax(this)}})}function aP(){countryInfo={};countryIds=[];var a1=JSON.parse(localStorage.getItem("apiCountries.html"));for(var a0=0;a0<a1.length;++a0){var aZ=a1[a0];aZ.flagName=aZ.name.replace(/ /g,"-");countryIds.push(aZ.id);countryInfo[aZ.id]=aZ;countryInfo[aZ.name]=aZ;countryInfo[aZ.shortName]=aZ;countryInfo[aZ.flagName]=aZ;countryInfo[aZ.currencyName]=aZ}regionInfo=[];var aY=JSON.parse(localStorage.getItem("apiMap.html"));var aX=JSON.parse(localStorage.getItem("apiRegions.html"));for(a0=0;a0<aY.length;++a0){regionInfo[aY[a0].regionId]=aY[a0]}for(a0=0;a0<aX.length;++a0){var a4=aX[a0].id;for(var a3 in aX[a0]){regionInfo[a4][a3]=aX[a0][a3]}}var a2={};for(var a0=0;a0<regionInfo.length;++a0){var aZ=regionInfo[a0];if(aZ){a2[aZ.id]=aZ;a2[aZ.name]=aZ}}localStorage.setItem("countryIds",JSON.stringify(countryIds));localStorage.setItem("countryInfo",JSON.stringify(countryInfo));localStorage.setItem("regionInfo",JSON.stringify(a2));localStorage.setItem("maxRegionCount",regionInfo.length);console.log("国家和地图信息已更新")}}function aN(){var aP=$("a[href^='profile.html']",$("#userAvatar")).attr("href");userId=parseInt(aP.replace("profile.html?id=",""));citizenInfo=JSON.parse(localStorage.getItem("citizenInfo"));if(citizenInfo===null){citizenInfo={}}citizenPage=JSON.parse(localStorage.getItem("citizenPage"));if(citizenPage===null){citizenPage={}}aF(userId);H(userId)}function z(aQ,aP){if(config.fetchCitizenDisabled&&aQ.id!==userId){return}if(aP===undefined){aP=true}console.log("玩家",aQ.id,"(",aQ.login,") API已更新");ar(aQ);citizenInfo[aQ.id]=aQ;if(aP){localStorage.setItem("citizenInfo",JSON.stringify(citizenInfo))}}function aF(aR,aQ){if(config.fetchCitizenDisabled&&aR!==userId){return}var aP=citizenInfo[aR];if(aP!==undefined&&!aI(aP,600)){return}$.ajax({url:"apiCitizenById.html?id="+aR,success:function(aS){var aT=JSON.parse(aS);z(aT,aQ)},error:function(aS,aT){console.log("用户",aR,"API抓取错误 (",aT,")，重新抓取");$.ajax(this)}})}function U(aS,aV,aR){if(config.fetchCitizenDisabled&&aS!==userId){return}if($("#indexShortcut",aV).length===0){return}if(aR===undefined){aR=true}console.log("玩家",aS,"(",$(".big-login",aV).text(),")页面已更新");page=citizenPage[aS];if(page===undefined){page={}}page.avatar=$(".bigAvatar",aV).attr("src").trim();page.premium=$("img[src$='star_32.png']",aV).length==1;page.buffIcons=[];$("img[src$='_positive.png']",aV).each(function(){if($(this).attr("class")!="smallhelp"){return true}if(page.buffIcons.indexOf(this)==-1){page.buffIcons.push($(this).attr("src"))}});page.debuffIcons=[];$("img[src$='_negative.png']",aV).each(function(){if($(this).attr("class")!="smallhelp"){return true}if(page.debuffIcons.indexOf(this)==-1){page.debuffIcons.push($(this).attr("src"))}});var aQ=b();var aX=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aW=[24,24,24,24,1,10,25,24,24,24];for(var aU=0;aU<aX.length;++aU){$.each(page.buffIcons,function(){if(this.indexOf(aX[aU])>0){aP(aX[aU],aQ-aW[aU]*3600*1000,aQ)}});$.each(page.debuffIcons,function(){if(this.indexOf(aX[aU])>0){if(page.premium){aP(aX[aU],aQ-aW[aU]*2*3600*1000,aQ-aW[aU]*3600*1000)}else{aP(aX[aU],aQ-aW[aU]*3*3600*1000,aQ-aW[aU]*3600*1000)}}});if(page[aX[aU]]===undefined){page[aX[aU]]=[aQ,aQ+1000*24*3600*1000]}}function aP(a1,a3,aZ){if(page[a1]===undefined){page[a1]=[a3,aZ]}else{var a2=page[a1][0]>a3?page[a1][0]:a3;var a0=page[a1][1]<aZ?page[a1][1]:aZ;if(a2>a0){page[a1]=[a3,aZ]}else{page[a1]=[a2,a0]}}}var aT=[];$(".equipmentBack",aV).each(function(){if($(this).attr("class").indexOf("rewardEQ")<0){aT.push($(this).attr("class").split(" ").pop())}});page.equipments=aT;var aY=$("div.rank :eq(0)",aV).parent().children("div.profile-row:eq(7)").children("span.data");if(aY.length!=0){page.lowHit=parseInt($("div#hitHelp",aV).text().split("/")[0].replace(",",""));page.highHit=parseInt($("div#hitHelp",aV).text().split("/")[1].replace(",",""));page.critical=parseFloat($("#criticalHelp",aV).text().trim().split(" ")[0]);page.miss=parseFloat($("#missHelp",aV).text().trim().split(" ")[0]);page.avoid=parseFloat($("#avoidHelp",aV).text().trim().split(" ")[0]);page.power=parseInt((page.lowHit+page.highHit)/2*(1-page.miss/100)*(1+page.critical/100)/(1-page.avoid/100)*37*5*1.2*1.2*1.2);page.strength=parseInt($("div.rank :eq(0)",aV).parent().children("div.profile-row:eq(4)").children("span.data").text());page.totalDamage=parseInt($("div.rank :eq(0)",aV).parent().children("div.profile-row:eq(2)").children("span.data").text().replace(/,/g,""))}ar(page);citizenPage[aS]=page;if(aR){localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}}function H(aR,aP,aS){if(config.fetchCitizenDisabled&&aR!==userId){return}var aQ=citizenPage[aR];if(aQ!==undefined&&!aI(aQ,600)){if(typeof(aS)==="function"){aS()}return}$.ajax({url:"profile.html?id="+aR,success:function(aT){U(aR,aT,aP);if(typeof(aS)==="function"){aS()}},error:function(aV,aW){var aT=(aR%10)*0.5+1;var aU=this;console.log("用户",aR,"页面抓取错误 (",aW,")，",aT,"秒后重新抓取");setTimeout(function(){$.ajax(aU)},aT*1000)}})}function I(aQ,aR){if(!muInfo[aQ]){muInfo[aQ]={}}var aP=muInfo[aQ];if(aI(aP.member,48*3600)){$.ajax({url:"apiMilitaryUnitMembers.html?id="+aQ,success:function(aU){var aT=JSON.parse(aU);for(var aS=0;aS<aT.length;++aS){z(aT[aS],false)}aP.member={};ar(aP.member);localStorage.setItem("citizenInfo",JSON.stringify(citizenInfo));localStorage.setItem("muInfo",JSON.stringify(muInfo));if(typeof(aR)==="function"){aR()}},error:function(aU,aV){var aS=(aQ%10)*0.5+1;var aT=this;console.log("军团",aQ,"的成员API抓取错误 (",aV,")，",aS,"秒后重新抓取");setTimeout(function(){$.ajax(aT)},aS*1000)}})}else{console.log("军团",aQ,"的成员API无需抓取");if(typeof(aR)==="function"){aR()}}}function N(aS){if(config.fetchCitizenDisabled&&aS!==userId){return}var aP=b();$("img[src$='_positive.png']").after("<br>");$("img[src$='_negative.png']").after("<br>");var aW=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aV=[24,24,24,24,1,10,25,24,24,24];for(var aU=0;aU<aW.length;++aU){var aT=$("img[src$='"+aW[aU]+"_positive.png']:first")[0];var aQ=$("img[src$='"+aW[aU]+"_negative.png']:first")[0];var aY=citizenPage[aS][aW[aU]];if(aT){if($(aT).attr("class")=="smallhelp"){var aR=aY[0]+aV[aU]*3600*1000-aP;var aX=aY[1]+aV[aU]*3600*1000-aP;if((aX-aR)<60*1000){$("<b>",{text:aj(aR)}).insertAfter(aT)}else{$("<b>",{text:aj(aR)+" - "+aj(aX)}).insertAfter(aT)}}}if(aQ){if($(aQ).attr("class")=="smallhelp"){var aR=aY[0]+aV[aU]*2*3600*1000-aP;var aX=aY[1]+aV[aU]*2*3600*1000-aP;if(!citizenPage[aS].premium){aR+=aV[aU]*3600*1000;aX+=aV[aU]*3600*1000}if((aX-aR)<60*1000){$("<b>",{text:aj(aX)}).insertAfter(aQ)}else{$("<b>",{text:aj(aR)+" - "+aj(aX)}).insertAfter(aQ)}}}}}function aB(){var aT=$(".time:first").text().trim().split(", ");var aQ=aC(aT[1],aT[0]);var aS=["steroids","tank","bunker","resistance","painDealer1h","painDealer10h","painDealer25h","camouflage_third_class","camouflage_second_class","camouflage_first_class"];var aR=[24,24,24,24,1,10,25,24,24,24];var aP=$("#userAvatar span.premiumStar").length===1;$(".specialItemInventory").each(function(){var a0=$(this);var aV=$("strong",a0);if(aV.length===0){return}aT=aV.text().split(" ");var aU=aC(aT[0],aT[1]);var aY=aj(aU-aQ);aV.append(" ("+aY+")");var aX=$("img:first",a0).attr("src");for(var aW=0;aW<aS.length;++aW){if(aX.indexOf(aS[aW])>=0){if(aW<4){var aZ=b()+aU-aQ-48*3600*1000;if(!aP){aZ-=24*3600*1000}}else{var aZ=b()+aU-aQ-aR[aW]*3600*1000}citizenPage[userId][aS[aW]]=[aZ,aZ+1];localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}}})}function c(){var aP=$("<table id='quickBuffTable' UpdateCount='0'></table>").prependTo($("#storageConteiner"));var aQ=$("<tr>").appendTo(aP);var aS=$("<tr>").appendTo(aP);var aU=$("<tr>").appendTo(aP);aR($(".specialItemInventory").parent(),aQ,aS,aU);function aR(aX,aW,aZ,a0){var aY=["medkit_big","vacations_big","spa_big","steroids_big","tank_big","painDealer1h_big","painDealer10h_big","painDealer25h_big","resistance_big","bunker_big"];var aV=["#EAC100","#00BB00","#00BB00","#FF5809","#FF5809","#9F4D95","#9F4D95","#9F4D95","#7373B9","#7373B9"];$.each(aY,function(a6,bc){var be=$("img[src$='"+bc+".png']",aX).parent();if(be.length<=0){return true}var a7=$(".smallhelp",be);if(a7.length===0){return true}var a3=$('<td bgcolor="'+aV[a6]+'"></td>').appendTo(aW);a7.clone().appendTo(a3);var a8=$("span",be).text();if(a8!=""){$("<br><b>"+a8+"</b>").appendTo(a3)}else{$("<br><br>").appendTo(a3)}var ba=$('<td bgcolor="'+aV[a6]+'"></td>').appendTo(aZ);var a2=$('<td bgcolor="'+aV[a6]+'"></td>').appendTo(a0);var a4=$(".siForms",be);var a1=$("form",a4);if(a1.length<1){return true}else{if(a1.length==1){var bd=$("select",a1);if(bd.length<1){var a9=$('input[name="item"]',a1).attr("value");var a5=$("<input type='button' class='foundation-style button' value='使用'></input>").appendTo(ba);a5.click(function(){var bf=parseInt(aP.attr("UpdateCount"))+1;aP.attr("UpdateCount",bf);a5.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"item="+a9+"&storageType=SPECIAL_ITEM&action=USE",success:function(bg){aT(bg,bf);console.log("使用"+a9+"：成功响应")},error:function(bg,bh){a5.val("使用失败");console.log("使用"+a9+"时发生错误")}})})}else{var a9=$('input[name="itemType"]',a1).attr("value");var bb=$("<input type='button' class='foundation-style button' value='购买'></input>").appendTo(a2);bb.click(function(){var bf=parseInt(aP.attr("UpdateCount"))+1;aP.attr("UpdateCount",bf);bb.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"itemType="+a9+"&storageType=SPECIAL_ITEM&action=BUY&quantity=1",success:function(bg){aT(bg,bf);console.log("购买"+a9+"：成功响应")},error:function(bg,bh){bb.val("购买失败");console.log("购买"+a9+"时发生错误")}})})}}else{var a9=$('input[name="itemType"]',a1).attr("value");var a5=$("<input type='button' class='foundation-style button' value='使用'></input>").appendTo(ba);a5.click(function(){var bf=parseInt(aP.attr("UpdateCount"))+1;aP.attr("UpdateCount",bf);a5.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"item="+a9+"&storageType=SPECIAL_ITEM&action=USE",success:function(bg){aT(bg,bf);console.log("使用"+a9+"：成功响应")},error:function(bg,bh){a5.val("使用失败");console.log("使用"+a9+"时发生错误")}})});var bb=$("<input type='button' class='foundation-style button' value='购买'></input>").appendTo(a2);bb.click(function(){var bf=parseInt(aP.attr("UpdateCount"))+1;aP.attr("UpdateCount",bf);bb.attr({disabled:true});$.ajax({type:"POST",url:"storage.html",data:"itemType="+a9+"&storageType=SPECIAL_ITEM&action=BUY&quantity=1",success:function(bg){aT(bg,bf);console.log("购买"+a9+"：成功响应")},error:function(bg,bh){bb.val("购买失败");console.log("购买"+a9+"时发生错误")}})})}}})}function aT(aX,aW){var aV=aP.attr("UpdateCount");if(aW>=aV){$("td",aP).remove();aR($(".specialItemInventory",aX).parent(),aQ,aS,aU)}}}function aL(){var aS=$("<div>",{"class":"battleSettingsDiv",style:"overflow:auto; width:450px; height:auto; display:block; position:fixed; top:50%; left:50%; margin-left: -225px; margin-top: -150px; padding-bottom: 20px; text-align:center;background-color:lightgray;"}).appendTo($("body"));var aP=$('<br>战场设置<br><table class="battleSettingsTable" style="text-align:left"></table><button class="battleSettingsCancel">关闭</button><br>').appendTo(aS);var aQ=$(".battleSettingsTable");var aR=$("<tr>").appendTo(aQ);var aT=$("<td>").appendTo(aR);aa(aT,"battleEnhanceDivPlacement","战场界面功能框下移","battleEnhanceDivPlacement",false);$("<p>",{text:"观战玩家变动不会改变按钮位置。"}).appendTo(aT);aR=$("<tr>").appendTo(aQ);aT=$("<td>").appendTo(aR);aa(aT,"battleBorderless","战场页面缩小框体间距","battleBorderless",false);$("<p>",{text:"能看到下面的玩家输出排行和实时输出伤害。"}).appendTo(aT);aR=$("<tr>").appendTo(aQ);aT=$("<td>").appendTo(aR);aa(aT,"addEmptyRecentRecord","预置最近输出栏位","addEmptyRecentRecord",false);$("<p>",{text:"当最近输出不足5个时补充至5个栏位，以便第一时间能看到输出状况。"}).appendTo(aT);aR=$("<tr>").appendTo(aQ);aT=$("<td>").appendTo(aR);aa(aT,"enableBattleAjaxTimeout","设定请求超时时间：","enableBattleAjaxTimeout",false);Y(aT,60,"battleAjaxTimeout","5");$("<span>",{text:" 秒"}).appendTo(aT);$("<p>",{text:"缓解因网络环境差，同时进行的请求数量多，导致后续请求被堵塞。"}).appendTo(aT);aR=$("<tr>").appendTo(aQ);aT=$("<td>").appendTo(aR);aa(aT,"EnableAutoFight","启用自动打枪功能","EnableAutoFight",false);$("<p>",{text:"珍惜账号，慎用自动。"}).appendTo(aT);$(".battleSettingsCancel").click(function(){$("#btnBattleSettings").attr({disabled:false});aS.remove()})}function al(){var aV=$('<li class="has-dropdown">').appendTo($("ul.foundation-left"));var aP=$('<a id="quickSite" href="#"><i class="icon-pin"></i>快捷站点</a>').appendTo(aV);var aT=$('<ul class="dropdown">').appendTo(aV);var aS=$('<li><a href="#" class="quickSiteSettings">快捷站点设置</a></li>').appendTo(aT);$(".quickSiteSettings").click(function(){aU()});var aR=JSON.parse(localStorage.getItem("quickSite"));if(aR!=null){for(var aQ=0;aQ<aR.length;aQ++){$('<li><a href="'+aR[aQ].url+'" target="_blank">'+aR[aQ].name+"</a></li>").appendTo(aT)}}function aU(){var a0=$("<div>",{"class":"quickSiteDiv",style:"overflow:auto; width:450px; height:300px; display:block; position:absolute; top:50%; left:50%; margin-left: -225px; margin-top: -150px; padding-bottom: 20px; text-align:center;background-color:lightgray;"}).appendTo($("body"));var aX=$('<br>注意: 留空“名称”一栏则表示删除该行，修改后请保存，刷新后生效<br>站外链接请以http或https开头<br>举例：名称：EC在线玩家 链接：citizensOnline.html?countryId=28<br>举例：名称：Esim贴吧 链接：https://tieba.baidu.com/f?kw=esim<table style="text-align:center; margin:auto"><tbody><tr class="EHQS"><td>名称</td><td>链接</td></tr></tbody></table><button class="quickSiteAdd">增加站点</button><button class="quickSiteComplete">保存</button><button class="quickSiteCancel">取消</button><br>').appendTo(a0);var aW=$(".EHQS").parent();$(".quickSiteAdd").click(function(){var a1=$('<tr><td><input class="EHQSSites" type="text" style="width:100px;"></td><td><input class="EHQSSites" type="text" style="width:300px;"></td></tr>').appendTo(aW)});var aZ=JSON.parse(localStorage.getItem("quickSite"));if(aZ!=null){for(var aY=0;aY<aZ.length;aY++){$('<tr><td><input class="EHQSSites" type="text" style="width:100px;" value="'+aZ[aY].name+'"></td><td><input class="EHQSSites" type="text" style="width:300px;" value="'+aZ[aY].url+'"></td></tr>').appendTo(aW)}}$(".quickSiteComplete").click(function(){var a2=[];var a1=$("tr:gt(0)",$(".EHQS").parent());a1.each(function(){var a4=$(this);var a3=$("td:eq(0)",a4).find("input")[0].value;if(a3!=""){a2.push({name:a3,url:$("td:eq(1)",a4).find("input")[0].value})}});localStorage.setItem("quickSite",JSON.stringify(a2));a0.remove()});$(".quickSiteCancel").click(function(){a0.remove()})}}function u(){$("select").each(function(){var aW=$(this);var aZ=$("option",aW);if(aZ.length<countryIds.length-3){return}var aQ=false;var aR=false;var aP=true;for(var aS=0;aS<aZ.length;++aS){var aX=parseInt(aZ.eq(aS).val());if(aX===0){aQ=true;continue}else{if(aX===-1){aR=true;continue}else{if(aX<-1){return}else{if($.inArray(aX,countryIds)===-1){return}else{if(aZ.eq(aS).text().indexOf(countryInfo[aX].currencyName)===-1){aP=false}}}}}}var aU=$("~ input[type='submit']",aW);aW.after("<br />");var aV=JSON.parse(localStorage.getItem("favoriteCountries"));if(aV===null){aV=[28]}$.each(aV,function(a1,a2){if(!countryInfo[a2]){return}var a0=$("<div>",{"class":(aP?"xflagsSmall xflagsSmall-":"xflagsMedium xflagsMedium-")+countryInfo[a2].flagName,style:"vertical-align:middle;",value:a2,title:countryInfo[a2].name}).insertAfter(aW);a0.click(function(){aW.val($(this).val());if(aU.length===1){aU.click()}})});if(!aP&&((aQ&&!aR)||(!aQ&&aR))){var aT=$("<div>",{"class":" xflagsMedium xflagsMedium-Adminland",style:"vertical-align:middle;",title:"全世界"}).insertAfter(aW);aT.click(function(){aW.val(aQ?0:-1);if(aU.length===1){aU.click()}})}if(aQ&&aP){var aT=$("<div>",{"class":"xflagsSmall xflagsSmall-Gold",style:"vertical-align:middle;"}).insertAfter(aW);aT.click(function(){aW.val(0);if(aU.length===1){aU.click()}})}if(aU.length===1){aU.click(function(){aY(parseInt(aW.val()))})}else{aW.change(function(){aY(parseInt(aW.val()))})}function aY(a0){var a2=localStorage.getItem("lockFavoriteCountries");if(a2==null||a2!="true"){if(a0>0){var a1=$.inArray(a0,aV);if(a1>-1){aV.splice(a1,1)}aV.push(a0)}localStorage.setItem("favoriteCountries",JSON.stringify(aV.slice(-9)))}}})}function y(){var aQ=$("#editCitizenId").parent();var aR=JSON.parse(localStorage.getItem("citizenNumber"));if(aR===null||aI(aR,24*3600)){$.ajax({url:"militaryUnitStorage.html",success:function(aT){aR=aP(aT);console.log("团员编号为",aR);aS(aR)},error:function(aT,aU){console.log("抓取团员编号时发生错误 (",aU,")，重新尝试");$.ajax(this)}})}else{aS(aR.cn)}function aS(aX){if(aX==="disabled"){return}var aT=0;var aZ=0;if($("#foodLimit").length==1){aT=parseInt($("#foodLimit").text());aZ=parseInt($("#giftLimit").text())}else{aT=parseInt($("#foodLimit2").text());aZ=parseInt($("#giftLimit2").text())}var aU=[["bread","Food",5,"5-FOOD","Q5食物",Math.floor(Math.random()*4+2)*10],["gift","Gift",5,"5-GIFT","Q5礼物",Math.floor(Math.random()*4+2)*10],["tank","Weapon",5,"5-WEAPON","Q5武器",Math.floor(Math.random()*10+15)*10],["ticket ","Ticket",5,"5-TICKET","Q5机票",10],["bread","Food",3,"3-FOOD","Q3食物",10],["gift","Gift",3,"3-GIFT","Q3礼物",10],["tank","Weapon",1,"1-WEAPON","Q1武器",Math.floor(Math.random()*10+15)*10],["ticket ","Ticket",1,"1-TICKET","Q1机票",10]];var aY=$('<ul id="storageTable" class="button foundation-center foundation-style-group"></ul>');aQ.parent().after(aY);$.each(aU,function(a5,a8){var a7=$("<li></li>");var a1=$("#storageTable").append(a7);var a2=a8[5];var a3=$("<button>",{id:"send"+a8[3],style:"width:41px; margin:1px;","class":"button foundation-style smallhelp only-icon profileButton",title:"从军团仓库取"+a2+"个"+a8[4]}).appendTo(a7);var a6=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/"+a8[1]+".png",style:"width:28px; height:28px;"}).appendTo(a3);var a4=$("<span>",{text:"x"+a2,style:"position: absolute; top: 26px; right: 1px;"}).appendTo(a3);a3.append($("<br />"));var a0=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/q"+a8[2]+".png",style:"width:28px;"}).appendTo(a3);a3.click(function(){a3.attr({disabled:true});var a9={product:a8[3],quantity:a2,reason:" "};a9[aX]=userId;$.ajax({url:"militaryUnitStorage.html",type:"POST",data:a9,success:function(ba){console.log("已从军团仓库取了"+a2+"个"+a8[4]);a3.attr({disabled:false})},error:function(ba,bb){console.log("从军团仓库取"+a2+"个"+a8[4]+"时发生错误 (",bb,")，重新尝试");$.ajax(this)}})})});var aW=$("<input type='button' id='gsnbtn' value='获取仓库物资数目'></input> ");aQ.parent().after(aW);aW.click(function(){aV(aX);aW.remove()});function aV(a0){$.ajax({url:"storage.html?storageType=PRODUCT",success:function(a6){var a2=$("div.storage",a6);var ba=[0,0,0,0,0,0];var bc=[0,0,0,0,0,0];var a9=[0,0,0,0,0,0];var a4=[0,0,0,0,0,0];for(var a7=0;a7<a2.length;a7++){var bb;var a3;var a1;bb=parseInt("0"+a2[a7].children[0].innerText.trim());var a5=$(a2[a7]).children()[1];a1=$(a5.children[0]).attr("src").split("/")[6];a3=$(a5.children[1]).attr("src");if(a3!=null){a3=a3.split("/")[6];a3=a3.substring(1,2);if(a1=="Food.png"){ba[parseInt(a3)]=bb}else{if(a1=="Gift.png"){bc[parseInt(a3)]=bb}else{if(a1=="Weapon.png"){a9[parseInt(a3)]=bb}else{if(a1=="Ticket.png"){a4[parseInt(a3)]=bb}}}}}}var a8=parseInt((aT+aZ+40)*5*100/(100-citizenPage[userId].avoid));console.log(aT,aZ,ba,bc,a9,a4,a8);aU=[["bread","Food",5,"5-FOOD","Q5食物",ba[5]<aT+25,aT+30-ba[5],30],["gift","Gift",5,"5-GIFT","Q5礼物",bc[5]<aZ+15,aZ+20-bc[5],20],["tank","Weapon",5,"5-WEAPON","Q5武器",a9[5]<a8,a8-a9[5]+30,250],["ticket ","Ticket",5,"5-TICKET","Q5机票",a4[5]<6,10-a4[5],10],["bread","Food",3,"3-FOOD","Q3食物",ba[3]<10,10-ba[3],10],["gift","Gift",3,"3-GIFT","Q3礼物",bc[3]<10,10-bc[3],10],["tank","Weapon",1,"1-WEAPON","Q1武器",a9[1]<a8,a8-a9[1]+30,250],["ticket ","Ticket",1,"1-TICKET","Q1机票",a4[1]<6,10-a4[1],10]];$("ul#storageTable").html("");$.each(aU,function(bj,bm){var bl=$("<li></li>");var bf=$("#storageTable").append(bl);var be=bm[5]?"red;":"black;";var bg=bm[5]?bm[6]:bm[7];var bh=$("<button>",{id:"send"+bm[3],style:"width:41px; margin:1px; border-color:"+be,"class":"button foundation-style smallhelp only-icon profileButton",title:"从军团仓库取"+bg+"个"+bm[4]+(bm[5]?", 补足2天的用量":"")}).appendTo(bl);var bk=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/"+bm[1]+".png",style:"width:28px; height:28px;"}).appendTo(bh);var bi=$("<span>",{text:"x"+bg,style:"position: absolute; top: 26px; right: 1px;"}).appendTo(bh);bh.append($("<br />"));var bd=$("<img>",{src:"//cdn.e-sim.org/img/productIcons/q"+bm[2]+".png",style:"width:28px;"}).appendTo(bh);bh.click(function(){bh.attr({disabled:true});var bn={product:bm[3],quantity:bg,reason:" "};bn[a0]=userId;$.ajax({url:"militaryUnitStorage.html",type:"POST",data:bn,success:function(bo){console.log("已从军团仓库取了"+bg+"个"+bm[4]);bh.attr({disabled:false})},error:function(bo,bp){console.log("从军团仓库取"+bg+"个"+bm[4]+"时发生错误 (",bp,")，重新尝试");$.ajax(this)}})})})},error:function(a1,a2){console.log("获取物资时发生错误 (",a2,")，重新尝试");$.ajax(this)}})}}function aP(aV){var aT=$("input[value='"+userId+"']",aV);var aU={};if(aT.length===1){aU.cn=aT.attr("name")}else{aU.cn="disabled"}ar(aU);localStorage.setItem("citizenNumber",JSON.stringify(aU));return aU.cn}}function m(){var aS=$("table.dataTable:last").width("100%");aS.parent().attr("style","width:98% !important;");var aP=$("tr:gt(0)",aS).sort(function(aU,aT){return $("td:eq(1)",aU).html().localeCompare($("td:eq(1)",aT).html())});$("tr:gt(0)",aS).remove();var aR=$("tr",aS);aR.after(aP);$("td:first",aR).append(" ("+aP.length+")");var aQ=$("<button>",{"class":"foundation-style button",text:"查看全部"}).appendTo($("<td>").appendTo(aR));aQ.click(function(){aQ.attr("disabled",true);setTimeout(function(){aQ.attr("disabled",false)},10000);$('button[id^="ehShow"]').click()});aP.each(function(){var aV=$(this);if(parseInt($("td:eq(3)",aV).text())===0){aV.append($("<td>"));return}var aT=parseInt($('td:first a[href^="company.html?id="]',aV).attr("href").match(/([0-9]+)$/)[1]);aV.attr("id","ehRow"+aT);var aU=$("<button>",{"class":"foundation-style button",style:"padding:10px;",id:"ehShow"+aT,text:"查看工作情况",target:aT}).appendTo($("<td>").appendTo(aV));aU.click(function(){aU.attr("disabled",true);var aW=aU.attr("target");$.ajax({url:"companyWorkResults.html?id="+aW,success:function(a0){aU.remove();var aY=$("table.dataTable:last",a0);if($("tr",aY).length===1){return}var aX=$("<tr>").insertAfter($("#ehRow"+aW));var aZ=$("<td colspan=5></td>").appendTo(aX);aY.appendTo(aZ)},error:function(aX,aY){console.log("工厂",aW,"抓取错误 (",aY,")");aU.click()}})})})}function az(){var aP=$("<button>",{id:"returnButton","class":"foundation-style",style:"padding:5px; margin:5px",text:"回到工厂页面"});aP.click(function(){var aQ=n("id");document.location=location.origin+"/company.html?id="+aQ});$(".darkTable").before(aP)}function ap(){var aP=$("#orderForm > select");if(aP.length!=1){return}var aS=[];for(var aR=0;aR<allies.length;++aR){aS.push("("+countryInfo[allies[aR]].shortName)}var aQ=$("option",aP).sort(function(aU,aT){return $(aU).text().localeCompare($(aT).text())});aQ.each(function(){var aU=$(this);for(var aT=0;aT<aS.length;++aT){if(aU.text().indexOf(aS[aT]+" ")!=-1){if(aT==0){aU.attr("style","background:pink;")}else{aU.attr("style","background:lavender;")}}}});aP.html(aQ)}function aG(){var a5=$(".dataTable :first");var a1=$("<div class='foundation-style'></div>");a1.insertBefore(a5);var a0=$("<table align='right'></table>");a1.append(a0);var aS=$("<tr align='right'></tr>");a0.append(aS);var aY=$("<input type='button' class='foundation-style button' id='btnShowEndTime' value='显示T5时间'></input> ");aS.append(aY);var aR=$("<input type='button' class='foundation-style button' id='btnCloseShowEndTime' value='关闭T5时间'></input> ");aR.hide();aS.append(aR);var aW=$("<input type='button' class='foundation-style button' id='btnShowBattleID' value='显示战场ID'></input> ");aS.append(aW);var a6=$("<input type='button' class='foundation-style button' id='btnCloseShowBattleID' value='关闭战场ID'></input> ");a6.hide();aS.append(a6);var aP=$("<tr align='right'></tr>");a0.append(aP);var a7=$("<input type='button' class='foundation-style button' id='btnDeleteTourment' value='隐藏Cup战场'></input> ");aP.append(a7);var a3=$("<input type='button' class='foundation-style button' id='btnFilter' value='筛选战场'></input> ");aP.append(a3);var aV=$("<input type='button' class='foundation-style button' id='btnCloseFilter' value='关闭筛选'></input> ");aV.hide();aP.append(aV);var aT=$("<input type='button' class='foundation-style button' id='btnDeleteCheckedBattle' value='隐藏选中战场'></input> ");aT.attr("disabled",true);aP.append(aT);var aZ=$("<input type='button' class='foundation-style button' id='btnDeleteUncheckedBattle' value='保留选中战场'></input> ");aZ.attr("disabled",true);aP.append(aZ);var a2=$("<input type='button' class='foundation-style button' id='btnCopyCheckedBattleInfo' value='复制选中战场信息'></input> ");a2.attr("disabled",true);aP.append(a2);aT.click(function(){$("#battlesTable tr:gt(0)").each(function(a8,ba){var a9=$("input:checkbox",ba);if(a9.is(":checked")===true){ba.remove()}})});aZ.click(function(){$("#battlesTable tr:gt(0)").each(function(a8,ba){var a9=$("input:checkbox",ba);if(a9.is(":checked")===false){ba.remove()}})});a7.click(function(){$("#battlesTable tr:gt(0)").each(function(a8,bb){var ba=$("a[href*='battle.html']",bb);if(ba==null){return true}var a9=ba.text();if((a9=="Cup tournament")||(a9=="MU Cup")||(a9=="Country Tournament")){bb.remove()}})});a3.click(function(){a3.hide();aV.show();var a8=$("<td exid='filter'><input type='checkbox'></input></td>");$("#battlesTable tr:eq(0)").append($("<td exid='filter'><input id='filterSelectAll' type='checkbox'></input>全选</td>"));$("#battlesTable tr:gt(0)").append(a8);aT.attr("disabled",false);aZ.attr("disabled",false);a2.attr("disabled",false);$("#filterSelectAll").click(function(){$("#battlesTable tr:gt(0)").each(function(a9,ba){$("input:checkbox",ba).attr("checked",$("#filterSelectAll").is(":checked"))})})});aV.click(function(){a3.show();aV.hide();$("#battlesTable td[exid='filter']").remove();aT.attr("disabled",true);aZ.attr("disabled",true);a2.attr("disabled",true)});aY.click(function(){aY.hide();aR.show();$("#battlesTable tr:eq(0)").append($("<td exid='endTime'>T5时间</td>"));$("#battlesTable tr:gt(0)").each(function(bd,bf){var bh=$("a[href*='battle.html']",bf);var bj=bh.text();var a8=$("span.is-countdown",bf);var bi;if(a8.length!==1){bi=$("<td exid='endTime'>未知</td>")}else{var a9=a8.text().split(":");if(a9.length<3){bi=$("<td exid='endTime'>已过期</td>")}else{var ba=new Date();var bg=parseInt(a9[0])*60*60*1000+parseInt(a9[1])*60*1000+parseInt(a9[2])*1000-5*60*1000;var bb=new Date(ba.getTime()+bg);bi=$("<td exid='endTime'></td>");bi.text(bb.toLocaleTimeString());var be=bh.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1];var bc=$("<input type='button' class='foundation-style button' id='btnAutoPopup-"+be+"' value='T5自动打开战场' title='首次使用可能会被浏览器拦截，加入白名单即可' endtime='"+Date.parse(bb)+"'></input> ");bi.append(bc);bc.click(function(){var bm=$(this);var bl=new Date();var bk=new Date(parseInt(bm.attr("endtime")));setTimeout(function(){window.open(bh.attr("href"),"Battle"+be,"resizable,scrollbars,width=1200,height=600")},bk-bl);console.log("在"+(bk-bl)/1000+"秒后打开"+bh.attr("href"));bm.attr("disabled",true);bm.val("预约成功");bm.attr("title","请勿关闭或刷新该网页")})}}$(bf).append(bi)})});aR.click(function(){aY.show();aR.hide();$("#battlesTable td[exid='endTime']").remove()});aW.click(function(){aW.hide();a6.show();$("#battlesTable tr:eq(0)").append($("<td exid='battleID'>战场ID</td>"));$("#battlesTable tr:gt(0)").each(function(a8,bb){var ba=$("a[href*='battle.html']",bb);if(ba==null){return true}var a9=ba.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1];$(bb).append($("<td exid='battleID'>"+a9+"</td>"))})});a6.click(function(){aW.show();a6.hide();$("#battlesTable td[exid='battleID']").remove()});a2.click(function(){var a8="";$("#battlesTable tr:gt(0)").each(function(be,bf){var bc=$("input:checkbox",bf);if(bc.is(":checked")===true){var bg=$("a[href*='battle.html']",bf);var bh=bg.text();var a9=$("span.is-countdown",bf);if(a9.length!==1){a8=a8+bg[0].href+"  "+bh+"\r\n"}else{var ba=a9.text().split(":");var bb=new Date();var bd=new Date(bb.getTime()+parseInt(ba[0])*60*60*1000+parseInt(ba[1])*60*1000+parseInt(ba[2])*1000-5*60*1000);a8=a8+bg[0].href+"  "+bh+" T5时间："+bd.toLocaleTimeString()+"\r\n"}}});GM_setClipboard(a8)});var aU=$("<button>",{text:"按结束时间排序","class":"foundation-style button"}).appendTo($("#battlesTable tr:first td:first").empty());aU.click(function(){aU.attr("disabled",true);setTimeout(function(){aU.attr("disabled",false)},1000);var a8=[];$("#battlesTable tr:gt(0)").each(function(a9,bc){var bb=$("a[href*='battle.html']",bc);if(bb==null){return true}var ba=parseInt(bb.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1]);$(this).attr("id","battle-"+ba);var bd=$("span.is-countdown",bc);if(bd.length!==1){return}a8.push(bd.text()+" "+$(this).attr("id"))});a8.sort().reverse();$.each(a8,function(ba,bb){var a9=bb.split(" ").pop();$("#battlesTable #"+a9).insertAfter($("#battlesTable tr:first"))})});var aX=$("#pagination-digg");if(aX.length>0){var aQ=$("<button>",{text:"加载其他页的战场","class":"foundation-style button",title:"如果需要加载所有战场，请尽快点击该按钮，否则可能会出现重复战场而导致插件失效"}).appendTo($("#battlesTable tr:first td:first"));aQ.click(function(){aQ.attr("disabled",true);var a8=$("li.next");var bb=parseInt($("li.active")[0].innerHTML);var a9;if(a8.length>0){a9=parseInt(a8.prev().children().attr("href").split("page=")[1])}else{a9=bb}var ba=a9-1;aQ.text("剩余"+ba+"个");for(var bd=1;bd<=a9;bd++){if(bd==bb){continue}var bc=document.URL;if(bc.indexOf("page")>0){bc=bc.substring(0,bc.indexOf("page"))+"page="+bd}else{if(bc.indexOf("?")>0){bc=bc+"&page="+bd}else{bc=bc+"?page="+bd}}$.ajax({url:bc,success:function(bn){if($(".time",bn).length!==2){console.log(citizenId,"抓取错误，重新抓取");$.ajax(this);return}var bo=$("#battlesTable").children("tbody");var br=bn.split('<table id="battlesTable"')[1];br=br.split("</table>")[0];var bq=br.substring(br.indexOf("</tr>")+5);var bt=bq.split("<tr>");var bf=[];var bp=[];var bg=[];var bh=[];var be=[];for(var bm=1;bm<bt.length;bm++){var bl=bt[bm].split('<script type="text/javascript">');if(bl.length>1){bf[bm]=bl[0];var bj=bl[1].split("<\/script>");bf[bm]=bf[bm]+bj[1];bf[bm]=bf[bm].split("</tr>")[0];bp[bm]=bj[0];be[bm]=bf[bm].split("?id=")[1];be[bm]=be[bm].substring(0,be[bm].indexOf('"'));$("<tr>",{id:"battle-"+be[bm]}).appendTo(bo);$("#battle-"+be[bm]).html(bf[bm]);var bi=bp[bm].split("+");var bs=[];for(var bk=1;bk<bi.length;bk++){bs[bk]=bi[bk].substring(0,bi[bk].indexOf(")"))}bg[bm]=new Date();bg[bm].setHours(bg[bm].getHours()+parseInt(bs[1]));bg[bm].setMinutes(bg[bm].getMinutes()+parseInt(bs[2]));bg[bm].setSeconds(bg[bm].getSeconds()+parseInt(bs[3]));bh[bm]=$("<span>",{id:"fundraisingTimer"+be[bm]}).appendTo($("a[href='battle.html?id="+be[bm]+"']").parent());unsafeWindow.$("#fundraisingTimer"+be[bm]).countdown({until:bg[bm],compact:true,format:"dHMS",expiryText:"这个回合已经结束"})}else{be[bm]=bt[bm].split("?id=")[1];be[bm]=be[bm].substring(0,be[bm].indexOf('"'));$("<tr>",{id:"battle-"+be[bm]}).appendTo(bo);bf[bm]=bt[bm].split("</tr>")[0];$("#battle-"+be[bm]).html(bf[bm])}}aQ.text("剩余"+(--ba)+"个");if(ba<=0){aQ.text("加载完成，共"+a9+"页")}},error:function(be,bf){console.log("抓取错误 (",bf,")，重新抓取");$.ajax(this)}})}});var a4=$("<button>",{text:"加载详情","class":"foundation-style button",style:"padding:5px; margin:5px;",title:"加载刷新战场详情功能"}).appendTo($("#battlesTable tr:first td:last").empty());a4.click(function(){a4.attr("disabled",true);a4.remove();aO()})}else{aO()}}function aO(){$("#battlesTable tr:gt(0)").each(function(aZ,aR){if($("div.teamBlack",aR).length>0){return}var a5=$("span.is-countdown",aR);if(a5.length!==1){return}var a1=$("a[href*='battle.html']",aR);var aW=parseInt(a1.attr("href").match(/battle\.html[?]id=([0-9]+)/)[1]);$(this).attr("id","battle-"+aW);var bm=a1.text();if($("~ b",a1).length===1){bm+="起义"}else{bm+="进攻"}var be=w($("div.xflagsMedium:first",aR).attr("class")).replace(/-/g," ");var a4=w($("div.xflagsMedium:last",aR).attr("class")).replace(/-/g," ");var bc=$("div.ui-progressbar-value",aR);var bf=$("<div>",{id:"wall"+aW,style:"text-align:center;"}).insertAfter($("div.ui-progressbar",aR));if($("div.xflagsMedium",aR).length<=0){var a3=$("<div>",{id:"defenderBattleHero"+aW,style:"text-align:center;"}).insertAfter($(".muAvatar:first",aR).parent());var bk=$("<div>",{id:"defenderScore"+aW,style:"text-align:center;"}).insertAfter($(".muAvatar:first",aR).parent());var bh=$("<div>",{id:"attackerBattleHero"+aW,style:"text-align:center;"}).insertAfter($(".muAvatar:last",aR).parent());var a7=$("<div>",{id:"attackerScore"+aW,style:"text-align:center;"}).insertAfter($(".muAvatar:last",aR).parent())}else{var a3=$("<div>",{id:"defenderBattleHero"+aW,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:first",aR));var bk=$("<div>",{id:"defenderScore"+aW,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:first",aR));var bh=$("<div>",{id:"attackerBattleHero"+aW,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:last",aR));var a7=$("<div>",{id:"attackerScore"+aW,style:"text-align:center;"}).insertAfter($("div.xflagsMedium:last",aR))}var bl=$("<div>",{id:"showSpectators"+aW,text:"Show spectators",style:"color:#3787ea; cursor:pointer;"}).appendTo($("td:first",aR)).click(function(){a9.children().show();bl.hide();bn.show()}).hide();var bn=$("<div>",{id:"hideSpectators"+aW,text:"Hide spectators",style:"color:#3787ea; cursor:pointer;"}).appendTo($("td:first",aR)).click(function(){a9.children().hide();bl.show();bn.hide()}).hide();var a9=$("<div>",{id:"spectators"+aW,"class":"battleDiv",style:"width:100%; text-align:center;"}).appendTo($("td:first",aR));var a0=$("<div>",{style:"width:33%; border:0; padding:0; margin:0; display:inline-block;",text:" defenders"}).appendTo(a9);var aQ=$("<i>",{id:"totaldefenders"+aW,text:"0"}).prependTo(a0);var aV=$("<div>",{id:"defendersMenu"+aW}).appendTo(a0);var bd=$("<div>",{style:"width:34%; border:0; padding:0; margin:0; display:inline-block; text-align:center;",text:" spectators"}).appendTo(a9);var aT=$("<i>",{id:"totalspectators"+aW,text:"0"}).prependTo(bd);var aU=$("<div>",{id:"spectatorsMenu"+aW}).appendTo(bd);var aY=$("<div>",{style:"width:33%; border:0; padding:0; margin:0; display:inline-block; text-align:center;",text:" attackers"}).appendTo(a9);var a2=$("<i>",{id:"totalattackers"+aW,text:"0"}).prependTo(aY);var bb=$("<div>",{id:"attackersMenu"+aW}).appendTo(aY);a9.children().hide();var aS=$("<div>",{id:"dsOrHospital"+aW}).appendTo(a5.parent().parent());var bg=$("<img>",{src:$("#userAvatar img").attr("src")}).insertAfter(aS).hide();var bj=$("<div>",{id:"myDamage"+aW}).insertAfter(bg);var bi=$("<button>",{id:"peek"+aW,text:"刷新","class":"foundation-style button",style:"padding:6px; margin:3px;"}).appendTo($("td:eq(3)",aR));var a6=$("<button>",{id:"copy"+aW,text:"复制","class":"foundation-style button",style:"padding:6px; margin:3px;",title:bm+": "+a1[0].href+"\n"}).appendTo($("td:eq(3)",aR)).hide();var a8=$("<div>").appendTo($("td:eq(3)",aR));var aX=$("<span>",{id:"lastPeek"+aW}).appendTo(a8);var ba=$("<span>",{id:"2lastPeek"+aW,text:"秒前更新"}).hide().appendTo(a8);bi.click(function(){bi.attr("disabled",true);$.ajax({url:"battle.html?id="+aW,success:function(bp){if($(".time",bp).length!==2){console.log(aW,"抓取错误，重新抓取");$.ajax(this);return}bk.text($("#defenderScore",bp).text());a7.text($("#attackerScore",bp).text());var bo=parseInt($("#defenderScore",bp).text().replace(/,/g,"").replace(/\xA0/g,""))-parseInt($("#attackerScore",bp).text().replace(/,/g,"").replace(/\xA0/g,""));if(bo===0){bf.text("");bf.attr("title",bk===0?"双方无伤害":"双方伤害相同")}else{if(bo>0){bf.text(">> "+bo.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>");bf.attr("title",be+" 领先 "+a4+" "+(bo/1000000).toFixed(2)+"M")}else{bf.text("<< "+(-bo).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<");bf.attr("title",a4+" 领先 "+be+" "+((-bo)/1000000).toFixed(2)+"M")}}bc.attr("style","width:"+$("#leftStat",bp).text().replace(" ","")+"; margin:0;");a3.html($("#topDefender1 > div",bp).attr("style","width:100%;"));bh.html($("#topAttacker1 > div",bp).attr("style","width:100%;"));if(bh.height()<a3.height()){bh.parent().height(a3.parent().height())}if($("td:first > div:first",aR).children().length==4){$("td:first > div:first >div:last",aR).hide()}if($("div.product",bp).length>0){aS.empty().append($("div.product",bp))}var bq=$("#topPlayerHit",bp).text();if(bq!=="0"){bg.show();bj.text(bq)}if($("#userAvatar span.premiumStar").length===1){aQ.text($("#totaldefenders",bp).text());aV.html($("#defendersMenu",bp).html());aT.text($("#totalspectators",bp).text());aU.html($("#spectatorsMenu",bp).html());a2.text($("#totalattackers",bp).text());bb.html($("#attackersMenu",bp).html());if(!bn.is(":visible")){bl.show()}}aX.text("0");ba.show();bi.attr("disabled",false);a6.show()},error:function(bo,bp){console.log("战场",aW,"抓取错误 (",bp,")");$.ajax(this)}})});a6.click(function(){GM_setClipboard(a6.attr("title")+a5.text()+", "+bf.attr("title")+" ("+a8.text()+")")})});setInterval(function(){$("span[id^='lastPeek']").each(function(){var aQ=parseInt($(this).text());if(!isNaN(aQ)){$(this).text(aQ+1)}})},1000);var aP=$("<button>",{text:"刷新全部","class":"foundation-style button",style:"padding:5px; margin:5px;"}).appendTo($("#battlesTable tr:first td:eq(3)").empty());aP.click(function(){aP.attr("disabled",true);$("#battlesTable tr:gt(0) button[id^='peek']").click();setTimeout(function(){aP.attr("disabled",false)},10000)})}function ah(){var a0=20;var aU=[0.1,1,5,12,35,100,400];var aY=$(".time").first().text().split(" ")[0];var aS=aY.split(":")[0];var aQ=a0>aS?(a0-aS+24):(a0-aS+48);console.log("距离波兰时间",a0,"点还有约",aQ,"小时");console.log("各等级装备的起价是 ",aU);var a1=$(".equipmentInStorage");for(i=0;i<a1.length;++i){var aT=$(".equipmentActions",a1[i])[0];var aZ=$(aT).children()[4];aZ=$(aZ).children()[0];var aR=$(aZ).attr("title");if(aR==null){var aW=5}else{var aW=parseInt($(aZ).attr("title").substring(1))-1}var aP=$(aT).children()[2];var aV=$("input",$(aP));var aX=$(aT).children();for(a=0;a<aX.length;++a){if(aX[a].outerHTML=="<hr>"){aT.removeChild(aX[a])}}for(j=0;j<aV.length;++j){switch(aV[j].name){case"price":aV[j].setAttribute("value",aU[aW]);aV[j].setAttribute("type","text");aV[j].setAttribute("style","width:30px");aV.eq(j).before("起价: ");aV.eq(j).after("<div></div>");break;case"length":aV[j].setAttribute("value",aQ);aV[j].setAttribute("type","text");aV[j].setAttribute("style","width:30px");aV.eq(j).before("时间: ");aV.eq(j).after("<i></i>");break;default:break}}}}function ay(){unsafeWindow.$(".mergeItemForm :checkbox").unbind();$("#mergeItem").children("button").remove();var aR=$("<input type='button' style='display:inline-block;'value='选择(同等级)装备批量合成'></input> ");var aP=$("<input type='button' style='display:inline-block;'value='选择所有Q1'></input> ");var aW=$("<input type='button' style='display:inline-block;'value='选择所有Q2'></input> ");var aV=$("<input type='button' style='display:inline-block;'value='选择所有Q3'></input> ");var aT=$("<input type='button' style='display:inline-block;'value='选择所有Q4'></input> ");var aQ=$("<input type='button' style='display:inline-block;'value='选择所有Q5'></input> ");function aU(){aR.val("已选择"+$(".mergeItemForm :checkbox[checked]").length+"件装备，点击此处合成")}function aS(aX,aZ){if(aZ>=aX.length){aR.val("合成结束");location=location;return}console.log("合成 "+aX[aZ-2]+" "+aX[aZ-1]+" "+aX[aZ]);var aY="itemId%5B"+aX[aZ-2]+"%5D="+aX[aZ-2]+"&itemId%5B"+aX[aZ-1]+"%5D="+aX[aZ-1]+"&itemId%5B"+aX[aZ]+"%5D="+aX[aZ]+"&action=MERGE";$.ajax({type:"POST",url:"equipmentAction.html",data:aY,success:function(){aR.val("合成第"+(aZ-1)+"-"+(aZ+1)+"个");setTimeout(function(){aS(aX,aZ+3)},200)},error:function(a0,a1){aR.val("合成时发生错误")}})}aR.click(function(){aR.attr("disabled",true);var aX=[];$(".mergeItemForm :checkbox[checked]").each(function(aZ,aY){aX.push(aY.value)});aS(aX,2)});aP.click(function(){$(".mergeItemForm :checkbox").removeAttr("checked");$(".mergeItemQ1").attr("checked","checked");aU()});aW.click(function(){$(".mergeItemForm :checkbox").removeAttr("checked");$(".mergeItemQ2").attr("checked","checked");aU()});aV.click(function(){$(".mergeItemForm :checkbox").removeAttr("checked");$(".mergeItemQ3").attr("checked","checked");aU()});aT.click(function(){$(".mergeItemForm :checkbox").removeAttr("checked");$(".mergeItemQ4").attr("checked","checked");aU()});aQ.click(function(){$(".mergeItemForm :checkbox").removeAttr("checked");$(".mergeItemQ5").attr("checked","checked");aU()});$(".mergeItemForm :checkbox").click(function(){aU()});$("#equipmentTable").prepend(aR,aP,aW,aV,aT,aQ)}function t(){var bt=[0.1,0.2,0.4,0.6,0.8,1.1];var bH=[0.2,0.4,0.6,0.8,1.1,1.4];var bW=[0.5,1,1.5,2,3,4];var a6=[1,1.5,2,3,4,5.5];var a8=[0,1.5,3,4.5,6,7.5];var bl=[1.5,3,4.5,6,7.5,9];var bS=[0,1,2,3,4,6];var a5=[1,2,3,4,6,8];var bc=[0,1,2,3,4,6];var bn=[1,2,3,4,6,8];var aU=[0,1,2,3,4,6];var bf=[1,2,3,4,6,8];var bI=[0,2,4,6,8,12];var aV=[2,4,6,8,12,16];var bp=[10,16,20,24,28,40];var bF=[16,20,24,28,40,60];var bj=[20,40,50,60,70,90];var bx=[40,50,60,70,90,130];var bN=[3,4,5,6,7,8];var a0=[4,5,6,7,8,10];var aS=[2,2.5,3,3.5,4,4.5];var bd=[2.5,3,3.5,4,4.5,5];var bu=[1,1,1,1,1,1,1,0,0,0,0];var bw=[1,1,1,1,1,1,1,0,0,0,0];var bJ=[1,1,1,1,1,1,1,0,0,0,0];var by=[1,1,1,1,1,1,1,0,1,0,0];var bB=[1,1,1,1,1,1,1,0,1,0,0];var bO=[1,1,1,1,1,1,1,0,0,0,0];var bg=[1,1,1,1,1,1,1,0,0,0,0];var br=[1,1,0,0,1,0,0,1,1,0,0];var bC=[1,0,1,1,1,0,0,1,0,0,0];var bQ=[1,0,1,1,1,0,0,0,0,0,0];var a9=[1,0,1,1,1,0,0,1,0,0,0];var aZ=[1,0,1,1,1,0,0,0,0,0,0];var a2=[1,0,1,1,1,0,0,0,0,0,0];var a1=[1,1,1,1,1,0,0,0,0,0,0];var aY=[1,1,1,1,1,0,0,0,0,0,0];var bm=[1,1,0,0,1,0,0,1,1,0,0];var bv=[0,1,1,0,0,1,1,0,0,0,1];var bG=[1,1,1,0,0,1,1,0,0,0,1];var bY=[0,1,1,0,0,1,1,0,0,0,1];var bK=[0,1,1,0,0,1,1,0,0,0,1];var bL=[0,1,1,0,0,1,1,0,0,0,1];var aR=[0,1,1,1,0,1,1,0,0,0,1];var aQ=[0,1,1,1,0,1,1,0,0,0,1];var bh=[1,1,0,0,1,0,0,1,1,0,0];var bq=[1,1,1,1,1,0,0,0,1,1,0];var bA=[1,1,1,1,1,0,0,0,1,1,0];var bb=[1,1,1,1,1,0,0,0,1,1,0];var a3=[1,1,1,1,1,0,0,1,1,1,0];var a4=[1,1,1,1,1,0,0,0,1,1,0];var bT=[1,1,1,1,1,1,1,0,1,1,0];var be=[1,1,1,1,1,1,1,0,1,1,0];var bE=[1,1,0,0,1,0,0,1,1,0,0];var aW=[0,1,1,0,1,0,0,0,0,1,1];var ba=[0,1,1,0,1,0,0,1,0,1,1];var aT=[0,1,1,0,1,0,0,0,0,1,1];var bV=[0,1,1,0,1,0,0,0,0,1,1];var bX=[0,1,1,0,1,0,0,0,0,1,1];var bk=[0,1,1,0,1,0,0,1,0,1,1];var bz=[0,1,1,0,1,0,0,1,0,1,1];var bM=[1,1,0,0,1,0,0,1,1,0,0];var bi=["pirate","postapo","future","ee"];var a7=["helmet","vision","armor","pants","shoes","weapon","offhand","charm"];var bU=["Reduce miss chance","Increase critical chance","Increase maximum damage","Increase damage","Increase chance to avoid damage","Increase strength","Increase hit","Increase economy skill","Increase chance for free flight","Increase chance to use less weapons for Berserk","Increase chance to find a weapon"];bR();bo();function bZ(b1){var b4=b1.split(" by ");var b5=b4[0].trim();var b3=b4[1].trim();if(b3.substring(b3.length-1)=="%"){b3=b3.substring(0,b3.length-1).trim()}var b2=[0,0];for(var b0=0;b0<bU.length;b0++){if(b5==bU[b0]){b2[0]=b0;break}}b2[1]=parseFloat(b3);return b2}function bP(b2,b1){var b0=[0,0];switch(b2){case 0:b0[0]=a8[b1];b0[1]=bl[b1];return b0;case 1:b0[0]=bS[b1];b0[1]=a5[b1];return b0;case 2:b0[0]=bI[b1];b0[1]=aV[b1];return b0;case 3:b0[0]=aU[b1];b0[1]=bf[b1];return b0;case 4:b0[0]=bc[b1];b0[1]=bn[b1];return b0;case 5:b0[0]=bp[b1];b0[1]=bF[b1];return b0;case 6:b0[0]=bj[b1];b0[1]=bx[b1];return b0;case 7:b0[0]=bt[b1];b0[1]=bH[b1];return b0;case 8:b0[0]=bW[b1];b0[1]=a6[b1];return b0;case 9:b0[0]=bN[b1];b0[1]=a0[b1];return b0;case 10:b0[0]=aS[b1];b0[1]=bd[b1];return b0;default:console.log("获取装备属性数值范围时parameter越界："+b2);b0[0]=0;b0[1]=0;return b0}}function bR(){var b1=$(".equipmentBack",$(".testDivblue")).attr("class");b1=parseInt(b1.substring(b1.length-1))-1;var b0=$("h4");b0.each(function(){var b3=this.innerText;var b4=bZ(b3);var b2=bP(b4[0],b1);var b6=(b2[1]-b4[1])/3;var b5=(b2[1]-b2[0])*0.9+b2[0];if(b4[1]<b5){this.append("（强化+"+b6.toFixed(2)+"）")}else{this.append("（无法强化）")}})}function aP(b1,b0){if(b1==0){if(b0==0){return bu}if(b0==1){return bw}if(b0==2){return bJ}if(b0==3){return by}if(b0==4){return bB}if(b0==5){return bO}if(b0==6){return bg}if(b0==7){return br}return[0,0,0,0,0,0,0,0,0,0,0]}if(b1==1){if(b0==0){return bC}if(b0==1){return bQ}if(b0==2){return a9}if(b0==3){return aZ}if(b0==4){return a2}if(b0==5){return a1}if(b0==6){return aY}if(b0==7){return bm}return[0,0,0,0,0,0,0,0,0,0,0]}if(b1==2){if(b0==0){return bv}if(b0==1){return bG}if(b0==2){return bY}if(b0==3){return bK}if(b0==4){return bL}if(b0==5){return aR}if(b0==6){return aQ}if(b0==7){return bh}return[0,0,0,0,0,0,0,0,0,0,0]}if(b1==3){if(b0==0){return bq}if(b0==1){return bA}if(b0==2){return bb}if(b0==3){return a3}if(b0==4){return a4}if(b0==5){return bT}if(b0==6){return be}if(b0==7){return bE}return[0,0,0,0,0,0,0,0,0,0,0]}if(b1==4){if(b0==0){return aW}if(b0==1){return ba}if(b0==2){return aT}if(b0==3){return bV}if(b0==4){return bX}if(b0==5){return bk}if(b0==6){return bz}if(b0==7){return bM}return[0,0,0,0,0,0,0,0,0,0,0]}return[0,0,0,0,0,0,0,0,0,0,0]}function aX(b0){switch(b0){case 0:return"miss";case 1:return"暴击";case 2:return"大伤";case 3:return"小伤";case 4:return"免体";case 5:return"力量";case 6:return"伤害点";case 7:return"经济技能";case 8:return"免费飞行";case 9:return"减少连击消耗";case 10:return"捡到手枪";default:return"[未知属性]"}}function bs(b0){for(var b1=0;b1<bi.length;b1++){if(b0==bi[b1]){return b1+1}}return -1}function bD(b1){for(var b0=0;b0<a7.length;b0++){if(b1==a7[b0]){return b0}}return -1}function bo(){var b1=$(".equipmentBack",$(".testDivblue")).children().attr("class");b1=b1.split(" ")[1];b1=b1.substring(0,b1.length-1);var b6=b1.split("_");var b7,b4;if(b6.length==1){b7=0;b4=bD(b6[0])}else{b7=bs(b6[0]);b4=bD(b6[1])}var b5=aP(b7,b4);var b0="可以刷出的属性：";for(var b3=0;b3<b5.length;b3++){if(b5[b3]>0){b0=b0+aX(b3)+"、"}}var b2=$(".dashedLine :eq(1)");b2.before("<br />");b2.before(b0)}}function B(){var aU=$(".statisticsTable");var aP=$("tr",aU);var aT=aP.eq(0);aT.append('<td><button class="foundation-style" id="ehShowAll">查看所有</button></td>');$("#ehShowAll").click(function(){$(this).attr("disabled","disabled");setTimeout(function(){$("#ehShowAll").attr("disabled",false)},10000);$('[id^="ehShow_"]').click()});function aS(aY){var aX=parseInt(aY.replace(/,/g,"").replace(/\xA0/g,""));return aX>1000000?((aX/1000000).toFixed(1)+"M"):aY}for(var aR=1;aR<aP.length;++aR){var aV=aP.eq(aR);$("td:eq(5)",aV).text(aS($("td:eq(5)",aV).text()));$("td:eq(6)",aV).text(aS($("td:eq(6)",aV).text()));var aW=$('a[href^="militaryUnit.html?id="]',aV).attr("href").replace("militaryUnit.html?id=","");var aQ=$('<button style="padding:10px;" class="foundation-style" id="ehShow_'+aW+'">查看军令</button>');aV.append($("<td>").append(aQ));aQ.click(function(){$(this).attr("disabled","disabled");var aX=$(this).attr("id").replace("ehShow_","");$.ajax({url:"militaryUnit.html?id="+aX,timeout:9000,success:function(a0){var a6=$("#ehShow_"+aX);var a5=$('img[src="//cdn.e-sim.org//img/newOnline.png"]',a0).prev();var a2=a5.prev();var a7=a2.prev();var aZ=$("td:eq(3)",a6.parent().parent());aZ.append('<b title="统计在线的人数">('+a5.length+"人在线)</b>");for(var a1=0;a1<a5.length;++a1){aZ.append($("<div>",{style:"text-align:left;"}).append(a7.eq(a1),a2.eq(a1),a5.eq(a1)))}if($("#pagination-digg",a0).length>0){$.ajax({url:"militaryUnit.html?id="+aX+"&page=2",success:function(bd){var bc=$('img[src="//cdn.e-sim.org//img/newOnline.png"]',bd).prev();var bb=bc.prev();var a8=bb.prev();var a9=parseInt(aZ.find("b:eq(1)").text().replace(/[^0-9]/g,""));a9+=bc.length;aZ.find("b:eq(1)").text("("+a9.toString()+"人在线)");for(var ba=0;ba<bc.length;++ba){aZ.append($("<div>",{style:"text-align:left;"}).append(a8.eq(ba),bb.eq(ba),bc.eq(ba)))}},error:function(a8,a9){$.ajax(this)}})}var a4=$('div.battleDiv a[href^="battle.html"]',a0).parent();var aY=$("div.xflagsMedium",$("div.battleDiv",a0).parent().parent());if(aY.length!=3){a6.after("无军令");a6.remove();return}if(aY.eq(0).attr("class")===aY.eq(2).attr("class")){aY.eq(0).attr("style","vertical-align:middle;");var a3=w(aY.eq(1).attr("class"));aY.eq(1).attr("class","xflagsSmall xflagsSmall-"+a3);aY.eq(1).attr("style","vertical-align:middle;")}else{aY.eq(1).attr("style","vertical-align:middle;");var a3=w(aY.eq(0).attr("class"));aY.eq(0).attr("class","xflagsSmall xflagsSmall-"+a3);aY.eq(0).attr("style","vertical-align:middle;")}a6.after(a4,aY.eq(0),"vs",aY.eq(1));a6.remove()},error:function(aY,aZ){console.log(url,"抓取错误 (",aZ,")");$("#ehShow_"+aX).click()}})})}}function q(aU){if(config.fetchCurrencyDisabled){return}if($(".dataTable:first tr:eq(1) td",aU).length===1){return}var aQ=w($(".dataTable:first tr:eq(1) td:eq(1) div.xflagsSmall",aU).attr("class"));var aS=parseFloat($(".dataTable:first tr:eq(1) td:eq(2) b",aU).text().replace(",","."));var aR=w($(".dataTable:first tr:eq(1) td:eq(2) div.xflagsSmall",aU).attr("class"));if(aR==="Gold"){var aT=countryInfo[aQ].id;if(currencyRatio[aT]===undefined){currencyRatio[aT]={}}var aP=currencyRatio[aT];if(aP.buy===undefined){aP.buy={}}aP.buy.ratio=1/aS;ar(aP.buy);localStorage.setItem("currencyRatio",JSON.stringify(currencyRatio))}else{var aT=countryInfo[aR].id;if(currencyRatio[aT]===undefined){currencyRatio[aT]={}}var aP=currencyRatio[aT];if(aP.sell===undefined){aP.sell={}}aP.sell.ratio=aS;ar(aP.sell);localStorage.setItem("currencyRatio",JSON.stringify(currencyRatio))}}function ao(){$("div.xflagsSmall + b").each(function(){var aV=$(this);if(isNaN(aV.text())){return}var aS=w(aV.prev().attr("class"));var aW=countryInfo[aS]&&countryInfo[aS].id;if(!aW||!currencyRatio[aW]||!currencyRatio[aW].sell||!currencyRatio[aW].buy){return}var a0=countryInfo[aW]&&countryInfo[aW].currencyName;if(aV.parent().text().indexOf(aV.text()+" "+a0)===-1){return}var aP=parseFloat(aV.text());var aX=(currencyRatio[aW].sell.ratio);var aQ=aP/aX;var aR=(currencyRatio[aW].buy.ratio);var aY=aP/aR;var aZ=Math.abs(aQ-aY)<0.01;var aU=((aX+aR)/2).toPrecision(4);var aT=((aQ+aY)/2).toPrecision(4);aQ=aQ.toPrecision(4);aY=aY.toPrecision(4);if(aZ){if(aV.next().length===1){aV.next().before("(",$("<b>",{text:aT,title:""+aU+" "+a0+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{aV.parent().append("(",$("<b>",{text:aT,title:""+aU+" "+a0+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}}else{if(aV.next().length===1){aV.next().before("(",$("<b>",{text:aY+" 或 "+aQ,title:"用 "+aY+" Gold买 "+aP+" "+a0+"，或用 "+aP+" "+a0+"卖 "+aQ+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{aV.parent().append("(",$("<b>",{text:aY+" 或 "+aQ,title:"用 "+aY+" Gold买 "+aP+" "+a0+"，或用 "+aP+" "+a0+"卖 "+aQ+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}}});$("td b").each(function(){var aR=$(this).text().trim().split(" ");if(aR.length!==2||isNaN(aR[0])||!countryInfo[aR[1]]){return}var aV=parseFloat(aR[0]);var a0=aR[1];var aW=countryInfo[a0]&&countryInfo[a0].id;if(!aW||!currencyRatio[aW]||!currencyRatio[aW].sell||!currencyRatio[aW].buy){return}var aP=parseFloat(aR[1]);var aX=(currencyRatio[aW].sell.ratio);var aQ=aP/aX;var aS=(currencyRatio[aW].buy.ratio);var aY=aP/aS;var aZ=Math.abs(aQ-aY)<0.1;var aU=((aX+aS)/2).toPrecision(4);var aT=((aQ+aY)/2).toPrecision(4);aQ=aQ.toPrecision(4);aY=aY.toPrecision(4);if(aZ){$(this).after(" (",$("<b>",{text:aT,title:""+aU+" "+a0+" = 1 Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}else{$(this).after(" (",$("<b>",{text:aY+" 或 "+aQ,title:"用 "+aY+" Gold买 "+aP+" "+a0+"，或用 "+aP+" "+a0+"卖 "+aQ+" Gold"}),$("<div>",{"class":"xflagsSmall xflagsSmall-Gold"}),")")}})}function W(){clipWithFlag=false;$("#battleHeaderImage").attr("style","height:85px; background-color:#222");$("#battleHeaderImage img").remove();var aP=$(".small-2").eq(1);aP.attr("id","ehPanel");aP.prev().attr("class",aP.prev().attr("class").replace("small-4","small-2"));aP.next().attr("class",aP.next().attr("class").replace("small-4","small-2"));aP.attr("class",aP.attr("class").replace("small-2","small-3"));aP.after($("<div>",{"class":aP.attr("class"),id:"ehRefresh"}));aP.empty();var a0=[["调试","Debug","bug"],["飞行","Flight","airplane"],["统计","Statistics","stocks"],["特殊","Special","uniF00F"],["观战","Spectator","eye"],["详细","SpectatorDetail","users"],["闹钟","Alarm","uptime"],["高级","Advanced","uniF478"]];var aZ="padding:6px 2px 6px 2px;";var aT=aZ+" color:orange;";for(var aV=0;aV<a0.length;++aV){var aX=$('<button class="small button foundation-style" style="'+aZ+'" id="ehButton'+a0[aV][1]+'"> <i class="icon-'+a0[aV][2]+'"></i>'+a0[aV][0]+"</button> ");var aQ=$("<div>",{"class":"foundation-radius fightContainer foundation-base-font",style:"display:none;",id:"ehDiv"+a0[aV][1]});aX.click(function(){if(this.getAttribute("style")==aZ){$("[id^=ehButton]").attr("style",aZ);$("[id^=ehDiv]").attr("style","display:none;");this.setAttribute("style",aT);$("#"+this.getAttribute("id").replace("Button","Div")).attr("style","display:block;")}else{$("[id^=ehButton]").attr("style",aZ);$("[id^=ehDiv]").attr("style","display:none;")}});aP.append(aX);var a1=localStorage.getItem("battleEnhanceDivPlacement");if(a1==null||a1!="true"){aP.parent().after(aQ)}else{$("#battleSelectable:first").before(aQ)}}h();ak();C();F();ai();L();ab();D();V();at();P();Q();v();x();aJ();var aS=localStorage.getItem("battleBorderless");if(aS==="true"){aD()}$("#recentDefenders").parent().parent().prependTo($("#recentDefenders").parent().parent().parent().parent());$("#minimalChatpanel").remove();var aY=localStorage.getItem("addEmptyRecentRecord");if(aY==="true"){var a2=$("#recentDefenders");var aR=$("#recentAttackers");for(var aU=1;aU<=5;aU++){if($("#recentDefender"+aU).length<=0){$('<span style="display:block" id="recentDefender'+aU+'">插件预置栏位</span>').appendTo(a2)}}for(var aW=1;aW<=5;aW++){if($("#recentAttacker"+aW).length<=0){$('<span style="display:block" id="recentAttacker'+aW+'">插件预置栏位</span>').appendTo(aR)}}}unsafeWindow.addRecentHits=function(be,bb){if(bb.length==0){return}var a7;if(be){a7="#recentAttackers"}else{a7="#recentDefenders"}var bg=bb[0].htmlCode;var a5=">[0-9,]+<";var a3=bg.match(a5);var a4=a3[a3.length-1].substring(1,a3[a3.length-1].length-1);var bc=parseInt(a4.replace(/,/g,""));var bf=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var a6=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var ba=Math.abs(bf-a6);var a9;if(ba==0){a9=1000}else{a9=bc*100/ba}var bd;if(a9>50){bd="rgb(100%,"+parseInt(200-a9*2)+"%,0%)"}else{bd="rgb("+parseInt(a9*2)+"%,100%,0%)"}var a8="(<span style='color:"+bd+"'>"+a9.toFixed(0)+"%</span>)";bg=bg.replace(a4,a4+a8);$(a7+" > span:last-child").fadeOut("300",function(){$(a7+" > span:last-child").remove();$(a7+" > span:nth-child(2)").before('<span style="display:block;"></span>');$(a7+" > span:nth-child(2)").animate({},function(){$(a7+" > span:nth-child(2)").append(bg);$(a7+" > span:nth-child(2) > span").fadeIn("300")})})}}function aD(){GM_addStyle("#newFightView .fightContainer { margin: 0em!important;padding: .3em!important;border-style:none;}");GM_addStyle("#newFightView .fightContainer .topPlayer { padding-top: 0px!important;}");GM_addStyle("#newFightView .fightContainer .topPlayer a img { margin: 0px auto!important;}");GM_addStyle("#newFightView .fightContainer .fightRounds { margin: 0em!important;}");GM_addStyle("#newFightView .fightContainer #roundCountdown { font-size: 2.4em!important;margin:0 0!important;}");GM_addStyle("#battleSelectable #selectable4, #battleSelectable #selectable5, #battleSelectable #selectable6 { height: 30px!important;}");GM_addStyle("#battleSelectable #selectable4 li, #battleSelectable #selectable5 li, #battleSelectable #selectable6 li { height: 30px!important;}");GM_addStyle(".laurelssprite { height: 90px!important;}");$("i.icon-bread.ui-selectee").remove();$("i.icon-gift-2.ui-selectee").remove();$("i.icon-uniF470.ui-selectee").remove();$("i.icon-tank.ui-selectee").remove();var aQ=$(".topPlayer").children();for(var aP=0;aP<aQ.length;++aP){if(aQ[aP].outerHTML=="<br>"){$(".topPlayer")[0].removeChild(aQ[aP])}}$("#moreBattleStats").parent().remove()}function aJ(){var aQ=$("#medkitForm");if(aQ.length>0){var aP=$("<button>",{id:"sendMedkitRequest","class":"button smallhelp foundation-style",text:"无需确认直接使用医疗包（当前页面不会刷新额度显示）"}).prependTo(aQ.parent());aP.click(function(){aP.attr({disabled:true});var aR="item=MEDKIT&storageType=SPECIAL_ITEM&action=USE";$.ajax({type:"POST",url:"storage.html",data:aR,success:function(){aP.attr({disabled:false});console.log("使用医疗包：成功响应")},error:function(aS,aT){console.log("使用医疗包时发生错误")}})})}}function X(){if(isNaN(endEpoch)){endEpoch=(new Date().getTime())+o()*1000}var aP=parseInt((endEpoch-new Date().getTime())/1000)-timeBias;return aP<0?0:aP}function o(){var aP=$("#roundCountdown");hmsArray=aP.text().split(/:| /);return parseInt(hmsArray[0])*3600+parseInt(hmsArray[1])*60+parseInt(hmsArray[2])}function O(aQ){var aP=(parseInt(aQ/60))%60;var aR=aQ%60;return"0"+parseInt(aQ/3600)+(aP<10?":0":":")+aP+(aR<10?":0":":")+aR}function h(){$("#ehDivDebug").append($("<div>",{style:"text-align:left;"}));var aR=$('a[href^="region.html?id="][href!="region.html?id="]');userId=parseInt($("#userName").attr("href").replace("profile.html?id=",""));userName=$("#userName").text();userLocationId=parseInt(aR.first().attr("href").replace("region.html?id=",""));userLocationName=aR.first().text();userCitizenshipId=parseInt($('li > a[href^="battles.html?countryId="][href$="&sorting=BY_TOTAL_DAMAGE&_substidedOnly=on"]').attr("href").match(/.+?countryId=([0-9]+).+?/)[1]);battleId=parseInt($('a[href^="battleStatistics.html?id="]').attr("href").replace("battleStatistics.html?id=",""));battleName=$("#fightName a[class=fightFont]").text().trim();battleLocationId=parseInt(aR.length==1?-1:aR.last().attr("href").replace("region.html?id=",""));battleLocationName=battleLocationId==-1?"无":battleName;isResistance=($("#fightName div").length>0);roundId=parseInt($("span.fightFont").text().match("[0-9]+$")[0]);battleRoundId=parseInt($("#battleRoundId").val());if($(".xflagsBig").length>0){defenderName=$(".xflagsBig:first").attr("class").split(" ").pop();defenderName=defenderName.substring(defenderName.indexOf("-")+1);attackerName=$(".xflagsBig:last").attr("class").split(" ").pop();attackerName=attackerName.substring(attackerName.indexOf("-")+1)}else{if($(".flags-big").length>0){defenderName=$(".flags-big:first").attr("class").split(" ").pop();attackerName=$(".flags-big:last").attr("class").split(" ").pop()}else{if($(".muAvatar").length>0){defenderName=$(".alliesList.leftList.fightFont").text().trim();attackerName=$(".alliesList.rightList.fightFont").text().trim()}else{defenderName="未知";attackerName="未知"}}}defenderId=countryInfo[defenderName]&&countryInfo[defenderName].id;attackerId=countryInfo[attackerName]&&countryInfo[attackerName].id;defenderScore=$('img[src$="/img/blue_ball.png"]').length;attackerScore=$('img[src$="/img/red_ball.png"]').length;defenderDescription=battleName+", "+defenderName+"方";attackerDescription=battleName+", "+attackerName+"方";isActive=roundId>(defenderScore+attackerScore);if($("#fightButton1").length>0){isActive=true}isPremium=$("#totalspectators").length>0;d("玩家id=",userId,", 玩家名字=",userName,", 国籍=",userCitizenshipId,", 会员=",isPremium,", 当前位置=",userLocationName," (",userLocationId,")");d("战斗id=",battleId,", 战斗名字=",battleName,", 战斗地点=",battleLocationName," (",battleLocationId,")");d("起义战=",isResistance,", 局数=",roundId,", battleRoundId=",battleRoundId,", 战斗中=",isActive);d(defenderName," v.s. ",attackerName,", 比分",defenderScore,":",attackerScore);timeBias=0;endEpoch=(new Date().getTime())+7200*1000;if(clipWithFlag){defenderNameOrFlag="/"+defenderName.slice(0,5);attackerNameOrFlag="/"+attackerName.slice(0,5)}else{defenderNameOrFlag=defenderName;attackerNameOrFlag=attackerName}if(battleLocationId==-1){document.title=battleName}else{var aP=countryInfo[defenderName].shortName;var aQ=countryInfo[attackerName].shortName;if(defenderName=="Kekistan"){aP="KK"}if(attackerName=="Kekistan"){aQ="KK"}document.title=aP+" vs "+aQ+" @"+battleName}}function d(){var aP=$("#ehDivDebug > div");aP.append($(".time").first().text().split(" ")[0].slice(0,-1),": ");for(var aQ=0;aQ<arguments.length;aQ++){aP.append(arguments[aQ].toString()," ")}aP.append("<br />")}function P(){var aW=$(".fightButton").length;var aY,aX,aR,aP,aS,aQ,aT;if(aW===2){aY=$("#fightButtonBerserk1").parent();aT=$("#fightButtonBerserk1").attr("name");aY.append("<br />");aR=$("<a id='foodWithFight1' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' href='#' title='' value='Berserk' name='"+aT+"'> Hit & food</a>");aY.append(aR);aS=$("<a id='giftWithFight1' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' href='#' title='' value='Berserk' name='"+aT+"'>Hit & gift</a>");aY.append(aS)}else{if(aW===4){aY=$("#fightButtonBerserk1").parent();aT=$("#fightButtonBerserk1").attr("name");aY.append("<br />");aR=$("<a id='foodWithFight1' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aT+"'> Hit & food</a>");aY.append(aR);aS=$("<a id='giftWithFight1' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aT+"'>Hit & gift</a>");aY.append(aS);aX=$("#fightButtonBerserk2").parent();aT=$("#fightButtonBerserk2").attr("name");aX.append("<br />");aP=$("<a id='foodWithFight2' class='button foundation-style smallhelp profileButton foodWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aT+"'> Hit & food</a>");aX.append(aP);aQ=$("<a id='giftWithFight2' class='button foundation-style smallhelp profileButton giftWithFight' style='font-size: 0.95em !important; padding: 0.5em !important;' title='' value='Berserk' name='"+aT+"'>Hit & gift</a>");aX.append(aQ);aP.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)");aQ.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)")}}if(aW!==0){aR.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)");aS.css("background-image","linear-gradient(to bottom, #c00 0px, #a00 100%)")}unsafeWindow.$(".fightButton").unbind("click");$(".fightButton").click(function(a2){a2.preventDefault();a2.stopPropagation();var a0=$(this)[0].name;var a1=$(this).attr("value");K(a0,a1);return false});$(".foodWithFight").click(function(a2){a2.preventDefault();a2.stopPropagation();if(parseFloat($("#actualHealth").html())<=51||(o()%5)==0){aU()}var a0=$(this)[0].name;var a1=$(this).attr("value");K(a0,a1);return false});$(".giftWithFight").click(function(a2){a2.preventDefault();a2.stopPropagation();if(parseFloat($("#actualHealth").html())<=51||(o()%5)==0){aZ()}var a0=$(this)[0].name;var a1=$(this).attr("value");K(a0,a1);return false});function aU(){var a1="quality="+$("#foodQuality").val();if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"eat.html",data:a1,success:function(a2){aV(a2)}})}else{var a0=$.ajax({type:"POST",url:"eat.html",timeout:varBattleAjaxTimeout*1000,data:a1,success:function(a2){aV(a2)},error:function(a2,a4,a3){if(a4=="timeout"){a0.abort()}}})}}function aZ(){var a0="quality="+$("#giftQuality").val();if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"gift.html",data:a0,success:function(a2){aV(a2)}})}else{var a1=$.ajax({type:"POST",url:"gift.html",timeout:varBattleAjaxTimeout*1000,data:a0,success:function(a2){aV(a2)},error:function(a2,a4,a3){if(a4=="timeout"){a1.abort()}}})}}function aV(a1){var a0=jQuery.parseJSON(a1);$("#foodLimit").html(a0.foodLimit);$("#giftLimit").html(a0.giftLimit);$("#foodLimit2").html(a0.foodLimit);$("#giftLimit2").html(a0.giftLimit);$("#wellness").html(a0.wellness);$("#healthBar").html(a0.wellness);$("#healthProgress .ui-progressbar-value").animate({width:a0.wellness+"%"},{queue:false});$("#actualHealth").html(a0.wellness);$("#foodQ1").html("<b>Q1</b><br>"+a0.q1FoodStorage);$("#foodQ2").html("<b>Q2</b><br>"+a0.q2FoodStorage);$("#foodQ3").html("<b>Q3</b><br>"+a0.q3FoodStorage);$("#foodQ4").html("<b>Q4</b><br>"+a0.q4FoodStorage);$("#foodQ5").html("<b>Q5</b><br>"+a0.q5FoodStorage);$("#giftQ1").html("<b>Q1</b><br>"+a0.q1GiftStorage);$("#giftQ2").html("<b>Q2</b><br>"+a0.q2GiftStorage);$("#giftQ3").html("<b>Q3</b><br>"+a0.q3GiftStorage);$("#giftQ4").html("<b>Q4</b><br>"+a0.q4GiftStorage);$("#giftQ5").html("<b>Q5</b><br>"+a0.q5GiftStorage);$("#sfoodQ1").html("<b>Q1</b><br>"+a0.q1FoodStorage);$("#sfoodQ2").html("<b>Q2</b><br>"+a0.q2FoodStorage);$("#sfoodQ3").html("<b>Q3</b><br>"+a0.q3FoodStorage);$("#sfoodQ4").html("<b>Q4</b><br>"+a0.q4FoodStorage);$("#sfoodQ5").html("<b>Q5</b><br>"+a0.q5FoodStorage);$("#sgiftQ1").html("<b>Q1</b><br>"+a0.q1GiftStorage);$("#sgiftQ2").html("<b>Q2</b><br>"+a0.q2GiftStorage);$("#sgiftQ3").html("<b>Q3</b><br>"+a0.q3GiftStorage);$("#sgiftQ4").html("<b>Q4</b><br>"+a0.q4GiftStorage);$("#sgiftQ5").html("<b>Q5</b><br>"+a0.q5GiftStorage)}}function K(aP,aS){var aQ="weaponQuality="+$("#weaponQuality").attr("value")+"&battleRoundId="+$("#battleRoundId").val()+"&side="+aP+"&value="+aS;if(varEnableBattleAjaxTimeout==false){$.ajax({type:"POST",url:"fight.html",data:aQ,success:function(aV){$("#fightResponse > div").replaceWith(aV);aE($(aV));var aU=$("#healthUpdate",aV).text();if(aU!==""){var aT=aU.substr(0,aU.length-3);if(aT<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:aT+"%"},{queue:false});$("#healthProgress").attr("title",aT+" / 100");$("#actualHealth").html(aT)}},error:function(aU,aY,aW){if(aU.status=="404"){var aX=window.location.protocol;var aT=window.location.href;if(aX=="http:"){aT="https:"+aT.substring(5);alert("404错误！点击“确认”立刻切换协议为：https！\r\n建议删除cookie以解决此问题。");location=aT}else{if(aX=="https:"){aT="http:"+aT.substring(6);alert("404错误！点击“确认”立刻切换协议为：http！\r\n建议删除cookie以解决此问题。");location=aT}else{alert("404错误！请立刻切换协议！\r\n建议删除cookie以解决此问题。")}}}else{var aV=$("#showMsg");aV.text("错误："+aU.status);aV.show();aV.fadeOut(2000)}}})}else{var aR=$.ajax({type:"POST",url:"fight.html",timeout:varBattleAjaxTimeout*1000,data:aQ,success:function(aV){$("#fightResponse > div").replaceWith(aV);aE($(aV));var aU=$("#healthUpdate",aV).text();if(aU!==""){var aT=aU.substr(0,aU.length-3);if(aT<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:aT+"%"},{queue:false});$("#healthProgress").attr("title",aT+" / 100");$("#actualHealth").html(aT)}},error:function(aU,aY,aW){if(aU.status=="404"){var aX=window.location.protocol;var aT=window.location.href;if(aX=="http:"){aT="https:"+aT.substring(5);alert("404错误！点击“确认”立刻切换协议为：https！\r\n建议删除cookie以解决此问题。");location=aT}else{if(aX=="https:"){aT="http:"+aT.substring(6);alert("404错误！点击“确认”立刻切换协议为：http！\r\n建议删除cookie以解决此问题。");location=aT}else{alert("404错误！请立刻切换协议！\r\n建议删除cookie以解决此问题。")}}}else{if(aY=="timeout"){aR.abort();var aV=$("#showMsg");aV.text("请求超时");aV.show();aV.fadeOut(2000)}else{var aV=$("#showMsg");aV.text("错误："+aU.status);aV.show();aV.fadeOut(2000)}}}})}}function aE(aW){function aQ(a7){a7+="";var a5=a7.split(".");var a6=/(\d{1,3})(?=(\d{3})+$)/g;return a5[0].replace(a6,"$1,")+(a5.length==2?"."+a5[1]:"")}var a3=$("#showMsg");a3.text("");a3.show();var aS=$("#DamageDone",aW);if(aS.length>0){var a1=parseInt(aS.text().replace(/,/g,"").replace(/\xA0/g,""));var a4=$(".fightsprite",aS.parent().parent());var aX={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var aY={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var aV=0;aV<a4.length;++aV){var a2=a4.eq(aV).attr("class").split(" ").pop();if(a2 in aY){var aR=aY[a2];aX[aR[0]]=aR[1]}}var aT="";var aU=aX.xp;delete aX.xp;for(aV in aX){aT='<i style="color:'+aX[aV][0]+';" class="icon-'+aV+'" title="'+aX[aV][1]+'"></i>'+aT}aT+='<b title="'+aU+'次攻击">x'+aU+"</b>";var aP=$("#fightHistory");var a0=$("div[class^=foundation-style]",aP);if(a0.length===6){$("#ehHistoryExpand").show()}a0.slice(0,2).attr("style","opacity:0.6;");a0.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){a0.slice(4,6).hide()}var aZ=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(aZ){aP.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:aT}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:aS.text()}))}else{aP.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:aT}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:aS.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+aU);$("#ehTotalDamage").text(aQ(parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+a1))}else{a3.text($("#fightResponse").text().trim());a3.fadeOut(2000)}}function F(){if(!isActive||battleLocationId==-1){$("#ehButtonFlight").attr("disabled",true);return}var a3=$("#ehDivFlight");var aY=$("<div>");var aS=$("<td>",{id:"defenderRegions",style:"text-align:left; font-size:9px; width:280px"});var a4=$("<td>",{id:"attackerRegions",style:"text-align:right; font-size:9px; width:280px"});var a7=$("<td>",{style:"text-align:center; width:250px"});aY.append(aS,a7,a4);a3.append(aY);var aV=$("<select>",{id:"ticketQuality",name:"ticketQuality",style:"padding:3px; margin:3px"});for(var a2=1;a2<=5;++a2){aV.append($('<option value="'+a2+'">Q'+a2+"</option>"))}var aR=localStorage.getItem("ticketSelectQuality");if(aR!==null){aV.val(aR)}aV.change(function(){localStorage.setItem("ticketSelectQuality",aV.val())});var aZ=$("<button>",{text:"飞行","class":"small button foundation-style",style:"padding:5px; margin:3px;"});var a0=$("<input>",{type:"checkbox",id:"newFightFrameCheckbox"});var a1=$("<label>",{"class":"checkboxlabel","for":"newFightFrameCheckbox",text:"刷新攻击框 ",title:"飞行后不刷新网页，只刷新攻击框"});var aP=localStorage.getItem("newFightFrame");if(aP==null){localStorage.setItem("newFightFrame","false")}else{a0.attr("checked",aP=="true")}a0.click(function(){$("input[type='radio']:disabled",aY).removeAttr("disabled");if(a0.is(":checked")){localStorage.setItem("newFightFrame",true)}else{localStorage.setItem("newFightFrame",false)}});var aT=$("<div>");a7.append(aV,aZ,aT);var aU=$("<b>",{text:"强制刷新",style:"text-align:right;color:#0066cc;text-decoration:underline;cursor:pointer"});aU.click(function(){aT.text("正在更新...");a6(location)});a7.append(a0,a1,aU);var a5=$("form[action='travel.html']");if(a5.length>0){var aQ=a5.children(".foundation-text-center").children("select#ticketQuality");var aX;for(var a2=1;a2<=5;++a2){var aW=aQ.find("option[value="+a2+"]");if(aW.length<1){aX=0}else{aX=aW.text().split("(")[1].split(")")[0];if(aX.indexOf(",")>0){aX=aX.split(",")[0]}}if(aX!==""){$("#ticketQuality option[value='"+a2+"']").text("Q"+a2+" ("+aX+")")}else{$("#ticketQuality option[value='"+a2+"']").text("Q"+a2+" (0)")}}}else{$.ajax({url:"travel.html",success:function(bb){console.log("获取机票数量成功");var bc=$("select#ticketQuality",bb);var a8;for(var a9=1;a9<=5;++a9){var ba=bc.find("option[value="+a9+"]");if(ba.length<1){a8=0}else{a8=ba.text().split("(")[1].split(")")[0];if(a8.indexOf(",")>0){a8=a8.split(",")[0]}}if(a8!==""){$("#ticketQuality option[value='"+a9+"']").text("Q"+a9+" ("+a8+")")}else{$("#ticketQuality option[value='"+a9+"']").text("Q"+a9+" (0)")}}},error:function(a8,a9){console.log("获取机票数量失败 (",a9,")，重新抓取");$.ajax(this)}})}R();if(aP=="true"){$("input[type='radio']:disabled",aY).removeAttr("disabled")}aZ.click(function(){var a8=$("input[type='radio']:checked",aY);if(a8.length===0){aT.text("请选择地区");return}var ba=parseInt(aV.val());var a9=parseInt(a8.attr("countryId"));var bb=parseInt(a8.val());aT.text("使用Q"+ba+"机票飞往 "+countryInfo[a9].name+" 的 "+regionInfo[bb].name);$.ajax({url:"travel.html",type:"POST",data:{countryId:a9,regionId:bb,ticketQuality:ba},success:function(bc){if($("#newFightFrameCheckbox").is(":checked")===true){var bd=$("div.testDivred",bc);if(bd.length===1){aT.text("飞行失败："+bd.text().trim())}else{aT.text("飞行成功！更新攻击框中……");a6(location)}}else{var bd=$("div.testDivred",bc);if(bd.length===1){aT.text("飞行失败："+bd.text().trim())}else{aT.text("飞行成功！");if($("#fightButtonBerserk1").length===0){location=location}}}},error:function(bc,bd){console.log("飞行错误 (",bd,")")}})});function a6(a8){$.ajax({url:a8,success:function(bc){var a9=$("#battleRoundId",bc).parent();if($("#fightLeft").length>0){$("#fightRight").empty();$("#fightRight").append(a9.children());var bf=$("[id^=fightButton]");var bg=bf.parent().parent();$("[id^=fightButton] > i",bg).remove()}else{$("#battleRoundId").parent().replaceWith(a9);at()}var ba=parseFloat($("#actualHealth",bc).html());$("#healthProgress .ui-progressbar-value").animate({width:ba+"%"},{queue:false});$("#healthProgress").attr("title",ba+" / 100");$("#actualHealth").html(ba);P();v();E("advancedFightChooseTable");var bb=$('a[href^="region.html?id="][href!="region.html?id="]');var bh=bb.first().parent();var bd=$('a[href^="region.html?id="][href!="region.html?id="]',bc);var be=bd.first().parent();bh.replaceWith(be);aT.text("更新完毕！")}})}}function Q(){if(!isActive){return}if(defenderId==allies[0]){$(".xflagsBig-"+defenderName).after('<div class="fightFont">祖国</div>')}else{if(allies.indexOf(defenderId)>0){$(".xflagsBig-"+defenderName).after('<div class="fightFont">盟国</div>')}else{if(enemies.indexOf(defenderId)!==-1){$(".xflagsBig-"+defenderName).after('<div class="fightFont">敌国</div>')}else{if(coalitionMembers.indexOf(defenderId)>0){$(".xflagsBig-"+defenderName).after('<div class="fightFont">联盟成员国</div>')}}}}if(attackerId==allies[0]){$(".xflagsBig-"+attackerName).after('<div class="fightFont">祖国</div>')}else{if(allies.indexOf(attackerId)>0){$(".xflagsBig-"+attackerName).after('<div class="fightFont">盟国</div>')}else{if(enemies.indexOf(attackerId)!==-1){$(".xflagsBig-"+attackerName).after('<div class="fightFont">敌国</div>')}else{if(coalitionMembers.indexOf(attackerId)>0){$(".xflagsBig-"+attackerName).after('<div class="fightFont">联盟成员国</div>')}}}}if(allies.indexOf(defenderId)!==-1&&allies.indexOf(attackerId)===-1){var aP=defenderId==allies[0]?"祖国":"盟国";$(".flags-medium."+defenderName).after('<b style="color:lightgreen"><i class="icon-uniF479" />帮助'+aP+"</b>");$(".flags-medium."+attackerName).after('<b style="color:pink"><i class="icon-uniF478" />打反'+aP+"</b>")}else{if(allies.indexOf(defenderId)===-1&&allies.indexOf(attackerId)!==-1){var aP=attackerId==allies[0]?"祖国":"盟国";$(".flags-medium."+attackerName).after('<b style="color:lightgreen"><i class="icon-uniF479" />帮助'+aP+"</b>");$(".flags-medium."+defenderName).after('<b style="color:pink"><i class="icon-uniF478" />打反'+aP+"</b>");$("#copySideAttacker").attr("checked",true)}else{if(enemies.indexOf(defenderId)!==-1&&enemies.indexOf(attackerId)===-1){$(".flags-medium."+attackerName).after('<b style="color:lightgreen"><i class="icon-uniF479" />攻击敌国</b>');$(".flags-medium."+defenderName).after('<b style="color:pink"><i class="icon-uniF478" />帮助敌国</b>');$("#copySideAttacker").attr("checked",true)}else{if(enemies.indexOf(defenderId)===-1&&enemies.indexOf(attackerId)!==-1){$(".flags-medium."+defenderName).after('<b style="color:lightgreen"><i class="icon-uniF479" />攻击敌国</b>');$(".flags-medium."+attackerName).after('<b style="color:pink"><i class="icon-uniF478" />帮助敌国</b>')}else{}}}}}function v(){$(".flags-medium."+defenderName).attr("class","xflagsMedium xflagsMedium-"+defenderName);$(".flags-medium."+attackerName).attr("class","xflagsMedium xflagsMedium-"+attackerName)}function R(){function aU(bl,bj){var bi=[];for(var bh=0;bh<regionInfo[bl].neighbours.length;++bh){var bk=regionInfo[bl].neighbours[bh];if(regionInfo[bk].occupantId==bj){bi.push(bk)}}return bi}function aT(bi,bk,bl){var bm=[];var br=[bi];var bo=bl;var bp=false;bo.push(bi);while(br.length>0){var bh=br.pop();bm.push(bh);if(regionInfo[bh].homeCountry==bk){bp=true}var bq=aU(bh,bk);for(var bn=0;bn<bq.length;++bn){var bj=bq[bn];if(bo.indexOf(bj)==-1){br.push(bj);bo.push(bj)}}}return[bm,bp]}function bf(bi,bm,bl){var bh=regionInfo[bm].name;var bj=$("<input>",{type:"radio",name:"regionId",id:"rR"+bi.selector.substring(1,2)+"-"+bm,value:bm,countryId:regionInfo[bm].occupantId});var bk='<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bm].occupantId].flagName+'" />';if(regionInfo[bm].occupantId!=regionInfo[bm].homeCountry){bk+='(<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bm].homeCountry].flagName+'" />)'}bk+='<label for="rR'+bi.selector.substring(1,2)+"-"+bm+'"> '+regionInfo[bm].name+"</label>";if(regionInfo[bm].battle){bk+=' <i title="'+regionInfo[bm].name+'正在被攻击" class="icon-cannon"></i> '}if(!bl){bk+=" (被包围)";bh+="(被包围)"}if((userLocationId==bm)&&bj.attr("disabled","disabled")){bk+=" (你在这里)"}bi.append(bj,bk,"<br />");return bh}function a6(bi,bl){var bh=regionInfo[bl].name;var bj=$("<input>",{type:"radio",name:"regionId",id:"rR"+bi.selector.substring(1,2)+"-"+bl,value:bl,countryId:regionInfo[bl].occupantId});var bk='<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bl].occupantId].flagName+'" />';if(regionInfo[bl].occupantId!=regionInfo[bl].homeCountry){bk+='(<p class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[bl].homeCountry].flagName+'" />)'}bk+='<label for="rR'+bi.selector.substring(1,2)+"-"+bl+'"> '+regionInfo[bl].name+"</label>";if(regionInfo[bl].battle){bk+=' <i title="'+regionInfo[bl].name+'正在被攻击" class="icon-cannon"></i> '}bk+=" (断路)";bh+="(断路)";if((userLocationId==bl)&&bj.attr("disabled","disabled")){bk+=" (你在这里)"}bi.append(bj,bk,"<br />");return bh}defenderId=countryInfo[defenderName].id;attackerId=countryInfo[attackerName].id;var aQ=aT(battleLocationId,defenderId,[]);var ba=aQ[1];aQ=aQ[0];d("防守方被包围：",!ba);isAttackerLinkage=false;isDefenderLinkage=false;var aY=aU(battleLocationId,defenderId);if(aY.length===0){isDefenderLinkage=false;d(battleName,"不与防守方其它地区相连，所以",battleName,"不是守方连接地")}else{var bg=aT(aY[0],defenderId,[battleLocationId]);var aX=bg[1];bg=bg[0];if(bg.length==aQ.length-1){d(battleName,"丢掉后，防守方现在相连的地区仍相连，所以",battleName,"不是守方连接地")}else{if(!aX){isDefenderLinkage=true;d(battleName,"丢掉后，防守方现在相连的地区被切断，且",regionInfo[aY[0]].name,"不与本土相连，因此",battleName,"是守方连接地")}else{for(var a9=1;a9<aY.length;++a9){if(bg.indexOf(aY[a9])!=-1){continue}var aW=aT(aY[a9],defenderId,[battleLocationId])[1];if(aW){isDefenderLinkage=false;d(battleName,"丢掉后，防守方现在相连的地区被切断，但都与本土相连，因此",battleName,"不是守方连接地")}else{isDefenderLinkage=true;d(battleName,"丢掉后，防守方现在相连的地区被切断，且",regionInfo[aY[a9]].name,"不与本土相连，因此",battleName,"是守方连接地")}}}}}defenderLocationText=bf($("#defenderRegions"),battleLocationId,ba);attackerLocationText="";if(isResistance){attackerLocationText=bf($("#attackerRegions"),battleLocationId,true)}var aR=aU(battleLocationId,defenderId);var aV=[];var bc=false;for(var bb=0;bb<aR.length;++bb){aV=aT(aR[bb],defenderId,[]);bc=aV[1];defenderLocationText+=(defenderLocationText!==""?" 或 ":"")+bf($("#defenderRegions"),aR[bb],bc)}var a4=aU(battleLocationId,attackerId);var a7=[];var a0=[];var a2=false;var a8=false;var a1=null;for(var bb=0;bb<a4.length;++bb){var a3=a4[bb];if(a7.indexOf(a3)!=-1){continue}a8=bb>0;a0=aT(a4[bb],attackerId,[]);a2=a0[1];if(!a2){a1=a4[bb]}a0=a0[0];for(var a9=0;a9<a4.length;++a9){if(a0.indexOf(a4[a9])!=-1){if(!isResistance){attackerLocationText+=(attackerLocationText!==""?" 或 ":"")+bf($("#attackerRegions"),a4[a9],a2)}a7.push(a4[a9])}}}if(a4.length<=0){for(var a3=1;a3<parseInt(localStorage.getItem("maxRegionCount"));a3++){if(regionInfo[a3]!=undefined){if(regionInfo[a3].occupantId==attackerId){a6($("#attackerRegions"),a3)}}}}if(!a8){isAttackerLinkage=false;d(battleName,"攻克后，进攻方没连接新的地区，因此",battleName,"不是夺回连接地")}else{if(a1===null){isAttackerLinkage=false;d(battleName,"攻克后，进攻方的两组地区连成一片，但它们已与本土相连，因此",battleName,"不是夺回连接地")}else{isAttackerLinkage=true;d(battleName,"攻克后，进攻方被包围的"+regionInfo[a1].name+"将与另一地区相连，因此",battleName,"是夺回连接地")}}var aP=' <div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+countryInfo[regionInfo[battleLocationId].homeCountry].flagName+'" />';var a5=battleLocationName;if(regionInfo[battleLocationId].capital){aP+='<img style="height:16px" src="https://cdn.e-sim.org/img/map/house.png"> ';a5+=" (首都)"}if(regionInfo[battleLocationId].rawRichness==="HIGH"){var aS=regionInfo[battleLocationId].raw.toLowerCase();aS=aS.charAt(0).toUpperCase()+aS.slice(1);aP+='<img style="height:16px" src="http://cdn.e-sim.org/img/productIcons/'+aS+'.png"> ';a5+=" ("+aS+")"}if(isDefenderLinkage){aP+=' (<div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+defenderName+'" />防守连接地) '}if(isAttackerLinkage){aP+=' (<div style="vertical-align:middle;" class="xflagsSmall xflagsSmall-'+attackerName+'" />收复连接地) '}$("#fightName a[class=fightFont]").append(aP);var aZ=(isResistance?4:0)+(isDefenderLinkage?2:0)+(isAttackerLinkage?1:0);var bd=[defenderNameOrFlag+" 在 "+a5+"防守"+attackerNameOrFlag,defenderNameOrFlag+" 防守 "+a5+", 保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 在连接地 "+a5+"防守"+attackerNameOrFlag,defenderNameOrFlag+" 防守连接地 "+a5+", 并保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 镇压 "+attackerNameOrFlag+" 在 "+a5+" 的起义",defenderNameOrFlag+" 镇压 "+a5+" 的起义, 保持"+attackerNameOrFlag+"断路",defenderNameOrFlag+" 镇压 "+attackerNameOrFlag+" 在连接地 "+a5+" 的起义",defenderNameOrFlag+" 镇压连接地 "+a5+" 的起义, 并保持"+attackerNameOrFlag+"断路"];var be=[attackerNameOrFlag+" 进攻 "+defenderNameOrFlag+" 的 "+a5,attackerNameOrFlag+" 进攻 "+defenderNameOrFlag+", 收复连接地 "+a5,attackerNameOrFlag+" 进攻 "+a5+", 使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 收复连接地 "+a5+", 同时使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 在 "+a5+" 起义反抗 "+defenderNameOrFlag,attackerNameOrFlag+" 在 "+a5+" 起义反抗 "+defenderNameOrFlag+", 收复连接地",attackerNameOrFlag+" 在 "+a5+" 发起起义, 使"+defenderNameOrFlag+"断路",attackerNameOrFlag+" 在 "+a5+" 发起起义, 收复连接地并使"+defenderNameOrFlag+"断路"];defenderDescription=bd[aZ];attackerDescription=be[aZ];d(defenderDescription);d(attackerDescription)}function ak(){$("#battleProgressStats").append('<div id="wallStat"></div>');function aQ(){var aS=defenderHistoryClutch.length-1;if(aS<=1){return}var aV=aS-1;while(aV>0&&defenderHistoryClutch[aV][0]>defenderHistoryClutch[aS][0]-15){aV--}if(aV<aS-1){}aV++;var aT=defenderHistoryClutch[aS][0]-defenderHistoryClutch[aV][0];var aU=(defenderHistoryClutch[aS][1]-defenderHistoryClutch[aV][1])/aT;var aR=(attackerHistoryClutch[aS][1]-attackerHistoryClutch[aV][1])/aT;$("#defenderFirepower").text((aU*15/1000000).toFixed(1));$("#attackerFirepower").text((aR*15/1000000).toFixed(1))}function aP(){var aT=X();$("#ehCountdown").text(O(aT));var aR=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aS=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aU=aR-aS;if(aU===0){$("#wallStat").text("")}else{if(aU>0){$("#wallStat").text(">> "+aU.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>")}else{$("#wallStat").text("<< "+(-aU).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<")}}if($("#autoCopy").is(":checked")){aq()}if(aT>0&&aT<clutchStandard){if(defenderHistoryClutch.length<=1){lastUpdatedSeconds=aT;defenderHistoryClutch.push([-aT,aR]);attackerHistoryClutch.push([-aT,aS])}else{if(defenderHistoryClutch[defenderHistoryClutch.length-1][1]<aR||attackerHistoryClutch[attackerHistoryClutch.length-1][1]<aS){lastUpdatedSeconds=aT;defenderHistoryClutch.push([-aT,aR]);attackerHistoryClutch.push([-aT,aS])}}$("#wallStat").append(' <b style="font-size:12px;">('+(lastUpdatedSeconds-aT)+"秒前更新)</b>");if(lastUpdatedSeconds<=aT){aQ();if($("#ehDivStatistics").attr("style").indexOf("display:block")!=-1){aA()}}}}endEpoch=(new Date().getTime())+o()*1000;window.setInterval(aP,1000)}function C(){var a1=$("#ehRefresh");var a0=$("<div>");var aS=$("<button>",{type:"button","class":"small button foundation-style",id:"manualRefresh",style:"padding:6px;",html:'<i class="icon-search"></i>刷新',title:"刷新双方的总伤害"});var aR=$("<input>",{type:"checkbox","class":"foundation-style",id:"autoRefresh",text:"自动"});var a2=$("<input>",{type:"radio",id:"copySideDefender",name:"copySide",value:"defender",checked:"checked"});var a5=$("#fightName a[class=fightFont]").text().trim();if($(".fightFlagDefender").length>0){var a3=$(".fightFlagDefender").attr("class").split(" ").pop();var aU=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a3.substring(a3.indexOf("-")+1)})}else{if($(".xflagsBig").length>0){var a3=$(".xflagsBig:first").attr("class").split(" ").pop();var aU=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a3.substring(a3.indexOf("-")+1)})}else{if($(".flags-big").length>0){var aU=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+$("div.fightFlag.flags-big").first().attr("class").split(" ")[2]})}else{var aU=$("<span>",{style:"vertical-align:middle;","class":"icon-uniF472"})}}}a0.append(aS,aR,"自动",a2,aU);var aZ=$("<div>");var aT=$("<button>",{type:"button","class":"small button foundation-style",id:"manualCopy",style:"padding:6px;",html:'<i class="icon-comment2"></i>复制',title:"复制战场状态到剪贴板"});var aV=$("<input>",{type:"checkbox","class":"foundation-style",id:"autoCopy",text:"自动"});var aW=$("<input>",{type:"radio",id:"copySideAttacker",name:"copySide",value:"attacker"});if($(".fightFlagAttacker").length>0){var a4=$(".fightFlagAttacker").attr("class").split(" ").pop();var aY=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a4.substring(a4.indexOf("-")+1)})}else{if($(".xflagsBig").length>0){var a4=$(".xflagsBig:last").attr("class").split(" ").pop();var aY=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+a4.substring(a4.indexOf("-")+1)})}else{if($(".flags-big").length>0){var aY=$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+$("div.fightFlag.flags-big").last().attr("class").split(" ")[2]})}else{var aY=$("<span>",{style:"vertical-align:middle;","class":"icon-uniF473"})}}}aZ.append(aT,aV,"自动",aW,aY);a1.append(a0,aZ);$("#defenderScore").after('<div title="防守方即时输出，仅在自动刷新时显示">防守火力: <b id="defenderFirepower" style="color:lightblue">?</b> M/15秒</div>');$("#attackerScore").after('<div title="进攻方即时输出，仅在自动刷新时显示">进攻火力: <b id="attackerFirepower" style="color:pink">?</b> M/15秒</div>');$("#manualRefresh").click(T);$("#manualCopy").click(aq);var aX=0;$("#autoRefresh").click(function(){if($(this).is(":checked")){if(X()>0){aX=window.setInterval(T,7000)}$("#manualRefresh").attr("disabled",true)}else{window.clearInterval(aX);$("#manualRefresh").attr("disabled",false)}});$("#autoCopy").click(function(){if($(this).is(":checked")){$("#manualCopy").attr("disabled",true)}else{$("#manualCopy").attr("disabled",false)}});if(typeof(unsafeWindow.sendUpdateRequest)=="function"){var aQ=unsafeWindow.sendUpdateRequest.toString().replace(/dataString \+\= \'&at\=.+?;/,";").replace(/dataString \+\= \'&ci\=.+?;/,";").replace(/\s+/g,"");var aP=1075;if(isPremium){aP=1100}if(aQ.length===aP){d("sendUpdateRequest已检查，无变化（字数："+aP+"）")}else{alert("页面中的 sendUpdateRequest 函数有更新，请联系e-sim helper的开发者。刷新功能暂时禁用。\n");$("#autoRefresh").attr("disabled",true);$("#manualRefresh").attr("disabled",true);d("sendUpdateRequest已检查，有变化")}}else{d("sendUpdateRequest未检查")}if(!isActive){$("#autoRefresh").attr("disabled",true);$("#manualRefresh").attr("disabled",true);$("#autoCopy").attr("disabled",true);$("#manualCopy").attr("disabled",true);$("#copySideAttacker").attr("disabled",true);$("#copySideDefender").attr("disabled",true)}}function aq(){function aW(aY,a0){var aZ=aY.toString()+":"+a0.toString();if(aY===a0){return aZ}if(aY>a0){return aZ+(aY===8?"获胜":"领先")}else{return aZ+(a0===8?"失利":"落后")}}var aX=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aR=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var aU=((aX-aR)/1000000).toFixed(2);var aS=X();var aV="";if(aS>=120||aS%5===0){var aT=document.URL.match(/.+?battle.html\?id=[0-9]+/).toString();if(aT.indexOf("https")>=0){aV+=aT+"\n";aV+=aT.replace(/https/,"http")+"\n"}else{if(aT.indexOf("http")>=0){aV+=aT.replace(/http/,"https")+"\n";aV+=aT+"\n"}else{aV+=document.URL.match(/.+?battle.html\?id=[0-9]+/)+"\n"}}}if(aS>=120){if($("#copySideDefender").is(":checked")){aV+="第"+roundId+"局(总比分"+aW(defenderScore,attackerScore)+"), t"+parseInt(aS/60)+"墙高"+aU.toString()+"M\n"+defenderDescription+(battleLocationId==-1?"":"\n加成地点"+defenderLocationText)}else{aV+="第"+roundId+"局(总比分"+aW(attackerScore,defenderScore)+"), t"+parseInt(aS/60)+"墙高"+(-aU).toString()+"M\n"+attackerDescription+(battleLocationId==-1?"":"\n加成地点"+attackerLocationText)}}else{if(aS>0){aV+=aS.toString()+"秒, ";var aP=parseFloat($("#defenderFirepower").text());var aQ=parseFloat($("#attackerFirepower").text());if($("#copySideDefender").is(":checked")){aV+=aU.toString()+"M ("+(lastUpdatedSeconds-aS)+"秒前更新)";if(!isNaN(aP)){aV+=", "+defenderNameOrFlag+"火力 "+aP+(aP<aQ?"M < ":"M ≥ ")+aQ+"M"}}else{aV+=(-aU).toString()+"M ("+(lastUpdatedSeconds-aS)+"秒前更新)";if(!isNaN(aP)){aV+=", "+attackerNameOrFlag+"火力 "+aQ+(aQ<aP?"M < ":"M ≥ ")+aP+"M"}}}else{aV+=battleName+"第"+roundId+"局结束, ";if($("#copySideDefender").is(":checked")){if(aX>=aR){aV+="防守方"+defenderNameOrFlag+"获胜("+aU.toString()+"M), 总比分"+aW(defenderScore+1,attackerScore)}else{aV+="防守方"+defenderNameOrFlag+"失利("+aU.toString()+"M), 总比分"+aW(defenderScore,attackerScore+1)}}else{if(aR>=aX){aV+="进攻方"+attackerNameOrFlag+"获胜("+(-aU).toString()+"M), 总比分"+aW(attackerScore+1,defenderScore)}else{aV+="进攻方"+attackerNameOrFlag+"失利("+(-aU).toString()+"M), 总比分"+aW(attackerScore,defenderScore+1)}}}}GM_setClipboard(aV)}function ad(aQ){var aP=X();var aR=timeBias;if(aQ<aP){timeBias+=(aP-aQ)}else{if(timeBias>0&&aP%6===0){timeBias--}}console.log("实际时间≤"+aQ+", 页面时间="+o()+", eh计时="+aP+", 修正值="+aR,"->",timeBias)}function T(aP){var aQ="id="+battleRoundId;aQ+="&at="+userId;aQ+="&ci="+userCitizenshipId;if(isPremium||aP===true){d("以高级会员身份抓取数据");aQ+="&premium=1"}$.ajax({type:"GET",url:"battleScore.html",data:aQ,dataType:"json",success:function(aS){historyLen=defenderHistoryClutch.length;if(historyLen>0){if(defenderHistoryClutch[historyLen-1][1]>parseInt(aS.defenderScore.replace(/,/g,"").replace(/\xA0/g,""))||attackerHistoryClutch[historyLen-1][1]>parseInt(aS.attackerScore.replace(/,/g,"").replace(/\xA0/g,""))){return}}aS=cloneInto(aS,unsafeWindow);unsafeWindow.updateStatus(aS.attackerScore,aS.defenderScore,aS.remainingTimeInSeconds,aS.percentAttackers);ad(aS.remainingTimeInSeconds);if(aS.remainingTimeInSeconds<=clutchStandard){lastUpdatedSeconds=aS.remainingTimeInSeconds<0?0:aS.remainingTimeInSeconds;defenderHistoryClutch.push([-lastUpdatedSeconds,parseInt(aS.defenderScore.replace(/,/g,"").replace(/\xA0/g,""))]);attackerHistoryClutch.push([-lastUpdatedSeconds,parseInt(aS.attackerScore.replace(/,/g,"").replace(/\xA0/g,""))]);if(lastUpdatedSeconds>0&&$("#ehDivStatistics").attr("style").indexOf("display:block")!=-1){aA()}}unsafeWindow.updateBattleHeros(aS.topAttackers,aS.topDefenders);unsafeWindow.updateTop10(aS.top10Attackers,aS.top10Defenders);if(!isPremium&&aP===false){unsafeWindow.updateBattleMonitor(aS)}else{$("#ehTotaldefenders").html(aS.defendersOnline);$("#ehTotalattackers").html(aS.attackersOnline);$("#ehTotalspectators").html(aS.spectatorsOnline);$("#ehDefendersMenu").html(aS.defendersByCountries);$("#ehAttackersMenu").html(aS.attackersByCountries);$("#ehSpectatorsMenu").html(aS.spectatorsByCountries);$(".countryNameTranslated").attr("onclick","window.open('citizensOnline.html?countryId=' + countryInfo[this.innerText].id);")}unsafeWindow.updatePlace(aS.yourPlace);unsafeWindow.updateTotalDamage(aS.totalPlayerDamage);for(var aR=0;aR<aS.recentAttackers.length;aR++){if(aS.recentAttackers[aR].id==unsafeWindow.latestAttackerId){aS.recentAttackers=cloneInto(aS.recentAttackers.slice(0,aR),unsafeWindow);break}}for(aR=0;aR<aS.recentDefenders.length;aR++){if(aS.recentDefenders[aR].id==unsafeWindow.latestDefenderId){aS.recentDefenders=cloneInto(aS.recentDefenders.slice(0,aR),unsafeWindow);break}}if(aS.recentAttackers.length!==0){unsafeWindow.latestAttackerId=aS.recentAttackers[0].id;unsafeWindow.attackerHits=aS.recentAttackers}if(aS.recentDefenders.length!==0){unsafeWindow.latestDefenderId=aS.recentDefenders[0].id;unsafeWindow.defenderHits=aS.recentDefenders}}})}function l(aP){return aP.slice(6,10)+"/"+aP.slice(3,5)+"/"+aP.slice(0,2)+aP.slice(10,aP.indexOf(":")+6)}function s(bb){var aZ=JSON.parse(bb);var aY=new Date(l(aZ[aZ.length-1].time));var aS=new Date(l(aZ[0].time));$("<div>",{text:"服务器时间 "+aY.toLocaleString()+" - "+aS.toLocaleString()}).prependTo($("#ehBattleDescription"));aY=aY.getTime();var a2=parseInt((aS.getTime()-aY)/(60*1000));if(a2<10){aY=aS-600*1000;a2=10}else{if(a2<120){aY=aS-7200*1000;a2=120}}var aQ={"true":[],"false":[]};for(var a3=0;a3<=a2;++a3){aQ["true"][a3]=0;aQ["false"][a3]=0}var a5={"true":{},"false":{}};var ba={"true":{},"false":{}};var a6={"true":{},"false":{}};var aU=0;for(a3=0;a3<aZ.length;++a3){var a4=aZ[a3];aU+=a4.berserk?5:1;var aX=parseInt((Date.parse(l(a4.time))-aY)/(60*1000));aQ[a4.defenderSide][aX]=aQ[a4.defenderSide][aX]+a4.damage;var a1=a4.citizenship;a5[a4.defenderSide][a1]=(a5[a4.defenderSide][a1])?(a5[a4.defenderSide][a1]+a4.damage):a4.damage;var aT=a4.citizenId;a6[a4.defenderSide][aT]=(a6[a4.defenderSide][aT])?(a6[a4.defenderSide][aT]+a4.damage):a4.damage;var a0=a4.militaryUnit;if(a0){ba[a4.defenderSide][a0]=(ba[a4.defenderSide][a0])?(ba[a4.defenderSide][a0]+a4.damage):a4.damage}}$("<div>",{text:"本局掉落Q5装备"+(aU/30000).toFixed(2)+"件，Q4装备"+(aU/10000).toFixed(2)+"件"}).prependTo($("#ehBattleDescription"));var a8=new Array(a2+1);var a9=new Array(a2+1);a8[0]=aQ["true"][0];a9[0]=aQ["false"][0];for(a3=1;a3<=a2;++a3){a8[a3]=a8[a3-1]+aQ["true"][a3];a9[a3]=a9[a3-1]+aQ["false"][a3]}var a7=Math.pow(10,Math.floor(Math.log10(Math.max(a8[a2],a9[a2]))));$.jqplot("ehChart120m",[a8,a9],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"时间 (分钟)",max:a2,min:0,tickOptions:{formatString:"%d"}},yaxis:{min:0,tickInterval:a7,pad:1.1,tickOptions:{formatString:"%'d"}}}});var aV=180;aQ={"true":[],"false":[]};for(a3=0;a3<=aV;++a3){aQ["true"][a3]=0;aQ["false"][a3]=0}var a6={"true":{},"false":{}};for(a3=0;a3<aZ.length;++a3){var a4=aZ[a3];var aX=parseInt((aS-Date.parse(l(a4.time)))/1000);aX=aX>=aV?aV:aX;aQ[a4.defenderSide][aX]=aQ[a4.defenderSide][aX]+a4.damage;if(aX<aV){var aT=a4.citizenId;if(a6[a4.defenderSide][aT]){a6[a4.defenderSide][aT].damage+=a4.damage;a6[a4.defenderSide][aT].hitNumber[a4.weapon]+=a4.berserk?5:1;a6[a4.defenderSide][aT].first=aX}else{a6[a4.defenderSide][aT]={};a6[a4.defenderSide][aT].citizenId=aT;a6[a4.defenderSide][aT].damage=a4.damage;a6[a4.defenderSide][aT].hitNumber=[0,0,0,0,0,0];a6[a4.defenderSide][aT].hitNumber[a4.weapon]=a4.berserk?5:1;a6[a4.defenderSide][aT].citizenship=a4.citizenship;a6[a4.defenderSide][aT].militaryUnit=a4.militaryUnit;a6[a4.defenderSide][aT].first=aX;a6[a4.defenderSide][aT].last=aX}}}var aP=aQ["true"][aV];var aR=aQ["false"][aV];a8=[[-aV,aP]];a9=[[-aV,aR]];for(a3=aV-1;a3>=0;--a3){aP+=aQ["true"][a3];aR+=aQ["false"][a3];a8.push([-a3,aP]);a9.push([-a3,aR])}$.jqplot("ehChartClutch",[a8,a9],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"时间 (秒)",max:0,min:-aV,tickOptions:{formatString:"%d"}},yaxis:{min:0,tickInterval:a7,pad:1.1,tickOptions:{formatString:"%'d"}}}});aW(a6["true"],$("#ehTableClutchDefenders"));aW(a6["false"],$("#ehTableClutchAttackers"));function aW(bc,be){var bd=Object.keys(bc).map(function(bi){return bc[bi]});bd.sort(function(bj,bi){return bi.damage-bj.damage});var bh=$("<div>",{style:"text-align: left; margin:1em 1.6em 1em 1em; font-size:.9em;"}).appendTo(be);var bf=$("<table>",{style:"width:100%;"}).appendTo(bh);var bg=$("<tr>").appendTo(bf).append($("<td>",{text:"玩家",style:"text-align:center;"}),$("<td>",{colspan:2,text:"时段",style:"text-align:center;"}),$("<td>",{text:"次数",style:"text-align:right;"}),$("<td>",{text:"Q5",style:"text-align:right;"}),$("<td>",{text:"伤害值",style:"text-align:right;"}));$.each(bd,function(bj,bk){var bi=$("<tr>").appendTo(bf);var bm=$("<td>").appendTo(bi);$("<b>",{style:"float:left;padding: 0 .5em 0 0",text:bj+1}).appendTo(bm);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bk.citizenship].flagName}).appendTo(bm);if(citizenPage[bk.citizenId]){$("<img>",{align:"absmiddle","class":"smallAvatar",src:citizenPage[bk.citizenId].avatar.replace("normal","small")}).appendTo(bm)}else{$("<img>",{align:"absmiddle","class":"smallAvatar",src:"//cdn.e-sim.org/img/blank-avatar.png"}).appendTo(bm)}$("<a>",{"class":"profileLink",href:"profile.html?id="+bk.citizenId,text:citizenInfo[bk.citizenId]?citizenInfo[bk.citizenId].login:"???"}).appendTo(bm);$("<td>",{style:"text-align:right;",text:bk.first+"~"}).appendTo(bi);$("<td>",{style:"text-align:right;",text:bk.last+"s"}).appendTo(bi);var bl=0;$.each(bk.hitNumber,function(bn,bo){bl+=bo});$("<td>",{style:"text-align:right;",text:bl}).appendTo(bi);$("<td>",{style:"text-align:right;",text:bk.hitNumber[5]}).appendTo(bi);$("<td>",{style:"text-align:right;",text:bk.damage.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).appendTo(bi)})}}function aA(){if(X()>=clutchStandard){$("#ehChartClutch").text("压秒趋势图仅在战场结束前"+clutchStandard+"秒内显示");return}$("#ehChartClutch").text("");console.log(X(),"重绘压秒趋势图");if(chartClutch){chartClutch.destroy()}chartClutch=$.jqplot("ehChartClutch",[defenderHistoryClutch,attackerHistoryClutch],{series:[{color:"blue"},{color:"red"}],axes:{xaxis:{label:"倒计时",max:0,pad:1.1,tickOptions:{formatString:"%d"}},yaxis:{min:0,pad:1.1,tickOptions:{formatString:"%'d"}}}})}function ai(){if(!isActive){$("#ehButtonStatistics").click();$("#ehDivStatistics").append($("<div>",{id:"ehBattleDescription"}));$("#ehDivStatistics").append('<br /> <div style="font-size:24px;"> 全场趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChart120m",style:"height:300px;width:750px;"}));$("<table>",{id:"ehTable120m"}).hide().appendTo($("#ehDivStatistics"));$("#ehDivStatistics").append('<br /> <br /> <br /> <div style="font-size:24px;"> 压秒趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChartClutch",style:"height:300px;width:750px;"}));$("<div>",{id:"ehTableClutchDefenders","class":"foundation-style small-5 columns"}).appendTo($("#ehDivStatistics"));$("<div>",{id:"ehTableClutchAttackers","class":"foundation-style small-5 columns"}).appendTo($("#ehDivStatistics"));$.ajax({url:"apiFights.html?battleId="+battleId+"&roundId="+roundId,timeout:5000,success:s,error:function(aP,aQ){d("战斗记录抓取错误 (",aQ,")，重新抓取");$.ajax(this)}})}else{$("#ehDivStatistics").append('<br /> <div style="font-size:24px;"> 压秒趋势图 </div>');$("#ehDivStatistics").append($("<div>",{id:"ehChartClutch",style:"height:300px;width:750px;"}));defenderHistoryClutch=[[]];attackerHistoryClutch=[[]];chartClutch=null;clutchStandard=300;lastUpdatedSeconds=X();$("#ehButtonStatistics").click(aA)}}function L(){var a2=$("#ehDivSpecial");var aR=$("<table>",{style:"width:100%;line-height:1px;"}).appendTo(a2);var aY=$("<tr>").appendTo(aR);var aS=$("<td>").appendTo(aY);var a0=$("<p>",{"class":"AjaxStat",text:"准备中……"}).appendTo(aS);function aQ(){var a4=G.length;for(var a5=0;a5<a4;a5++){if((G[a5].readyState==4)||(G[a5].readyState==0)){G.splice(a5,1);a5=a5-1;a4=a4-1}}a4=G.length;if(a4<=0){a0.text("当前网页共有"+a4+"个未完成请求，网络畅通。")}else{if(a4<6){a0.text("当前网页共有"+a4+"个未完成请求，网络畅通。")}else{a0.text("当前网页共有"+a4+"个未完成请求，网络堵塞，后续请求无法立即响应。");if(($("#AutoAbortAllAjax").is(":checked"))&&(a4>10)){Z()}}}}setInterval(aQ,3000);aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);var aW=$("<button>",{text:"终止所有未完成请求","class":"small button foundation-style"}).appendTo(aS);aW.click(function(){Z()});aa(aS,"AutoAbortAllAjax","自动清理请求","AutoAbortAllAjax",false);function a3(a6,a5){var a4="action=SET_ORDERS&battleId="+a6+"_"+a5.toString();$.ajax({type:"POST",url:"militaryUnitsActions.html",data:a4,success:function(a7){$(".orderStat").text("设置军令成功！")},error:function(a7){$("#setMuOrderToDefender").attr("disabled",false);$("#setMuOrderToAttacker").attr("disabled",false);$(".orderStat").text("设置军令失败，请重试。")}})}function a1(a5,a4){$.ajax({url:"myMilitaryUnit.html",type:"GET",dataType:"html",success:function(a9){if(a9!=null){var bb=$("#orderButton",a9);if(bb.length>0){var ba=$("option[value="+a5+"_"+a4.toString()+"]",a9);if(ba.length>0){a3(a5,a4)}else{$(".orderStat").text("无法设置军令给当前战场。")}}else{var a7,a6=$(a9).find(".battleDiv:first > div:eq(3) a[href^='battle.html?id=']:first");var a8=$(".battleDiv:first .xflagsMedium",a9).length;if(0<a6.length&&a8===2){a7=$(a9).find(".battleDiv:first").parent().parent().find(".xflagsMedium:last");if(0<a7.length){$(".orderStat").text("无法设置军令，当前军令："+a6.text()+"，"+w(a7.attr("class"))+"方。")}}else{$(".orderStat").text("当前你无法设置任何军令。")}}}else{$("#setMuOrderToDefender").attr("disabled",false);$("#setMuOrderToAttacker").attr("disabled",false);$(".orderStat").text("获取网页失败，请重试。")}},error:function(a6){$("#setMuOrderToDefender").attr("disabled",false);$("#setMuOrderToAttacker").attr("disabled",false);$(".orderStat").text("获取网页失败，请重试。")}})}var aX=$("<p>",{"class":"orderStat",text:"设置军令"}).appendTo(a2);aR=$("<table>",{style:"width:100%;line-height:1px;"}).appendTo(a2);aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);var aZ=$("<button>",{id:"setMuOrderToDefender",text:"设置军令到防守方("+defenderName+")","class":"small button foundation-style"}).appendTo(aS);$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+defenderName}).appendTo(aZ);aS=$("<td>").appendTo(aY);var aV=$("<button>",{id:"setMuOrderToAttacker",text:"设置军令到进攻方("+attackerName+")","class":"small button foundation-style"}).appendTo(aS);$("<p>",{style:"vertical-align:middle;","class":"xflagsSmall xflagsSmall-"+attackerName}).appendTo(aV);aZ.click(function(){aZ.attr("disabled",true);aV.attr("disabled",true);a1(n("id"),false)});aV.click(function(){aZ.attr("disabled",true);aV.attr("disabled",true);a1(n("id"),true)});$("<p>发送到Discord</p>").appendTo(a2);aR=$("<table>",{style:"width:100%;line-height:1px;"}).appendTo(a2);aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);$("<p>登录网页版discord，开启F12控制台的Network页，在discord频道里</p><p>发送一条信息，点击控制台Network里出现的messages，在右边往下</p><p>找到Request Headers的authorization：右边内容复制到这里</p>").appendTo(aS);aS=$("<td>").appendTo(aY);$("<p>",{text:"右击discord频道，选择复制ID粘贴进来"}).appendTo(aS);aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);$("<span>",{text:"authToken："}).appendTo(aS);Y(aS,300,"discordAuthToken","");aS=$("<td>").appendTo(aY);$("<span>",{text:"channelID："}).appendTo(aS);Y(aS,200,"discordChannelID","");aY=$("<tr>").appendTo(aR);aS=$("<td>").appendTo(aY);aa(aS,"diyMessageToDiscord","自定义发送消息","diyMessageToDiscord",false);Y(aS,200,"diyMessageToDiscordText","");aS=$("<td>").appendTo(aY);var aP=$("<button>",{text:"发送到Discord",id:"sendToDiscordButton","class":"small button foundation-style"}).appendTo(aS);aP.click(function(){if($("#diyMessageToDiscord").is(":checked")){aU($("#diyMessageToDiscordText").val(),localStorage.getItem("discordAuthToken"),localStorage.getItem("discordChannelID"))}else{aU(aT(),localStorage.getItem("discordAuthToken"),localStorage.getItem("discordChannelID"))}});aa(aS,"autoSendMessageToDiscord","T5自动发送(不用记得去掉)","autoSendMessageToDiscord",false);function aT(){function a8(bb,bd){var bc=bb.toString()+":"+bd.toString();if(bb===bd){return bc}if(bb>bd){return bc+(bb===8?"获胜":"领先")}else{return bc+(bd===8?"失利":"落后")}}var a5=parseInt($("#defenderScore").text().replace(/,/g,"").replace(/\xA0/g,""));var a6=parseInt($("#attackerScore").text().replace(/,/g,"").replace(/\xA0/g,""));var a7=((a5-a6)/1000000).toFixed(2);var a9=X();var a4="";var ba=document.URL.match(/.+?battle.html\?id=[0-9]+/).toString();if(ba.indexOf("https")>=0){a4+=ba+"\n";a4+=ba.replace(/https/,"http")+"\n"}else{if(ba.indexOf("http")>=0){a4+=ba.replace(/http/,"https")+"\n";a4+=ba+"\n"}else{a4+=document.URL.match(/.+?battle.html\?id=[0-9]+/)+"\n"}}if(a9>0){if($("#copySideDefender").is(":checked")){a4+="第"+roundId+"局(总比分"+a8(defenderScore,attackerScore)+"), t"+parseInt(a9/60)+"墙高"+a7.toString()+"M\n"+defenderDescription}else{a4+="第"+roundId+"局(总比分"+a8(attackerScore,defenderScore)+"), t"+parseInt(a9/60)+"墙高"+(-a7).toString()+"M\n"+attackerDescription}}else{a4+=battleName+"第"+roundId+"局结束, ";if($("#copySideDefender").is(":checked")){if(a5>=a6){a4+="防守方"+defenderNameOrFlag+"获胜("+a7.toString()+"M), 总比分"+a8(defenderScore+1,attackerScore)}else{a4+="防守方"+defenderNameOrFlag+"失利("+a7.toString()+"M), 总比分"+a8(defenderScore,attackerScore+1)}}else{if(a6>=a5){a4+="进攻方"+attackerNameOrFlag+"获胜("+(-a7).toString()+"M), 总比分"+a8(attackerScore+1,defenderScore)}else{a4+="进攻方"+attackerNameOrFlag+"失利("+(-a7).toString()+"M), 总比分"+a8(attackerScore,defenderScore+1)}}}return a4}function aU(a6,a4,a5){if((a6!="")&&(a4!="")&&(a5!="")){$.ajax({type:"POST",url:"https://discordapp.com/api/channels/"+a5+"/messages",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US","Content-Type":"application/json",Authorization:a4},data:JSON.stringify({content:a6})})}else{alert("发送失败：缺少参数")}}}var f=false;function E(a1){var a3=$("."+a1);if(a3.length>0){a3.remove()}var aU="defender";var ba="attacker";var aW="side";var aY="undefined";var a7="Berserk";var a9=$("<table>",{"class":a1,style:"width:100%;line-height:1px;"});var aQ=$("<tr>",{style:"background-color:DarkSlateGray;",height:"30px"}).appendTo(a9);var aZ=$("<td>").appendTo(aQ);$("<span>输出选择：</span>").appendTo(aZ);if($("#fightButton2").length>0){aZ=$("<td>").appendTo(aQ);$("<span>防守方：</span>").appendTo(aZ);var aR=$("<input>",{type:"radio",id:"AFHitStyleLeftHit",name:"AFHitStyle","data-AFSide":aU,"data-AFValue":aY}).appendTo(aZ);var aS=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleLeftHit",text:"打一下"}).appendTo(aZ);var a8=$("<input>",{type:"radio",id:"AFHitStyleLeftBerserk",name:"AFHitStyle","data-AFSide":aU,"data-AFValue":a7}).appendTo(aZ);var aX=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleLeftBerserk",text:"打五下"}).appendTo(aZ);aZ=$("<td>").appendTo(aQ);$("<span>进攻方：</span>").appendTo(aZ);var aV=$("<input>",{type:"radio",id:"AFHitStyleRightHit",name:"AFHitStyle","data-AFSide":ba,"data-AFValue":aY}).appendTo(aZ);var a6=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleRightHit",text:"打一下"}).appendTo(aZ);var a0=$("<input>",{type:"radio",id:"AFHitStyleRightBerserk",name:"AFHitStyle","data-AFSide":ba,"data-AFValue":a7}).appendTo(aZ);var aT=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleRightBerserk",text:"打五下"}).appendTo(aZ)}else{if($("#fightButton1").length>0){aZ=$("<td>").appendTo(aQ);var a4=$("<input>",{type:"radio",id:"AFHitStyleHit",name:"AFHitStyle","data-AFSide":aW,"data-AFValue":aY}).appendTo(aZ);var aP=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleHit",text:"打一下"}).appendTo(aZ);var a5=$("<input>",{type:"radio",id:"AFHitStyleBerserk",name:"AFHitStyle",checked:"checked","data-AFSide":aW,"data-AFValue":a7}).appendTo(aZ);var a2=$("<label>",{"class":"checkboxlabel","for":"AFHitStyleBerserk",text:"打五下"}).appendTo(aZ)}else{aZ=$("<td>").appendTo(aQ);$("<span>当前所在地无法输出</span>").appendTo(aZ)}}$(".setupAdvancedTable").after(a9)}function x(){var aZ=$("#ehDivAdvanced");if(localStorage.getItem("EnableAutoFight")!=="true"){$("<p>",{"class":"advancedStat",text:"未启用自动打枪。"}).appendTo(aZ);return}var a2=$("<p>",{"class":"advancedStat",text:"使用自动打枪有可能受到封号惩罚。使用前你必须清楚其原理作用和可能产生的后果。"}).appendTo(aZ);function aY(bb){a2.text(bb)}var aT=false;var a8;var a0=0;var aQ=0;var a6=0;var a1;function a9(){a0=0;aQ=0;a6=0}function aU(be,bb){var bd=bb-be;var bc=Math.random()*bd+be;bc=parseInt(bc,10);return bc}var aS=[];a5();function a5(){var bf=$("<div>",{"class":"foundation-style small-10 columns foundation-text-center"}).appendTo(aZ);var bc=$("<table>",{align:"right"}).appendTo(bf);var bk=$("<button>",{type:"button","class":"small button foundation-style",id:"AFManualStart",text:"开始自动打枪"}).appendTo(bc);bk.attr("disabled",true);var br=$("<button>",{type:"button","class":"small button foundation-style",id:"AFStopButton",text:"停止自动打枪"}).appendTo(bc);br.attr("disabled",true);var bo=$("<table>",{"class":"setupAdvancedTable",style:"width:100%;line-height:1px;height:200px;"}).appendTo(aZ);var bn;var bg;bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bg=$("<td>",{width:"25%"}).appendTo(bn);$("<span>补充额度顺序：</span>").appendTo(bg);bg=$("<td>",{width:"25%"}).appendTo(bn);g(bg,"优先：",[0,1,2],["无","食物","礼物"],"AFRestoreHealth1",2);bg=$("<td>",{width:"25%"}).appendTo(bn);g(bg,"其次：",[0,1,2],["无","食物","礼物"],"AFRestoreHealth2",1);bg=$("<td>",{width:"25%"}).appendTo(bn);bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bg=$("<td>").appendTo(bn);bg=$("<td>").appendTo(bn);g(bg,"使用食物：",[1,2,3,4,5],["Q1","Q2","Q3","Q4","Q5"],"AFHitUseFood",5);bg=$("<td>").appendTo(bn);g(bg,"使用礼物：",[1,2,3,4,5],["Q1","Q2","Q3","Q4","Q5"],"AFHitUseGift",5);bg=$("<td>").appendTo(bn);g(bg,"使用武器：",[0,1,2,3,4,5],["Q0","Q1","Q2","Q3","Q4","Q5"],"AFHitUseWeapon",1);bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bg=$("<td>").appendTo(bn);aa(bg,"AFRestrictHitCount","限制攻击次数：","AFRestrictHitCount",false);$("<span>最多</span>").appendTo(bg);Y(bg,60,"AFRestrictHitCountTextbox","15");$("<span>次攻击</span>").appendTo(bg);bg=$("<td>").appendTo(bn);aa(bg,"AFRestrictDamage","限制伤害：","AFRestrictDamage",false);$("<span>总伤害超过</span>").appendTo(bg);Y(bg,60,"AFRestrictDamageTextbox","1000000");$("<span>后停止</span>").appendTo(bg);bg=$("<td>").appendTo(bn);aa(bg,"AFRestrictTime","限制时间：","AFRestrictTime",false);$("<span>自动打枪</span>").appendTo(bg);Y(bg,60,"AFRestrictTimeTextbox","10");$("<span>秒后停止</span>").appendTo(bg);bg=$("<td>").appendTo(bn);bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bg=$("<td>").appendTo(bn);var bh=$("<input>",{type:"radio",id:"AFStartModeAuto",name:"AFSelectStartMode","data-startmode":"auto"}).appendTo(bg);var be=$("<label>",{"class":"checkboxlabel","for":"AFStartModeAuto",text:"自动开始："}).appendTo(bg);$("<span>在S</span>").appendTo(bg);Y(bg,40,"AFStartModeAutoStartTextbox","15");$("<span>到S</span>").appendTo(bg);Y(bg,40,"AFStartModeAutoEndTextbox","10");$("<span>之间任意时间</span>").appendTo(bg);bg=$("<td>").appendTo(bn);var bi=$("<input>",{type:"radio",id:"AFStartModeManual",name:"AFSelectStartMode","data-startmode":"manual"}).appendTo(bg);var bd=$("<label>",{"class":"checkboxlabel","for":"AFStartModeManual",text:"手动开始"}).appendTo(bg);var bm=localStorage.getItem("AFStartModeSettings");if(bm===null){localStorage.setItem("AFStartModeSettings","1");bi.attr("checked",true)}else{if(bm=="0"){bh.attr("checked",true)}else{bi.attr("checked",true)}}bh.change(function(){if(bh.is(":checked")){localStorage.setItem("AFStartModeSettings","0")}else{localStorage.setItem("AFStartModeSettings","1")}});bi.change(function(){if(bi.is(":checked")){localStorage.setItem("AFStartModeSettings","1")}else{localStorage.setItem("AFStartModeSettings","0")}});bg=$("<td>").appendTo(bn);bg=$("<td>").appendTo(bn);bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bo);bg=$("<td>").appendTo(bn);$("<span>每次攻击间隔（毫秒）：</span>").appendTo(bg);bg=$("<td>").appendTo(bn);Y(bg,60,"AFIntervalStart","500");$("<span>到</span>").appendTo(bg);Y(bg,60,"AFIntervalEnd","1500");bg=$("<td>").appendTo(bn);$("<span>未响应请求允许数量：</span>").appendTo(bg);bg=$("<td>").appendTo(bn);Y(bg,60,"AFMaxNotRespondRequest","12");var bp=$("<table>",{align:"right"}).appendTo(aZ);bn=$("<tr>",{style:"background-color:DarkSlateGray;"}).appendTo(bp);bg=$("<td>").appendTo(bn);$("<span>总伤害： </span>").appendTo(bg);var bq=$("<span>",{id:"AFNowTotalDamage"}).appendTo(bg);bg=$("<td>").appendTo(bn);$("<span>攻击次数： </span>").appendTo(bg);var bj=$("<span>",{id:"AFNowHitCount"}).appendTo(bg);$("<span> 次</span>").appendTo(bg);bg=$("<td>").appendTo(bn);$("<span>攻击用时： </span>").appendTo(bg);var bb=$("<span>",{id:"AFNowSpendTime"}).appendTo(bg);$("<span> 秒</span>").appendTo(bg);bg=$("<td>").appendTo(bn);$("<span>未完成请求：</span>").appendTo(bg);var bl=$("<span>",{id:"AFAjaxCount"}).appendTo(bg);$("<span> 次</span>").appendTo(bg);E("advancedFightChooseTable");bk.attr("disabled",false);bk.click(function(){var bt=$("input[name='AFSelectStartMode']:checked");if(bt.length<=0){aY("未选择开始方式")}else{bk.attr("disabled",true);br.attr("disabled",false);if(bt.attr("data-startmode")=="auto"){var bs=aU(parseInt($("#AFStartModeAutoStartTextbox").val()),parseInt($("#AFStartModeAutoEndTextbox").val()));if(X()<=bs){aY("当前时间已经超过预定时间");bk.attr("disabled",false);br.attr("disabled",true)}else{aY("预订于剩余 "+bs+" 秒时开始自动攻击");a8=setInterval(function(){if(X()<=bs){clearInterval(a8);a1=new Date();aT=true;a9();aV(parseInt($("#AFIntervalStart").val()),parseInt($("#AFIntervalEnd").val()))}},1000)}}else{a1=new Date();aT=true;a9();aV(parseInt($("#AFIntervalStart").val()),parseInt($("#AFIntervalEnd").val()))}}});br.click(function(){bk.attr("disabled",false);br.attr("disabled",true);var bs=$("input[name='AFSelectStartMode']:checked");if(bs.attr("data-startmode")=="auto"){if(a8!=undefined){aY("停止计时");clearInterval(a8)}else{aY("停止攻击");aT=false}}else{aY("停止攻击");aT=false}})}function aV(bc,bf){$("#AFNowTotalDamage").text(a0);$("#AFNowHitCount").text(aQ);a6=parseInt(new Date()-a1)/1000;$("#AFNowSpendTime").text(a6);var bb=aS.length;for(var be=0;be<bb;be++){if((aS[be].readyState==4)||(aS[be].readyState==0)){aS.splice(be,1);be=be-1;bb=bb-1}}$("#AFAjaxCount").text(aS.length);if(bb>parseInt($("#AFMaxNotRespondRequest").val())){Z();aS=[]}if(aT==true){if(X()<=0){aY("回合结束，停止攻击");aT=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictHitCount").is(":checked")&&(aQ>=parseInt($("#AFRestrictHitCountTextbox").val()))){aY("攻击次数超限，停止攻击");aT=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictDamage").is(":checked")&&(a0>=parseInt($("#AFRestrictDamageTextbox").val()))){aY("总伤害超限，停止攻击");aT=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if($("#AFRestrictTime").is(":checked")&&(a6>=parseInt($("#AFRestrictTimeTextbox").val()))){aY("时间超限，停止攻击");aT=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}if(a3()==false){aT=false;$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}var bd=aU(bc,bf);aY(bd+"毫秒后输出");setTimeout(function(){aV(bc,bf)},bd)}else{$("#AFManualStart").attr("disabled",false);$("#AFStopButton").attr("disabled",true);return}}function a7(bi){function bc(bt){bt+="";var br=bt.split(".");var bs=/(\d{1,3})(?=(\d{3})+$)/g;return br[0].replace(bs,"$1,")+(br.length==2?"."+br[1]:"")}var bp=$("#showMsg");bp.text("");bp.show();var be=$("#DamageDone",bi);if(be.length>0){var bn=parseInt(be.text().replace(/,/g,"").replace(/\xA0/g,""));a0+=bn;var bq=$(".fightsprite",be.parent().parent());var bj={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var bk={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var bh=0;bh<bq.length;++bh){var bo=bq.eq(bh).attr("class").split(" ").pop();if(bo in bk){var bd=bk[bo];bj[bd[0]]=bd[1]}}var bf="";var bg=bj.xp;delete bj.xp;for(bh in bj){bf='<i style="color:'+bj[bh][0]+';" class="icon-'+bh+'" title="'+bj[bh][1]+'"></i>'+bf}bf+='<b title="'+bg+'次攻击">x'+bg+"</b>";aQ+=bg;var bb=$("#fightHistory");var bm=$("div[class^=foundation-style]",bb);if(bm.length===6){$("#ehHistoryExpand").show()}bm.slice(0,2).attr("style","opacity:0.6;");bm.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){bm.slice(4,6).hide()}var bl=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(bl){bb.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:bf}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:be.text()}))}else{bb.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:bf}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:be.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+bg);$("#ehTotalDamage").text(bc(parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+bn))}else{bp.text($("#fightResponse").text().trim());bp.fadeOut(2000)}}function ba(bc){var bb=jQuery.parseJSON(bc);$("#foodLimit").html(bb.foodLimit);$("#giftLimit").html(bb.giftLimit);$("#foodLimit2").html(bb.foodLimit);$("#giftLimit2").html(bb.giftLimit);$("#wellness").html(bb.wellness);$("#healthBar").html(bb.wellness);$("#healthProgress .ui-progressbar-value").animate({width:bb.wellness+"%"},{queue:false});$("#actualHealth").html(bb.wellness);$("#foodQ1").html("<b>Q1</b><br>"+bb.q1FoodStorage);$("#foodQ2").html("<b>Q2</b><br>"+bb.q2FoodStorage);$("#foodQ3").html("<b>Q3</b><br>"+bb.q3FoodStorage);$("#foodQ4").html("<b>Q4</b><br>"+bb.q4FoodStorage);$("#foodQ5").html("<b>Q5</b><br>"+bb.q5FoodStorage);$("#giftQ1").html("<b>Q1</b><br>"+bb.q1GiftStorage);$("#giftQ2").html("<b>Q2</b><br>"+bb.q2GiftStorage);$("#giftQ3").html("<b>Q3</b><br>"+bb.q3GiftStorage);$("#giftQ4").html("<b>Q4</b><br>"+bb.q4GiftStorage);$("#giftQ5").html("<b>Q5</b><br>"+bb.q5GiftStorage);$("#sfoodQ1").html("<b>Q1</b><br>"+bb.q1FoodStorage);$("#sfoodQ2").html("<b>Q2</b><br>"+bb.q2FoodStorage);$("#sfoodQ3").html("<b>Q3</b><br>"+bb.q3FoodStorage);$("#sfoodQ4").html("<b>Q4</b><br>"+bb.q4FoodStorage);$("#sfoodQ5").html("<b>Q5</b><br>"+bb.q5FoodStorage);$("#sgiftQ1").html("<b>Q1</b><br>"+bb.q1GiftStorage);$("#sgiftQ2").html("<b>Q2</b><br>"+bb.q2GiftStorage);$("#sgiftQ3").html("<b>Q3</b><br>"+bb.q3GiftStorage);$("#sgiftQ4").html("<b>Q4</b><br>"+bb.q4GiftStorage);$("#sgiftQ5").html("<b>Q5</b><br>"+bb.q5GiftStorage)}function aR(bc,bf){var bb=$("#AFHitUseWeapon").val();if(bb<0){return}var bd="weaponQuality="+bb+"&battleRoundId="+$("#battleRoundId").val()+"&side="+bc+"&value="+bf;var be=$.ajax({type:"POST",url:"fight.html",data:bd,success:function(bi){$("#fightResponse > div").replaceWith(bi);a7($(bi));var bh=$("#healthUpdate",bi).text();if(bh!==""){var bg=bh.substr(0,bh.length-3);if(bg<100){$("#healthProgress div.ui-corner-right").removeClass("ui-corner-right")}$("#healthProgress .ui-progressbar-value").animate({width:bg+"%"},{queue:false});$("#healthProgress").attr("title",bg+" / 100");$("#actualHealth").html(bg)}},error:function(bg,bj,bi){var bh=$("#showMsg");bh.text("错误："+bg.status);bh.show();bh.fadeOut(2000)}});aS.push(be)}function aP(){var bb=$("#AFHitUseFood").val();if(bb<=0){return}var bc="quality="+bb;var bd=$.ajax({type:"POST",url:"eat.html",data:bc,success:function(be){ba(be)}});aS.push(bd)}function aW(){var bb=$("#AFHitUseGift").val();if(bb<=0){return}var bc="quality="+bb;var bd=$.ajax({type:"POST",url:"gift.html",data:bc,success:function(be){ba(be)}});aS.push(bd)}function aX(bh){if(bh){var bc=parseInt($("#foodLimit2").text());if(bc>0){var be=parseInt($("#AFHitUseFood").val());var bg=parseInt($("span#sfoodQ"+be)[0].childNodes[2].nodeValue);if(bg>0){aP();return true}else{aY("食物不足");return false}}else{aY("食物额度不足");return false}}else{var bf=parseInt($("#giftLimit2").text());if(bf>0){var bd=parseInt($("#AFHitUseGift").val());var bb=parseInt($("span#sgiftQ"+bd)[0].childNodes[2].nodeValue);if(bb>0){aW();return true}else{aY("礼物不足");return false}}else{aY("礼物额度不足");return false}}}function a4(){var bc=$("#AFRestoreHealth1").val();var bb=$("#AFRestoreHealth2").val();if(bc==1){if(!aX(true)){if(bb==2){return aX(false)}else{return false}}else{return true}}else{if(bc==2){if(!aX(false)){if(bb==1){return aX(true)}else{return false}}else{return true}}else{aY("补充体力选择错误");return false}}}function a3(){if(parseFloat($("#actualHealth").html())<=50){if(!a4()){return false}}var bc=parseInt($("#AFHitUseWeapon").val());if(bc>0){var be=parseInt($("span#Q"+bc+"WeaponStock").text());if(be<=0){aY("武器不足");return false}}var bb=$("input[name='AFHitStyle']:checked");if(bb.length<=0){aY("未选择输出方");return false}var bd=bb.attr("data-AFSide");var bf=bb.attr("data-AFValue");aR(bd,bf)}}function ab(){if(!isActive){$("#ehButtonSpectator").attr("disabled",true);return}if(isPremium){$(".battleMonitorDiv").remove();var aQ=$("#ehDivSpectator");aQ.append($("<button>",{type:"button","class":"small button foundation-style",id:"showSpectator",text:"刷新观战玩家",style:"height:20px;width:100px;",click:function(){T(true)}}));var aP=$("<div>");aQ.append(aP);aP.append('<div class="foundation-style small-3 columns">  <b>Total defenders online:</b> <i id="ehTotaldefenders"  style="display: inline;">0</i>  <br> <div align="center" id="ehDefendersMenu" >No one <br> </div>  </div>');aP.append('<div class="foundation-style small-4 columns">  <b>Total spectators online:</b><i id="ehTotalspectators"                         >0</i>  <br> <div align="center" id="ehSpectatorsMenu">No one <br> </div>  </div>');aP.append('<div class="foundation-style small-3 columns">  <b>Total attackers online:</b> <i id="ehTotalattackers"  style="display: inline;">0</i>  <br> <div align="center" id="ehAttackersMenu" >No one <br> </div>  </div>')}else{var aQ=$("#ehDivSpectator");aQ.append($("<div>",{style:"font-color:red; font-size:24px;",text:"此功能利用了e-sim的小漏洞，有一定危险性，请自行承担后果"}));aQ.append($("<button>",{type:"button","class":"small button foundation-style",id:"showSpectator",text:"我知道了，还是想看！",click:function(){T(true)}}));var aP=$("<div>");aQ.append(aP);aP.append('<div class="foundation-style small-3 columns">  <b>Total defenders online:</b> <i id="ehTotaldefenders"  style="display: inline;">0</i>  <br> <div align="center" id="ehDefendersMenu" >No one <br> </div>  </div>');aP.append('<div class="foundation-style small-4 columns">  <b>Total spectators online:</b><i id="ehTotalspectators"                         >0</i>  <br> <div align="center" id="ehSpectatorsMenu">No one <br> </div>  </div>');aP.append('<div class="foundation-style small-3 columns">  <b>Total attackers online:</b> <i id="ehTotalattackers"  style="display: inline;">0</i>  <br> <div align="center" id="ehAttackersMenu" >No one <br> </div>  </div>')}}function D(){if(!isActive){$("#ehButtonAlarm").attr("disabled",true);return}var aY=X();var aU=$("<div>");var aQ=$("<input>",{type:"checkbox",id:"PopupCheckbox"}).appendTo(aU);var aR=$("<label>",{"class":"checkboxlabel","for":"PopupCheckbox",text:"自动弹窗（首次使用可能会被浏览器拦截，加入白名单即可）"}).appendTo(aU);var aW=localStorage.getItem("battlePopup");if(aW==null){localStorage.setItem("battlePopup","false")}else{aQ.attr("checked",aW=="true")}aQ.click(function(){if(aQ.is(":checked")){localStorage.setItem("battlePopup",true)}else{localStorage.setItem("battlePopup",false)}});var aT=$("<button>",{type:"button","class":"small button foundation-style",id:"testNotification",text:"测试",click:function(){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"：测试")}}}).appendTo(aU);$("#ehDivAlarm").append(aU);var aS=$("<div>",{"class":"foundation-style small-2 columns"});aS.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aS.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable10",value:10})," t10提醒");var aX=$("<div>",{"class":"foundation-style small-3 columns"});aX.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aX.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable5",value:5})," t5提醒");var aP=$("<div>",{"class":"foundation-style small-3 columns"});aP.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aP.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable2",value:2})," t2提醒");var aV=$("<div>",{"class":"foundation-style small-2 columns"});aV.append($("<i>",{"class":"icon-uptime",style:"font-size:20px;"}));aV.append($("<input>",{type:"checkbox","class":"foundation-style",id:"alarmEnable1",value:1})," t1提醒");$("#ehDivAlarm").append(aS,aX,aP,aV);if(aY<=10*60){$("#alarmEnable10").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable10").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时10分钟")}}$("#alarmEnable10").attr("disabled",true)},(aY-10*60)*1000)}if(aY<=5*60){$("#alarmEnable5").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable5").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时5分钟")}}if(localStorage.getItem("autoSendMessageToDiscord")=="true"){var aZ=$("#sendToDiscordButton");if(aZ.length==1){aZ.click()}}$("#alarmEnable5").attr("disabled",true)},(aY-5*60)*1000)}if(aY<=2*60){$("#alarmEnable2").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable2").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时2分钟")}}$("#alarmEnable2").attr("disabled",true)},(aY-2*60)*1000)}if(aY<=1*60){$("#alarmEnable1").attr("disabled",true)}else{setTimeout(function(){if($("#alarmEnable1").is(":checked")){if($("#PopupCheckbox").is(":checked")&&!window.opener){window.open(location.href,"Battle","resizable,scrollbars,width=1200,height=600")}else{alert(battleName+"倒计时1分钟")}}$("#alarmEnable1").attr("disabled",true)},(aY-1*60)*1000)}setInterval(au,1000)}function au(){var aQ=X();if(document.title.indexOf("：")!=-1){var aR=document.title.split("：")[1]}else{var aR=document.title}if(aQ>99){var aP="T"+parseInt(aQ/60).toString();var aR=aR+"：(S"+aQ.toString()+")"}else{var aP="S"+aQ.toString()}document.title=aP+"："+aR}function at(){var aV=$("[id^=fightButton]");if(aV.length===0){return}var aS=".critical { color:red; }";GM_addStyle(aS);var aW=aV.parent().parent();$("[id^=fightButton] > i",aW).remove();var aT=$("<div>",{id:"fightLeft","class":"foundation-style small-3 columns",style:"font-size:12px;"});var aQ=$("<div>",{id:"fightRight","class":"foundation-style small-7 columns foundation-text-center"});aQ.append(aW.children());aW.append(aT,aQ);var aY=$("<div>",{"class":"foundation-style small-5 columns foundation-text-left",html:'<b id="ehCountdown">00:00:00</b>',title:"点击刷新按钮可校准"});var aR=$("<div>",{"class":"foundation-style small-1 columns foundation-text-right",html:'x<b id="ehHitsNumber">0</b>',title:"在当前页面上攻击的次数, 刷新页面会清零"});var aU=$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",html:'<div id="ehTotalDamage">0</div>',title:"在当前页面上攻击的总伤害, 刷新页面会清零"});var aP=$("<div>",{id:"fightHistory"});var aX=$("<div>",{html:'<b id="showMsg"></b>'});aT.append(aY,aR,aU,aP,aX);aP.append('<div id="ehHistoryExpand" class="small-6"><i class="icon-uniF475" title="展开所有伤害记录"></i></div>','<div id="ehHistoryContract" class="small-6"><i class="icon-uniF474" title="收起输出伤害"></i></div>');$("#ehHistoryExpand").hide().click(function(){$("#fightHistory > div").slice(6).show();$(this).hide()});$("#ehHistoryContract").hide().click(function(){$("#fightHistory > div").slice(6).hide();$("#ehHistoryExpand").show()});$(".pico-content").livequery(function(){var aZ=$("#DamageDone",$(this));if(aZ.length>0){var a8=parseInt(aZ.text().replace(/,/g,"").replace(/\xA0/g,""));var ba=$(".fightsprite",aZ.parent().parent());var a4={bomb:["grey","无暴击(pain dealer)"],tank:["grey","无坦克(tank)"],syringe:["grey","无类固醇(steroid)"],airplane:["grey","无地点加成"],bookmark:["grey","无军令加成"]};var a5={absorbed:["loved",["lightgreen","闪避(avoid)"]],mu:["bookmark",["lightgreen","有军令加成"]],location:["airplane",["lightgreen","有地点加成"]],STEROIDSplus:["syringe",["lightgreen","有类固醇(steroid)"]],STEROIDSminus:["syringe",["pink","类固醇副作用(steroid)"]],TANKplus:["tank",["lightgreen","有坦克(tank)"]],TANKminus:["tank",["pink","坦克副作用(tank)"]],xp1:["xp",1],xp5:["xp",5],PAIN_DEALER_1_Hplus:["bomb",["lightgreen","1小时暴击(pain dealer)"]],PAIN_DEALER_10_Hplus:["bomb",["lightgreen","10小时暴击(pain dealer)"]],PAIN_DEALER_25_Hplus:["bomb",["lightgreen","25小时暴击(pain dealer)"]]};for(var a3=0;a3<ba.length;++a3){var a9=ba.eq(a3).attr("class").split(" ").pop();if(a9 in a5){var a0=a5[a9];a4[a0[0]]=a0[1]}}var a1="";var a2=a4.xp;delete a4.xp;for(a3 in a4){a1='<i style="color:'+a4[a3][0]+';" class="icon-'+a3+'" title="'+a4[a3][1]+'"></i>'+a1}a1+='<b title="'+a2+'次攻击">x'+a2+"</b>";var a7=$("div[class^=foundation-style]",aP);if(a7.length===6){$("#ehHistoryExpand").show()}a7.slice(0,2).attr("style","opacity:0.6;");a7.slice(2,4).attr("style","opacity:0.3;");if($("#ehHistoryExpand").is(":hidden")===false){a7.slice(4,6).hide()}var a6=($("#fightResult>div").attr("class").split(" ").pop().indexOf("critical")!==-1);if(a6){aP.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:a1}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right critical",text:aZ.text()}))}else{aP.prepend($("<div>",{"class":"foundation-style small-6 columns foundation-text-right",html:a1}),$("<div>",{"class":"foundation-style small-4 columns foundation-text-right",text:aZ.text()}))}$("#ehHitsNumber").text(parseInt($("#ehHitsNumber").text())+a2);$("#ehTotalDamage").text((parseInt($("#ehTotalDamage").text().replace(/,/g,"").replace(/\xA0/g,""))+a8).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}})}function af(){$.ajax({url:"apiOnlinePlayers.html?countryId=0",success:function(aP){var aQ=JSON.parse(aP);var aR=[];$.each(aQ,function(aS,aT){aR.push(JSON.parse(aT))});console.log(aR)},error:function(aP,aQ){console.log("apiOnlinePlayers抓取错误 (",aQ,")，该服可能不支持该API")}})}function V(){var aR=$("#ehDivSpectatorDetail");var aU=$("<button>",{id:"eh2ShowSpectatorDetail",text:"推测观战玩家（必须先查看过观战人员）","class":"foundation-style button",style:"padding:10px; margin:5px;"}).appendTo($("<div>").appendTo(aR));var aV=$("<button>",{id:"eh2ShowSpectatorBuff",text:"显示玩家状态","class":"foundation-style button",style:"padding:10px; margin:5px;",disabled:true}).insertAfter(aU);var aX=$("<INPUT TYPE='checkbox' id='eh2CheckCoalition'>按联盟分类玩家</INPUT>").insertAfter(aV);var aQ=$("<div>",{id:"eh2Defenders",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:33%;",text:"可能的防御者"}).appendTo(aR));var aT=$("<div>",{id:"eh2Strangers",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:34%;",text:"其他人"}).appendTo(aR));var aW=$("<div>",{id:"eh2Attackers",style:"text-align:left;"}).appendTo($("<div>",{"class":"foundation-style columns",style:"width:33%;",text:"可能的进攻者"}).appendTo(aR));var a1={defenderRegions:[],attackerRegions:[]};$("#defenderRegions input").each(function(){a1.defenderRegions.push(parseInt($(this).attr("value")))});$("#attackerRegions input").each(function(){a1.attackerRegions.push(parseInt($(this).attr("value")))});aU.click(function(){aU.attr("disabled",true);aV.attr("disabled",true);aY();aP();if($("#eh2CheckCoalition").is(":checked")){aZ()}else{aS()}});function aY(){var a3=$("#ehSpectatorsMenu").text().replace(/-[ \n\r]*/g,"- ").replace(/[\n\r]+ +/g,"\n").trim().split("\n");console.log(a3);var a5=[];var a2=a3.length;function a4(a7,a6){if(a6>=a7.length){a1.onlineCitizens=a5;console.log("相关国家的在线玩家扫描完毕");a0();return}var a9=a7[a6].split(" - ");var ba=a9[0];var a8=countryInfo[a9[1]]&&countryInfo[a9[1]].id;if(!a8){setTimeout(function(){a4(a7,a6+1)},200)}else{$.ajax({url:"citizensOnline.html?countryId="+a8,success:function(bd){var bc=$("table.dataTable:last tr:gt(0)",bd);var bb=bc.length;console.log(countryInfo[a8].name,"共有"+bb+"名在线玩家");bc.each(function(){if($("td",$(this)).length===1){console.log(countryInfo[a8].name,"没有玩家");return false}var bg=parseInt($("td:first a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var bf=parseInt($("td:last a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var be=a5.push({citizenId:bg,locationId:bf,countryId:a8,a:ba,b:bb,profile:$("td:first a",$(this)),avatar:$("td:first img",$(this)).attr("class","smallAvatar").attr("style","").attr("align","absmiddle")})});setTimeout(function(){a4(a7,a6+1)},200)},error:function(bb,bc){console.log("抓取错误 (",bc,")，重新抓取");$.ajax(this)}})}}a4(a3,0)}function aP(){$.ajax({url:"battleUnitsStats.html?id="+battleId,success:function(a7){var a8=$("div.small-5:eq(-2) a",a7);var a4=a8.length;if(a4===0){console.log("防御方没有军团");a1.defenderMus=[];a0()}else{var a3=[];a8.each(function(){var a9=parseInt($(this).attr("href").match(/([0-9]+)$/)[1]);a3.push(a9);I(a9,function(){if(--a4===0){a1.defenderMus=a3;console.log("防御方军团玩家扫描完毕");a0()}})})}var a6=$("div.small-5:last a",a7);var a5=a6.length;if(a5===0){console.log("进攻方没有军团");a1.attackerMus=[];a0()}else{var a2=[];a6.each(function(){var a9=parseInt($(this).attr("href").match(/([0-9]+)$/)[1]);a2.push(a9);I(a9,function(){if(--a5===0){a1.attackerMus=a2;console.log("进攻方军团玩家扫描完毕");a0()}})})}},error:function(a2,a3){console.log("抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}function aS(){if(!defenderId){a1.defenderAllies=[]}else{if(defenderId===allies[0]){a1.defenderAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+defenderId,success:function(a4){console.log(countryInfo[defenderId].name,"盟友抓取成功");var a2=[defenderId];var a3=$("div.xflagsMedium",$("table.dataTable:last",a4));a3.each(function(){var a5=$(this).attr("class").split(" ").pop();a5=a5.substring(a5.indexOf("-")+1);console.log("防守方盟友："+a5);a2.push(countryInfo[a5].id)});a1.defenderAllies=a2;a0()},error:function(a2,a3){console.log(countryInfo[defenderId].name,"盟友抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}}if(!attackerId){a1.attackerAllies=[]}else{if(attackerId===allies[0]){a1.attackerAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+attackerId,success:function(a4){console.log(countryInfo[attackerId].name,"盟友抓取成功");var a2=[attackerId];var a3=$("div.xflagsMedium",$("table.dataTable:last",a4));a3.each(function(){var a5=$(this).attr("class").split(" ").pop();a5=a5.substring(a5.indexOf("-")+1);console.log("进攻方盟友："+a5);a2.push(countryInfo[a5].id)});a1.attackerAllies=a2;a0()},error:function(a2,a3){console.log(countryInfo[attackerId].name,"盟友抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}}}function aZ(){if(!defenderId){a1.defenderAllies=[]}else{if(defenderId===allies[0]){a1.defenderAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+defenderId,success:function(a8){console.log(countryInfo[defenderId].name,"盟友及联盟抓取成功");var a6=[defenderId];var a7=$("div.xflagsMedium",$("table.dataTable:last",a8));a7.each(function(){var a9=$(this).attr("class").split(" ").pop();a9=a9.substring(a9.indexOf("-")+1);console.log("防守方盟友："+a9);a6.push(countryInfo[a9].id)});var a3=$("h2",a8);var a5;if(a3.length>4){a5=a3[2]}else{a5=a3[1]}if(a5.innerText.split(" ")[0]!="Coalition"){console.log("防守方没有联盟")}else{console.log("防守方属于联盟 "+a5.innerText.split(" ")[1]);var a2=$(a5,a8).nextAll("div.xflagsSmall");a2.each(function(){var a9=$(this).attr("class").split(" ").pop();a9=a9.substring(a9.indexOf("-")+1);if(countryInfo[defenderId].flagName!=a9){console.log("防守方联盟成员国："+a9);a6.push(countryInfo[a9].id)}})}var a4=$.unique(a6.sort());a1.defenderAllies=a4;a0()},error:function(a2,a3){console.log(countryInfo[defenderId].name,"盟友及联盟抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}}if(!attackerId){a1.attackerAllies=[]}else{if(attackerId===allies[0]){a1.attackerAllies=allies}else{$.ajax({url:"countryPoliticalStatistics.html?countryId="+attackerId,success:function(a8){console.log(countryInfo[attackerId].name,"盟友及联盟抓取成功");var a6=[attackerId];var a7=$("div.xflagsMedium",$("table.dataTable:last",a8));a7.each(function(){var a9=$(this).attr("class").split(" ").pop();a9=a9.substring(a9.indexOf("-")+1);console.log("进攻方盟友："+a9);a6.push(countryInfo[a9].id)});var a3=$("h2",a8);var a5;if(a3.length>4){a5=a3[2]}else{a5=a3[1]}if(a5.innerText.split(" ")[0]!="Coalition"){console.log("进攻方没有联盟")}else{console.log("进攻方属于联盟 "+a5.innerText.split(" ")[1]);var a2=$(a5,a8).nextAll("div.xflagsSmall");a2.each(function(){var a9=$(this).attr("class").split(" ").pop();a9=a9.substring(a9.indexOf("-")+1);if(countryInfo[attackerId].flagName!=a9){console.log("进攻方联盟成员国："+a9);a6.push(countryInfo[a9].id)}})}var a4=$.unique(a6.sort());a1.attackerAllies=a4;a0()},error:function(a2,a3){console.log(countryInfo[attackerId].name,"盟友及联盟抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}}}function a0(){if(!a1.onlineCitizens||!a1.defenderMus||!a1.attackerMus||!a1.defenderAllies||!a1.attackerAllies){return}aQ.empty();aW.empty();aT.empty();var a2=[];$.each(a1.onlineCitizens,function(a9,ba){var a6=ba.citizenId;var a3=citizenInfo[a6];var a7=aT;var a5=ba.a*100/ba.b;var a4=$("<div>",{id:"citizen"+a6,style:"font-size:12px;"});var bb=$("<i>",{"class":"icon-bookmark"}).appendTo(a4);if(a3&&$.inArray(a3.militaryUnitId,a1.defenderMus)!==-1){a7=aQ;bb.attr("style","color:SkyBlue;")}else{if(a3&&$.inArray(a3.militaryUnitId,a1.attackerMus)!==-1){a7=aW;bb.attr("style","color:Crimson;")}else{bb.attr("style","color:rgb(77, 77, 77);");a5-=0.0001}}if(a1.defenderRegions.length!==0){var a8=$("<i>",{"class":"icon-airplane"}).appendTo(a4);if($.inArray(ba.locationId,a1.defenderRegions)!==-1){if($.inArray(ba.locationId,a1.attackerRegions)!==-1){a8.attr("style","color:SeaGreen;")}else{if(a7===aT){a7=aQ}a8.attr("style","color:SkyBlue;")}}else{if($.inArray(ba.locationId,a1.attackerRegions)!==-1){a8.attr("style","color:Crimson;");if(a7===aT){a7=aW}}else{a8.attr("style","color:rgb(77, 77, 77);");a5-=0.0002}}}a4.append($("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[ba.countryId].flagName}),ba.avatar,ba.profile," ("+parseInt(ba.a*100/ba.b)+"%)");if(a7===aT){if($.inArray(ba.countryId,a1.defenderAllies)!==-1){a7=aQ}else{if($.inArray(ba.countryId,a1.attackerAllies)!==-1){a7=aW}else{a5-=0.0004}}}a2.push([a5,a4,a7])});a2.sort(function(a4,a3){return a3[0]-a4[0]});$.each(a2,function(a3,a4){if(isResistance&&$(".icon-airplane",a4[1]).attr("style")==="color:SeaGreen;"){if(a4[2]===aQ){$(".icon-airplane",a4[1]).attr("style","color:SkyBlue;")}else{if(a4[2]===aW){$(".icon-airplane",a4[1]).attr("style","color:Crimson;")}}}a4[1].appendTo(a4[2])});aU.attr("disabled",false);aV.attr("disabled",false)}aV.click(function(){aU.attr("disabled",true);aV.attr("disabled",true);aQ.parent().attr("class","foundation-style column small-5");aW.parent().attr("class","foundation-style column small-5");aT.parent().attr("style","width:100%;").insertAfter(aW.parent());aT.attr("style","width:50%; margin:0 auto; text-align:left;");var a2="rgb(139, 139, 139);; rgb(177, 11, 11);; rgb(242, 160, 27);; rgb(177, 182, 6);; rgb(33, 157, 33);; rgb(169, 34, 156);; rgb(0, 211, 211);".split("; ");var a6="帽 镜 甲 裤 鞋 符 武 副".split(" ");var a5="头盔, 眼镜, 盔甲, 作战裤, 作战靴, 幸运符, 武器配件, 副手".split(", ");var a3=$("div[id^='citizen']",aR);var a4=a3.length;a3.each(function(){var a8=$(this);var a7=parseInt(a8.attr("id").match(/([0-9]+)$/)[1]);H(a7,false,function(){if(citizenPage[a7].equipments.length===0){a8.remove();return true}var a9=[];$.each(citizenPage[a7].equipments,function(bb,bc){bc=parseInt(bc[1]);a9.push($("<span>",{style:"color:"+a2[bc],text:a6[bb],title:"Q"+bc+" "+a5[bb]}))});a8.prepend(a9);var ba=[];$.each(citizenPage[a7].buffIcons,function(bc,bb){ba.push($("<img>",{src:bb,style:"width:18px; vertical-align:middle;"}))});$.each(citizenPage[a7].debuffIcons,function(bc,bb){ba.push($("<img>",{src:bb,style:"width:18px; vertical-align:middle;"}))});a8.append(ba);if(--a4===0){aU.attr("disabled",false);localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}})})})}function J(){var aQ=$("div > a.fbShare2").closest("div.columns").empty();console.log(aQ);var aP=$("<button>",{"class":"foundation-style button",text:"显示所有局"}).appendTo(aQ);var aR=$("#battleProgress:first");aP.click(function(){var aX=aQ.closest("div.fightContainer ");var aV=$('a[href^="battle.html"]').attr("href");var aW=$('img[src$="blue_ball.png"]').length+$('img[src$="red_ball.png"]').length;for(var aU=aW;aU>0;--aU){var aT=$("<div>",{"class":"foundation-radius fightContainer oldRound",id:"ehRound"+aU,roundId:aU}).insertAfter(aX).hide();$("<div>",{"class":"foundation-style small-2 columns topDefenders",id:"defenderBH"}).appendTo(aT);var aS=$("<div>",{"class":"foundation-style small-6 columns",id:"middle"}).appendTo(aT);aR.clone().appendTo(aS);$("<div>",{"class":"foundation-radius fightContainer foundation-base-font",id:"scores"}).appendTo(aS);$("<div>",{"class":"foundation-style small-2 columns topAttackers",id:"attackerBH"}).appendTo(aT)}$("div.oldRound").each(function(){var aZ=$(this);var aY=$("#middle",aZ);var a0=$("#scores",aY);var a1=aZ.attr("roundId");$.ajax({url:aV+"&round="+a1,success:function(a5){$("#topDefender1",a5).children().appendTo($("#defenderBH",aZ));$("#topAttacker1",a5).children().appendTo($("#attackerBH",aZ));var a4=$("#leftStat",a5).text().match(/^([\d\.]+)/)[1];$("#battleProgress",aZ).attr("aria-valuenow",a4);$("#battleProgress > div.ui-progressbar-value",aZ).attr("style","width: "+a4+"%");var a6=$("#battleProgressStats",a5).insertAfter($("#battleProgress",aZ));var a2=$("<div>").appendTo(a6);var a3=parseInt($("#defenderScore",a5).text().replace(/,/g,"").replace(/\xA0/g,""))-parseInt($("#attackerScore",a5).text().replace(/,/g,"").replace(/\xA0/g,""));if(a3===0){a2.text("")}else{if(a3>0){a2.text(">> "+a3.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" >>")}else{a2.text("<< "+(-a3).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" <<")}}$("#defenderScore",a5).closest("div").appendTo(a0);$("<a>",{"class":"foundation-style small-2 columns",href:aV+"&round="+a1,text:"Round "+a1}).appendTo(a0);$("#attackerScore",a5).closest("div").appendTo(a0);aZ.show()},error:function(a2,a3){console.log("第",a1,"局伤害抓取错误 (",a3,")，重新抓取");$.ajax(this)}})})});k()}function k(){var a6=[];var bA=[];var bf=[];var bB=[];var a1=[];var a0=[];var aZ=[];var aY=[];var aW=[];var aV=[];var aX=[];var bo=[];var bl=[];var bG=[];var aS=[];var aR=[];var aP=[];var bI=[];var bF=[];var bE=[];var a5=[];var br=[];var bn=[];var a4=[];var by=[];var bx=[];var bw=[];var bv=[];var bu=[];var bs=[];var ba=[];var bz=[];var bq;function bi(){var bJ=window.navigator.userAgent;if(bJ.indexOf("MSIE")>=0){return"ie"}else{if(bJ.indexOf("Firefox")>=0){return"Firefox"}else{if(bJ.indexOf("Chrome")>=0){return"Chrome"}else{if(bJ.indexOf("Opera")>=0){return"Opera"}else{if(bJ.indexOf("Safari")>=0){return"Safari"}}}}}}function aQ(bL){if(bi()=="ie"){var bJ=document.getElementById(bL);var bO=new ActiveXObject("Excel.Application");var bK=bO.Workbooks.Add();var bN=bK.Worksheets(1);var bM=document.body.createTextRange();bM.moveToElementText(bJ);bM.select();bM.execCommand("Copy");bN.Paste();bO.Visible=true;try{var bQ=bO.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(bP){print("Nested catch caught "+bP)}finally{bK.SaveAs(bQ);bK.Close(savechanges=false);bO.Quit();bO=null;bq=window.setInterval("Cleanup();",1)}}else{be(bL)}}function bH(){window.clearInterval(bq);CollectGarbage()}var be=(function(){var bL="data:application/vnd.ms-excel;base64,",bK='<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',bJ=function(bN){return window.btoa(unescape(encodeURIComponent(bN)))},bM=function(bN,bO){return bN.replace(/{(\w+)}/g,function(bP,bQ){return bO[bQ]})};return function(bP,bO){if(!bP.nodeType){bP=document.getElementById(bP)}var bN={worksheet:bO||"Worksheet",table:bP.innerHTML};window.location.href=bL+bJ(bM(bK,bN))}})();bd();function a3(bR,bN,bQ,bP,bM,bO,bK){var bL=$("<tr>",{id:"CBCCountry"+bR,"class":"CBCCountry",style:"background-color:#3d6571;"}).appendTo($("#CBCCountryResultTbody"));var bJ=$("<td>",{text:countryInfo[bR].name,CBCCountryId:bR}).appendTo(bL);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bR].flagName,style:"vertical-align:middle;"}).prependTo(bJ);for(i=1;i<=bN;++i){$("<td>",{text:bQ[i],"class":"CBCTableRoundsTd",sortPoint:bP[i]}).appendTo(bL)}$("<td>",{text:bM[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bM[0]}).appendTo(bL);$("<td>",{text:bM[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bM[1]}).appendTo(bL);$("<td>",{text:bM[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bM[2]}).appendTo(bL);$("<td>",{text:bM[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bM[3]}).appendTo(bL);$("<td>",{text:bM[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bM[4]}).appendTo(bL);$("<td>",{text:bM[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bM[5]}).appendTo(bL);$("<td>",{text:bO[0],"class":"CBCTableTotalDmgTd",sortPoint:bO[0]}).appendTo(bL);$("<td>",{text:bO[1],"class":"CBCTableTotalDmgTd",sortPoint:bO[1]}).appendTo(bL);$("<td>",{text:bO[2],"class":"CBCTableTotalDmgTd",sortPoint:bO[2]}).appendTo(bL);$("<td>",{text:bK,"class":"CBCTableTotalDmgTd",sortPoint:bK}).appendTo(bL)}function bt(bJ,bM,bL,bK){}function bm(bL,bO,bR,bQ,bM,bP,bK){var bJ=$("<tr>",{id:"CBCMu"+bL,"class":"CBCMu",style:"background-color:#3d6571;"}).appendTo($("#CBCMuResultTbody"));var bN=$("<td>",{CBCMuId:bL}).appendTo(bJ);bN.attr("GetAPI","false");$("<a>",{href:"militaryUnit.html?id="+bL,target:"_blank",text:"("+bL+")"}).appendTo(bN);for(i=1;i<=bO;++i){$("<td>",{text:bR[i],"class":"CBCTableRoundsTd",sortPoint:bQ[i]}).appendTo(bJ)}$("<td>",{text:bM[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bM[0]}).appendTo(bJ);$("<td>",{text:bM[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bM[1]}).appendTo(bJ);$("<td>",{text:bM[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bM[2]}).appendTo(bJ);$("<td>",{text:bM[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bM[3]}).appendTo(bJ);$("<td>",{text:bM[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bM[4]}).appendTo(bJ);$("<td>",{text:bM[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bM[5]}).appendTo(bJ);$("<td>",{text:bP[0],"class":"CBCTableTotalDmgTd",sortPoint:bP[0]}).appendTo(bJ);$("<td>",{text:bP[1],"class":"CBCTableTotalDmgTd",sortPoint:bP[1]}).appendTo(bJ);$("<td>",{text:bP[2],"class":"CBCTableTotalDmgTd",sortPoint:bP[2]}).appendTo(bJ);$("<td>",{text:bK,"class":"CBCTableTotalDmgTd",sortPoint:bK}).appendTo(bJ)}function bc(bJ,bM,bL,bK){}function bh(bM,bN,bR,bP,bL,bO,bJ){var bK=$("<tr>",{id:"CBCCitizen"+bM,"class":"CBCCitizen",style:"background-color:#3d6571;"}).appendTo($("#CBCCitizenResultTbody"));var bQ=$("<td>",{CBCCitizenId:bM}).appendTo(bK);if(typeof(citizenInfo[bM])=="undefined"){bQ.attr("GetAPI","false");$("<a>",{href:"profile.html?id="+bM,target:"_blank",text:"("+bM+")"}).appendTo(bQ)}else{bQ.attr("GetAPI","true");$("<a>",{href:"profile.html?id="+bM,target:"_blank",text:citizenInfo[bM].login}).appendTo(bQ);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[citizenInfo[bM].citizenshipId].flagName,style:"vertical-align:middle;"}).prependTo(bQ)}for(i=1;i<=bN;++i){$("<td>",{text:bR[i],"class":"CBCTableRoundsTd",sortPoint:bP[i]}).appendTo(bK)}$("<td>",{text:bL[0],"class":"CBCTableTotalTd",quality:0,sortPoint:bL[0]}).appendTo(bK);$("<td>",{text:bL[1],"class":"CBCTableTotalTd",quality:1,sortPoint:bL[1]}).appendTo(bK);$("<td>",{text:bL[2],"class":"CBCTableTotalTd",quality:2,sortPoint:bL[2]}).appendTo(bK);$("<td>",{text:bL[3],"class":"CBCTableTotalTd",quality:3,sortPoint:bL[3]}).appendTo(bK);$("<td>",{text:bL[4],"class":"CBCTableTotalTd",quality:4,sortPoint:bL[4]}).appendTo(bK);$("<td>",{text:bL[5],"class":"CBCTableTotalTd",quality:5,sortPoint:bL[5]}).appendTo(bK);$("<td>",{text:bO[0],"class":"CBCTableTotalDmgTd",sortPoint:bO[0]}).appendTo(bK);$("<td>",{text:bO[1],"class":"CBCTableTotalDmgTd",sortPoint:bO[1]}).appendTo(bK);$("<td>",{text:bO[2],"class":"CBCTableTotalDmgTd",sortPoint:bO[2]}).appendTo(bK);$("<td>",{text:bJ,"class":"CBCTableTotalDmgTd",sortPoint:bJ}).appendTo(bK)}function a2(bJ,bM,bL,bK){}function a7(bJ,bM){if(bM>=bJ.length){return}var bL=$(bJ[bM]);var bK=bL.attr("CBCMuId");$.ajax({url:"apiMilitaryUnitById.html?id="+bK,success:function(bN){var bO=JSON.parse(bN);bL.empty();bL.attr("GetAPI","true");$("<a>",{href:"militaryUnit.html?id="+bK,target:"_blank",text:bO.name}).appendTo(bL);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bO.countryId].flagName,style:"vertical-align:middle;"}).prependTo(bL);setTimeout(function(){a7(bJ,bM+1)},200)},error:function(bN,bO){console.log("获取军团API错误 (",bO,")")}})}function bC(bK,bJ){if(bJ>=bK.length){return}var bM=$(bK[bJ]);var bL=bM.attr("CBCCitizenId");$.ajax({url:"apiCitizenById.html?id="+bL,success:function(bN){var bO=JSON.parse(bN);bM.empty();bM.attr("GetAPI","true");$("<a>",{href:"profile.html?id="+bL,target:"_blank",text:bO.login}).appendTo(bM);$("<div>",{"class":"xflagsSmall xflagsSmall-"+countryInfo[bO.citizenshipId].flagName,style:"vertical-align:middle;"}).prependTo(bM);setTimeout(function(){bC(bK,bJ+1)},200)},error:function(bN,bO){console.log("获取玩家API错误 (",bO,")")}})}function bp(bW,bJ,bS){var b1;$("<p>国家消耗统计</p>").appendTo(bW);var b5=$("<table>",{id:"CBCCountryResult",style:"width:100%;font-size:12px;"}).appendTo(bW);var bY=$("<thead>").appendTo(b5);var bO=$("<tfoot>",{id:"CBCCountryResultTfoot"}).appendTo(b5);var b4=$("<tbody>",{id:"CBCCountryResultTbody"}).appendTo(b5);var b0=$("<tr>",{id:"CBCCountryResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bY);var b8=$("<td>",{text:"国家"}).appendTo(b0);for(b1=1;b1<=bJ;++b1){$("<td>",{text:b1,"class":"CBCTableRoundsTd"}).appendTo(b0)}if(bS==false){$("<td>",{text:(bJ+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(b0)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(b0);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(b0);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(b0);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(b0);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(b0);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(b0);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(b0);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(b0);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(b0);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(b0);var b9=$('<button type="button">导出</button>').appendTo(bW);b9.click(function(){aQ("CBCCountryResult")});$("#CBCCountryResultTheadTr").children(":gt(0)").each(function(cb,cc){$(cc).click(function(){a8("CBCCountry",cb+1)})});$("<p>军团消耗统计</p>").appendTo(bW);var bV=$("<table>",{id:"CBCMuResult",style:"width:100%;font-size:12px;"}).appendTo(bW);var bL=$("<thead>").appendTo(bV);var b7=$("<tfoot>",{id:"CBCMuResultTfoot"}).appendTo(bV);var bT=$("<tbody>",{id:"CBCMuResultTbody"}).appendTo(bV);var bZ=$("<tr>",{id:"CBCMuResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bL);var bP=$("<td>",{text:"军团"}).appendTo(bZ);var bK=$('<button type="button">获取军团名</button>').appendTo(bP);bK.click(function(){var cb=$("[CBCMuId][getapi=false]");a7(cb,0)});for(b1=1;b1<=bJ;++b1){$("<td>",{text:b1,"class":"CBCTableRoundsTd"}).appendTo(bZ)}if(bS==false){$("<td>",{text:(bJ+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(bZ)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(bZ);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(bZ);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(bZ);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(bZ);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(bZ);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(bZ);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bZ);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(bZ);var b6=$('<button type="button">导出</button>').appendTo(bW);b6.click(function(){aQ("CBCMuResult")});$("#CBCMuResultTheadTr").children(":gt(0)").each(function(cb,cc){$(cc).click(function(){a8("CBCMu",cb+1)})});$("<p>个人消耗统计</p>").appendTo(bW);var bQ=$("<table>",{id:"CBCCitizenResult",style:"width:100%;font-size:12px;"}).appendTo(bW);var bX=$("<thead>").appendTo(bQ);var bN=$("<tfoot>",{id:"CBCCitizenResultTfoot"}).appendTo(bQ);var b3=$("<tbody>",{id:"CBCCitizenResultTbody"}).appendTo(bQ);var bR=$("<tr>",{id:"CBCCitizenResultTheadTr",style:"background-color:#3d6571;"}).appendTo(bX);var b2=$("<td>",{text:"玩家"}).appendTo(bR);var bU=$('<button type="button">获取玩家名</button>').appendTo(b2);bU.click(function(){var cb=$("[CBCCitizenId][getapi=false]");bC(cb,0)});for(b1=1;b1<=bJ;++b1){$("<td>",{text:b1,"class":"CBCTableRoundsTd"}).appendTo(bR)}if(bS==false){$("<td>",{text:(bJ+1)+"(未结束)","class":"CBCTableRoundsTd"}).appendTo(bR)}$("<td>",{text:"总计(Q0)","class":"CBCTableTotalTd",quality:0}).appendTo(bR);$("<td>",{text:"总计(Q1)","class":"CBCTableTotalTd",quality:1}).appendTo(bR);$("<td>",{text:"总计(Q2)","class":"CBCTableTotalTd",quality:2}).appendTo(bR);$("<td>",{text:"总计(Q3)","class":"CBCTableTotalTd",quality:3}).appendTo(bR);$("<td>",{text:"总计(Q4)","class":"CBCTableTotalTd",quality:4}).appendTo(bR);$("<td>",{text:"总计(Q5)","class":"CBCTableTotalTd",quality:5}).appendTo(bR);$("<td>",{text:"防守方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bR);$("<td>",{text:"进攻方总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bR);$("<td>",{text:"总伤害","class":"CBCTableTotalDmgTd"}).appendTo(bR);$("<td>",{text:"武器利用比","class":"CBCTableTotalDmgTd"}).appendTo(bR);var bM=$('<button type="button">导出</button>').appendTo(bW);bM.click(function(){aQ("CBCCitizenResult")});$("#CBCCitizenResultTheadTr").children(":gt(0)").each(function(cb,cc){$(cc).click(function(){a8("CBCCitizen",cb+1)})});var ca=$('<button type="button">复制自己的消耗记录</button>').appendTo(bW);ca.click(function(){var cg=$("a[href^='profile.html']",$("#userAvatar"));var cd=cg.text();var cb=cg.attr("href").replace("profile.html?id=","");var ci=$("[cbccitizenid="+cb+"]").parent();var ch=cd+"的战场消耗：\r\n";var cj=location.origin+"/battle.html?id="+n("id")+"&round=";var cc;var ck;if(bS==true){ck=bJ}else{ck=bJ+1}for(var cf=0;cf<ck;cf++){cc=ci.children("td:eq("+(cf+1)+")").text();if(cc!=""){ch=ch+cj+$(".CBCTableRoundsTd :eq("+cf+")").text()+"    "+cc+"\r\n"}}ch=ch+"------------------------------------------------------------\r\n总计： ";for(var ce=0;ce<=5;ce++){cc=ci.children("td:eq("+(ci.children("td").length-10+ce)+")").text();if(cc!="0"){ch=ch+cc+" Q"+ce+"  |  "}}GM_setClipboard(ch)})}function bd(){var bK=$("div.foundation-radius.fightContainer.foundation-base-font :last");var bL=bK.clone().insertAfter(bK);bL.empty();var bT=$("<button>",{"class":"foundation-style button",text:"统计战场消耗"}).appendTo(bL);bT.click(function(){bT.attr("disabled",true);var bV=$('a[href^="battle.html"]').attr("href").split("?id=")[1];var bY=$('img[src$="red_ball.png"]').length;var bZ=$('img[src$="blue_ball.png"]').length;var bW=bY+bZ;var bX=bW;var bU=true;if((bY<8)&&(bZ<8)){bU=false;bX=bX+1}bp(bL,bW,bU);aU(bT,bV,1,bX)});var bQ=$("<input>",{type:"checkbox",id:"HideRoundsCheckbox"}).appendTo(bL);var bR=$("<label>",{"class":"checkboxlabel","for":"HideRoundsCheckbox",text:"隐藏回合"}).appendTo(bL);bQ.click(function(){if(bQ.is(":checked")){$(".CBCTableRoundsTd").hide()}else{$(".CBCTableRoundsTd").show()}});var bM=$("<input>",{type:"checkbox",id:"HideTotalCheckbox"}).appendTo(bL);var bS=$("<label>",{"class":"checkboxlabel","for":"HideTotalCheckbox",text:"隐藏消耗总计"}).appendTo(bL);bM.click(function(){if(bM.is(":checked")){$(".CBCTableTotalTd").hide()}else{$(".CBCTableTotalTd").show()}});var bP=$("<input>",{type:"checkbox",id:"HideTotalSpecialQualityCheckbox"}).appendTo(bL);var bO=$("<label>",{"class":"checkboxlabel","for":"HideTotalSpecialQualityCheckbox",text:"仅保留Q1和Q5消耗总计"}).appendTo(bL);bP.click(function(){if(bP.is(":checked")){$(".CBCTableTotalTd[quality!=1][quality!=5]").hide()}else{$(".CBCTableTotalTd[quality!=1][quality!=5]").show()}});var bJ=$("<input>",{type:"checkbox",id:"HideTotalDmgCheckbox"}).appendTo(bL);var bN=$("<label>",{"class":"checkboxlabel","for":"HideTotalDmgCheckbox",text:"隐藏伤害总计"}).appendTo(bL);bJ.click(function(){if(bJ.is(":checked")){$(".CBCTableTotalDmgTd").hide()}else{$(".CBCTableTotalDmgTd").show()}})}function a9(bK,bL){var bJ=JSON.parse(bK);for(i=0;i<bJ.length;++i){if(bJ[i].weapon==0){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(by[bL][bJ[i].citizenId])=="undefined"){by[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{by[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(a1[bL][bJ[i].citizenship])=="undefined"){a1[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{a1[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(aS[bL][bJ[i].militaryUnit])=="undefined"){aS[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{aS[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}else{if(bJ[i].weapon==1){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(bx[bL][bJ[i].citizenId])=="undefined"){bx[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{bx[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(a0[bL][bJ[i].citizenship])=="undefined"){a0[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{a0[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(aR[bL][bJ[i].militaryUnit])=="undefined"){aR[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{aR[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}else{if(bJ[i].weapon==2){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(bw[bL][bJ[i].citizenId])=="undefined"){bw[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{bw[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(aZ[bL][bJ[i].citizenship])=="undefined"){aZ[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{aZ[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(aP[bL][bJ[i].militaryUnit])=="undefined"){aP[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{aP[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}else{if(bJ[i].weapon==3){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(bv[bL][bJ[i].citizenId])=="undefined"){bv[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{bv[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(aY[bL][bJ[i].citizenship])=="undefined"){aY[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{aY[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(bI[bL][bJ[i].militaryUnit])=="undefined"){bI[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{bI[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}else{if(bJ[i].weapon==4){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(bu[bL][bJ[i].citizenId])=="undefined"){bu[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{bu[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(aW[bL][bJ[i].citizenship])=="undefined"){aW[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{aW[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(bF[bL][bJ[i].militaryUnit])=="undefined"){bF[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{bF[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}else{if(bJ[i].weapon==5){if(bf.indexOf(bJ[i].citizenId)<0){bf.push(bJ[i].citizenId)}if(typeof(bs[bL][bJ[i].citizenId])=="undefined"){bs[bL][bJ[i].citizenId]=1+4*bJ[i].berserk}else{bs[bL][bJ[i].citizenId]+=1+4*bJ[i].berserk}if(a6.indexOf(bJ[i].citizenship)<0){a6.push(bJ[i].citizenship)}if(typeof(aV[bL][bJ[i].citizenship])=="undefined"){aV[bL][bJ[i].citizenship]=1+4*bJ[i].berserk}else{aV[bL][bJ[i].citizenship]+=1+4*bJ[i].berserk}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bA.indexOf(bJ[i].militaryUnit)<0){bA.push(bJ[i].militaryUnit)}if(typeof(bE[bL][bJ[i].militaryUnit])=="undefined"){bE[bL][bJ[i].militaryUnit]=1+4*bJ[i].berserk}else{bE[bL][bJ[i].militaryUnit]+=1+4*bJ[i].berserk}}}}}}}}if(bJ[i].defenderSide==true){if(typeof(bz[bJ[i].citizenId])=="undefined"){bz[bJ[i].citizenId]=bJ[i].damage}else{bz[bJ[i].citizenId]+=bJ[i].damage}if(typeof(bo[bJ[i].citizenship])=="undefined"){bo[bJ[i].citizenship]=bJ[i].damage}else{bo[bJ[i].citizenship]+=bJ[i].damage}}if(bJ[i].defenderSide==false){if(typeof(ba[bJ[i].citizenId])=="undefined"){ba[bJ[i].citizenId]=bJ[i].damage}else{ba[bJ[i].citizenId]+=bJ[i].damage}if(typeof(aX[bJ[i].citizenship])=="undefined"){aX[bJ[i].citizenship]=bJ[i].damage}else{aX[bJ[i].citizenship]+=bJ[i].damage}}if(typeof(bJ[i].militaryUnit)!="undefined"){if(bJ[i].defenderSide==true){if(typeof(br[bJ[i].militaryUnit])=="undefined"){br[bJ[i].militaryUnit]=bJ[i].damage}else{br[bJ[i].militaryUnit]+=bJ[i].damage}}if(bJ[i].defenderSide==false){if(typeof(a5[bJ[i].militaryUnit])=="undefined"){a5[bJ[i].militaryUnit]=bJ[i].damage}else{a5[bJ[i].militaryUnit]+=bJ[i].damage}}}}}function bk(bT,bJ){function bS(bW,bX){var bV=[0,0,0,0,0,0];if(typeof(a1[bX][bW])=="undefined"){bV[0]=0}else{bV[0]=a1[bX][bW]}if(typeof(a0[bX][bW])=="undefined"){bV[1]=0}else{bV[1]=a0[bX][bW]}if(typeof(aZ[bX][bW])=="undefined"){bV[2]=0}else{bV[2]=aZ[bX][bW]}if(typeof(aY[bX][bW])=="undefined"){bV[3]=0}else{bV[3]=aY[bX][bW]}if(typeof(aW[bX][bW])=="undefined"){bV[4]=0}else{bV[4]=aW[bX][bW]}if(typeof(aV[bX][bW])=="undefined"){bV[5]=0}else{bV[5]=aV[bX][bW]}return bV}var bU=[];var bM=["","","","","","","","","","","","","","","",""];var bP=[];var bQ=[0,0,0,0,0,0];var bO=[];var bR;var bL;for(var bN=1;bN<=bJ;bN++){bU[bN]=bS(bT,bN);bP[bN]=0;for(var bK=0;bK<6;bK++){if(bU[bN][bK]!=0){bM[bN]+=(bU[bN][bK]+" q"+bK+" ");bQ[bK]+=bU[bN][bK];bP[bN]+=((bK+1)*bU[bN][bK])}}}if(typeof(bo[bT])=="undefined"){bO[0]=0}else{bO[0]=bo[bT]}if(typeof(aX[bT])=="undefined"){bO[1]=0}else{bO[1]=aX[bT]}bO[2]=bO[0]+bO[1];bR=bQ[0]*0.5+bQ[1]*1.2+bQ[2]*1.4+bQ[3]*1.6+bQ[4]*1.8+bQ[5]*2;if(bR==0){bR=1}bL=parseInt(bO[2]/bR);a3(bT,bJ,bM,bP,bQ,bO,bL)}function bj(bQ,bJ){function bT(bW,bX){var bV=[0,0,0,0,0,0];if(typeof(aS[bX][bW])=="undefined"){bV[0]=0}else{bV[0]=aS[bX][bW]}if(typeof(aR[bX][bW])=="undefined"){bV[1]=0}else{bV[1]=aR[bX][bW]}if(typeof(aP[bX][bW])=="undefined"){bV[2]=0}else{bV[2]=aP[bX][bW]}if(typeof(bI[bX][bW])=="undefined"){bV[3]=0}else{bV[3]=bI[bX][bW]}if(typeof(bF[bX][bW])=="undefined"){bV[4]=0}else{bV[4]=bF[bX][bW]}if(typeof(bE[bX][bW])=="undefined"){bV[5]=0}else{bV[5]=bE[bX][bW]}return bV}var bU=[];var bM=["","","","","","","","","","","","","","","",""];var bP=[];var bR=[0,0,0,0,0,0];var bO=[];var bS;var bL;for(var bN=1;bN<=bJ;bN++){bU[bN]=bT(bQ,bN);bP[bN]=0;for(var bK=0;bK<6;bK++){if(bU[bN][bK]!=0){bM[bN]+=(bU[bN][bK]+" q"+bK+" ");bR[bK]+=bU[bN][bK];bP[bN]+=((bK+1)*bU[bN][bK])}}}if(typeof(br[bQ])=="undefined"){bO[0]=0}else{bO[0]=br[bQ]}if(typeof(a5[bQ])=="undefined"){bO[1]=0}else{bO[1]=a5[bQ]}bO[2]=bO[0]+bO[1];bS=bR[0]*0.5+bR[1]*1.2+bR[2]*1.4+bR[3]*1.6+bR[4]*1.8+bR[5]*2;if(bS==0){bS=1}bL=parseInt(bO[2]/bS);bm(bQ,bJ,bM,bP,bR,bO,bL)}function bb(bR,bJ){function bN(bX,bW){var bV=[0,0,0,0,0,0];if(typeof(by[bW][bX])=="undefined"){bV[0]=0}else{bV[0]=by[bW][bX]}if(typeof(bx[bW][bX])=="undefined"){bV[1]=0}else{bV[1]=bx[bW][bX]}if(typeof(bw[bW][bX])=="undefined"){bV[2]=0}else{bV[2]=bw[bW][bX]}if(typeof(bv[bW][bX])=="undefined"){bV[3]=0}else{bV[3]=bv[bW][bX]}if(typeof(bu[bW][bX])=="undefined"){bV[4]=0}else{bV[4]=bu[bW][bX]}if(typeof(bs[bW][bX])=="undefined"){bV[5]=0}else{bV[5]=bs[bW][bX]}return bV}var bU=[];var bM=["","","","","","","","","","","","","","","",""];var bQ=[];var bS=[0,0,0,0,0,0];var bP=[];var bT;var bL;for(var bO=1;bO<=bJ;bO++){bU[bO]=bN(bR,bO);bQ[bO]=0;for(var bK=0;bK<6;bK++){if(bU[bO][bK]!=0){bM[bO]+=(bU[bO][bK]+" q"+bK+" ");bS[bK]+=bU[bO][bK];bQ[bO]+=((bK+1)*bU[bO][bK])}}}if(typeof(bz[bR])=="undefined"){bP[0]=0}else{bP[0]=bz[bR]}if(typeof(ba[bR])=="undefined"){bP[1]=0}else{bP[1]=ba[bR]}bP[2]=bP[0]+bP[1];bT=bS[0]*0.5+bS[1]*1.2+bS[2]*1.4+bS[3]*1.6+bS[4]*1.8+bS[5]*2;if(bT==0){bT=1}bL=parseInt(bP[2]/bT);bh(bR,bJ,bM,bQ,bS,bP,bL)}function aT(bM){for(var bK=0;bK<a6.length;bK++){bk(a6[bK],bM)}for(var bJ=0;bJ<bA.length;bJ++){bj(bA[bJ],bM)}for(var bL=0;bL<bf.length;bL++){bb(bf[bL],bM)}}function bg(bJ,bK){return(Array(bK).join(0)+bJ).slice(-bK)}function bD(bO,bN){var bM=[];var bK=[];var bL;var bJ;$("."+bO).each(function(bP,bQ){bK[0]=parseInt($(this).children("td:eq("+(bN+1)+")").text());bK[1]=parseInt($(this).children("td:eq("+(bN+2)+")").text());bK[2]=parseInt($(this).children("td:eq("+(bN+3)+")").text());bK[3]=parseInt($(this).children("td:eq("+(bN+4)+")").text());bK[4]=parseInt($(this).children("td:eq("+(bN+5)+")").text());bK[5]=parseInt($(this).children("td:eq("+(bN+6)+")").text());bL=bK[1]+bK[2]*2+bK[3]*3+bK[4]*4+bK[5]*5;bJ=bg(bL,6);bM.push(bJ+" "+$(this).attr("id"))});bM.sort();$.each(bM,function(bQ,bR){var bP=bR.split(" ").pop();$("#"+bP).prependTo($("#"+bO+"ResultTbody"))})}function a8(bM,bK){var bL=[];var bJ;$("."+bM).each(function(bN,bO){bJ=$(this).children("td:eq("+bK+")").attr("sortPoint");bJ=bg(bJ,15);bL.push(bJ+" "+$(this).attr("id"))});bL.sort();$.each(bL,function(bO,bP){var bN=bP.split(" ").pop();$("#"+bN).prependTo($("#"+bM+"ResultTbody"))})}function aU(bJ,bK,bM,bL){$.ajax({url:"apiFights.html?battleId="+bK+"&roundId="+bM,success:function(bN){a1[bM]=[];a0[bM]=[];aZ[bM]=[];aY[bM]=[];aW[bM]=[];aV[bM]=[];aS[bM]=[];aR[bM]=[];aP[bM]=[];bI[bM]=[];bF[bM]=[];bE[bM]=[];by[bM]=[];bx[bM]=[];bw[bM]=[];bv[bM]=[];bu[bM]=[];bs[bM]=[];a9(bN,bM);bJ.text("剩余"+(bL-bM)+"个");if(bM>=bL){bJ.text("获取成功");aT(bL);bD("CBCCountry",bL);bD("CBCMu",bL);bD("CBCCitizen",bL)}else{aU(bJ,bK,bM+1,bL)}},error:function(bN,bO){console.log("抓取错误 (",bO,")，重新抓取");$.ajax(this)}})}}function A(){if($("td",$("table.dataTable tr:gt(0)")).length===1){return}aP();aS();aQ();aR();function aS(){var a4=$(".dataTable :first").parent();var a7=$("<div class='foundation-style columns'></div>");a4.before(a7);var a1=$("<b>",{text:"默认使用武器：",title:"不开坦克buff的情况下该服务器大多数玩家使用的武器"}).appendTo(a7);var a2=$("<select>",{id:"DefaultWeapon",style:"padding:3px; margin:3px;"}).appendTo(a7);$("<option>",{value:1,text:"Q1"}).appendTo(a2);$("<option>",{value:5,text:"Q5"}).appendTo(a2);var a6=localStorage.getItem("CitizensOnlineDefaultWeapon");if(a6===null){localStorage.setItem("CitizensOnlineDefaultWeapon",1);a2.val(1)}else{a2.val(a6)}a2.change(function(){localStorage.setItem("CitizensOnlineDefaultWeapon",a2.val())});var a9=$("<input>",{type:"checkbox",id:"DefaultMuBonus"}).appendTo(a7);var ba=$("<label>",{"class":"checkboxlabel","for":"DefaultMuBonus",text:"军令加成",title:"默认精英军团（20%加成）"}).appendTo(a7);var a8=localStorage.getItem("CitizensOnlineDefaultMuBonus");if(a8===null){localStorage.setItem("CitizensOnlineDefaultMuBonus",true);a9.attr("checked",true)}else{a9.attr("checked",a8=="true")}a9.click(function(){if(a9.is(":checked")){localStorage.setItem("CitizensOnlineDefaultMuBonus",true)}else{localStorage.setItem("CitizensOnlineDefaultMuBonus",false)}});var aT=$("<span>",{text:"    更多伤害："}).appendTo(a7);var aZ=$("<select>",{id:"MoreDamage",style:"padding:3px; margin:3px;"}).appendTo(a7);for(var a3=0;a3<=40;a3++){$("<option>",{value:(a3*10),text:(a3*10).toString()+"%"}).appendTo(aZ)}var aY=localStorage.getItem("CitizensOnlineMoreDamage");if(aY===null){localStorage.setItem("CitizensOnlineMoreDamage",0);aZ.val(0)}else{aZ.val(aY)}aZ.change(function(){localStorage.setItem("CitizensOnlineMoreDamage",aZ.val())});var aW=$("<span>",{text:"更多暴击："}).appendTo(a7);var a5=$("<select>",{id:"MoreCritical",style:"padding:3px; margin:3px;"}).appendTo(a7);for(var a3=0;a3<=20;a3++){$("<option>",{value:(a3*10),text:(a3*10).toString()+"%"}).appendTo(a5)}var a0=localStorage.getItem("CitizensOnlineMoreCritical");if(a0===null){localStorage.setItem("CitizensOnlineMoreCritical",0);a5.val(0)}else{a5.val(a0)}a5.change(function(){localStorage.setItem("CitizensOnlineMoreCritical",a5.val())});var aV=$("<input type='button' class='foundation-style button' value='获取玩家状态'></input> ");a7.append(aV);aV.click(function(){aV.attr("disabled",true);$("table.dataTable tr:eq(0)").append($("<td exid='info'>详细信息</td>"));$("table.dataTable tr:gt(0)").append($('<td exid="info"><span id="buffs">BUFF：</span><br><span id="estBerserkAvg" title="伤害不含建筑加成，默认有本地加成，无被包围加成">连击平均伤害：加载中……</span><br><span id="score1" title="与无装备状态相比">总伤害：加载中……</span><br><span id="score2" title="与无装备状态相比，且不考虑闪避属性(avoid)">爆发力：加载中……</span></td>'));aU()});function aX(bd){bd+="";var bb=bd.split(".");var bc=/(\d{1,3})(?=(\d{3})+$)/g;return bb[0].replace(bc,"$1,")+(bb.length==2?"."+bb[1]:"")}function aU(){var bb=$("table.dataTable:last tr:gt(0)");var bc=bb.length;bb.each(function(){var be=parseInt($("td:first a",$(this)).attr("href").match(/([0-9]+)$/)[1]);var bd=$(this);H(be,false,function(){if(citizenPage[be].equipments.length===0){$("td[exid='info']",bd).html("组织号");return true}var bk=[];$.each(citizenPage[be].buffIcons,function(bK,bJ){bk.push($("<img>",{src:bJ,style:"width:20px; height:20px; vertical-align:middle;"}))});$.each(citizenPage[be].debuffIcons,function(bK,bJ){bk.push($("<img>",{src:bJ,style:"width:20px; height:20px; vertical-align:middle;"}))});if(bk.length>0){$("#buffs",bd).append(bk)}else{$("#buffs",bd).append("无")}var bo;var bm;var bg=0;var bt=0;var bz=0;var bn=0;var bE=1;var bv=$("#DefaultWeapon").val();if(bv==0){bE=0.5}else{bE=1+bv*0.2}var bs;if($("#DefaultMuBonus").is(":checked")){bs=1.2}else{bs=1}var bA=1+$("#MoreDamage").val()*0.01;var bF=1+$("#MoreCritical").val()*0.01;var bl=citizenPage[be].buffIcons;for(var bC=0;bC<citizenPage[be].debuffIcons.length;bC++){bl.push(citizenPage[be].debuffIcons[bC])}for(var bB=0;bB<bl.length;bB++){var bG=bl[bB].match(/(steroids|tank|spa|vacations|bunker|resistance|painDealer1h|painDealer10h|painDealer25h)\_(positive|negative)/ig);if(bG===null){break}switch(bG[0]){case"painDealer10h_positive":case"painDealer1h_positive":case"painDealer25h_positive":bg=1;break;case"steroids_positive":bt=1;break;case"steroids_negative":bt=-1;break;case"tank_positive":bz=1;bE=2;break;case"tank_negative":bz=-1;bE=0.5;break;case"bunker_positive":case"resistance_positive":bn=1;break;case"bunker_negative":case"resistance_negative":bn=1;break;default:break}}var bq=1;var bi=citizenPage[be].lowHit;var bx=citizenPage[be].highHit;var bj=citizenPage[be].critical/100;var bf=citizenPage[be].miss/100;var bu=citizenPage[be].avoid/100;var bh;var bw=bE;bh=bj;if(bg==1){bh=bh*2}bh=bh*bF;if(bh>0.8){bh=0.8}if(bt==1){bw=bw*1.2}else{if(bt==-1){bw=bw*0.8}}if(bz==1){bw=bw*1.2}if(bn==1){bw=bw*1.25}else{if(bn==-1){bw=bw*0.8}}bw=bw*bs;bw=bw*1.2;bw=bw*bA;var by=Math.round(bi*bw*5);var bp=Math.round(bx*bw*5);var bD=(by+bp)*(1+bh)/10;$("#estBerserkAvg",bd).html("连击平均伤害："+aX(Math.round(bD*5)));var bH=citizenPage[be].strength;var br=citizenPage[be].totalDamage;var bI=[{damageRequired:0,name:"Rookie",damageModifier:1},{damageRequired:250,name:"Private",damageModifier:1.1},{damageRequired:1000,name:"Private First Class",damageModifier:1.2},{damageRequired:3000,name:"Corporal",damageModifier:1.3},{damageRequired:5000,name:"Sergeant",damageModifier:1.4},{damageRequired:10000,name:"Staff Sergeant",damageModifier:1.5},{damageRequired:30000,name:"Sergeant First Class",damageModifier:1.6},{damageRequired:60000,name:"Master Sergeant",damageModifier:1.65},{damageRequired:100000,name:"First Sergeant",damageModifier:1.7},{damageRequired:250000,name:"Sergeant Major",damageModifier:1.75},{damageRequired:500000,name:"Command Sergeant Major",damageModifier:1.8},{damageRequired:750000,name:"Sergeant Major of the Army",damageModifier:1.85},{damageRequired:1000000,name:"Second Lieutenant",damageModifier:1.9},{damageRequired:1500000,name:"First Lieutenant",damageModifier:1.93},{damageRequired:2500000,name:"Captain",damageModifier:1.96},{damageRequired:5000000,name:"Major",damageModifier:2},{damageRequired:10000000,name:"Lieutenant Colonel",damageModifier:2.03},{damageRequired:17000000,name:"Colonel",damageModifier:2.06},{damageRequired:25000000,name:"Brigadier General",damageModifier:2.1},{damageRequired:35000000,name:"Major General",damageModifier:2.13},{damageRequired:45000000,name:"Lieutenant General",damageModifier:2.16},{damageRequired:60000000,name:"General",damageModifier:2.19},{damageRequired:80000000,name:"General of the Army",damageModifier:2.21},{damageRequired:100000000,name:"Marshall",damageModifier:2.24},{damageRequired:125000000,name:"Field Marshall",damageModifier:2.27},{damageRequired:175000000,name:"Supreme Marshall",damageModifier:2.3},{damageRequired:250000000,name:"Generalissimus",damageModifier:2.33},{damageRequired:400000000,name:"Supreme Generalissimuss",damageModifier:2.36},{damageRequired:600000000,name:"Imperial Generalissimus",damageModifier:2.4},{damageRequired:800000000,name:"Legendary Generalissimuss",damageModifier:2.42},{damageRequired:1000000000,name:"Imperator",damageModifier:2.44},{damageRequired:1500000000,name:"Imperator Caesar",damageModifier:2.46},{damageRequired:2500000000,name:"Deus Dimidiam",damageModifier:2.48},{damageRequired:5000000000,name:"Deus",damageModifier:2.5},{damageRequired:7500000000,name:"Summi Deus",damageModifier:2.52},{damageRequired:10000000000,name:"Deus Imperialis",damageModifier:2.54},{damageRequired:15000000000,name:"Deus Fabuloso",damageModifier:2.56},{damageRequired:20000000000,name:"Deus Ultimum",damageModifier:2.58}];for(var bC=0;bC<bI.length;++bC){if(bI[bC]["damageRequired"]>br){br=bI[bC-1]["damageModifier"];break}}if(bI[bI.length-1]["damageRequired"]<=br){br=bI[bI.length-1]["damageModifier"]}bm=((bi+bx)/2*(1+bh)*(1-bf))/(bH*br*1.125*0.875);bm=bm<1?1:bm;bo=bm*0.95/(1-bu);$("#score1",bd).text("总伤害：+"+((bo-1)*100).toFixed(2)+"%");$("#score2",bd).text("爆发力：+"+((bm-1)*100).toFixed(2)+"%");if(--bc===0){localStorage.setItem("citizenPage",JSON.stringify(citizenPage))}})})}}function aP(){var aU=$("#pagination-digg");if(aU.length>0){var aV=$("<button>",{text:"加载其他页的在线玩家","class":"foundation-style button",title:"如果需要加载所有在线玩家，请尽快点击该按钮，否则可能会出现重复玩家或丢失玩家"}).appendTo($(".dataTable tr:first td:first"));var aT=$("table.dataTable:last");aV.click(function(){aV.attr("disabled",true);var aW=$("li.next");var aZ=parseInt($("li.active")[0].innerHTML);var aX;if(aW.length>0){aX=parseInt(aW.prev().children().attr("href").split("page=")[1])}else{aX=aZ}var aY=aX-1;aV.text("剩余"+aY+"个");for(var a1=1;a1<=aX;a1++){if(a1==aZ){continue}var a0=document.URL;if(a0.indexOf("page")>0){a0=a0.substring(0,a0.indexOf("page"))+"page="+a1}else{if(a0.indexOf("?")>0){a0=a0+"&page="+a1}else{a0=a0+"?page="+a1}}$.ajax({url:a0,success:function(a2){if($(".time",a2).length!==2){console.log(citizenId,"抓取错误，重新抓取");$.ajax(this);return}if($("td",$(".dataTable tr:gt(0)",a2)).length===1){return false}var a3=$("tr :gt(0)",$(".dataTable",a2));a3.appendTo(aT);aV.text("剩余"+(--aY)+"个");if(aY<=0){aV.text("加载完成，共"+aX+"页")}},error:function(a2,a3){console.log("抓取错误 (",a3,")，重新抓取");$.ajax(this)}})}})}}function aQ(){sortIndex=-1;var aW,aV;var aX=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(1)"));var aY=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(2)"));var aZ=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(3)"));var aU=$("<button>",{text:"▼"}).appendTo($("table.dataTable:last tr:first td:eq(4)"));aX.click(function(){aT($("table.dataTable:last tr:gt(0)"),"number",1)});aY.click(function(){aT($("table.dataTable:last tr:gt(0)"),"formatNumber",2)});aZ.click(function(){aT($("table.dataTable:last tr:gt(0)"),"formatNumber",3)});aU.click(function(){aT($("table.dataTable:last tr:gt(0)"),"region",4)});function aT(a4,a6,a3){var a7=new Array();a4.each(function(){var a9=$(this).find("td");a7.push(a6+".separator"+$(a9[a3]).html()+".separator"+$(this).html());$(this).html("")});var a5=a7.length;if(a3==sortIndex){a7.reverse()}else{for(var a2=0;a2<a5;a2++){a6=a7[a2].split(".separator")[0];for(var a0=a2+1;a0<a5;a0++){aW=a7[a2].split(".separator")[1];aV=a7[a0].split(".separator")[1];if(a6=="number"){aW=aW==""?0:parseInt(aW);aV=aV==""?0:parseInt(aV);if(aW<aV){var a8=a7[a0];a7[a0]=a7[a2];a7[a2]=a8}}else{if(a6=="formatNumber"){aW=aW==""?0:parseInt(aW.replace(/,/g,"").replace(/\xA0/g,""));aV=aV==""?0:parseInt(aV.replace(/,/g,"").replace(/\xA0/g,""));if(aW<aV){var a8=a7[a0];a7[a0]=a7[a2];a7[a2]=a8}}else{if(a6=="region"){aW=aW==""?0:parseInt(aW.match(/id=([0-9]+)/)[1]);aV=aV==""?0:parseInt(aV.match(/id=([0-9]+)/)[1]);if(aW<aV){var a8=a7[a0];a7[a0]=a7[a2];a7[a2]=a8}}}}}}}var a1=$("table.dataTable:last").children();for(var a2=0;a2<a5;a2++){$("tr:eq("+(a2+1)+")",a1).html(a7[a2].split(".separator")[2])}sortIndex=a3}}function aR(){var aU=$("table.dataTable:last");var a0=$("<div></div>");a0.insertBefore(aU);var aT=$("<table align='right'></table>");a0.append(aT);var aX=$("<tr align='right'></tr>");aT.append(aX);var aW=$("<input type='button' id='btnFilter' value='筛选玩家'></input> ");aX.append(aW);var aZ=$("<input type='button' id='btnCloseFilter' value='关闭筛选'></input> ");aZ.hide();aX.append(aZ);var aV=$("<input type='button' id='btnDeleteCheckedCitizen' value='隐藏选中玩家'></input> ");aV.attr("disabled",true);aX.append(aV);var aY=$("<input type='button' id='btnDeleteUncheckedCitizen' value='保留选中玩家'></input> ");aY.attr("disabled",true);aX.append(aY);aW.click(function(){aW.hide();aZ.show();var a1=$("<td exid='filter'><input type='checkbox'></input></td>");$("tr:eq(0)",aU).append($("<td exid='filter'><input id='filterSelectAll' type='checkbox'></input>全选</td>"));$("tr:gt(0)",aU).append(a1);aV.attr("disabled",false);aY.attr("disabled",false);$("#filterSelectAll").click(function(){$("tr:gt(0)",aU).each(function(a2,a3){$("input:checkbox",a3).attr("checked",$("#filterSelectAll").is(":checked"))})})});aZ.click(function(){aW.show();aZ.hide();$("td[exid='filter']",aU).remove();aV.attr("disabled",true);aY.attr("disabled",true)});aV.click(function(){$("tr:gt(0)",aU).each(function(a1,a3){var a2=$("input:checkbox",a3);if(a2.is(":checked")===true){a3.remove()}})});aY.click(function(){$("tr:gt(0)",aU).each(function(a1,a3){var a2=$("input:checkbox",a3);if(a2.is(":checked")===false){a3.remove()}})})}}!function(bF){function bE(bH){bF.jqplot.ElemContainer.call(this),this.name=bH,this._series=[],this.show=!1,this.tickRenderer=bF.jqplot.AxisTickRenderer,this.tickOptions={},this.labelRenderer=bF.jqplot.AxisLabelRenderer,this.labelOptions={},this.label=null,this.showLabel=!0,this.min=null,this.max=null,this.autoscale=!1,this.pad=1.2,this.padMax=null,this.padMin=null,this.ticks=[],this.numberTicks,this.tickInterval,this.renderer=bF.jqplot.LinearAxisRenderer,this.rendererOptions={},this.showTicks=!0,this.showTickMarks=!0,this.showMinorTicks=!0,this.drawMajorGridlines=!0,this.drawMinorGridlines=!1,this.drawMajorTickMarks=!0,this.drawMinorTickMarks=!0,this.useSeriesColor=!1,this.borderWidth=null,this.borderColor=null,this.scaleToHiddenSeries=!1,this._dataBounds={min:null,max:null},this._intervalStats=[],this._offsets={min:null,max:null},this._ticks=[],this._label=null,this.syncTicks=null,this.tickSpacing=75,this._min=null,this._max=null,this._tickInterval=null,this._numberTicks=null,this.__ticks=null,this._options={}}function bD(bH){bF.jqplot.ElemContainer.call(this),this.show=!1,this.location="ne",this.labels=[],this.showLabels=!0,this.showSwatches=!0,this.placement="insideGrid",this.xoffset=0,this.yoffset=0,this.border,this.background,this.textColor,this.fontFamily,this.fontSize,this.rowSpacing="0.5em",this.renderer=bF.jqplot.TableLegendRenderer,this.rendererOptions={},this.preDraw=!1,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null,this.escapeHtml=!1,this._series=[],bF.extend(!0,this,bH)}function bC(bH){bF.jqplot.ElemContainer.call(this),this.text=bH,this.show=!0,this.fontFamily,this.fontSize,this.textAlign,this.textColor,this.renderer=bF.jqplot.DivTitleRenderer,this.rendererOptions={},this.escapeHtml=!1}function bB(bH){bH=bH||{},bF.jqplot.ElemContainer.call(this),this.show=!0,this.xaxis="xaxis",this._xaxis,this.yaxis="yaxis",this._yaxis,this.gridBorderWidth=2,this.renderer=bF.jqplot.LineRenderer,this.rendererOptions={},this.data=[],this.gridData=[],this.label="",this.showLabel=!0,this.color,this.negativeColor,this.lineWidth=2.5,this.lineJoin="round",this.lineCap="round",this.linePattern="solid",this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1.25,this.shadowDepth=3,this.shadowAlpha="0.1",this.breakOnNull=!1,this.markerRenderer=bF.jqplot.MarkerRenderer,this.markerOptions={},this.showLine=!0,this.showMarker=!0,this.index,this.fill=!1,this.fillColor,this.fillAlpha,this.fillAndStroke=!1,this.disableStack=!1,this._stack=!1,this.neighborThreshold=4,this.fillToZero=!1,this.fillToValue=0,this.fillAxis="y",this.useNegativeColors=!0,this._stackData=[],this._plotData=[],this._plotValues={x:[],y:[]},this._intervals={x:{},y:{}},this._prevPlotData=[],this._prevGridData=[],this._stackAxis="y",this._primaryAxis="_xaxis",this.canvas=new bF.jqplot.GenericCanvas,this.shadowCanvas=new bF.jqplot.GenericCanvas,this.plugins={},this._sumy=0,this._sumx=0,this._type="",this.step=!1}function bA(){bF.jqplot.ElemContainer.call(this),this.drawGridlines=!0,this.gridLineColor="#cccccc",this.gridLineWidth=1,this.background="#fffdf6",this.borderColor="#999999",this.borderWidth=2,this.drawBorder=!0,this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1.5,this.shadowWidth=3,this.shadowDepth=3,this.shadowColor=null,this.shadowAlpha="0.07",this._left,this._top,this._right,this._bottom,this._width,this._height,this._axes=[],this.renderer=bF.jqplot.CanvasGridRenderer,this.rendererOptions={},this._offsets={top:null,bottom:null,left:null,right:null}}function bz(){function bJ(bL){for(var bK,bQ=0;bQ<bL.length;bQ++){for(var bP,bO=[bL[bQ].data,bL[bQ]._stackData,bL[bQ]._plotData,bL[bQ]._prevPlotData],bN=0;4>bN;bN++){if(bP=!0,bK=bO[bN],"x"==bL[bQ]._stackAxis){for(var bM=0;bM<bK.length;bM++){if("number"!=typeof bK[bM][1]){bP=!1;break}}bP&&bK.sort(function(bS,bR){return bS[1]-bR[1]})}else{for(var bM=0;bM<bK.length;bM++){if("number"!=typeof bK[bM][0]){bP=!1;break}}bP&&bK.sort(function(bS,bR){return bS[0]-bR[0]})}}}}function bI(bS){var bR,bQ,bP=bS.data.plot,bO=bP.eventCanvas._elem.offset(),bN={x:bS.pageX-bO.left,y:bS.pageY-bO.top},bM={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null,yMidAxis:null},bL=["xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"],bK=bP.axes;for(bR=11;bR>0;bR--){bQ=bL[bR-1],bK[bQ].show&&(bM[bQ]=bK[bQ].series_p2u(bN[bQ.charAt(0)]))}return{offsets:bO,gridPos:bN,dataPos:bM}}function bH(cj,ci){function ch(cl,ck,cp){var co=(ck[1]-cp[1])/(ck[0]-cp[0]),cn=ck[1]-co*ck[0],cm=cl+ck[1];return[(cm-cn)/co,cm]}var cg,cf,ce,cd,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2,b1,b0,bZ,bY,bX=ci.series;for(ce=ci.seriesStack.length-1;ce>=0;ce--){switch(cg=ci.seriesStack[ce],cd=bX[cg],b0=cd._highlightThreshold,cd.renderer.constructor){case bF.jqplot.BarRenderer:for(cb=cj.x,ca=cj.y,cf=0;cf<cd._barPoints.length;cf++){if(b1=cd._barPoints[cf],b2=cd.gridData[cf],cb>b1[0][0]&&cb<b1[2][0]&&(ca>b1[2][1]&&ca<b1[0][1]||ca<b1[2][1]&&ca>b1[0][1])){return{seriesIndex:cd.index,pointIndex:cf,gridData:b2,data:cd.data[cf],points:cd._barPoints[cf]}}}break;case bF.jqplot.PyramidRenderer:for(cb=cj.x,ca=cj.y,cf=0;cf<cd._barPoints.length;cf++){if(b1=cd._barPoints[cf],b2=cd.gridData[cf],cb>b1[0][0]+b0[0][0]&&cb<b1[2][0]+b0[2][0]&&ca>b1[2][1]&&ca<b1[0][1]){return{seriesIndex:cd.index,pointIndex:cf,gridData:b2,data:cd.data[cf],points:cd._barPoints[cf]}}}break;case bF.jqplot.DonutRenderer:if(b7=cd.startAngle/180*Math.PI,cb=cj.x-cd._center[0],ca=cj.y-cd._center[1],cc=Math.sqrt(Math.pow(cb,2)+Math.pow(ca,2)),cb>0&&-ca>=0?b9=2*Math.PI-Math.atan(-ca/cb):cb>0&&0>-ca?b9=-Math.atan(-ca/cb):0>cb?b9=Math.PI-Math.atan(-ca/cb):0==cb&&-ca>0?b9=3*Math.PI/2:0==cb&&0>-ca?b9=Math.PI/2:0==cb&&0==ca&&(b9=0),b7&&(b9-=b7,0>b9?b9+=2*Math.PI:b9>2*Math.PI&&(b9-=2*Math.PI)),b8=cd.sliceMargin/180*Math.PI,cc<cd._radius&&cc>cd._innerRadius){for(cf=0;cf<cd.gridData.length;cf++){if(b6=cf>0?cd.gridData[cf-1][1]+b8:b8,b5=cd.gridData[cf][1],b9>b6&&b5>b9){return{seriesIndex:cd.index,pointIndex:cf,gridData:[cj.x,cj.y],data:cd.data[cf]}}}}break;case bF.jqplot.PieRenderer:if(b7=cd.startAngle/180*Math.PI,cb=cj.x-cd._center[0],ca=cj.y-cd._center[1],cc=Math.sqrt(Math.pow(cb,2)+Math.pow(ca,2)),cb>0&&-ca>=0?b9=2*Math.PI-Math.atan(-ca/cb):cb>0&&0>-ca?b9=-Math.atan(-ca/cb):0>cb?b9=Math.PI-Math.atan(-ca/cb):0==cb&&-ca>0?b9=3*Math.PI/2:0==cb&&0>-ca?b9=Math.PI/2:0==cb&&0==ca&&(b9=0),b7&&(b9-=b7,0>b9?b9+=2*Math.PI:b9>2*Math.PI&&(b9-=2*Math.PI)),b8=cd.sliceMargin/180*Math.PI,cc<cd._radius){for(cf=0;cf<cd.gridData.length;cf++){if(b6=cf>0?cd.gridData[cf-1][1]+b8:b8,b5=cd.gridData[cf][1],b9>b6&&b5>b9){return{seriesIndex:cd.index,pointIndex:cf,gridData:[cj.x,cj.y],data:cd.data[cf]}}}}break;case bF.jqplot.BubbleRenderer:cb=cj.x,ca=cj.y;var bW=null;if(cd.show){for(var cf=0;cf<cd.gridData.length;cf++){b2=cd.gridData[cf],b3=Math.sqrt((cb-b2[0])*(cb-b2[0])+(ca-b2[1])*(ca-b2[1])),b3<=b2[2]&&(b4>=b3||null==b4)&&(b4=b3,bW={seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]})}if(null!=bW){return bW}}break;case bF.jqplot.FunnelRenderer:cb=cj.x,ca=cj.y;var bV,bU,bT,bS=cd._vertices,bR=bS[0],bQ=bS[bS.length-1];for(bV=ch(ca,bR[0],bQ[3]),bU=ch(ca,bR[1],bQ[2]),cf=0;cf<bS.length;cf++){if(bT=bS[cf],ca>=bT[0][1]&&ca<=bT[3][1]&&cb>=bV[0]&&cb<=bU[0]){return{seriesIndex:cd.index,pointIndex:cf,gridData:null,data:cd.data[cf]}}}break;case bF.jqplot.LineRenderer:if(cb=cj.x,ca=cj.y,cc=cd.renderer,cd.show){if(!(!(cd.fill||cd.renderer.bands.show&&cd.renderer.bands.fill)||ci.plugins.highlighter&&ci.plugins.highlighter.show)){var bP=!1;if(cb>cd._boundingBox[0][0]&&cb<cd._boundingBox[1][0]&&ca>cd._boundingBox[1][1]&&ca<cd._boundingBox[0][1]){for(var bO,bN=cd._areaPoints.length,cf=bN-1,bO=0;bN>bO;bO++){var bM=[cd._areaPoints[bO][0],cd._areaPoints[bO][1]],bL=[cd._areaPoints[cf][0],cd._areaPoints[cf][1]];(bM[1]<ca&&bL[1]>=ca||bL[1]<ca&&bM[1]>=ca)&&bM[0]+(ca-bM[1])/(bL[1]-bM[1])*(bL[0]-bM[0])<cb&&(bP=!bP),cf=bO}}if(bP){return{seriesIndex:cg,pointIndex:null,gridData:cd.gridData,data:cd.data,points:cd._areaPoints}}break}bY=cd.markerRenderer.size/2+cd.neighborThreshold,bZ=bY>0?bY:0;for(var cf=0;cf<cd.gridData.length;cf++){if(b2=cd.gridData[cf],cc.constructor==bF.jqplot.OHLCRenderer){if(cc.candleStick){var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._bodyWidth/2&&cb<=b2[0]+cc._bodyWidth/2&&ca>=bK(cd.data[cf][2])&&ca<=bK(cd.data[cf][3])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}else{if(cc.hlc){var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._tickLength&&cb<=b2[0]+cc._tickLength&&ca>=bK(cd.data[cf][1])&&ca<=bK(cd.data[cf][2])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}else{var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._tickLength&&cb<=b2[0]+cc._tickLength&&ca>=bK(cd.data[cf][2])&&ca<=bK(cd.data[cf][3])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}}}else{if(null!=b2[0]&&null!=b2[1]&&(b3=Math.sqrt((cb-b2[0])*(cb-b2[0])+(ca-b2[1])*(ca-b2[1])),bZ>=b3&&(b4>=b3||null==b4))){return b4=b3,{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}}}break;default:if(cb=cj.x,ca=cj.y,cc=cd.renderer,cd.show){bY=cd.markerRenderer.size/2+cd.neighborThreshold,bZ=bY>0?bY:0;for(var cf=0;cf<cd.gridData.length;cf++){if(b2=cd.gridData[cf],cc.constructor==bF.jqplot.OHLCRenderer){if(cc.candleStick){var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._bodyWidth/2&&cb<=b2[0]+cc._bodyWidth/2&&ca>=bK(cd.data[cf][2])&&ca<=bK(cd.data[cf][3])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}else{if(cc.hlc){var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._tickLength&&cb<=b2[0]+cc._tickLength&&ca>=bK(cd.data[cf][1])&&ca<=bK(cd.data[cf][2])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}else{var bK=cd._yaxis.series_u2p;if(cb>=b2[0]-cc._tickLength&&cb<=b2[0]+cc._tickLength&&ca>=bK(cd.data[cf][2])&&ca<=bK(cd.data[cf][3])){return{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}}}else{if(b3=Math.sqrt((cb-b2[0])*(cb-b2[0])+(ca-b2[1])*(ca-b2[1])),bZ>=b3&&(b4>=b3||null==b4)){return b4=b3,{seriesIndex:cg,pointIndex:cf,gridData:b2,data:cd.data[cf]}}}}}}}return null}this.animate=!1,this.animateReplot=!1,this.axes={xaxis:new bE("xaxis"),yaxis:new bE("yaxis"),x2axis:new bE("x2axis"),y2axis:new bE("y2axis"),y3axis:new bE("y3axis"),y4axis:new bE("y4axis"),y5axis:new bE("y5axis"),y6axis:new bE("y6axis"),y7axis:new bE("y7axis"),y8axis:new bE("y8axis"),y9axis:new bE("y9axis"),yMidAxis:new bE("yMidAxis")},this.baseCanvas=new bF.jqplot.GenericCanvas,this.captureRightClick=!1,this.data=[],this.dataRenderer,this.dataRendererOptions,this.defaults={axesDefaults:{},axes:{xaxis:{},yaxis:{},x2axis:{},y2axis:{},y3axis:{},y4axis:{},y5axis:{},y6axis:{},y7axis:{},y8axis:{},y9axis:{},yMidAxis:{}},seriesDefaults:{},series:[]},this.defaultAxisStart=1,this.drawIfHidden=!1,this.eventCanvas=new bF.jqplot.GenericCanvas,this.fillBetween={series1:null,series2:null,color:null,baseSeries:0,fill:!0},this.fontFamily,this.fontSize,this.grid=new bA,this.legend=new bD,this.noDataIndicator={show:!1,indicator:"Loading Data...",axes:{xaxis:{min:0,max:10,tickInterval:2,show:!0},yaxis:{min:0,max:12,tickInterval:3,show:!0}}},this.negativeSeriesColors=bF.jqplot.config.defaultNegativeColors,this.options={},this.previousSeriesStack=[],this.plugins={},this.series=[],this.seriesStack=[],this.seriesColors=bF.jqplot.config.defaultColors,this.sortData=!0,this.stackSeries=!1,this.syncXTicks=!0,this.syncYTicks=!0,this.target=null,this.targetId=null,this.textColor,this.title=new bC,this._drawCount=0,this._sumy=0,this._sumx=0,this._stackData=[],this._plotData=[],this._width=null,this._height=null,this._plotDimensions={height:null,width:null},this._gridPadding={top:null,right:null,bottom:null,left:null},this._defaultGridPadding={top:10,right:10,bottom:23,left:10},this._addDomReference=bF.jqplot.config.addDomReference,this.preInitHooks=new bF.jqplot.HooksManager,this.postInitHooks=new bF.jqplot.HooksManager,this.preParseOptionsHooks=new bF.jqplot.HooksManager,this.postParseOptionsHooks=new bF.jqplot.HooksManager,this.preDrawHooks=new bF.jqplot.HooksManager,this.postDrawHooks=new bF.jqplot.HooksManager,this.preDrawSeriesHooks=new bF.jqplot.HooksManager,this.postDrawSeriesHooks=new bF.jqplot.HooksManager,this.preDrawLegendHooks=new bF.jqplot.HooksManager,this.addLegendRowHooks=new bF.jqplot.HooksManager,this.preSeriesInitHooks=new bF.jqplot.HooksManager,this.postSeriesInitHooks=new bF.jqplot.HooksManager,this.preParseSeriesOptionsHooks=new bF.jqplot.HooksManager,this.postParseSeriesOptionsHooks=new bF.jqplot.HooksManager,this.eventListenerHooks=new bF.jqplot.EventListenerManager,this.preDrawSeriesShadowHooks=new bF.jqplot.HooksManager,this.postDrawSeriesShadowHooks=new bF.jqplot.HooksManager,this.colorGenerator=new bF.jqplot.ColorGenerator,this.negativeColorGenerator=new bF.jqplot.ColorGenerator,this.canvasManager=new bF.jqplot.CanvasManager,this.themeEngine=new bF.jqplot.ThemeEngine;this.init=function(bV,bU,bT){bT=bT||{};for(var bS=0;bS<bF.jqplot.preInitHooks.length;bS++){bF.jqplot.preInitHooks[bS].call(this,bV,bU,bT)}for(var bS=0;bS<this.preInitHooks.hooks.length;bS++){this.preInitHooks.hooks[bS].call(this,bV,bU,bT)}if(this.targetId="#"+bV,this.target=bF("#"+bV),this._addDomReference&&this.target.data("jqplot",this),this.target.removeClass("jqplot-error"),!this.target.get(0)){throw new Error("No plot target specified")}if("static"==this.target.css("position")&&this.target.css("position","relative"),this.target.hasClass("jqplot-target")||this.target.addClass("jqplot-target"),this.target.height()){this._height=bR=this.target.height()}else{var bR;bR=bT&&bT.height?parseInt(bT.height,10):this.target.attr("data-height")?parseInt(this.target.attr("data-height"),10):parseInt(bF.jqplot.config.defaultHeight,10),this._height=bR,this.target.css("height",bR+"px")}if(this.target.width()){this._width=bQ=this.target.width()}else{var bQ;bQ=bT&&bT.width?parseInt(bT.width,10):this.target.attr("data-width")?parseInt(this.target.attr("data-width"),10):parseInt(bF.jqplot.config.defaultWidth,10),this._width=bQ,this.target.css("width",bQ+"px")}for(var bS=0,bP=a8.length;bP>bS;bS++){this.axes[a8[bS]]=new bE(a8[bS])}if(this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions,this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Canvas dimension not set")}if(bT.dataRenderer&&bF.isFunction(bT.dataRenderer)&&(bT.dataRendererOptions&&(this.dataRendererOptions=bT.dataRendererOptions),this.dataRenderer=bT.dataRenderer,bU=this.dataRenderer(bU,this,this.dataRendererOptions)),bT.noDataIndicator&&bF.isPlainObject(bT.noDataIndicator)&&bF.extend(!0,this.noDataIndicator,bT.noDataIndicator),null==bU||0==bF.isArray(bU)||0==bU.length||0==bF.isArray(bU[0])||0==bU[0].length){if(0==this.noDataIndicator.show){throw new Error("No data specified")}for(var bO in this.noDataIndicator.axes){for(var bN in this.noDataIndicator.axes[bO]){this.axes[bO][bN]=this.noDataIndicator.axes[bO][bN]}}this.postDrawHooks.add(function(){var bW=this.eventCanvas.getHeight(),b1=this.eventCanvas.getWidth(),b0=bF('<div class="jqplot-noData-container" style="position:absolute;"></div>');this.target.append(b0),b0.height(bW),b0.width(b1),b0.css("top",this.eventCanvas._offsets.top),b0.css("left",this.eventCanvas._offsets.left);var bZ=bF('<div class="jqplot-noData-contents" style="text-align:center; position:relative; margin-left:auto; margin-right:auto;"></div>');b0.append(bZ),bZ.html(this.noDataIndicator.indicator);var bY=bZ.height(),bX=bZ.width();bZ.height(bY),bZ.width(bX),bZ.css("top",(bW-bY)/2+"px")})}this.data=bF.extend(!0,[],bU),this.parseOptions(bT),this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this.title.init(),this.legend.init(),this._sumy=0,this._sumx=0,this.computePlotData();for(var bS=0;bS<this.series.length;bS++){this.seriesStack.push(bS),this.previousSeriesStack.push(bS),this.series[bS].shadowCanvas._plotDimensions=this._plotDimensions,this.series[bS].canvas._plotDimensions=this._plotDimensions;for(var bM=0;bM<bF.jqplot.preSeriesInitHooks.length;bM++){bF.jqplot.preSeriesInitHooks[bM].call(this.series[bS],bV,this.data,this.options.seriesDefaults,this.options.series[bS],this)}for(var bM=0;bM<this.preSeriesInitHooks.hooks.length;bM++){this.preSeriesInitHooks.hooks[bM].call(this.series[bS],bV,this.data,this.options.seriesDefaults,this.options.series[bS],this)}this.series[bS]._plotDimensions=this._plotDimensions,this.series[bS].init(bS,this.grid.borderWidth,this);for(var bM=0;bM<bF.jqplot.postSeriesInitHooks.length;bM++){bF.jqplot.postSeriesInitHooks[bM].call(this.series[bS],bV,this.data,this.options.seriesDefaults,this.options.series[bS],this)}for(var bM=0;bM<this.postSeriesInitHooks.hooks.length;bM++){this.postSeriesInitHooks.hooks[bM].call(this.series[bS],bV,this.data,this.options.seriesDefaults,this.options.series[bS],this)}this._sumy+=this.series[bS]._sumy,this._sumx+=this.series[bS]._sumx}for(var bL,bK,bS=0,bP=a8.length;bP>bS;bS++){bL=a8[bS],bK=this.axes[bL],bK._plotDimensions=this._plotDimensions,bK.init(),null==this.axes[bL].borderColor&&("x"!==bL.charAt(0)&&bK.useSeriesColor===!0&&bK.show?bK.borderColor=bK._series[0].color:bK.borderColor=this.grid.borderColor)}this.sortData&&bJ(this.series),this.grid.init(),this.grid._axes=this.axes,this.legend._series=this.series;for(var bS=0;bS<bF.jqplot.postInitHooks.length;bS++){bF.jqplot.postInitHooks[bS].call(this,bV,this.data,bT)}for(var bS=0;bS<this.postInitHooks.hooks.length;bS++){this.postInitHooks.hooks[bS].call(this,bV,this.data,bT)}},this.resetAxesScale=function(bK,bP){var bO=bP||{},bN=bK||this.axes;if(bN===!0&&(bN=this.axes),bF.isArray(bN)){for(var bM=0;bM<bN.length;bM++){this.axes[bN[bM]].resetScale(bO[bN[bM]])}}else{if("object"==typeof bN){for(var bL in bN){this.axes[bL].resetScale(bO[bL])}}}},this.reInitialize=function(bW,bV){for(var bU=bF.extend(!0,{},this.options,bV),bT=this.targetId.substr(1),bS=null==bW?this.data:bW,bR=0;bR<bF.jqplot.preInitHooks.length;bR++){bF.jqplot.preInitHooks[bR].call(this,bT,bS,bU)}for(var bR=0;bR<this.preInitHooks.hooks.length;bR++){this.preInitHooks.hooks[bR].call(this,bT,bS,bU)}if(this._height=this.target.height(),this._width=this.target.width(),this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")}this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions;for(var bQ,bP,bO,bN,bR=0,bM=a8.length;bM>bR;bR++){bQ=a8[bR],bN=this.axes[bQ],bP=bN._ticks;for(var bO=0,bL=bP.length;bL>bO;bO++){var bK=bP[bO]._elem;bK&&(bF.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a9&&window.G_vmlCanvasManager.uninitElement(bK.get(0)),bK.emptyForce(),bK=null,bP._elem=null)}bP=null,delete bN.ticks,delete bN._ticks,this.axes[bQ]=new bE(bQ),this.axes[bQ]._plotWidth=this._width,this.axes[bQ]._plotHeight=this._height}bW&&(bU.dataRenderer&&bF.isFunction(bU.dataRenderer)&&(bU.dataRendererOptions&&(this.dataRendererOptions=bU.dataRendererOptions),this.dataRenderer=bU.dataRenderer,bW=this.dataRenderer(bW,this,this.dataRendererOptions)),this.data=bF.extend(!0,[],bW)),bV&&this.parseOptions(bU),this.title._plotWidth=this._width,this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this.title.init(),this.legend.init(),this._sumy=0,this._sumx=0,this.seriesStack=[],this.previousSeriesStack=[],this.computePlotData();for(var bR=0,bM=this.series.length;bM>bR;bR++){this.seriesStack.push(bR),this.previousSeriesStack.push(bR),this.series[bR].shadowCanvas._plotDimensions=this._plotDimensions,this.series[bR].canvas._plotDimensions=this._plotDimensions;for(var bO=0;bO<bF.jqplot.preSeriesInitHooks.length;bO++){bF.jqplot.preSeriesInitHooks[bO].call(this.series[bR],bT,this.data,this.options.seriesDefaults,this.options.series[bR],this)}for(var bO=0;bO<this.preSeriesInitHooks.hooks.length;bO++){this.preSeriesInitHooks.hooks[bO].call(this.series[bR],bT,this.data,this.options.seriesDefaults,this.options.series[bR],this)}this.series[bR]._plotDimensions=this._plotDimensions,this.series[bR].init(bR,this.grid.borderWidth,this);for(var bO=0;bO<bF.jqplot.postSeriesInitHooks.length;bO++){bF.jqplot.postSeriesInitHooks[bO].call(this.series[bR],bT,this.data,this.options.seriesDefaults,this.options.series[bR],this)}for(var bO=0;bO<this.postSeriesInitHooks.hooks.length;bO++){this.postSeriesInitHooks.hooks[bO].call(this.series[bR],bT,this.data,this.options.seriesDefaults,this.options.series[bR],this)}this._sumy+=this.series[bR]._sumy,this._sumx+=this.series[bR]._sumx}for(var bR=0,bM=a8.length;bM>bR;bR++){bQ=a8[bR],bN=this.axes[bQ],bN._plotDimensions=this._plotDimensions,bN.init(),null==bN.borderColor&&("x"!==bQ.charAt(0)&&bN.useSeriesColor===!0&&bN.show?bN.borderColor=bN._series[0].color:bN.borderColor=this.grid.borderColor)}this.sortData&&bJ(this.series),this.grid.init(),this.grid._axes=this.axes,this.legend._series=this.series;for(var bR=0,bM=bF.jqplot.postInitHooks.length;bM>bR;bR++){bF.jqplot.postInitHooks[bR].call(this,bT,this.data,bU)}for(var bR=0,bM=this.postInitHooks.hooks.length;bM>bR;bR++){this.postInitHooks.hooks[bR].call(this,bT,this.data,bU)}},this.quickInit=function(){if(this._height=this.target.height(),this._width=this.target.width(),this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")}this._plotDimensions.height=this._height,this._plotDimensions.width=this._width,this.grid._plotDimensions=this._plotDimensions,this.title._plotDimensions=this._plotDimensions,this.baseCanvas._plotDimensions=this._plotDimensions,this.eventCanvas._plotDimensions=this._plotDimensions,this.legend._plotDimensions=this._plotDimensions;for(var bK in this.axes){this.axes[bK]._plotWidth=this._width,this.axes[bK]._plotHeight=this._height}this.title._plotWidth=this._width,this.textColor&&this.target.css("color",this.textColor),this.fontFamily&&this.target.css("font-family",this.fontFamily),this.fontSize&&this.target.css("font-size",this.fontSize),this._sumy=0,this._sumx=0,this.computePlotData();for(var bP=0;bP<this.series.length;bP++){"line"===this.series[bP]._type&&this.series[bP].renderer.bands.show&&this.series[bP].renderer.initBands.call(this.series[bP],this.series[bP].renderer.options,this),this.series[bP]._plotDimensions=this._plotDimensions,this.series[bP].canvas._plotDimensions=this._plotDimensions,this._sumy+=this.series[bP]._sumy,this._sumx+=this.series[bP]._sumx}for(var bO,bN=0;12>bN;bN++){bO=a8[bN];for(var bM=this.axes[bO]._ticks,bP=0;bP<bM.length;bP++){var bL=bM[bP]._elem;bL&&(bF.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a9&&window.G_vmlCanvasManager.uninitElement(bL.get(0)),bL.emptyForce(),bL=null,bM._elem=null)}bM=null,this.axes[bO]._plotDimensions=this._plotDimensions,this.axes[bO]._ticks=[]}this.sortData&&bJ(this.series),this.grid._axes=this.axes,this.legend._series=this.series},this.computePlotData=function(){this._plotData=[],this._stackData=[];var bV,bU,bT;for(bU=0,bT=this.series.length;bT>bU;bU++){bV=this.series[bU],this._plotData.push([]),this._stackData.push([]);var bS=bV.data;this._plotData[bU]=bF.extend(!0,[],bS),this._stackData[bU]=bF.extend(!0,[],bS),bV._plotData=this._plotData[bU],bV._stackData=this._stackData[bU];var bR={x:[],y:[]};if(this.stackSeries&&!bV.disableStack){bV._stack=!0;for(var bQ="x"===bV._stackAxis?0:1,bP=0,bO=bS.length;bO>bP;bP++){var bN=bS[bP][bQ];if(null==bN&&(bN=0),this._plotData[bU][bP][bQ]=bN,this._stackData[bU][bP][bQ]=bN,bU>0){for(var bM=bU;bM--;){var bL=this._plotData[bM][bP][bQ];if(bN*bL>=0){this._plotData[bU][bP][bQ]+=bL,this._stackData[bU][bP][bQ]+=bL;break}}}}}else{for(var bK=0;bK<bV.data.length;bK++){bR.x.push(bV.data[bK][0]),bR.y.push(bV.data[bK][1])}this._stackData.push(bV.data),this.series[bU]._stackData=bV.data,this._plotData.push(bV.data),bV._plotData=bV.data,bV._plotValues=bR}for(bU>0&&(bV._prevPlotData=this.series[bU-1]._plotData),bV._sumy=0,bV._sumx=0,bK=bV.data.length-1;bK>-1;bK--){bV._sumy+=bV.data[bK][1],bV._sumx+=bV.data[bK][0]}}},this.populatePlotData=function(bX,bW){this._plotData=[],this._stackData=[],bX._stackData=[],bX._plotData=[];var bV={x:[],y:[]};if(this.stackSeries&&!bX.disableStack){bX._stack=!0;for(var bU,bT,bS,bR,bQ="x"===bX._stackAxis?0:1,bP=bF.extend(!0,[],bX.data),bO=bF.extend(!0,[],bX.data),bN=0;bW>bN;bN++){for(var bM=this.series[bN].data,bL=0;bL<bM.length;bL++){bS=bM[bL],bU=null!=bS[0]?bS[0]:0,bT=null!=bS[1]?bS[1]:0,bP[bL][0]+=bU,bP[bL][1]+=bT,bR=bQ?bT:bU,bX.data[bL][bQ]*bR>=0&&(bO[bL][bQ]+=bR)}}for(var bK=0;bK<bO.length;bK++){bV.x.push(bO[bK][0]),bV.y.push(bO[bK][1])}this._plotData.push(bO),this._stackData.push(bP),bX._stackData=bP,bX._plotData=bO,bX._plotValues=bV}else{for(var bK=0;bK<bX.data.length;bK++){bV.x.push(bX.data[bK][0]),bV.y.push(bX.data[bK][1])}this._stackData.push(bX.data),this.series[bW]._stackData=bX.data,this._plotData.push(bX.data),bX._plotData=bX.data,bX._plotValues=bV}for(bW>0&&(bX._prevPlotData=this.series[bW-1]._plotData),bX._sumy=0,bX._sumx=0,bK=bX.data.length-1;bK>-1;bK--){bX._sumy+=bX.data[bK][1],bX._sumx+=bX.data[bK][0]}},this.getNextSeriesColor=function(bL){var bK=0,bM=bL.seriesColors;return function(){return bK<bM.length?bM[bK++]:(bK=0,bM[bK++])}}(this),this.parseOptions=function(bV){for(var bU=0;bU<this.preParseOptionsHooks.hooks.length;bU++){this.preParseOptionsHooks.hooks[bU].call(this,bV)}for(var bU=0;bU<bF.jqplot.preParseOptionsHooks.length;bU++){bF.jqplot.preParseOptionsHooks[bU].call(this,bV)}this.options=bF.extend(!0,{},this.defaults,bV);var bT=this.options;if(this.animate=bT.animate,this.animateReplot=bT.animateReplot,this.stackSeries=bT.stackSeries,bF.isPlainObject(bT.fillBetween)){for(var bS,bR=["series1","series2","color","baseSeries","fill"],bU=0,bQ=bR.length;bQ>bU;bU++){bS=bR[bU],null!=bT.fillBetween[bS]&&(this.fillBetween[bS]=bT.fillBetween[bS])}}bT.seriesColors&&(this.seriesColors=bT.seriesColors),bT.negativeSeriesColors&&(this.negativeSeriesColors=bT.negativeSeriesColors),bT.captureRightClick&&(this.captureRightClick=bT.captureRightClick),this.defaultAxisStart=bV&&null!=bV.defaultAxisStart?bV.defaultAxisStart:this.defaultAxisStart,this.colorGenerator.setColors(this.seriesColors),this.negativeColorGenerator.setColors(this.negativeSeriesColors),bF.extend(!0,this._gridPadding,bT.gridPadding),this.sortData=null!=bT.sortData?bT.sortData:this.sortData;for(var bU=0;12>bU;bU++){var bP=a8[bU],bO=this.axes[bP];bO._options=bF.extend(!0,{},bT.axesDefaults,bT.axes[bP]),bF.extend(!0,bO,bT.axesDefaults,bT.axes[bP]),bO._plotWidth=this._width,bO._plotHeight=this._height}var bN=function(bW,b1,b0){var bZ,bY,bX=[];if(b1=b1||"vertical",bF.isArray(bW[0])){bF.extend(!0,bX,bW)}else{for(bZ=0,bY=bW.length;bY>bZ;bZ++){"vertical"==b1?bX.push([b0+bZ,bW[bZ]]):bX.push([bW[bZ],b0+bZ])}}return bX};this.series=[];for(var bU=0;bU<this.data.length;bU++){for(var bM=bF.extend(!0,{index:bU},{seriesColors:this.seriesColors,negativeSeriesColors:this.negativeSeriesColors},this.options.seriesDefaults,this.options.series[bU],{rendererOptions:{animation:{show:this.animate}}}),bR=new bB(bM),bL=0;bL<bF.jqplot.preParseSeriesOptionsHooks.length;bL++){bF.jqplot.preParseSeriesOptionsHooks[bL].call(bR,this.options.seriesDefaults,this.options.series[bU])}for(var bL=0;bL<this.preParseSeriesOptionsHooks.hooks.length;bL++){this.preParseSeriesOptionsHooks.hooks[bL].call(bR,this.options.seriesDefaults,this.options.series[bU])}bF.extend(!0,bR,bM);var bK="vertical";switch(bR.renderer===bF.jqplot.BarRenderer&&bR.rendererOptions&&"horizontal"==bR.rendererOptions.barDirection&&(bK="horizontal",bR._stackAxis="x",bR._primaryAxis="_yaxis"),bR.data=bN(this.data[bU],bK,this.defaultAxisStart),bR.xaxis){case"xaxis":bR._xaxis=this.axes.xaxis;break;case"x2axis":bR._xaxis=this.axes.x2axis}bR._yaxis=this.axes[bR.yaxis],bR._xaxis._series.push(bR),bR._yaxis._series.push(bR),bR.show?(bR._xaxis.show=!0,bR._yaxis.show=!0):(bR._xaxis.scaleToHiddenSeries&&(bR._xaxis.show=!0),bR._yaxis.scaleToHiddenSeries&&(bR._yaxis.show=!0)),bR.label||(bR.label="Series "+(bU+1).toString()),this.series.push(bR);for(var bL=0;bL<bF.jqplot.postParseSeriesOptionsHooks.length;bL++){bF.jqplot.postParseSeriesOptionsHooks[bL].call(this.series[bU],this.options.seriesDefaults,this.options.series[bU])}for(var bL=0;bL<this.postParseSeriesOptionsHooks.hooks.length;bL++){this.postParseSeriesOptionsHooks.hooks[bL].call(this.series[bU],this.options.seriesDefaults,this.options.series[bU])}}bF.extend(!0,this.grid,this.options.grid);for(var bU=0,bQ=a8.length;bQ>bU;bU++){var bP=a8[bU],bO=this.axes[bP];null==bO.borderWidth&&(bO.borderWidth=this.grid.borderWidth)}"string"==typeof this.options.title?this.title.text=this.options.title:"object"==typeof this.options.title&&bF.extend(!0,this.title,this.options.title),this.title._plotWidth=this._width,this.legend.setOptions(this.options.legend);for(var bU=0;bU<bF.jqplot.postParseOptionsHooks.length;bU++){bF.jqplot.postParseOptionsHooks[bU].call(this,bV)}for(var bU=0;bU<this.postParseOptionsHooks.hooks.length;bU++){this.postParseOptionsHooks.hooks[bU].call(this,bV)}},this.destroy=function(){this.canvasManager.freeAllCanvases(),this.eventCanvas&&this.eventCanvas._elem&&this.eventCanvas._elem.unbind(),this.target.empty(),this.target[0].innerHTML=""},this.replot=function(bK){var bO=bK||{},bN=bO.data||null,bM=bO.clear===!1?!1:!0,bL=bO.resetAxes||!1;delete bO.data,delete bO.clear,delete bO.resetAxes,this.target.trigger("jqplotPreReplot"),bM&&this.destroy(),bN||!bF.isEmptyObject(bO)?this.reInitialize(bN,bO):this.quickInit(),bL&&this.resetAxesScale(bL,bO.axes),this.draw(),this.target.trigger("jqplotPostReplot")},this.redraw=function(bL){bL=null!=bL?bL:!0,this.target.trigger("jqplotPreRedraw"),bL&&(this.canvasManager.freeAllCanvases(),this.eventCanvas._elem.unbind(),this.target.empty());for(var bK in this.axes){this.axes[bK]._ticks=[]}this.computePlotData(),this._sumy=0,this._sumx=0;for(var bN=0,bM=this.series.length;bM>bN;bN++){this._sumy+=this.series[bN]._sumy,this._sumx+=this.series[bN]._sumx}this.draw(),this.target.trigger("jqplotPostRedraw")},this.draw=function(){if(this.drawIfHidden||this.target.is(":visible")){this.target.trigger("jqplotPreDraw");var cc,cb,ca;for(cc=0,ca=bF.jqplot.preDrawHooks.length;ca>cc;cc++){bF.jqplot.preDrawHooks[cc].call(this)}for(cc=0,ca=this.preDrawHooks.hooks.length;ca>cc;cc++){this.preDrawHooks.hooks[cc].apply(this,this.preDrawSeriesHooks.args[cc])}this.target.append(this.baseCanvas.createElement({left:0,right:0,top:0,bottom:0},"jqplot-base-canvas",null,this)),this.baseCanvas.setContext(),this.target.append(this.title.draw()),this.title.pack({top:0,left:0});var b9=this.legend.draw({},this),b8={top:0,left:0,bottom:0,right:0};if("outsideGrid"==this.legend.placement){switch(this.target.append(b9),this.legend.location){case"n":b8.top+=this.legend.getHeight();break;case"s":b8.bottom+=this.legend.getHeight();break;case"ne":case"e":case"se":b8.right+=this.legend.getWidth();break;case"nw":case"w":case"sw":b8.left+=this.legend.getWidth();break;default:b8.right+=this.legend.getWidth()}b9=b9.detach()}var b7,b6=this.axes;for(cc=0;12>cc;cc++){b7=a8[cc],this.target.append(b6[b7].draw(this.baseCanvas._ctx,this)),b6[b7].set()}b6.yaxis.show&&(b8.left+=b6.yaxis.getWidth());var b5,b4=["y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"],b3=[0,0,0,0,0,0,0,0],b2=0;for(b5=0;8>b5;b5++){b6[b4[b5]].show&&(b2+=b6[b4[b5]].getWidth(),b3[b5]=b2)}if(b8.right+=b2,b6.x2axis.show&&(b8.top+=b6.x2axis.getHeight()),this.title.show&&(b8.top+=this.title.getHeight()),b6.xaxis.show&&(b8.bottom+=b6.xaxis.getHeight()),this.options.gridDimensions&&bF.isPlainObject(this.options.gridDimensions)){var b1=parseInt(this.options.gridDimensions.width,10)||0,b0=parseInt(this.options.gridDimensions.height,10)||0,bZ=(this._width-b8.left-b8.right-b1)/2,bY=(this._height-b8.top-b8.bottom-b0)/2;bY>=0&&bZ>=0&&(b8.top+=bY,b8.bottom+=bY,b8.left+=bZ,b8.right+=bZ)}var bW=["top","bottom","left","right"];for(var b5 in bW){null==this._gridPadding[bW[b5]]&&b8[bW[b5]]>0?this._gridPadding[bW[b5]]=b8[bW[b5]]:null==this._gridPadding[bW[b5]]&&(this._gridPadding[bW[b5]]=this._defaultGridPadding[bW[b5]])}var bU=this._gridPadding;for("outsideGrid"===this.legend.placement&&(bU={top:this.title.getHeight(),left:0,right:0,bottom:0},"s"===this.legend.location&&(bU.left=this._gridPadding.left,bU.right=this._gridPadding.right)),b6.xaxis.pack({position:"absolute",bottom:this._gridPadding.bottom-b6.xaxis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right}),b6.yaxis.pack({position:"absolute",top:0,left:this._gridPadding.left-b6.yaxis.getWidth(),height:this._height},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top}),b6.x2axis.pack({position:"absolute",top:this._gridPadding.top-b6.x2axis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right}),cc=8;cc>0;cc--){b6[b4[cc-1]].pack({position:"absolute",top:0,right:this._gridPadding.right-b3[cc-1]},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top})}var bS=(this._width-this._gridPadding.left-this._gridPadding.right)/2+this._gridPadding.left-b6.yMidAxis.getWidth()/2;b6.yMidAxis.pack({position:"absolute",top:0,left:bS,zIndex:9,textAlign:"center"},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top}),this.target.append(this.grid.createElement(this._gridPadding,this)),this.grid.draw();var bQ=this.series,bP=bQ.length;for(cc=0,ca=bP;ca>cc;cc++){cb=this.seriesStack[cc],this.target.append(bQ[cb].shadowCanvas.createElement(this._gridPadding,"jqplot-series-shadowCanvas",null,this)),bQ[cb].shadowCanvas.setContext(),bQ[cb].shadowCanvas._elem.data("seriesIndex",cb)}for(cc=0,ca=bP;ca>cc;cc++){cb=this.seriesStack[cc],this.target.append(bQ[cb].canvas.createElement(this._gridPadding,"jqplot-series-canvas",null,this)),bQ[cb].canvas.setContext(),bQ[cb].canvas._elem.data("seriesIndex",cb)}this.target.append(this.eventCanvas.createElement(this._gridPadding,"jqplot-event-canvas",null,this)),this.eventCanvas.setContext(),this.eventCanvas._ctx.fillStyle="rgba(0,0,0,0)",this.eventCanvas._ctx.fillRect(0,0,this.eventCanvas._ctx.canvas.width,this.eventCanvas._ctx.canvas.height),this.bindCustomEvents(),this.legend.preDraw?(this.eventCanvas._elem.before(b9),this.legend.pack(bU),this.legend._elem?this.drawSeries({legendInfo:{location:this.legend.location,placement:this.legend.placement,width:this.legend.getWidth(),height:this.legend.getHeight(),xoffset:this.legend.xoffset,yoffset:this.legend.yoffset}}):this.drawSeries()):(this.drawSeries(),bP&&bF(bQ[bP-1].canvas._elem).after(b9),this.legend.pack(bU));for(var cc=0,ca=bF.jqplot.eventListenerHooks.length;ca>cc;cc++){this.eventCanvas._elem.bind(bF.jqplot.eventListenerHooks[cc][0],{plot:this},bF.jqplot.eventListenerHooks[cc][1])}for(var cc=0,ca=this.eventListenerHooks.hooks.length;ca>cc;cc++){this.eventCanvas._elem.bind(this.eventListenerHooks.hooks[cc][0],{plot:this},this.eventListenerHooks.hooks[cc][1])}var bO=this.fillBetween;if("number"==typeof bO.series1){bO.fill&&bO.series1!==bO.series2&&bO.series1<bP&&bO.series2<bP&&"line"===bQ[bO.series1]._type&&"line"===bQ[bO.series2]._type&&this.doFillBetweenLines()}else{if(null!=bO.series1&&null!=bO.series2){var bN=!1;if(bO.series1.length===bO.series2.length){for(var bM=0,bL=0,bK=0;bK<bO.series1.length;bK++){if(bM=bO.series1[bK],bL=bO.series2[bK],!(bM!==bL&&bP>bM&&bP>bL&&"line"===bQ[bM]._type&&"line"===bQ[bL]._type)){bN=!1;break}bN=!0}}bO.fill&&bN&&this.doFillBetweenLines()}}for(var cc=0,ca=bF.jqplot.postDrawHooks.length;ca>cc;cc++){bF.jqplot.postDrawHooks[cc].call(this)}for(var cc=0,ca=this.postDrawHooks.hooks.length;ca>cc;cc++){this.postDrawHooks.hooks[cc].apply(this,this.postDrawHooks.args[cc])}this.target.is(":visible")&&(this._drawCount+=1);var bX,bV,bT,bR;for(cc=0,ca=bP;ca>cc;cc++){bX=bQ[cc],bV=bX.renderer,bT=".jqplot-point-label.jqplot-series-"+cc,bV.animation&&bV.animation._supported&&bV.animation.show&&(this._drawCount<2||this.animateReplot)&&(bR=this.target.find(bT),bR.stop(!0,!0).hide(),bX.canvas._elem.stop(!0,!0).hide(),bX.shadowCanvas._elem.stop(!0,!0).hide(),bX.canvas._elem.jqplotEffect("blind",{mode:"show",direction:bV.animation.direction},bV.animation.speed),bX.shadowCanvas._elem.jqplotEffect("blind",{mode:"show",direction:bV.animation.direction},bV.animation.speed),bR.fadeIn(0.8*bV.animation.speed))}bR=null,this.target.trigger("jqplotPostDraw",[this])}},bz.prototype.doFillBetweenLines=function(){function bL(b1,b0){var bZ=bR[b1],bY=bR[b0];if(bY.renderer.smooth){var bX=bY.renderer._smoothedData.slice(0).reverse()}else{var bX=bY.gridData.slice(0).reverse()}if(bZ.renderer.smooth){var bW=bZ.renderer._smoothedData.concat(bX)}else{var bW=bZ.gridData.concat(bX)}var bV=null!==bK.color?bK.color:bR[bQ].fillColor,bU=null!==bK.baseSeries?bK.baseSeries:b1,bT=bR[bU].renderer.shapeRenderer,bS={fillStyle:bV,fill:!0,closePath:!0};bT.draw(bZ.shadowCanvas._ctx,bW,bS)}var bK=this.fillBetween,bR=this.series,bQ=bK.series1,bP=bK.series2,bO=0,bN=0;if("number"==typeof bQ&&"number"==typeof bP){bO=bP>bQ?bQ:bP,bN=bP>bQ?bP:bQ,bL(bO,bN)}else{for(var bM=0;bM<bQ.length;bM++){bO=bQ[bM]<bP[bM]?bQ[bM]:bP[bM],bN=bP[bM]>bQ[bM]?bP[bM]:bQ[bM],bL(bO,bN)}}},this.bindCustomEvents=function(){this.eventCanvas._elem.bind("click",{plot:this},this.onClick),this.eventCanvas._elem.bind("dblclick",{plot:this},this.onDblClick),this.eventCanvas._elem.bind("mousedown",{plot:this},this.onMouseDown),this.eventCanvas._elem.bind("mousemove",{plot:this},this.onMouseMove),this.eventCanvas._elem.bind("mouseenter",{plot:this},this.onMouseEnter),this.eventCanvas._elem.bind("mouseleave",{plot:this},this.onMouseLeave),this.captureRightClick?(this.eventCanvas._elem.bind("mouseup",{plot:this},this.onRightClick),this.eventCanvas._elem.get(0).oncontextmenu=function(){return !1}):this.eventCanvas._elem.bind("mouseup",{plot:this},this.onMouseUp)},this.onClick=function(bK){var bO=bI(bK),bN=bK.data.plot,bM=bH(bO.gridPos,bN),bL=bF.Event("jqplotClick");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])},this.onDblClick=function(bK){var bO=bI(bK),bN=bK.data.plot,bM=bH(bO.gridPos,bN),bL=bF.Event("jqplotDblClick");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])},this.onMouseDown=function(bK){var bO=bI(bK),bN=bK.data.plot,bM=bH(bO.gridPos,bN),bL=bF.Event("jqplotMouseDown");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])},this.onMouseUp=function(bK){var bM=bI(bK),bL=bF.Event("jqplotMouseUp");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bM.gridPos,bM.dataPos,null,bK.data.plot])},this.onRightClick=function(bK){var bO=bI(bK),bN=bK.data.plot,bM=bH(bO.gridPos,bN);if(bN.captureRightClick){if(3==bK.which){var bL=bF.Event("jqplotRightClick");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])}else{var bL=bF.Event("jqplotMouseUp");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])}}},this.onMouseMove=function(bK){var bO=bI(bK),bN=bK.data.plot,bM=bH(bO.gridPos,bN),bL=bF.Event("jqplotMouseMove");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bF(this).trigger(bL,[bO.gridPos,bO.dataPos,bM,bN])},this.onMouseEnter=function(bK){var bN=bI(bK),bM=bK.data.plot,bL=bF.Event("jqplotMouseEnter");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bL.relatedTarget=bK.relatedTarget,bF(this).trigger(bL,[bN.gridPos,bN.dataPos,null,bM])},this.onMouseLeave=function(bK){var bN=bI(bK),bM=bK.data.plot,bL=bF.Event("jqplotMouseLeave");bL.pageX=bK.pageX,bL.pageY=bK.pageY,bL.relatedTarget=bK.relatedTarget,bF(this).trigger(bL,[bN.gridPos,bN.dataPos,null,bM])},this.drawSeries=function(bK,bO){var bN,bM,bL;if(bO="number"==typeof bK&&null==bO?bK:bO,bK="object"==typeof bK?bK:{},bO!=a9){bM=this.series[bO],bL=bM.shadowCanvas._ctx,bL.clearRect(0,0,bL.canvas.width,bL.canvas.height),bM.drawShadow(bL,bK,this),bL=bM.canvas._ctx,bL.clearRect(0,0,bL.canvas.width,bL.canvas.height),bM.draw(bL,bK,this),bM.renderer.constructor==bF.jqplot.BezierCurveRenderer&&bO<this.series.length-1&&this.drawSeries(bO+1)}else{for(bN=0;bN<this.series.length;bN++){bM=this.series[bN],bL=bM.shadowCanvas._ctx,bL.clearRect(0,0,bL.canvas.width,bL.canvas.height),bM.drawShadow(bL,bK,this),bL=bM.canvas._ctx,bL.clearRect(0,0,bL.canvas.width,bL.canvas.height),bM.draw(bL,bK,this)}}bK=bO=bN=bM=bL=null},this.moveSeriesToFront=function(bK){bK=parseInt(bK,10);var bO=bF.inArray(bK,this.seriesStack);if(-1!=bO){if(bO==this.seriesStack.length-1){return void (this.previousSeriesStack=this.seriesStack.slice(0))}var bN=this.seriesStack[this.seriesStack.length-1],bM=this.series[bK].canvas._elem.detach(),bL=this.series[bK].shadowCanvas._elem.detach();this.series[bN].shadowCanvas._elem.after(bL),this.series[bN].canvas._elem.after(bM),this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack.splice(bO,1),this.seriesStack.push(bK)}},this.moveSeriesToBack=function(bK){bK=parseInt(bK,10);var bO=bF.inArray(bK,this.seriesStack);if(0!=bO&&-1!=bO){var bN=this.seriesStack[0],bM=this.series[bK].canvas._elem.detach(),bL=this.series[bK].shadowCanvas._elem.detach();this.series[bN].shadowCanvas._elem.before(bL),this.series[bN].canvas._elem.before(bM),this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack.splice(bO,1),this.seriesStack.unshift(bK)}},this.restorePreviousSeriesOrder=function(){var bL,bK,bP,bO,bN,bM;if(this.seriesStack!=this.previousSeriesStack){for(bL=1;bL<this.previousSeriesStack.length;bL++){bN=this.previousSeriesStack[bL],bM=this.previousSeriesStack[bL-1],bK=this.series[bN].canvas._elem.detach(),bP=this.series[bN].shadowCanvas._elem.detach(),this.series[bM].shadowCanvas._elem.after(bP),this.series[bM].canvas._elem.after(bK)}bO=this.seriesStack.slice(0),this.seriesStack=this.previousSeriesStack.slice(0),this.previousSeriesStack=bO}},this.restoreOriginalSeriesOrder=function(){var bL,bK,bN,bM=[];for(bL=0;bL<this.series.length;bL++){bM.push(bL)}if(this.seriesStack!=bM){for(this.previousSeriesStack=this.seriesStack.slice(0),this.seriesStack=bM,bL=1;bL<this.seriesStack.length;bL++){bK=this.series[bL].canvas._elem.detach(),bN=this.series[bL].shadowCanvas._elem.detach(),this.series[bL-1].shadowCanvas._elem.after(bN),this.series[bL-1].canvas._elem.after(bK)}}},this.activateTheme=function(bK){this.themeEngine.activate(this,bK)}}function by(bI,bH){return(3.4182054+bH)*Math.pow(bI,-0.3534992)}function bx(bI){var bH=(Math.exp(2*bI)-1)/(Math.exp(2*bI)+1);return bH}function bw(b7){function b6(b9,b8){return b9-b8==0?Math.pow(10,10):b9-b8}var b5=this.renderer.smooth,b4=this.canvas.getWidth(),b3=this._xaxis.series_p2u,b2=this._yaxis.series_p2u,b1=null,b0=b7.length/b4,bZ=[],bY=[];b1=isNaN(parseFloat(b5))?by(b0,0.5):parseFloat(b5);for(var bX=[],bW=[],bV=0,bU=b7.length;bU>bV;bV++){bX.push(b7[bV][1]),bW.push(b7[bV][0])}for(var bT,bR,bP,bO,bN=b7.length-1,bM=1,bL=b7.length;bL>bM;bM++){for(var bK=[],bJ=[],bI=0;2>bI;bI++){var bV=bM-1+bI;0==bV||bV==bN?bK[bI]=Math.pow(10,10):bX[bV+1]-bX[bV]==0||bX[bV]-bX[bV-1]==0?bK[bI]=0:(bW[bV+1]-bW[bV])/(bX[bV+1]-bX[bV])+(bW[bV]-bW[bV-1])/(bX[bV]-bX[bV-1])==0?bK[bI]=0:(bX[bV+1]-bX[bV])*(bX[bV]-bX[bV-1])<0?bK[bI]=0:bK[bI]=2/(b6(bW[bV+1],bW[bV])/(bX[bV+1]-bX[bV])+b6(bW[bV],bW[bV-1])/(bX[bV]-bX[bV-1]))}1==bM?bK[0]=1.5*(bX[1]-bX[0])/b6(bW[1],bW[0])-bK[1]/2:bM==bN&&(bK[1]=1.5*(bX[bN]-bX[bN-1])/b6(bW[bN],bW[bN-1])-bK[0]/2),bJ[0]=-2*(bK[1]+2*bK[0])/b6(bW[bM],bW[bM-1])+6*(bX[bM]-bX[bM-1])/Math.pow(b6(bW[bM],bW[bM-1]),2),bJ[1]=2*(2*bK[1]+bK[0])/b6(bW[bM],bW[bM-1])-6*(bX[bM]-bX[bM-1])/Math.pow(b6(bW[bM],bW[bM-1]),2),bO=1/6*(bJ[1]-bJ[0])/b6(bW[bM],bW[bM-1]),bP=0.5*(bW[bM]*bJ[0]-bW[bM-1]*bJ[1])/b6(bW[bM],bW[bM-1]),bR=(bX[bM]-bX[bM-1]-bP*(Math.pow(bW[bM],2)-Math.pow(bW[bM-1],2))-bO*(Math.pow(bW[bM],3)-Math.pow(bW[bM-1],3)))/b6(bW[bM],bW[bM-1]),bT=bX[bM-1]-bR*bW[bM-1]-bP*Math.pow(bW[bM-1],2)-bO*Math.pow(bW[bM-1],3);for(var bH,bS,bQ=(bW[bM]-bW[bM-1])/b1,bI=0,bU=b1;bU>bI;bI++){bH=[],bS=bW[bM-1]+bI*bQ,bH.push(bS),bH.push(bT+bR*bS+bP*Math.pow(bS,2)+bO*Math.pow(bS,3)),bZ.push(bH),bY.push([b3(bH[0]),b2(bH[1])])}}return bZ.push(b7[bV]),bY.push([b3(b7[bV][0]),b2(b7[bV][1])]),[bZ,bY]}function bv(cg){var cf,ce,cd,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2,b1,b0,bZ,bY,bX=this.renderer.smooth,bW=this.renderer.tension,bV=this.canvas.getWidth(),bU=this._xaxis.series_p2u,bT=this._yaxis.series_p2u,bS=null,bR=null,bQ=null,bP=null,bO=null,bN=null,bM=null,bL=cg.length/bV,bK=[],bJ=[];bS=isNaN(parseFloat(bX))?by(bL,0.5):parseFloat(bX),isNaN(parseFloat(bW))||(bW=parseFloat(bW));for(var bI=0,bH=cg.length-1;bH>bI;bI++){for(null===bW?(bO=Math.abs((cg[bI+1][1]-cg[bI][1])/(cg[bI+1][0]-cg[bI][0])),b2=0.3,b1=0.6,b0=(b1-b2)/2,bZ=2.5,bY=-1.4,bM=bO/bZ+bY,bQ=b0*bx(bM)-b0*bx(bY)+b2,bI>0&&(bN=Math.abs((cg[bI][1]-cg[bI-1][1])/(cg[bI][0]-cg[bI-1][0]))),bM=bN/bZ+bY,bP=b0*bx(bM)-b0*bx(bY)+b2,bR=(bQ+bP)/2):bR=bW,cf=0;bS>cf;cf++){ce=cf/bS,cd=(1+2*ce)*Math.pow(1-ce,2),cc=ce*Math.pow(1-ce,2),cb=Math.pow(ce,2)*(3-2*ce),ca=Math.pow(ce,2)*(ce-1),cg[bI-1]?(b9=bR*(cg[bI+1][0]-cg[bI-1][0]),b8=bR*(cg[bI+1][1]-cg[bI-1][1])):(b9=bR*(cg[bI+1][0]-cg[bI][0]),b8=bR*(cg[bI+1][1]-cg[bI][1])),cg[bI+2]?(b7=bR*(cg[bI+2][0]-cg[bI][0]),b6=bR*(cg[bI+2][1]-cg[bI][1])):(b7=bR*(cg[bI+1][0]-cg[bI][0]),b6=bR*(cg[bI+1][1]-cg[bI][1])),b5=cd*cg[bI][0]+cb*cg[bI+1][0]+cc*b9+ca*b7,b4=cd*cg[bI][1]+cb*cg[bI+1][1]+cc*b8+ca*b6,b3=[b5,b4],bK.push(b3),bJ.push([bU(b5),bT(b4)])}}return bK.push(cg[bH]),bJ.push([bU(cg[bH][0]),bT(cg[bH][1])]),[bK,bJ]}function bu(bH,bK,bJ){for(var bI=0;bI<this.series.length;bI++){this.series[bI].renderer.constructor==bF.jqplot.LineRenderer&&this.series[bI].highlightMouseOver&&(this.series[bI].highlightMouseDown=!1)}}function bt(){this.plugins.lineRenderer&&this.plugins.lineRenderer.highlightCanvas&&(this.plugins.lineRenderer.highlightCanvas.resetCanvas(),this.plugins.lineRenderer.highlightCanvas=null),this.plugins.lineRenderer.highlightedSeriesIndex=null,this.plugins.lineRenderer.highlightCanvas=new bF.jqplot.GenericCanvas,this.eventCanvas._elem.before(this.plugins.lineRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-lineRenderer-highlight-canvas",this._plotDimensions,this)),this.plugins.lineRenderer.highlightCanvas.setContext(),this.eventCanvas._elem.bind("mouseleave",{plot:this},function(bH){br(bH.data.plot)})}function bs(bI,bH,bN,bM){var bL=bI.series[bH],bK=bI.plugins.lineRenderer.highlightCanvas;bK._ctx.clearRect(0,0,bK._ctx.canvas.width,bK._ctx.canvas.height),bL._highlightedPoint=bN,bI.plugins.lineRenderer.highlightedSeriesIndex=bH;var bJ={fillStyle:bL.highlightColor};"line"===bL.type&&bL.renderer.bands.show&&(bJ.fill=!0,bJ.closePath=!0),bL.renderer.shapeRenderer.draw(bK._ctx,bM,bJ),bK=null}function br(bI){var bH=bI.plugins.lineRenderer.highlightCanvas;bH._ctx.clearRect(0,0,bH._ctx.canvas.width,bH._ctx.canvas.height);for(var bJ=0;bJ<bI.series.length;bJ++){bI.series[bJ]._highlightedPoint=null}bI.plugins.lineRenderer.highlightedSeriesIndex=null,bI.target.trigger("jqplotDataUnhighlight"),bH=null}function bq(bI,bH,bO,bN,bM){if(bN){var bL=[bN.seriesIndex,bN.pointIndex,bN.data],bK=jQuery.Event("jqplotDataMouseOver");if(bK.pageX=bI.pageX,bK.pageY=bI.pageY,bM.target.trigger(bK,bL),bM.series[bL[0]].highlightMouseOver&&bL[0]!=bM.plugins.lineRenderer.highlightedSeriesIndex){var bJ=jQuery.Event("jqplotDataHighlight");bJ.which=bI.which,bJ.pageX=bI.pageX,bJ.pageY=bI.pageY,bM.target.trigger(bJ,bL),bs(bM,bN.seriesIndex,bN.pointIndex,bN.points)}}else{null==bN&&br(bM)}}function bp(bI,bH,bN,bM,bL){if(bM){var bK=[bM.seriesIndex,bM.pointIndex,bM.data];if(bL.series[bK[0]].highlightMouseDown&&bK[0]!=bL.plugins.lineRenderer.highlightedSeriesIndex){var bJ=jQuery.Event("jqplotDataHighlight");bJ.which=bI.which,bJ.pageX=bI.pageX,bJ.pageY=bI.pageY,bL.target.trigger(bJ,bK),bs(bL,bM.seriesIndex,bM.pointIndex,bM.points)}}else{null==bM&&br(bL)}}function bo(bI,bH,bM,bL,bK){var bJ=bK.plugins.lineRenderer.highlightedSeriesIndex;null!=bJ&&bK.series[bJ].highlightMouseDown&&br(bK)}function bn(bI,bH,bN,bM,bL){if(bM){var bK=[bM.seriesIndex,bM.pointIndex,bM.data],bJ=jQuery.Event("jqplotDataClick");bJ.which=bI.which,bJ.pageX=bI.pageX,bJ.pageY=bI.pageY,bL.target.trigger(bJ,bK)}}function bm(bI,bH,bO,bN,bM){if(bN){var bL=[bN.seriesIndex,bN.pointIndex,bN.data],bK=bM.plugins.lineRenderer.highlightedSeriesIndex;null!=bK&&bM.series[bK].highlightMouseDown&&br(bM);var bJ=jQuery.Event("jqplotDataRightClick");bJ.which=bI.which,bJ.pageX=bI.pageX,bJ.pageY=bI.pageY,bM.target.trigger(bJ,bL)}}function bl(bI){var bH;if(bI=Math.abs(bI),bI>=10){bH="%d"}else{if(bI>1){bH=bI===parseInt(bI,10)?"%d":"%.1f"}else{var bJ=-Math.floor(Math.log(bI)/Math.LN10);bH="%."+bJ+"f"}}return bH}function bk(bX,bW,bV){for(var bU,bT,bS,bR,bQ,bP,bO,bN=Math.floor(bV/2),bM=Math.ceil(1.5*bV),bL=Number.MAX_VALUE,bK=bW-bX,bJ=bF.jqplot.getSignificantFigures,bI=0,bH=bM-bN+1;bH>bI;bI++){bP=bN+bI,bU=bK/(bP-1),bT=bJ(bU),bU=Math.abs(bV-bP)+bT.digitsRight,bL>bU?(bL=bU,bS=bP,bO=bT.digitsRight):bU===bL&&bT.digitsRight<bO&&(bS=bP,bO=bT.digitsRight)}return bR=Math.max(bO,Math.max(bJ(bX).digitsRight,bJ(bW).digitsRight)),bQ=0===bR?"%d":"%."+bR+"f",bU=bK/(bS-1),[bX,bW,bS,bQ,bU]}function bj(bI,bH){bH=bH||7;var bM,bL=bI/(bH-1),bK=Math.pow(10,Math.floor(Math.log(bL)/Math.LN10)),bJ=bL/bK;return bM=1>bK?bJ>5?10*bK:bJ>2?5*bK:bJ>1?2*bK:bK:bJ>5?10*bK:bJ>4?5*bK:bJ>3?4*bK:bJ>2?3*bK:bJ>1?2*bK:bK}function bi(bI,bH){bH=bH||1;var bM,bL=Math.floor(Math.log(bI)/Math.LN10),bK=Math.pow(10,bL),bJ=bI/bK;return bJ/=bH,bM=0.38>=bJ?0.1:1.6>=bJ?0.2:4>=bJ?0.5:8>=bJ?1:16>=bJ?2:5,bM*bK}function bh(bI,bH){var bN,bM,bL=Math.floor(Math.log(bI)/Math.LN10),bK=Math.pow(10,bL),bJ=bI/bK;return bJ/=bH,bM=0.38>=bJ?0.1:1.6>=bJ?0.2:4>=bJ?0.5:8>=bJ?1:16>=bJ?2:5,bN=bM*bK,[bN,bM,bK]}function bg(bI,bH){return bI-bH}function be(bI){if(null==bI||"object"!=typeof bI){return bI}var bH=new bI.constructor;for(var bJ in bI){bH[bJ]=be(bI[bJ])}return bH}function bd(bI,bH){if(null!=bH&&"object"==typeof bH){for(var bJ in bH){"highlightColors"==bJ&&(bI[bJ]=be(bH[bJ])),null!=bH[bJ]&&"object"==typeof bH[bJ]?(bI.hasOwnProperty(bJ)||(bI[bJ]={}),bd(bI[bJ],bH[bJ])):bI[bJ]=bH[bJ]}}}function bc(bI,bH){if(bH.indexOf){return bH.indexOf(bI)}for(var bK=0,bJ=bH.length;bJ>bK;bK++){if(bH[bK]===bI){return bK}}return -1}function bb(bH){return null===bH?"[object Null]":Object.prototype.toString.call(bH)}function ba(bH,bK,bJ,bI){return bF.isPlainObject(bH)?bH:(bH={effect:bH},bK===a9&&(bK={}),bF.isFunction(bK)&&(bI=bK,bJ=null,bK={}),("number"===bF.type(bK)||bF.fx.speeds[bK])&&(bI=bJ,bJ=bK,bK={}),bF.isFunction(bJ)&&(bI=bJ,bJ=null),bK&&bF.extend(bH,bK),bJ=bJ||bK.duration,bH.duration=bF.fx.off?0:"number"==typeof bJ?bJ:bJ in bF.fx.speeds?bF.fx.speeds[bJ]:bF.fx.speeds._default,bH.complete=bI||bK.complete,bH)}var a9;bF.fn.emptyForce=function(){for(var bH,bI=0;null!=(bH=bF(this)[bI]);bI++){if(1===bH.nodeType&&bF.cleanData(bH.getElementsByTagName("*")),bF.jqplot.use_excanvas){bH.outerHTML=""}else{for(;bH.firstChild;){bH.removeChild(bH.firstChild)}}bH=null}return bF(this)},bF.fn.removeChildForce=function(bH){for(;bH.firstChild;){this.removeChildForce(bH.firstChild),bH.removeChild(bH.firstChild)}},bF.fn.jqplot=function(){for(var bH=[],bK=[],bJ=0,bI=arguments.length;bI>bJ;bJ++){bF.isArray(arguments[bJ])?bH.push(arguments[bJ]):bF.isPlainObject(arguments[bJ])&&bK.push(arguments[bJ])}return this.each(function(bS){var bR,bQ,bP,bO,bN=bF(this),bM=bH.length,bL=bK.length;bP=bM>bS?bH[bS]:bM?bH[bM-1]:null,bO=bL>bS?bK[bS]:bL?bK[bL-1]:null,bR=bN.attr("id"),bR===a9&&(bR="jqplot_target_"+bF.jqplot.targetCounter++,bN.attr("id",bR)),bQ=bF.jqplot(bR,bP,bO),bN.data("jqplot",bQ)})},bF.jqplot=function(bH,bO,bN){var bM=null,bL=null;3===arguments.length?(bM=bO,bL=bN):2===arguments.length&&(bF.isArray(bO)?bM=bO:bF.isPlainObject(bO)&&(bL=bO)),null===bM&&null!==bL&&bL.data&&(bM=bL.data);var bK=new bz;if(bF("#"+bH).removeClass("jqplot-error"),!bF.jqplot.config.catchErrors){return bK.init(bH,bM,bL),bK.draw(),bK.themeEngine.init.call(bK),bK}try{return bK.init(bH,bM,bL),bK.draw(),bK.themeEngine.init.call(bK),bK}catch(bJ){var bI=bF.jqplot.config.errorMessage||bJ.message;bF("#"+bH).append('<div class="jqplot-error-message">'+bI+"</div>"),bF("#"+bH).addClass("jqplot-error"),document.getElementById(bH).style.background=bF.jqplot.config.errorBackground,document.getElementById(bH).style.border=bF.jqplot.config.errorBorder,document.getElementById(bH).style.fontFamily=bF.jqplot.config.errorFontFamily,document.getElementById(bH).style.fontSize=bF.jqplot.config.errorFontSize,document.getElementById(bH).style.fontStyle=bF.jqplot.config.errorFontStyle,document.getElementById(bH).style.fontWeight=bF.jqplot.config.errorFontWeight}},bF.jqplot.version="1.0.9",bF.jqplot.revision="d96a669",bF.jqplot.targetCounter=1,bF.jqplot.CanvasManager=function(){"undefined"==typeof bF.jqplot.CanvasManager.canvases&&(bF.jqplot.CanvasManager.canvases=[],bF.jqplot.CanvasManager.free=[]);var bH=[];this.getCanvas=function(){var bL,bK=!0;if(!bF.jqplot.use_excanvas){for(var bJ=0,bI=bF.jqplot.CanvasManager.canvases.length;bI>bJ;bJ++){if(bF.jqplot.CanvasManager.free[bJ]===!0){bK=!1,bL=bF.jqplot.CanvasManager.canvases[bJ],bF.jqplot.CanvasManager.free[bJ]=!1,bH.push(bJ);break}}}return bK&&(bL=document.createElement("canvas"),bH.push(bF.jqplot.CanvasManager.canvases.length),bF.jqplot.CanvasManager.canvases.push(bL),bF.jqplot.CanvasManager.free.push(!1)),bL},this.initCanvas=function(bI){if(bF.jqplot.use_excanvas){return window.G_vmlCanvasManager.initElement(bI)}var bM=bI.getContext("2d"),bL=1;window.devicePixelRatio>1&&(bM.webkitBackingStorePixelRatio===a9||bM.webkitBackingStorePixelRatio<2)&&(bL=window.devicePixelRatio);var bK=bI.width,bJ=bI.height;return bI.width=bL*bI.width,bI.height=bL*bI.height,bI.style.width=bK+"px",bI.style.height=bJ+"px",bM.save(),bM.scale(bL,bL),bI},this.freeAllCanvases=function(){for(var bI=0,bJ=bH.length;bJ>bI;bI++){this.freeCanvas(bH[bI])}bH=[]},this.freeCanvas=function(bI){if(bF.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a9){window.G_vmlCanvasManager.uninitElement(bF.jqplot.CanvasManager.canvases[bI]),bF.jqplot.CanvasManager.canvases[bI]=null}else{var bJ=bF.jqplot.CanvasManager.canvases[bI];bJ.getContext("2d").clearRect(0,0,bJ.width,bJ.height),bF(bJ).unbind().removeAttr("class").removeAttr("style"),bF(bJ).css({left:"",top:"",position:""}),bJ.width=0,bJ.height=0,bF.jqplot.CanvasManager.free[bI]=!0}}},bF.jqplot.log=function(){window.console&&window.console.log.apply(window.console,arguments)},bF.jqplot.config={addDomReference:!1,enablePlugins:!1,defaultHeight:300,defaultWidth:400,UTCAdjust:!1,timezoneOffset:new Date(60000*(new Date).getTimezoneOffset()),errorMessage:"",errorBackground:"",errorBorder:"",errorFontFamily:"",errorFontSize:"",errorFontStyle:"",errorFontWeight:"",catchErrors:!1,defaultTickFormatString:"%.1f",defaultColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc","#c747a3","#cddf54","#FBD178","#26B4E3","#bd70c7"],defaultNegativeColors:["#498991","#C08840","#9F9274","#546D61","#646C4A","#6F6621","#6E3F5F","#4F64B0","#A89050","#C45923","#187399","#945381","#959E5C","#C7AF7B","#478396","#907294"],dashLength:4,gapLength:4,dotGapLength:2.5,srcLocation:"jqplot/src/",pluginLocation:"jqplot/src/plugins/"},bF.jqplot.arrayMax=function(bH){return Math.max.apply(Math,bH)},bF.jqplot.arrayMin=function(bH){return Math.min.apply(Math,bH)},bF.jqplot.enablePlugins=bF.jqplot.config.enablePlugins,bF.jqplot.support_canvas=function(){return"undefined"==typeof bF.jqplot.support_canvas.result&&(bF.jqplot.support_canvas.result=!!document.createElement("canvas").getContext),bF.jqplot.support_canvas.result},bF.jqplot.support_canvas_text=function(){return"undefined"==typeof bF.jqplot.support_canvas_text.result&&(window.G_vmlCanvasManager!==a9&&window.G_vmlCanvasManager._version>887?bF.jqplot.support_canvas_text.result=!0:bF.jqplot.support_canvas_text.result=!(!document.createElement("canvas").getContext||"function"!=typeof document.createElement("canvas").getContext("2d").fillText)),bF.jqplot.support_canvas_text.result},bF.jqplot.use_excanvas=bF.support.boxModel&&bF.support.objectAll&&$support.leadingWhitespace||bF.jqplot.support_canvas()?!1:!0,bF.jqplot.preInitHooks=[],bF.jqplot.postInitHooks=[],bF.jqplot.preParseOptionsHooks=[],bF.jqplot.postParseOptionsHooks=[],bF.jqplot.preDrawHooks=[],bF.jqplot.postDrawHooks=[],bF.jqplot.preDrawSeriesHooks=[],bF.jqplot.postDrawSeriesHooks=[],bF.jqplot.preDrawLegendHooks=[],bF.jqplot.addLegendRowHooks=[],bF.jqplot.preSeriesInitHooks=[],bF.jqplot.postSeriesInitHooks=[],bF.jqplot.preParseSeriesOptionsHooks=[],bF.jqplot.postParseSeriesOptionsHooks=[],bF.jqplot.eventListenerHooks=[],bF.jqplot.preDrawSeriesShadowHooks=[],bF.jqplot.postDrawSeriesShadowHooks=[],bF.jqplot.ElemContainer=function(){this._elem,this._plotWidth,this._plotHeight,this._plotDimensions={height:null,width:null}},bF.jqplot.ElemContainer.prototype.createElement=function(bH,bN,bM,bL,bK){this._offsets=bN;var bJ=bM||"jqplot",bI=document.createElement(bH);return this._elem=bF(bI),this._elem.addClass(bJ),this._elem.css(bL),this._elem.attr(bK),bI=null,this._elem},bF.jqplot.ElemContainer.prototype.getWidth=function(){return this._elem?this._elem.outerWidth(!0):null},bF.jqplot.ElemContainer.prototype.getHeight=function(){return this._elem?this._elem.outerHeight(!0):null},bF.jqplot.ElemContainer.prototype.getPosition=function(){return this._elem?this._elem.position():{top:null,left:null,bottom:null,right:null}},bF.jqplot.ElemContainer.prototype.getTop=function(){return this.getPosition().top},bF.jqplot.ElemContainer.prototype.getLeft=function(){return this.getPosition().left},bF.jqplot.ElemContainer.prototype.getBottom=function(){return this._elem.css("bottom")},bF.jqplot.ElemContainer.prototype.getRight=function(){return this._elem.css("right")},bE.prototype=new bF.jqplot.ElemContainer,bE.prototype.constructor=bE,bE.prototype.init=function(){bF.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.tickOptions.axis=this.name,null==this.tickOptions.showMark&&(this.tickOptions.showMark=this.showTicks),null==this.tickOptions.showMark&&(this.tickOptions.showMark=this.showTickMarks),null==this.tickOptions.showLabel&&(this.tickOptions.showLabel=this.showTicks),null==this.label||""==this.label?this.showLabel=!1:this.labelOptions.label=this.label,0==this.showLabel&&(this.labelOptions.show=!1),0==this.pad&&(this.pad=1),0==this.padMax&&(this.padMax=1),0==this.padMin&&(this.padMin=1),null==this.padMax&&(this.padMax=(this.pad-1)/2+1),null==this.padMin&&(this.padMin=(this.pad-1)/2+1),this.pad=this.padMax+this.padMin-1,(null!=this.min||null!=this.max)&&(this.autoscale=!1),null==this.syncTicks&&this.name.indexOf("y")>-1?this.syncTicks=!0:null==this.syncTicks&&(this.syncTicks=!1),this.renderer.init.call(this,this.rendererOptions)},bE.prototype.draw=function(bI,bH){return this.__ticks&&(this.__ticks=null),this.renderer.draw.call(this,bI,bH)},bE.prototype.set=function(){this.renderer.set.call(this)},bE.prototype.pack=function(bI,bH){this.show&&this.renderer.pack.call(this,bI,bH),null==this._min&&(this._min=this.min,this._max=this.max,this._tickInterval=this.tickInterval,this._numberTicks=this.numberTicks,this.__ticks=this._ticks)},bE.prototype.reset=function(){this.renderer.reset.call(this)},bE.prototype.resetScale=function(bH){bF.extend(!0,this,{min:null,max:null,numberTicks:null,tickInterval:null,_ticks:[],ticks:[]},bH),this.resetDataBounds()},bE.prototype.resetDataBounds=function(){var bP=this._dataBounds;bP.min=null,bP.max=null;for(var bO,bN,bM,bL=this.show?!0:!1,bK=0;bK<this._series.length;bK++){if(bN=this._series[bK],bN.show||this.scaleToHiddenSeries){bM=bN._plotData,"line"===bN._type&&bN.renderer.bands.show&&"x"!==this.name.charAt(0)&&(bM=[[0,bN.renderer.bands._min],[1,bN.renderer.bands._max]]);var bJ=1,bI=1;null!=bN._type&&"ohlc"==bN._type&&(bJ=3,bI=2);for(var bH=0,bO=bM.length;bO>bH;bH++){"xaxis"==this.name||"x2axis"==this.name?((null!=bM[bH][0]&&bM[bH][0]<bP.min||null==bP.min)&&(bP.min=bM[bH][0]),(null!=bM[bH][0]&&bM[bH][0]>bP.max||null==bP.max)&&(bP.max=bM[bH][0])):((null!=bM[bH][bJ]&&bM[bH][bJ]<bP.min||null==bP.min)&&(bP.min=bM[bH][bJ]),(null!=bM[bH][bI]&&bM[bH][bI]>bP.max||null==bP.max)&&(bP.max=bM[bH][bI]))}bL&&bN.renderer.constructor!==bF.jqplot.BarRenderer?bL=!1:bL&&this._options.hasOwnProperty("forceTickAt0")&&0==this._options.forceTickAt0?bL=!1:bL&&bN.renderer.constructor===bF.jqplot.BarRenderer&&("vertical"==bN.barDirection&&"xaxis"!=this.name&&"x2axis"!=this.name?(null!=this._options.pad||null!=this._options.padMin)&&(bL=!1):"horizontal"!=bN.barDirection||"xaxis"!=this.name&&"x2axis"!=this.name||(null!=this._options.pad||null!=this._options.padMin)&&(bL=!1))}}bL&&this.renderer.constructor===bF.jqplot.LinearAxisRenderer&&bP.min>=0&&(this.padMin=1,this.forceTickAt0=!0)},bD.prototype=new bF.jqplot.ElemContainer,bD.prototype.constructor=bD,bD.prototype.setOptions=function(bH){if(bF.extend(!0,this,bH),"inside"==this.placement&&(this.placement="insideGrid"),this.xoffset>0){if("insideGrid"==this.placement){switch(this.location){case"nw":case"w":case"sw":null==this.marginLeft&&(this.marginLeft=this.xoffset+"px"),this.marginRight="0px";break;case"ne":case"e":case"se":default:null==this.marginRight&&(this.marginRight=this.xoffset+"px"),this.marginLeft="0px"}}else{if("outside"==this.placement){switch(this.location){case"nw":case"w":case"sw":null==this.marginRight&&(this.marginRight=this.xoffset+"px"),this.marginLeft="0px";break;case"ne":case"e":case"se":default:null==this.marginLeft&&(this.marginLeft=this.xoffset+"px"),this.marginRight="0px"}}}this.xoffset=0}if(this.yoffset>0){if("outside"==this.placement){switch(this.location){case"sw":case"s":case"se":null==this.marginTop&&(this.marginTop=this.yoffset+"px"),this.marginBottom="0px";break;case"ne":case"n":case"nw":default:null==this.marginBottom&&(this.marginBottom=this.yoffset+"px"),this.marginTop="0px"}}else{if("insideGrid"==this.placement){switch(this.location){case"sw":case"s":case"se":null==this.marginBottom&&(this.marginBottom=this.yoffset+"px"),this.marginTop="0px";break;case"ne":case"n":case"nw":default:null==this.marginTop&&(this.marginTop=this.yoffset+"px"),this.marginBottom="0px"}}}this.yoffset=0}},bD.prototype.init=function(){bF.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bD.prototype.draw=function(bH,bJ){for(var bI=0;bI<bF.jqplot.preDrawLegendHooks.length;bI++){bF.jqplot.preDrawLegendHooks[bI].call(this,bH)}return this.renderer.draw.call(this,bH,bJ)},bD.prototype.pack=function(bH){this.renderer.pack.call(this,bH)},bC.prototype=new bF.jqplot.ElemContainer,bC.prototype.constructor=bC,bC.prototype.init=function(){bF.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bC.prototype.draw=function(bH){return this.renderer.draw.call(this,bH)},bC.prototype.pack=function(){this.renderer.pack.call(this)},bB.prototype=new bF.jqplot.ElemContainer,bB.prototype.constructor=bB,bB.prototype.init=function(bH,bO,bN){this.index=bH,this.gridBorderWidth=bO;var bM,bL,bK=this.data,bJ=[];for(bM=0,bL=bK.length;bL>bM;bM++){if(this.breakOnNull){bJ.push(bK[bM])}else{if(null==bK[bM]||null==bK[bM][0]||null==bK[bM][1]){continue}bJ.push(bK[bM])}}if(this.data=bJ,this.color||(this.color=bN.colorGenerator.get(this.index)),this.negativeColor||(this.negativeColor=bN.negativeColorGenerator.get(this.index)),this.fillColor||(this.fillColor=this.color),this.fillAlpha){var bI=bF.jqplot.normalize2rgb(this.fillColor),bI=bF.jqplot.getColorComponents(bI);this.fillColor="rgba("+bI[0]+","+bI[1]+","+bI[2]+","+this.fillAlpha+")"}bF.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions,bN),this.markerRenderer=new this.markerRenderer,this.markerOptions.color||(this.markerOptions.color=this.color),null==this.markerOptions.show&&(this.markerOptions.show=this.showMarker),this.showMarker=this.markerOptions.show,this.markerRenderer.init(this.markerOptions)},bB.prototype.draw=function(bH,bN,bM){var bL=bN==a9?{}:bN;bH=bH==a9?this.canvas._ctx:bH;var bK,bJ,bI;for(bK=0;bK<bF.jqplot.preDrawSeriesHooks.length;bK++){bF.jqplot.preDrawSeriesHooks[bK].call(this,bH,bL)}for(this.show&&(this.renderer.setGridData.call(this,bM),bL.preventJqPlotSeriesDrawTrigger||bF(bH.canvas).trigger("jqplotSeriesDraw",[this.data,this.gridData]),bJ=[],bJ=bL.data?bL.data:this._stack?this._plotData:this.data,bI=bL.gridData||this.renderer.makeGridData.call(this,bJ,bM),"line"===this._type&&this.renderer.smooth&&this.renderer._smoothedData.length&&(bI=this.renderer._smoothedData),this.renderer.draw.call(this,bH,bI,bL,bM)),bK=0;bK<bF.jqplot.postDrawSeriesHooks.length;bK++){bF.jqplot.postDrawSeriesHooks[bK].call(this,bH,bL,bM)}bH=bN=bM=bK=bJ=bI=null},bB.prototype.drawShadow=function(bH,bN,bM){var bL=bN==a9?{}:bN;bH=bH==a9?this.shadowCanvas._ctx:bH;var bK,bJ,bI;for(bK=0;bK<bF.jqplot.preDrawSeriesShadowHooks.length;bK++){bF.jqplot.preDrawSeriesShadowHooks[bK].call(this,bH,bL)}for(this.shadow&&(this.renderer.setGridData.call(this,bM),bJ=[],bJ=bL.data?bL.data:this._stack?this._plotData:this.data,bI=bL.gridData||this.renderer.makeGridData.call(this,bJ,bM),this.renderer.drawShadow.call(this,bH,bI,bL,bM)),bK=0;bK<bF.jqplot.postDrawSeriesShadowHooks.length;bK++){bF.jqplot.postDrawSeriesShadowHooks[bK].call(this,bH,bL)}bH=bN=bM=bK=bJ=bI=null},bB.prototype.toggleDisplay=function(bI,bH){var bK,bJ;bK=bI.data.series?bI.data.series:this,bI.data.speed&&(bJ=bI.data.speed),bJ?bK.canvas._elem.is(":hidden")||!bK.show?(bK.show=!0,bK.canvas._elem.removeClass("jqplot-series-hidden"),bK.shadowCanvas._elem&&bK.shadowCanvas._elem.fadeIn(bJ),bK.canvas._elem.fadeIn(bJ,bH),bK.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bK.index).fadeIn(bJ)):(bK.show=!1,bK.canvas._elem.addClass("jqplot-series-hidden"),bK.shadowCanvas._elem&&bK.shadowCanvas._elem.fadeOut(bJ),bK.canvas._elem.fadeOut(bJ,bH),bK.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bK.index).fadeOut(bJ)):bK.canvas._elem.is(":hidden")||!bK.show?(bK.show=!0,bK.canvas._elem.removeClass("jqplot-series-hidden"),bK.shadowCanvas._elem&&bK.shadowCanvas._elem.show(),bK.canvas._elem.show(0,bH),bK.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bK.index).show()):(bK.show=!1,bK.canvas._elem.addClass("jqplot-series-hidden"),bK.shadowCanvas._elem&&bK.shadowCanvas._elem.hide(),bK.canvas._elem.hide(0,bH),bK.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+bK.index).hide())},bA.prototype=new bF.jqplot.ElemContainer,bA.prototype.constructor=bA,bA.prototype.init=function(){bF.isFunction(this.renderer)&&(this.renderer=new this.renderer),this.renderer.init.call(this,this.rendererOptions)},bA.prototype.createElement=function(bI,bH){return this._offsets=bI,this.renderer.createElement.call(this,bH)},bA.prototype.draw=function(){this.renderer.draw.call(this)},bF.jqplot.GenericCanvas=function(){bF.jqplot.ElemContainer.call(this),this._ctx},bF.jqplot.GenericCanvas.prototype=new bF.jqplot.ElemContainer,bF.jqplot.GenericCanvas.prototype.constructor=bF.jqplot.GenericCanvas,bF.jqplot.GenericCanvas.prototype.createElement=function(bH,bM,bL,bK){this._offsets=bH;var bJ="jqplot";bM!=a9&&(bJ=bM);var bI;return bI=bK.canvasManager.getCanvas(),null!=bL&&(this._plotDimensions=bL),bI.width=this._plotDimensions.width-this._offsets.left-this._offsets.right,bI.height=this._plotDimensions.height-this._offsets.top-this._offsets.bottom,this._elem=bF(bI),this._elem.css({position:"absolute",left:this._offsets.left,top:this._offsets.top}),this._elem.addClass(bJ),bI=bK.canvasManager.initCanvas(bI),bI=null,this._elem},bF.jqplot.GenericCanvas.prototype.setContext=function(){return this._ctx=this._elem.get(0).getContext("2d"),this._ctx},bF.jqplot.GenericCanvas.prototype.resetCanvas=function(){this._elem&&(bF.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a9&&window.G_vmlCanvasManager.uninitElement(this._elem.get(0)),this._elem.emptyForce()),this._ctx=null},bF.jqplot.HooksManager=function(){this.hooks=[],this.args=[]},bF.jqplot.HooksManager.prototype.addOnce=function(bI,bH){bH=bH||[];for(var bL=!1,bK=0,bJ=this.hooks.length;bJ>bK;bK++){this.hooks[bK]==bI&&(bL=!0)}bL||(this.hooks.push(bI),this.args.push(bH))},bF.jqplot.HooksManager.prototype.add=function(bI,bH){bH=bH||[],this.hooks.push(bI),this.args.push(bH)},bF.jqplot.EventListenerManager=function(){this.hooks=[]},bF.jqplot.EventListenerManager.prototype.addOnce=function(bI,bH){for(var bM,bL,bK=!1,bL=0,bJ=this.hooks.length;bJ>bL;bL++){bM=this.hooks[bL],bM[0]==bI&&bM[1]==bH&&(bK=!0)}bK||this.hooks.push([bI,bH])},bF.jqplot.EventListenerManager.prototype.add=function(bI,bH){this.hooks.push([bI,bH])};var a8=["yMidAxis","xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];bF.jqplot.computeHighlightColors=function(bH){var bN;if(bF.isArray(bH)){bN=[];for(var bM=0;bM<bH.length;bM++){for(var bL=bF.jqplot.getColorComponents(bH[bM]),bK=[bL[0],bL[1],bL[2]],bJ=bK[0]+bK[1]+bK[2],bI=0;3>bI;bI++){bK[bI]=bJ>660?0.85*bK[bI]:0.73*bK[bI]+90,bK[bI]=parseInt(bK[bI],10),bK[bI]>255?255:bK[bI]}bK[3]=0.3+0.35*bL[3],bN.push("rgba("+bK[0]+","+bK[1]+","+bK[2]+","+bK[3]+")")}}else{for(var bL=bF.jqplot.getColorComponents(bH),bK=[bL[0],bL[1],bL[2]],bJ=bK[0]+bK[1]+bK[2],bI=0;3>bI;bI++){bK[bI]=bJ>660?0.85*bK[bI]:0.73*bK[bI]+90,bK[bI]=parseInt(bK[bI],10),bK[bI]>255?255:bK[bI]}bK[3]=0.3+0.35*bL[3],bN="rgba("+bK[0]+","+bK[1]+","+bK[2]+","+bK[3]+")"}return bN},bF.jqplot.ColorGenerator=function(bH){bH=bH||bF.jqplot.config.defaultColors;var bI=0;this.next=function(){return bI<bH.length?bH[bI++]:(bI=0,bH[bI++])},this.previous=function(){return bI>0?bH[bI--]:(bI=bH.length-1,bH[bI])},this.get=function(bJ){var bK=bJ-bH.length*Math.floor(bJ/bH.length);return bH[bK]},this.setColors=function(bJ){bH=bJ},this.reset=function(){bI=0},this.getIndex=function(){return bI},this.setIndex=function(bJ){bI=bJ}},bF.jqplot.hex2rgb=function(bI,bH){bI=bI.replace("#",""),3==bI.length&&(bI=bI.charAt(0)+bI.charAt(0)+bI.charAt(1)+bI.charAt(1)+bI.charAt(2)+bI.charAt(2));var bJ;return bJ="rgba("+parseInt(bI.slice(0,2),16)+", "+parseInt(bI.slice(2,4),16)+", "+parseInt(bI.slice(4,6),16),bH&&(bJ+=", "+bH),bJ+=")"},bF.jqplot.rgb2hex=function(bI){for(var bH=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *(?:, *[0-9.]*)?\)/,bM=bI.match(bH),bL="#",bK=1;4>bK;bK++){var bJ;-1!=bM[bK].search(/%/)?(bJ=parseInt(255*bM[bK]/100,10).toString(16),1==bJ.length&&(bJ="0"+bJ)):(bJ=parseInt(bM[bK],10).toString(16),1==bJ.length&&(bJ="0"+bJ)),bL+=bJ}return bL},bF.jqplot.normalize2rgb=function(bH,bI){if(-1!=bH.search(/^ *rgba?\(/)){return bH}if(-1!=bH.search(/^ *#?[0-9a-fA-F]?[0-9a-fA-F]/)){return bF.jqplot.hex2rgb(bH,bI)}throw new Error("Invalid color spec")},bF.jqplot.getColorComponents=function(bH){bH=bF.jqplot.colorKeywordMap[bH]||bH;for(var bM=bF.jqplot.normalize2rgb(bH),bL=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *,? *([0-9.]* *)?\)/,bK=bM.match(bL),bJ=[],bI=1;4>bI;bI++){-1!=bK[bI].search(/%/)?bJ[bI-1]=parseInt(255*bK[bI]/100,10):bJ[bI-1]=parseInt(bK[bI],10)}return bJ[3]=parseFloat(bK[4])?parseFloat(bK[4]):1,bJ},bF.jqplot.colorKeywordMap={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb( 0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb( 0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb( 0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb( 95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb( 0, 255, 255)",darkblue:"rgb( 0, 0, 139)",darkcyan:"rgb( 0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb( 0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb( 85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb( 72, 61, 139)",darkslategray:"rgb( 47, 79, 79)",darkslategrey:"rgb( 47, 79, 79)",darkturquoise:"rgb( 0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb( 0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb( 30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb( 34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb( 0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb( 75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb( 32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb( 0, 255, 0)",limegreen:"rgb( 50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb( 0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb( 60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb( 0, 250, 154)",mediumturquoise:"rgb( 72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb( 25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb( 0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb( 65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb( 46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb( 0, 255, 127)",steelblue:"rgb( 70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb( 0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb( 64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)"},bF.jqplot.AxisLabelRenderer=function(bH){bF.jqplot.ElemContainer.call(this),this.axis,this.show=!0,this.label="",this.fontFamily=null,this.fontSize=null,this.textColor=null,this._elem,this.escapeHTML=!1,bF.extend(!0,this,bH)},bF.jqplot.AxisLabelRenderer.prototype=new bF.jqplot.ElemContainer,bF.jqplot.AxisLabelRenderer.prototype.constructor=bF.jqplot.AxisLabelRenderer,bF.jqplot.AxisLabelRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.AxisLabelRenderer.prototype.draw=function(bH,bI){return this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bF('<div style="position:absolute;" class="jqplot-'+this.axis+'-label"></div>'),Number(this.label)&&this._elem.css("white-space","nowrap"),this.escapeHTML?this._elem.text(this.label):this._elem.html(this.label),this.fontFamily&&this._elem.css("font-family",this.fontFamily),this.fontSize&&this._elem.css("font-size",this.fontSize),this.textColor&&this._elem.css("color",this.textColor),this._elem},bF.jqplot.AxisLabelRenderer.prototype.pack=function(){},bF.jqplot.AxisTickRenderer=function(bH){bF.jqplot.ElemContainer.call(this),this.mark="outside",this.axis,this.showMark=!0,this.showGridline=!0,this.isMinorTick=!1,this.size=4,this.markSize=6,this.show=!0,this.showLabel=!0,this.label=null,this.value=null,this._styles={},this.formatter=bF.jqplot.DefaultTickFormatter,this.prefix="",this.suffix="",this.formatString="",this.fontFamily,this.fontSize,this.textColor,this.escapeHTML=!1,this._elem,this._breakTick=!1,bF.extend(!0,this,bH)},bF.jqplot.AxisTickRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.AxisTickRenderer.prototype=new bF.jqplot.ElemContainer,bF.jqplot.AxisTickRenderer.prototype.constructor=bF.jqplot.AxisTickRenderer,bF.jqplot.AxisTickRenderer.prototype.setTick=function(bI,bH,bJ){return this.value=bI,this.axis=bH,bJ&&(this.isMinorTick=!0),this},bF.jqplot.AxisTickRenderer.prototype.draw=function(){null===this.label&&(this.label=this.prefix+this.formatter(this.formatString,this.value)+this.suffix);var bH={position:"absolute"};Number(this.label)&&(bH.whitSpace="nowrap"),this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bF(document.createElement("div")),this._elem.addClass("jqplot-"+this.axis+"-tick"),this.escapeHTML?this._elem.text(this.label):this._elem.html(this.label),this._elem.css(bH);for(var bI in this._styles){this._elem.css(bI,this._styles[bI])}return this.fontFamily&&this._elem.css("font-family",this.fontFamily),this.fontSize&&this._elem.css("font-size",this.fontSize),this.textColor&&this._elem.css("color",this.textColor),this._breakTick&&this._elem.addClass("jqplot-breakTick"),this._elem},bF.jqplot.DefaultTickFormatter=function(bH,bI){return"number"==typeof bI?(bH||(bH=bF.jqplot.config.defaultTickFormatString),bF.jqplot.sprintf(bH,bI)):String(bI)},bF.jqplot.PercentTickFormatter=function(bH,bI){return"number"==typeof bI?(bI=100*bI,bH||(bH=bF.jqplot.config.defaultTickFormatString),bF.jqplot.sprintf(bH,bI)):String(bI)},bF.jqplot.AxisTickRenderer.prototype.pack=function(){},bF.jqplot.CanvasGridRenderer=function(){this.shadowRenderer=new bF.jqplot.ShadowRenderer},bF.jqplot.CanvasGridRenderer.prototype.init=function(bH){this._ctx,bF.extend(!0,this,bH);var bI={lineJoin:"miter",lineCap:"round",fill:!1,isarc:!1,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.shadowWidth,closePath:!1,strokeStyle:this.shadowColor};this.renderer.shadowRenderer.init(bI)},bF.jqplot.CanvasGridRenderer.prototype.createElement=function(bH){var bK;this._elem&&(bF.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==a9&&(bK=this._elem.get(0),window.G_vmlCanvasManager.uninitElement(bK),bK=null),this._elem.emptyForce(),this._elem=null),bK=bH.canvasManager.getCanvas();var bJ=this._plotDimensions.width,bI=this._plotDimensions.height;return bK.width=bJ,bK.height=bI,this._elem=bF(bK),this._elem.addClass("jqplot-grid-canvas"),this._elem.css({position:"absolute",left:0,top:0}),bK=bH.canvasManager.initCanvas(bK),this._top=this._offsets.top,this._bottom=bI-this._offsets.bottom,this._left=this._offsets.left,this._right=bJ-this._offsets.right,this._width=this._right-this._left,this._height=this._bottom-this._top,bK=null,this._elem},bF.jqplot.CanvasGridRenderer.prototype.draw=function(){function b1(b2,b6,b5,b4,b3){b0.save(),b3=b3||{},(null==b3.lineWidth||0!=b3.lineWidth)&&(bF.extend(!0,b0,b3),b0.beginPath(),b0.moveTo(b2,b6),b0.lineTo(b5,b4),b0.stroke(),b0.restore())}this._ctx=this._elem.get(0).getContext("2d");var b0=this._ctx,bZ=this._axes;b0.save(),b0.clearRect(0,0,this._plotDimensions.width,this._plotDimensions.height),b0.fillStyle=this.backgroundColor||this.background,b0.fillRect(this._left,this._top,this._width,this._height),b0.save(),b0.lineJoin="miter",b0.lineCap="butt",b0.lineWidth=this.gridLineWidth,b0.strokeStyle=this.gridLineColor;for(var bY,bX,bW,bV,bU=["xaxis","yaxis","x2axis","y2axis"],bT=4;bT>0;bT--){var bS=bU[bT-1],bR=bZ[bS],bQ=bR._ticks,bP=bQ.length;if(bR.show){if(bR.drawBaseline){var bO={};switch(null!==bR.baselineWidth&&(bO.lineWidth=bR.baselineWidth),null!==bR.baselineColor&&(bO.strokeStyle=bR.baselineColor),bS){case"xaxis":b1(this._left,this._bottom,this._right,this._bottom,bO);break;case"yaxis":b1(this._left,this._bottom,this._left,this._top,bO);break;case"x2axis":b1(this._left,this._bottom,this._right,this._bottom,bO);break;case"y2axis":b1(this._right,this._bottom,this._right,this._top,bO)}}for(var bN=bP;bN>0;bN--){var bM=bQ[bN-1];if(bM.show){var bL=Math.round(bR.u2p(bM.value))+0.5;switch(bS){case"xaxis":if(bM.showGridline&&this.drawGridlines&&(!bM.isMinorTick&&bR.drawMajorGridlines||bM.isMinorTick&&bR.drawMinorGridlines)&&b1(bL,this._top,bL,this._bottom),bM.showMark&&bM.mark&&(!bM.isMinorTick&&bR.drawMajorTickMarks||bM.isMinorTick&&bR.drawMinorTickMarks)){bW=bM.markSize,bV=bM.mark;var bL=Math.round(bR.u2p(bM.value))+0.5;switch(bV){case"outside":bY=this._bottom,bX=this._bottom+bW;break;case"inside":bY=this._bottom-bW,bX=this._bottom;break;case"cross":bY=this._bottom-bW,bX=this._bottom+bW;break;default:bY=this._bottom,bX=this._bottom+bW}this.shadow&&this.renderer.shadowRenderer.draw(b0,[[bL,bY],[bL,bX]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:0.75*this.gridLineWidth,depth:2,fill:!1,closePath:!1}),b1(bL,bY,bL,bX)}break;case"yaxis":if(bM.showGridline&&this.drawGridlines&&(!bM.isMinorTick&&bR.drawMajorGridlines||bM.isMinorTick&&bR.drawMinorGridlines)&&b1(this._right,bL,this._left,bL),bM.showMark&&bM.mark&&(!bM.isMinorTick&&bR.drawMajorTickMarks||bM.isMinorTick&&bR.drawMinorTickMarks)){bW=bM.markSize,bV=bM.mark;var bL=Math.round(bR.u2p(bM.value))+0.5;switch(bV){case"outside":bY=this._left-bW,bX=this._left;break;case"inside":bY=this._left,bX=this._left+bW;break;case"cross":bY=this._left-bW,bX=this._left+bW;break;default:bY=this._left-bW,bX=this._left}this.shadow&&this.renderer.shadowRenderer.draw(b0,[[bY,bL],[bX,bL]],{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b1(bY,bL,bX,bL,{strokeStyle:bR.borderColor})}break;case"x2axis":if(bM.showGridline&&this.drawGridlines&&(!bM.isMinorTick&&bR.drawMajorGridlines||bM.isMinorTick&&bR.drawMinorGridlines)&&b1(bL,this._bottom,bL,this._top),bM.showMark&&bM.mark&&(!bM.isMinorTick&&bR.drawMajorTickMarks||bM.isMinorTick&&bR.drawMinorTickMarks)){bW=bM.markSize,bV=bM.mark;var bL=Math.round(bR.u2p(bM.value))+0.5;switch(bV){case"outside":bY=this._top-bW,bX=this._top;break;case"inside":bY=this._top,bX=this._top+bW;break;case"cross":bY=this._top-bW,bX=this._top+bW;break;default:bY=this._top-bW,bX=this._top}this.shadow&&this.renderer.shadowRenderer.draw(b0,[[bL,bY],[bL,bX]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:0.75*this.gridLineWidth,depth:2,fill:!1,closePath:!1}),b1(bL,bY,bL,bX)}break;case"y2axis":if(bM.showGridline&&this.drawGridlines&&(!bM.isMinorTick&&bR.drawMajorGridlines||bM.isMinorTick&&bR.drawMinorGridlines)&&b1(this._left,bL,this._right,bL),bM.showMark&&bM.mark&&(!bM.isMinorTick&&bR.drawMajorTickMarks||bM.isMinorTick&&bR.drawMinorTickMarks)){bW=bM.markSize,bV=bM.mark;var bL=Math.round(bR.u2p(bM.value))+0.5;switch(bV){case"outside":bY=this._right,bX=this._right+bW;break;case"inside":bY=this._right-bW,bX=this._right;break;case"cross":bY=this._right-bW,bX=this._right+bW;break;default:bY=this._right,bX=this._right+bW}this.shadow&&this.renderer.shadowRenderer.draw(b0,[[bY,bL],[bX,bL]],{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b1(bY,bL,bX,bL,{strokeStyle:bR.borderColor})}}}}bM=null}bR=null,bQ=null}bU=["y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];for(var bT=7;bT>0;bT--){var bR=bZ[bU[bT-1]],bQ=bR._ticks;if(bR.show){var bK=bQ[bR.numberTicks-1],bJ=bQ[0],bI=bR.getLeft(),bH=[[bI,bK.getTop()+bK.getHeight()/2],[bI,bJ.getTop()+bJ.getHeight()/2+1]];this.shadow&&this.renderer.shadowRenderer.draw(b0,bH,{lineCap:"butt",fill:!1,closePath:!1}),b1(bH[0][0],bH[0][1],bH[1][0],bH[1][1],{lineCap:"butt",strokeStyle:bR.borderColor,lineWidth:bR.borderWidth});for(var bN=bQ.length;bN>0;bN--){var bM=bQ[bN-1];bW=bM.markSize,bV=bM.mark;var bL=Math.round(bR.u2p(bM.value))+0.5;if(bM.showMark&&bM.mark){switch(bV){case"outside":bY=bI,bX=bI+bW;break;case"inside":bY=bI-bW,bX=bI;break;case"cross":bY=bI-bW,bX=bI+bW;break;default:bY=bI,bX=bI+bW}bH=[[bY,bL],[bX,bL]],this.shadow&&this.renderer.shadowRenderer.draw(b0,bH,{lineCap:"butt",lineWidth:1.5*this.gridLineWidth,offset:0.75*this.gridLineWidth,fill:!1,closePath:!1}),b1(bY,bL,bX,bL,{strokeStyle:bR.borderColor})}bM=null}bJ=null}bR=null,bQ=null}if(b0.restore(),this.shadow){var bH=[[this._left,this._bottom],[this._right,this._bottom],[this._right,this._top]];this.renderer.shadowRenderer.draw(b0,bH)}0!=this.borderWidth&&this.drawBorder&&(b1(this._left,this._top,this._right,this._top,{lineCap:"round",strokeStyle:bZ.x2axis.borderColor,lineWidth:bZ.x2axis.borderWidth}),b1(this._right,this._top,this._right,this._bottom,{lineCap:"round",strokeStyle:bZ.y2axis.borderColor,lineWidth:bZ.y2axis.borderWidth}),b1(this._right,this._bottom,this._left,this._bottom,{lineCap:"round",strokeStyle:bZ.xaxis.borderColor,lineWidth:bZ.xaxis.borderWidth}),b1(this._left,this._bottom,this._left,this._top,{lineCap:"round",strokeStyle:bZ.yaxis.borderColor,lineWidth:bZ.yaxis.borderWidth})),b0.restore(),b0=null,bZ=null},bF.jqplot.DivTitleRenderer=function(){},bF.jqplot.DivTitleRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.DivTitleRenderer.prototype.draw=function(){this._elem&&(this._elem.emptyForce(),this._elem=null);var bH=(this.renderer,document.createElement("div"));if(this._elem=bF(bH),this._elem.addClass("jqplot-title"),this.text){if(this.text){var bJ;this.color?bJ=this.color:this.textColor&&(bJ=this.textColor);var bI={position:"absolute",top:"0px",left:"0px"};this._plotWidth&&(bI.width=this._plotWidth+"px"),this.fontSize&&(bI.fontSize=this.fontSize),"string"==typeof this.textAlign?bI.textAlign=this.textAlign:bI.textAlign="center",bJ&&(bI.color=bJ),this.paddingBottom&&(bI.paddingBottom=this.paddingBottom),this.fontFamily&&(bI.fontFamily=this.fontFamily),this._elem.css(bI),this.escapeHtml?this._elem.text(this.text):this._elem.html(this.text)}}else{this.show=!1,this._elem.height(0),this._elem.width(0)}return bH=null,this._elem},bF.jqplot.DivTitleRenderer.prototype.pack=function(){};var a7=0.1;bF.jqplot.LinePattern=function(bW,bV){var bU={dotted:[a7,bF.jqplot.config.dotGapLength],dashed:[bF.jqplot.config.dashLength,bF.jqplot.config.gapLength],solid:null};if("string"==typeof bV){if("."===bV[0]||"-"===bV[0]){var bT=bV;bV=[];for(var bS=0,bR=bT.length;bR>bS;bS++){if("."===bT[bS]){bV.push(a7)}else{if("-"!==bT[bS]){continue}bV.push(bF.jqplot.config.dashLength)}bV.push(bF.jqplot.config.gapLength)}}else{bV=bU[bV]}}if(!bV||!bV.length){return bW}var bQ=0,bP=bV[0],bO=0,bN=0,bM=0,bL=0,bK=function(bX,bY){bW.moveTo(bX,bY),bO=bX,bN=bY,bM=bX,bL=bY},bJ=function(bZ,b3){var b2=bW.lineWidth,b1=bZ-bO,b0=b3-bN,bY=Math.sqrt(b1*b1+b0*b0);if(bY>0&&b2>0){for(b1/=bY,b0/=bY;;){var bX=b2*bP;if(!(bY>bX)){bO=bZ,bN=b3,0==(1&bQ)?bW.lineTo(bO,bN):bW.moveTo(bO,bN),bP-=bY/b2;break}bO+=bX*b1,bN+=bX*b0,0==(1&bQ)?bW.lineTo(bO,bN):bW.moveTo(bO,bN),bY-=bX,bQ++,bQ>=bV.length&&(bQ=0),bP=bV[bQ]}}},bI=function(){bW.beginPath()},bH=function(){bJ(bM,bL)};return{moveTo:bK,lineTo:bJ,beginPath:bI,closePath:bH}},bF.jqplot.LineRenderer=function(){this.shapeRenderer=new bF.jqplot.ShapeRenderer,this.shadowRenderer=new bF.jqplot.ShadowRenderer},bF.jqplot.LineRenderer.prototype.init=function(bH,bN){bH=bH||{},this._type="line",this.renderer.animation={show:!1,direction:"left",speed:2500,_supported:!0},this.renderer.smooth=!1,this.renderer.tension=null,this.renderer.constrainSmoothing=!0,this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[],this.renderer.bandData=[],this.renderer.bands={show:!1,hiData:[],lowData:[],color:this.color,showLines:!1,fill:!0,fillColor:null,_min:null,_max:null,interval:"3%"};var bM={highlightMouseOver:bH.highlightMouseOver,highlightMouseDown:bH.highlightMouseDown,highlightColor:bH.highlightColor};delete bH.highlightMouseOver,delete bH.highlightMouseDown,delete bH.highlightColor,bF.extend(!0,this.renderer,bH),this.renderer.options=bH,this.renderer.bandData.length>1&&(!bH.bands||null==bH.bands.show)?this.renderer.bands.show=!0:bH.bands&&null==bH.bands.show&&null!=bH.bands.interval&&(this.renderer.bands.show=!0),this.fill&&(this.renderer.bands.show=!1),this.renderer.bands.show&&this.renderer.initBands.call(this,this.renderer.options,bN),this._stack&&(this.renderer.smooth=!1);var bL={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:!1,strokeStyle:this.color,fillStyle:this.fillColor,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};this.renderer.shapeRenderer.init(bL);var bK=bH.shadowOffset;null==bK&&(bK=this.lineWidth>2.5?1.25*(1+0.6*(Math.atan(this.lineWidth/2.5)/0.785398163-1)):1.25*Math.atan(this.lineWidth/2.5)/0.785398163);var bJ={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:!1,angle:this.shadowAngle,offset:bK,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};if(this.renderer.shadowRenderer.init(bJ),this._areaPoints=[],this._boundingBox=[[],[]],!this.isTrendline&&this.fill||this.renderer.bands.show){if(this.highlightMouseOver=!0,this.highlightMouseDown=!1,this.highlightColor=null,bM.highlightMouseDown&&null==bM.highlightMouseOver&&(bM.highlightMouseOver=!1),bF.extend(!0,this,{highlightMouseOver:bM.highlightMouseOver,highlightMouseDown:bM.highlightMouseDown,highlightColor:bM.highlightColor}),!this.highlightColor){var bI=this.renderer.bands.show?this.renderer.bands.fillColor:this.fillColor;this.highlightColor=bF.jqplot.computeHighlightColors(bI)}this.highlighter&&(this.highlighter.show=!1)}!this.isTrendline&&bN&&(bN.plugins.lineRenderer={},bN.postInitHooks.addOnce(bu),bN.postDrawHooks.addOnce(bt),bN.eventListenerHooks.addOnce("jqplotMouseMove",bq),bN.eventListenerHooks.addOnce("jqplotMouseDown",bp),bN.eventListenerHooks.addOnce("jqplotMouseUp",bo),bN.eventListenerHooks.addOnce("jqplotClick",bn),bN.eventListenerHooks.addOnce("jqplotRightClick",bm))},bF.jqplot.LineRenderer.prototype.initBands=function(b1,b0){var bZ=b1.bandData||[],bY=this.renderer.bands;bY.hiData=[],bY.lowData=[];var bX=this.data;if(bY._max=null,bY._min=null,2==bZ.length){if(bF.isArray(bZ[0][0])){for(var bW,bV=0,bU=0,bT=0,bS=bZ[0].length;bS>bT;bT++){bW=bZ[0][bT],(null!=bW[1]&&bW[1]>bY._max||null==bY._max)&&(bY._max=bW[1]),(null!=bW[1]&&bW[1]<bY._min||null==bY._min)&&(bY._min=bW[1])}for(var bT=0,bS=bZ[1].length;bS>bT;bT++){bW=bZ[1][bT],(null!=bW[1]&&bW[1]>bY._max||null==bY._max)&&(bY._max=bW[1],bU=1),(null!=bW[1]&&bW[1]<bY._min||null==bY._min)&&(bY._min=bW[1],bV=1)}bU===bV&&(bY.show=!1),bY.hiData=bZ[bU],bY.lowData=bZ[bV]}else{if(bZ[0].length===bX.length&&bZ[1].length===bX.length){for(var bR=bZ[0][0]>bZ[1][0]?0:1,bQ=bR?0:1,bT=0,bS=bX.length;bS>bT;bT++){bY.hiData.push([bX[bT][0],bZ[bR][bT]]),bY.lowData.push([bX[bT][0],bZ[bQ][bT]])}}else{bY.show=!1}}}else{if(bZ.length>2&&!bF.isArray(bZ[0][0])){for(var bR=bZ[0][0]>bZ[0][1]?0:1,bQ=bR?0:1,bT=0,bS=bZ.length;bS>bT;bT++){bY.hiData.push([bX[bT][0],bZ[bT][bR]]),bY.lowData.push([bX[bT][0],bZ[bT][bQ]])}}else{var bP=bY.interval,bO=null,bN=null,bM=null,bL=null;if(bF.isArray(bP)?(bO=bP[0],bN=bP[1]):bO=bP,isNaN(bO)?"%"===bO.charAt(bO.length-1)&&(bM="multiply",bO=parseFloat(bO)/100+1):(bO=parseFloat(bO),bM="add"),null!==bN&&isNaN(bN)?"%"===bN.charAt(bN.length-1)&&(bL="multiply",bN=parseFloat(bN)/100+1):null!==bN&&(bN=parseFloat(bN),bL="add"),null!==bO){if(null===bN&&(bN=-bO,bL=bM,"multiply"===bL&&(bN+=2)),bN>bO){var bK=bO;bO=bN,bN=bK,bK=bM,bM=bL,bL=bK}for(var bT=0,bS=bX.length;bS>bT;bT++){switch(bM){case"add":bY.hiData.push([bX[bT][0],bX[bT][1]+bO]);break;case"multiply":bY.hiData.push([bX[bT][0],bX[bT][1]*bO])}switch(bL){case"add":bY.lowData.push([bX[bT][0],bX[bT][1]+bN]);break;case"multiply":bY.lowData.push([bX[bT][0],bX[bT][1]*bN])}}}else{bY.show=!1}}}for(var bJ=bY.hiData,bI=bY.lowData,bT=0,bS=bJ.length;bS>bT;bT++){(null!=bJ[bT][1]&&bJ[bT][1]>bY._max||null==bY._max)&&(bY._max=bJ[bT][1])}for(var bT=0,bS=bI.length;bS>bT;bT++){(null!=bI[bT][1]&&bI[bT][1]<bY._min||null==bY._min)&&(bY._min=bI[bT][1])}if(null===bY.fillColor){var bH=bF.jqplot.getColorComponents(bY.color);bH[3]=0.5*bH[3],bY.fillColor="rgba("+bH[0]+", "+bH[1]+", "+bH[2]+", "+bH[3]+")"}},bF.jqplot.LineRenderer.prototype.setGridData=function(bQ){var bP=this._xaxis.series_u2p,bO=this._yaxis.series_u2p,bN=this._plotData,bM=this._prevPlotData;this.gridData=[],this._prevGridData=[],this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[];for(var bL=this.renderer.bands,bK=!1,bJ=0,bI=bN.length;bI>bJ;bJ++){null!=bN[bJ][0]&&null!=bN[bJ][1]?this.gridData.push([bP.call(this._xaxis,bN[bJ][0]),bO.call(this._yaxis,bN[bJ][1])]):null==bN[bJ][0]?(bK=!0,this.gridData.push([null,bO.call(this._yaxis,bN[bJ][1])])):null==bN[bJ][1]&&(bK=!0,this.gridData.push([bP.call(this._xaxis,bN[bJ][0]),null])),null!=bM[bJ]&&null!=bM[bJ][0]&&null!=bM[bJ][1]?this._prevGridData.push([bP.call(this._xaxis,bM[bJ][0]),bO.call(this._yaxis,bM[bJ][1])]):null!=bM[bJ]&&null==bM[bJ][0]?this._prevGridData.push([null,bO.call(this._yaxis,bM[bJ][1])]):null!=bM[bJ]&&null!=bM[bJ][0]&&null==bM[bJ][1]&&this._prevGridData.push([bP.call(this._xaxis,bM[bJ][0]),null])}if(bK&&(this.renderer.smooth=!1,"line"===this._type&&(bL.show=!1)),"line"===this._type&&bL.show){for(var bJ=0,bI=bL.hiData.length;bI>bJ;bJ++){this.renderer._hiBandGridData.push([bP.call(this._xaxis,bL.hiData[bJ][0]),bO.call(this._yaxis,bL.hiData[bJ][1])])}for(var bJ=0,bI=bL.lowData.length;bI>bJ;bJ++){this.renderer._lowBandGridData.push([bP.call(this._xaxis,bL.lowData[bJ][0]),bO.call(this._yaxis,bL.lowData[bJ][1])])}}if("line"===this._type&&this.renderer.smooth&&this.gridData.length>2){var bH;this.renderer.constrainSmoothing?(bH=bw.call(this,this.gridData),this.renderer._smoothedData=bH[0],this.renderer._smoothedPlotData=bH[1],bL.show&&(bH=bw.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bH[0],bH=bw.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bH[0]),bH=null):(bH=bv.call(this,this.gridData),this.renderer._smoothedData=bH[0],this.renderer._smoothedPlotData=bH[1],bL.show&&(bH=bv.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bH[0],bH=bv.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bH[0]),bH=null)}},bF.jqplot.LineRenderer.prototype.makeGridData=function(bQ,bP){var bO=this._xaxis.series_u2p,bN=this._yaxis.series_u2p,bM=[];this.renderer._smoothedData=[],this.renderer._smoothedPlotData=[],this.renderer._hiBandGridData=[],this.renderer._lowBandGridData=[],this.renderer._hiBandSmoothedData=[],this.renderer._lowBandSmoothedData=[];for(var bL=this.renderer.bands,bK=!1,bJ=0;bJ<bQ.length;bJ++){null!=bQ[bJ][0]&&null!=bQ[bJ][1]?(this.step&&bJ>0&&bM.push([bO.call(this._xaxis,bQ[bJ][0]),bN.call(this._yaxis,bQ[bJ-1][1])]),bM.push([bO.call(this._xaxis,bQ[bJ][0]),bN.call(this._yaxis,bQ[bJ][1])])):null==bQ[bJ][0]?(bK=!0,bM.push([null,bN.call(this._yaxis,bQ[bJ][1])])):null==bQ[bJ][1]&&(bK=!0,bM.push([bO.call(this._xaxis,bQ[bJ][0]),null]))}if(bK&&(this.renderer.smooth=!1,"line"===this._type&&(bL.show=!1)),"line"===this._type&&bL.show){for(var bJ=0,bI=bL.hiData.length;bI>bJ;bJ++){this.renderer._hiBandGridData.push([bO.call(this._xaxis,bL.hiData[bJ][0]),bN.call(this._yaxis,bL.hiData[bJ][1])])}for(var bJ=0,bI=bL.lowData.length;bI>bJ;bJ++){this.renderer._lowBandGridData.push([bO.call(this._xaxis,bL.lowData[bJ][0]),bN.call(this._yaxis,bL.lowData[bJ][1])])}}if("line"===this._type&&this.renderer.smooth&&bM.length>2){var bH;this.renderer.constrainSmoothing?(bH=bw.call(this,bM),this.renderer._smoothedData=bH[0],this.renderer._smoothedPlotData=bH[1],bL.show&&(bH=bw.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bH[0],bH=bw.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bH[0]),bH=null):(bH=bv.call(this,bM),this.renderer._smoothedData=bH[0],this.renderer._smoothedPlotData=bH[1],bL.show&&(bH=bv.call(this,this.renderer._hiBandGridData),this.renderer._hiBandSmoothedData=bH[0],bH=bv.call(this,this.renderer._lowBandGridData),this.renderer._lowBandSmoothedData=bH[0]),bH=null)}return bM},bF.jqplot.LineRenderer.prototype.draw=function(b9,b8,b7,b6){var b5,b4,b3,b2,b1,b0=bF.extend(!0,{},b7),bZ=b0.shadow!=a9?b0.shadow:this.shadow,bY=b0.showLine!=a9?b0.showLine:this.showLine,bX=b0.fill!=a9?b0.fill:this.fill,bW=b0.fillAndStroke!=a9?b0.fillAndStroke:this.fillAndStroke;if(b9.save(),b8.length){if(bY){if(bX){if(this.fillToZero){var bV=this.negativeColor;this.useNegativeColors||(bV=b0.fillStyle);var bT=!1,bR=b0.fillStyle;if(bW){var bP=b8.slice(0)}if(0!=this.index&&this._stack){for(var bN=this._prevGridData,b5=bN.length;b5>0;b5--){b8.push(bN[b5-1])}bZ&&this.renderer.shadowRenderer.draw(b9,b8,b0),this._areaPoints=b8,this.renderer.shapeRenderer.draw(b9,b8,b0)}else{var bM=[],bL=this.renderer.smooth?this.renderer._smoothedPlotData:this._plotData;this._areaPoints=[];var bK=this._yaxis.series_u2p(this.fillToValue);this._xaxis.series_u2p(this.fillToValue);if(b0.closePath=!0,"y"==this.fillAxis){bM.push([b8[0][0],bK]),this._areaPoints.push([b8[0][0],bK]);for(var b5=0;b5<b8.length-1;b5++){if(bM.push(b8[b5]),this._areaPoints.push(b8[b5]),bL[b5][1]*bL[b5+1][1]<=0){bL[b5][1]<0?(bT=!0,b0.fillStyle=bV):(bT=!1,b0.fillStyle=bR);var bJ=b8[b5][0]+(b8[b5+1][0]-b8[b5][0])*(bK-b8[b5][1])/(b8[b5+1][1]-b8[b5][1]);bM.push([bJ,bK]),this._areaPoints.push([bJ,bK]),bZ&&this.renderer.shadowRenderer.draw(b9,bM,b0),this.renderer.shapeRenderer.draw(b9,bM,b0),bM=[[bJ,bK]]}}bL[b8.length-1][1]<0?(bT=!0,b0.fillStyle=bV):(bT=!1,b0.fillStyle=bR),bM.push(b8[b8.length-1]),this._areaPoints.push(b8[b8.length-1]),bM.push([b8[b8.length-1][0],bK]),this._areaPoints.push([b8[b8.length-1][0],bK])}bZ&&this.renderer.shadowRenderer.draw(b9,bM,b0),this.renderer.shapeRenderer.draw(b9,bM,b0)}}else{if(bW){var bP=b8.slice(0)}if(0!=this.index&&this._stack){for(var bN=this._prevGridData,b5=bN.length;b5>0;b5--){b8.push(bN[b5-1])}}else{var bI=b9.canvas.height;b8.unshift([b8[0][0],bI]);var bH=b8.length;b8.push([b8[bH-1][0],bI])}this._areaPoints=b8,bZ&&this.renderer.shadowRenderer.draw(b9,b8,b0),this.renderer.shapeRenderer.draw(b9,b8,b0)}if(bW){var bU=bF.extend(!0,{},b0,{fill:!1,closePath:!1});if(this.renderer.shapeRenderer.draw(b9,bP,bU),this.markerRenderer.show){for(this.renderer.smooth&&(bP=this.gridData),b5=0;b5<bP.length;b5++){this.markerRenderer.draw(bP[b5][0],bP[b5][1],b9,b0.markerOptions)}}}}else{if(this.renderer.bands.show){var bS,bQ=bF.extend(!0,{},b0);this.renderer.bands.showLines&&(bS=this.renderer.smooth?this.renderer._hiBandSmoothedData:this.renderer._hiBandGridData,this.renderer.shapeRenderer.draw(b9,bS,b0),bS=this.renderer.smooth?this.renderer._lowBandSmoothedData:this.renderer._lowBandGridData,this.renderer.shapeRenderer.draw(b9,bS,bQ)),this.renderer.bands.fill&&(bS=this.renderer.smooth?this.renderer._hiBandSmoothedData.concat(this.renderer._lowBandSmoothedData.reverse()):this.renderer._hiBandGridData.concat(this.renderer._lowBandGridData.reverse()),this._areaPoints=bS,bQ.closePath=!0,bQ.fill=!0,bQ.fillStyle=this.renderer.bands.fillColor,this.renderer.shapeRenderer.draw(b9,bS,bQ))}bZ&&this.renderer.shadowRenderer.draw(b9,b8,b0),this.renderer.shapeRenderer.draw(b9,b8,b0)}}var b4=b2=b3=b1=null;for(b5=0;b5<this._areaPoints.length;b5++){var bO=this._areaPoints[b5];(b4>bO[0]||null==b4)&&(b4=bO[0]),(b1<bO[1]||null==b1)&&(b1=bO[1]),(b2<bO[0]||null==b2)&&(b2=bO[0]),(b3>bO[1]||null==b3)&&(b3=bO[1])}if("line"===this.type&&this.renderer.bands.show&&(b1=this._yaxis.series_u2p(this.renderer.bands._min),b3=this._yaxis.series_u2p(this.renderer.bands._max)),this._boundingBox=[[b4,b1],[b2,b3]],this.markerRenderer.show&&!bX){for(this.renderer.smooth&&(b8=this.gridData),b5=0;b5<b8.length;b5++){null!=b8[b5][0]&&null!=b8[b5][1]&&this.markerRenderer.draw(b8[b5][0],b8[b5][1],b9,b0.markerOptions)}}}b9.restore()},bF.jqplot.LineRenderer.prototype.drawShadow=function(bI,bH,bJ){},bF.jqplot.LinearAxisRenderer=function(){},bF.jqplot.LinearAxisRenderer.prototype.init=function(bH){this.breakPoints=null,this.breakTickLabel="&asymp;",this.drawBaseline=!0,this.baselineWidth=null,this.baselineColor=null,this.forceTickAt0=!1,this.forceTickAt100=!1,this.tickInset=0,this.minorTicks=0,this.alignTicks=!1,this._autoFormatString="",this._overrideFormatString=!1,this._scalefact=1,bF.extend(!0,this,bH),this.breakPoints&&(bF.isArray(this.breakPoints)?(this.breakPoints.length<2||this.breakPoints[1]<=this.breakPoints[0])&&(this.breakPoints=null):this.breakPoints=null),null!=this.numberTicks&&this.numberTicks<2&&(this.numberTicks=2),this.resetDataBounds()},bF.jqplot.LinearAxisRenderer.prototype.draw=function(bH,bM){if(this.show){this.renderer.createTicks.call(this,bM);if(this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=bF(document.createElement("div")),this._elem.addClass("jqplot-axis jqplot-"+this.name),this._elem.css("position","absolute"),"xaxis"==this.name||"x2axis"==this.name?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions),this._label.show){var bL=this._label.draw(bH,bM);bL.appendTo(this._elem),bL=null}for(var bK,bJ=this._ticks,bI=0;bI<bJ.length;bI++){bK=bJ[bI],bK.show&&bK.showLabel&&(!bK.isMinorTick||this.showMinorTicks)&&this._elem.append(bK.draw(bH,bM))}bK=null,bJ=null}return this._elem},bF.jqplot.LinearAxisRenderer.prototype.reset=function(){this.min=this._options.min,this.max=this._options.max,this.tickInterval=this._options.tickInterval,this.numberTicks=this._options.numberTicks,this._autoFormatString="",this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString&&(this.tickOptions.formatString="")},bF.jqplot.LinearAxisRenderer.prototype.set=function(){var bH,bO=0,bN=0,bM=0,bL=null==this._label?!1:this._label.show;if(this.show){for(var bK,bJ=this._ticks,bI=0;bI<bJ.length;bI++){bK=bJ[bI],bK._breakTick||!bK.show||!bK.showLabel||bK.isMinorTick&&!this.showMinorTicks||(bH="xaxis"==this.name||"x2axis"==this.name?bK._elem.outerHeight(!0):bK._elem.outerWidth(!0),bH>bO&&(bO=bH))}bK=null,bJ=null,bL&&(bN=this._label._elem.outerWidth(!0),bM=this._label._elem.outerHeight(!0)),"xaxis"==this.name?(bO+=bM,this._elem.css({height:bO+"px",left:"0px",bottom:"0px"})):"x2axis"==this.name?(bO+=bM,this._elem.css({height:bO+"px",left:"0px",top:"0px"})):"yaxis"==this.name?(bO+=bN,this._elem.css({width:bO+"px",left:"0px",top:"0px"}),bL&&this._label.constructor==bF.jqplot.AxisLabelRenderer&&this._label._elem.css("width",bN+"px")):(bO+=bN,this._elem.css({width:bO+"px",right:"0px",top:"0px"}),bL&&this._label.constructor==bF.jqplot.AxisLabelRenderer&&this._label._elem.css("width",bN+"px"))}},bF.jqplot.LinearAxisRenderer.prototype.createTicks=function(cv){var cu,ct,cs,cr,cq=this._ticks,cp=this.ticks,co=this.name,cn=this._dataBounds,cm="x"===this.name.charAt(0)?this._plotDimensions.width:this._plotDimensions.height,cl=this.min,ck=this.max,cj=this.numberTicks,ci=this.tickInterval,ch=30;if(this._scalefact=(Math.max(cm,ch+1)-ch)/300,cp.length){for(cr=0;cr<cp.length;cr++){var cg=cp[cr],cf=new this.tickRenderer(this.tickOptions);bF.isArray(cg)?(cf.value=cg[0],this.breakPoints?cg[0]==this.breakPoints[0]?(cf.label=this.breakTickLabel,cf._breakTick=!0,cf.showGridline=!1,cf.showMark=!1):cg[0]>this.breakPoints[0]&&cg[0]<=this.breakPoints[1]?(cf.show=!1,cf.showGridline=!1,cf.label=cg[1]):cf.label=cg[1]:cf.label=cg[1],cf.setTick(cg[0],this.name),this._ticks.push(cf)):bF.isPlainObject(cg)?(bF.extend(!0,cf,cg),cf.axis=this.name,this._ticks.push(cf)):(cf.value=cg,this.breakPoints&&(cg==this.breakPoints[0]?(cf.label=this.breakTickLabel,cf._breakTick=!0,cf.showGridline=!1,cf.showMark=!1):cg>this.breakPoints[0]&&cg<=this.breakPoints[1]&&(cf.show=!1,cf.showGridline=!1)),cf.setTick(cg,this.name),this._ticks.push(cf))}this.numberTicks=cp.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{cm="xaxis"==co||"x2axis"==co?this._plotDimensions.width:this._plotDimensions.height;var ce=this.numberTicks;this.alignTicks&&("x2axis"===this.name&&cv.axes.xaxis.show?ce=cv.axes.xaxis.numberTicks:"y"===this.name.charAt(0)&&"yaxis"!==this.name&&"yMidAxis"!==this.name&&cv.axes.yaxis.show&&(ce=cv.axes.yaxis.numberTicks)),cu=null!=this.min?this.min:cn.min,ct=null!=this.max?this.max:cn.max;var cd,cc,cb,ca=ct-cu;if(null!=this.tickOptions&&this.tickOptions.formatString||(this._overrideFormatString=!0),null==this.min||null==this.max&&null==this.tickInterval&&!this.autoscale){this.forceTickAt0&&(cu>0&&(cu=0),0>ct&&(ct=0)),this.forceTickAt100&&(cu>100&&(cu=100),100>ct&&(ct=100));var b9=!1,b8=!1;null!=this.min?b9=!0:null!=this.max&&(b8=!0);var b7=bF.jqplot.LinearTickGenerator(cu,ct,this._scalefact,ce,b9,b8),b6=null!=this.min?cu:cu+ca*(this.padMin-1),b5=null!=this.max?ct:ct-ca*(this.padMax-1);(b6>cu||ct>b5)&&(b6=null!=this.min?cu:cu-ca*(this.padMin-1),b5=null!=this.max?ct:ct+ca*(this.padMax-1),b7=bF.jqplot.LinearTickGenerator(b6,b5,this._scalefact,ce,b9,b8)),this.min=b7[0],this.max=b7[1],this.numberTicks=b7[2],this._autoFormatString=b7[3],this.tickInterval=b7[4]}else{if(cu==ct){var b4=0.05;cu>0&&(b4=Math.max(Math.log(cu)/Math.LN10,0.05)),cu-=b4,ct+=b4}if(this.autoscale&&null==this.min&&null==this.max){for(var b3,b2,b1,b0=!1,bZ=!1,cr=0;cr<this._series.length;cr++){var bY=this._series[cr],bX="x"==bY.fillAxis?bY._xaxis.name:bY._yaxis.name;if(this.name==bX){for(var bW=bY._plotValues[bY.fillAxis],bV=bW[0],bU=bW[0],bT=1;bT<bW.length;bT++){bW[bT]<bV?bV=bW[bT]:bW[bT]>bU&&(bU=bW[bT])}var bS=(bU-bV)/bU;bY.renderer.constructor==bF.jqplot.BarRenderer?bV>=0&&(bY.fillToZero||bS>0.1)?b0=!0:(b0=!1,bZ=bY.fill&&bY.fillToZero&&0>bV&&bU>0?!0:!1):bY.fill?bV>=0&&(bY.fillToZero||bS>0.1)?b0=!0:0>bV&&bU>0&&bY.fillToZero?(b0=!1,bZ=!0):(b0=!1,bZ=!1):0>bV&&(b0=!1)}}if(b0){this.numberTicks=2+Math.ceil((cm-(this.tickSpacing-1))/this.tickSpacing),this.min=0,cl=0,b2=ct/(this.numberTicks-1),cb=Math.pow(10,Math.abs(Math.floor(Math.log(b2)/Math.LN10))),b2/cb==parseInt(b2/cb,10)&&(b2+=cb),this.tickInterval=Math.ceil(b2/cb)*cb,this.max=this.tickInterval*(this.numberTicks-1)}else{if(bZ){this.numberTicks=2+Math.ceil((cm-(this.tickSpacing-1))/this.tickSpacing);var bR=Math.ceil(Math.abs(cu)/ca*(this.numberTicks-1)),bQ=this.numberTicks-1-bR;b2=Math.max(Math.abs(cu/bR),Math.abs(ct/bQ)),cb=Math.pow(10,Math.abs(Math.floor(Math.log(b2)/Math.LN10))),this.tickInterval=Math.ceil(b2/cb)*cb,this.max=this.tickInterval*bQ,this.min=-this.tickInterval*bR}else{null==this.numberTicks&&(this.tickInterval?this.numberTicks=3+Math.ceil(ca/this.tickInterval):this.numberTicks=2+Math.ceil((cm-(this.tickSpacing-1))/this.tickSpacing)),null==this.tickInterval?(b2=ca/(this.numberTicks-1),cb=1>b2?Math.pow(10,Math.abs(Math.floor(Math.log(b2)/Math.LN10))):1,this.tickInterval=Math.ceil(b2*cb*this.pad)/cb):cb=1/this.tickInterval,b3=this.tickInterval*(this.numberTicks-1),b1=(b3-ca)/2,null==this.min&&(this.min=Math.floor(cb*(cu-b1))/cb),null==this.max&&(this.max=this.min+b3)}}var bP,bO=bF.jqplot.getSignificantFigures(this.tickInterval);if(bO.digitsLeft>=bO.significantDigits){bP="%d"}else{var cb=Math.max(0,5-bO.digitsLeft);cb=Math.min(cb,bO.digitsRight),bP="%."+cb+"f"}this._autoFormatString=bP}else{cd=null!=this.min?this.min:cu-ca*(this.padMin-1),cc=null!=this.max?this.max:ct+ca*(this.padMax-1),ca=cc-cd,null==this.numberTicks&&(null!=this.tickInterval?this.numberTicks=Math.ceil((cc-cd)/this.tickInterval)+1:cm>100?this.numberTicks=parseInt(3+(cm-100)/75,10):this.numberTicks=2),null==this.tickInterval&&(this.tickInterval=ca/(this.numberTicks-1)),null==this.max&&(cc=cd+this.tickInterval*(this.numberTicks-1)),null==this.min&&(cd=cc-this.tickInterval*(this.numberTicks-1));var bP,bO=bF.jqplot.getSignificantFigures(this.tickInterval);if(bO.digitsLeft>=bO.significantDigits){bP="%d"}else{var cb=Math.max(0,5-bO.digitsLeft);cb=Math.min(cb,bO.digitsRight),bP="%."+cb+"f"}this._autoFormatString=bP,this.min=cd,this.max=cc}if(this.renderer.constructor==bF.jqplot.LinearAxisRenderer&&""==this._autoFormatString){ca=this.max-this.min;var bN=new this.tickRenderer(this.tickOptions),bM=bN.formatString||bF.jqplot.config.defaultTickFormatString,bM=bM.match(bF.jqplot.sprintf.regex)[0],bL=0;if(bM){if(bM.search(/[fFeEgGpP]/)>-1){var bK=bM.match(/\%\.(\d{0,})?[eEfFgGpP]/);bL=bK?parseInt(bK[1],10):6}else{bM.search(/[di]/)>-1&&(bL=0)}var bJ=Math.pow(10,-bL);if(this.tickInterval<bJ&&null==cj&&null==ci){if(this.tickInterval=bJ,null==ck&&null==cl){this.min=Math.floor(this._dataBounds.min/bJ)*bJ,this.min==this._dataBounds.min&&(this.min=this._dataBounds.min-this.tickInterval),this.max=Math.ceil(this._dataBounds.max/bJ)*bJ,this.max==this._dataBounds.max&&(this.max=this._dataBounds.max+this.tickInterval);var bI=(this.max-this.min)/this.tickInterval;bI=bI.toFixed(11),bI=Math.ceil(bI),this.numberTicks=bI+1}else{if(null==ck){var bI=(this._dataBounds.max-this.min)/this.tickInterval;bI=bI.toFixed(11),this.numberTicks=Math.ceil(bI)+2,this.max=this.min+this.tickInterval*(this.numberTicks-1)}else{if(null==cl){var bI=(this.max-this._dataBounds.min)/this.tickInterval;bI=bI.toFixed(11),this.numberTicks=Math.ceil(bI)+2,this.min=this.max-this.tickInterval*(this.numberTicks-1)}else{this.numberTicks=Math.ceil((ck-cl)/this.tickInterval)+1,this.min=Math.floor(cl*Math.pow(10,bL))/Math.pow(10,bL),this.max=Math.ceil(ck*Math.pow(10,bL))/Math.pow(10,bL),this.numberTicks=Math.ceil((this.max-this.min)/this.tickInterval)+1}}}}}}}this._overrideFormatString&&""!=this._autoFormatString&&(this.tickOptions=this.tickOptions||{},this.tickOptions.formatString=this._autoFormatString);for(var cf,bH,cr=0;cr<this.numberTicks;cr++){if(cs=this.min+cr*this.tickInterval,cf=new this.tickRenderer(this.tickOptions),cf.setTick(cs,this.name),this._ticks.push(cf),cr<this.numberTicks-1){for(var bT=0;bT<this.minorTicks;bT++){cs+=this.tickInterval/(this.minorTicks+1),bH=bF.extend(!0,{},this.tickOptions,{name:this.name,value:cs,label:"",isMinorTick:!0}),cf=new this.tickRenderer(bH),this._ticks.push(cf)}}cf=null}}this.tickInset&&(this.min=this.min-this.tickInset*this.tickInterval,this.max=this.max+this.tickInset*this.tickInterval),cq=null},bF.jqplot.LinearAxisRenderer.prototype.resetTickValues=function(bH){if(bF.isArray(bH)&&bH.length==this._ticks.length){for(var bJ,bI=0;bI<bH.length;bI++){bJ=this._ticks[bI],bJ.value=bH[bI],bJ.label=bJ.formatter(bJ.formatString,bH[bI]),bJ.label=bJ.prefix+bJ.label,bJ._elem.html(bJ.label)}bJ=null,this.min=bF.jqplot.arrayMin(bH),this.max=bF.jqplot.arrayMax(bH),this.pack()}},bF.jqplot.LinearAxisRenderer.prototype.pack=function(bY,bX){bY=bY||{},bX=bX||this._offsets;var bW=this._ticks,bV=this.max,bU=this.min,bT=bX.max,bS=bX.min,bR=null==this._label?!1:this._label.show;for(var bQ in bY){this._elem.css(bQ,bY[bQ])}this._offsets=bX;var bP=bT-bS,bO=bV-bU;if(this.breakPoints?(bO=bO-this.breakPoints[1]+this.breakPoints[0],this.p2u=function(bZ){return(bZ-bS)*bO/bP+bU},this.u2p=function(bZ){return bZ>this.breakPoints[0]&&bZ<this.breakPoints[1]&&(bZ=this.breakPoints[0]),bZ<=this.breakPoints[0]?(bZ-bU)*bP/bO+bS:(bZ-this.breakPoints[1]+this.breakPoints[0]-bU)*bP/bO+bS},"x"==this.name.charAt(0)?(this.series_u2p=function(bZ){return bZ>this.breakPoints[0]&&bZ<this.breakPoints[1]&&(bZ=this.breakPoints[0]),bZ<=this.breakPoints[0]?(bZ-bU)*bP/bO:(bZ-this.breakPoints[1]+this.breakPoints[0]-bU)*bP/bO},this.series_p2u=function(bZ){return bZ*bO/bP+bU}):(this.series_u2p=function(bZ){return bZ>this.breakPoints[0]&&bZ<this.breakPoints[1]&&(bZ=this.breakPoints[0]),bZ>=this.breakPoints[1]?(bZ-bV)*bP/bO:(bZ+this.breakPoints[1]-this.breakPoints[0]-bV)*bP/bO},this.series_p2u=function(bZ){return bZ*bO/bP+bV})):(this.p2u=function(bZ){return(bZ-bS)*bO/bP+bU},this.u2p=function(bZ){return(bZ-bU)*bP/bO+bS},"xaxis"==this.name||"x2axis"==this.name?(this.series_u2p=function(bZ){return(bZ-bU)*bP/bO},this.series_p2u=function(bZ){return bZ*bO/bP+bU}):(this.series_u2p=function(bZ){return(bZ-bV)*bP/bO},this.series_p2u=function(bZ){return bZ*bO/bP+bV})),this.show){if("xaxis"==this.name||"x2axis"==this.name){for(var bN=0;bN<bW.length;bN++){var bM=bW[bN];if(bM.show&&bM.showLabel){var bL;if(bM.constructor==bF.jqplot.CanvasAxisTickRenderer&&bM.angle){var bK="xaxis"==this.name?1:-1;switch(bM.labelPosition){case"auto":bL=bK*bM.angle<0?-bM.getWidth()+bM._textRenderer.height*Math.sin(-bM._textRenderer.angle)/2:-bM._textRenderer.height*Math.sin(bM._textRenderer.angle)/2;break;case"end":bL=-bM.getWidth()+bM._textRenderer.height*Math.sin(-bM._textRenderer.angle)/2;break;case"start":bL=-bM._textRenderer.height*Math.sin(bM._textRenderer.angle)/2;break;case"middle":bL=-bM.getWidth()/2+bM._textRenderer.height*Math.sin(-bM._textRenderer.angle)/2;break;default:bL=-bM.getWidth()/2+bM._textRenderer.height*Math.sin(-bM._textRenderer.angle)/2}}else{bL=-bM.getWidth()/2}var bJ=this.u2p(bM.value)+bL+"px";bM._elem.css("left",bJ),bM.pack()}}if(bR){var bI=this._label._elem.outerWidth(!0);this._label._elem.css("left",bS+bP/2-bI/2+"px"),"xaxis"==this.name?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack()}}else{for(var bN=0;bN<bW.length;bN++){var bM=bW[bN];if(bM.show&&bM.showLabel){var bL;if(bM.constructor==bF.jqplot.CanvasAxisTickRenderer&&bM.angle){var bK="yaxis"==this.name?1:-1;switch(bM.labelPosition){case"auto":case"end":bL=bK*bM.angle<0?-bM._textRenderer.height*Math.cos(-bM._textRenderer.angle)/2:-bM.getHeight()+bM._textRenderer.height*Math.cos(bM._textRenderer.angle)/2;break;case"start":bL=bM.angle>0?-bM._textRenderer.height*Math.cos(-bM._textRenderer.angle)/2:-bM.getHeight()+bM._textRenderer.height*Math.cos(bM._textRenderer.angle)/2;break;case"middle":bL=-bM.getHeight()/2;break;default:bL=-bM.getHeight()/2}}else{bL=-bM.getHeight()/2}var bJ=this.u2p(bM.value)+bL+"px";bM._elem.css("top",bJ),bM.pack()}}if(bR){var bH=this._label._elem.outerHeight(!0);this._label._elem.css("top",bT-bP/2-bH/2+"px"),"yaxis"==this.name?this._label._elem.css("left","0px"):this._label._elem.css("right","0px"),this._label.pack()}}}bW=null};bF.jqplot.LinearTickGenerator=function(bV,bU,bT,bS,bR,bQ){if(bR=null===bR?!1:bR,bQ=null===bQ||bR?!1:bQ,bV===bU&&(bU=bU?0:1),bT=bT||1,bV>bU){var bP=bU;bU=bV,bV=bP}var bO=[],bN=bi(bU-bV,bT),bM=bF.jqplot.getSignificantFigures;if(null==bS){if(bR||bQ){if(bR){bO[0]=bV,bO[2]=Math.ceil((bU-bV)/bN+1),bO[1]=bV+(bO[2]-1)*bN;var bL=bM(bV).digitsRight,bK=bM(bN).digitsRight;bK>bL?bO[3]=bl(bN):bO[3]="%."+bL+"f",bO[4]=bN}else{if(bQ){bO[1]=bU,bO[2]=Math.ceil((bU-bV)/bN+1),bO[0]=bU-(bO[2]-1)*bN;var bJ=bM(bU).digitsRight,bK=bM(bN).digitsRight;bK>bJ?bO[3]=bl(bN):bO[3]="%."+bJ+"f",bO[4]=bN}}}else{bO[0]=Math.floor(bV/bN)*bN,bO[1]=Math.ceil(bU/bN)*bN,bO[2]=Math.round((bO[1]-bO[0])/bN+1),bO[3]=bl(bN),bO[4]=bN}}else{var bI=[];if(bI[0]=Math.floor(bV/bN)*bN,bI[1]=Math.ceil(bU/bN)*bN,bI[2]=Math.round((bI[1]-bI[0])/bN+1),bI[3]=bl(bN),bI[4]=bN,bI[2]===bS){bO=bI}else{var bH=bj(bI[1]-bI[0],bS);bO[0]=bI[0],bO[2]=bS,bO[4]=bH,bO[3]=bl(bH),bO[1]=bO[0]+(bO[2]-1)*bO[4]}}return bO},bF.jqplot.LinearTickGenerator.bestLinearInterval=bi,bF.jqplot.LinearTickGenerator.bestInterval=bj,bF.jqplot.LinearTickGenerator.bestLinearComponents=bh,bF.jqplot.LinearTickGenerator.bestConstrainedInterval=bk,bF.jqplot.MarkerRenderer=function(bH){this.show=!0,this.style="filledCircle",this.lineWidth=2,this.size=9,this.color="#666666",this.shadow=!0,this.shadowAngle=45,this.shadowOffset=1,this.shadowDepth=3,this.shadowAlpha="0.07",this.shadowRenderer=new bF.jqplot.ShadowRenderer,this.shapeRenderer=new bF.jqplot.ShapeRenderer,bF.extend(!0,this,bH)},bF.jqplot.MarkerRenderer.prototype.init=function(bH){bF.extend(!0,this,bH);var bJ={angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,lineWidth:this.lineWidth,depth:this.shadowDepth,closePath:!0};-1!=this.style.indexOf("filled")&&(bJ.fill=!0),-1!=this.style.indexOf("ircle")&&(bJ.isarc=!0,bJ.closePath=!1),this.shadowRenderer.init(bJ);var bI={fill:!1,isarc:!1,strokeStyle:this.color,fillStyle:this.color,lineWidth:this.lineWidth,closePath:!0};-1!=this.style.indexOf("filled")&&(bI.fill=!0),-1!=this.style.indexOf("ircle")&&(bI.isarc=!0,bI.closePath=!1),this.shapeRenderer.init(bI)},bF.jqplot.MarkerRenderer.prototype.drawDiamond=function(bP,bO,bN,bM,bL){var bK=1.2,bJ=this.size/2/bK,bI=this.size/2*bK,bH=[[bP-bJ,bO],[bP,bO+bI],[bP+bJ,bO],[bP,bO-bI]];this.shadow&&this.shadowRenderer.draw(bN,bH),this.shapeRenderer.draw(bN,bH,bL)},bF.jqplot.MarkerRenderer.prototype.drawPlus=function(bR,bQ,bP,bO,bN){var bM=1,bL=this.size/2*bM,bK=this.size/2*bM,bJ=[[bR,bQ-bK],[bR,bQ+bK]],bI=[[bR+bL,bQ],[bR-bL,bQ]],bH=bF.extend(!0,{},this.options,{closePath:!1});this.shadow&&(this.shadowRenderer.draw(bP,bJ,{closePath:!1}),this.shadowRenderer.draw(bP,bI,{closePath:!1})),this.shapeRenderer.draw(bP,bJ,bH),this.shapeRenderer.draw(bP,bI,bH)},bF.jqplot.MarkerRenderer.prototype.drawX=function(bR,bQ,bP,bO,bN){var bM=1,bL=this.size/2*bM,bK=this.size/2*bM,bJ=bF.extend(!0,{},this.options,{closePath:!1}),bI=[[bR-bL,bQ-bK],[bR+bL,bQ+bK]],bH=[[bR-bL,bQ+bK],[bR+bL,bQ-bK]];this.shadow&&(this.shadowRenderer.draw(bP,bI,{closePath:!1}),this.shadowRenderer.draw(bP,bH,{closePath:!1})),this.shapeRenderer.draw(bP,bI,bJ),this.shapeRenderer.draw(bP,bH,bJ)},bF.jqplot.MarkerRenderer.prototype.drawDash=function(bI,bH,bO,bN,bM){var bL=1,bK=this.size/2*bL,bJ=(this.size/2*bL,[[bI-bK,bH],[bI+bK,bH]]);this.shadow&&this.shadowRenderer.draw(bO,bJ),this.shapeRenderer.draw(bO,bJ,bM)},bF.jqplot.MarkerRenderer.prototype.drawLine=function(bI,bH,bM,bL,bK){var bJ=[bI,bH];this.shadow&&this.shadowRenderer.draw(bM,bJ),this.shapeRenderer.draw(bM,bJ,bK)},bF.jqplot.MarkerRenderer.prototype.drawSquare=function(bP,bO,bN,bM,bL){var bK=1,bJ=this.size/2/bK,bI=this.size/2*bK,bH=[[bP-bJ,bO-bI],[bP-bJ,bO+bI],[bP+bJ,bO+bI],[bP+bJ,bO-bI]];this.shadow&&this.shadowRenderer.draw(bN,bH),this.shapeRenderer.draw(bN,bH,bL)},bF.jqplot.MarkerRenderer.prototype.drawCircle=function(bI,bH,bO,bN,bM){var bL=this.size/2,bK=2*Math.PI,bJ=[bI,bH,bL,0,bK,!0];this.shadow&&this.shadowRenderer.draw(bO,bJ),this.shapeRenderer.draw(bO,bJ,bM)},bF.jqplot.MarkerRenderer.prototype.draw=function(bI,bH,bK,bJ){if(bJ=bJ||{},null==bJ.show||0!=bJ.show){switch(bJ.color&&!bJ.fillStyle&&(bJ.fillStyle=bJ.color),bJ.color&&!bJ.strokeStyle&&(bJ.strokeStyle=bJ.color),this.style){case"diamond":this.drawDiamond(bI,bH,bK,!1,bJ);break;case"filledDiamond":this.drawDiamond(bI,bH,bK,!0,bJ);break;case"circle":this.drawCircle(bI,bH,bK,!1,bJ);break;case"filledCircle":this.drawCircle(bI,bH,bK,!0,bJ);break;case"square":this.drawSquare(bI,bH,bK,!1,bJ);break;case"filledSquare":this.drawSquare(bI,bH,bK,!0,bJ);break;case"x":this.drawX(bI,bH,bK,!0,bJ);break;case"plus":this.drawPlus(bI,bH,bK,!0,bJ);break;case"dash":this.drawDash(bI,bH,bK,!0,bJ);break;case"line":this.drawLine(bI,bH,bK,!1,bJ);break;default:this.drawDiamond(bI,bH,bK,!1,bJ)}}},bF.jqplot.ShadowRenderer=function(bH){this.angle=45,this.offset=1,this.alpha=0.07,this.lineWidth=1.5,this.lineJoin="miter",this.lineCap="round",this.closePath=!1,this.fill=!1,this.depth=3,this.strokeStyle="rgba(0,0,0,0.1)",this.isarc=!1,bF.extend(!0,this,bH)},bF.jqplot.ShadowRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.ShadowRenderer.prototype.draw=function(bW,bV,bU){bW.save();var bT=null!=bU?bU:{},bS=null!=bT.fill?bT.fill:this.fill,bR=null!=bT.fillRect?bT.fillRect:this.fillRect,bQ=null!=bT.closePath?bT.closePath:this.closePath,bP=null!=bT.offset?bT.offset:this.offset,bO=null!=bT.alpha?bT.alpha:this.alpha,bN=null!=bT.depth?bT.depth:this.depth,bM=null!=bT.isarc?bT.isarc:this.isarc,bL=null!=bT.linePattern?bT.linePattern:this.linePattern;bW.lineWidth=null!=bT.lineWidth?bT.lineWidth:this.lineWidth,bW.lineJoin=null!=bT.lineJoin?bT.lineJoin:this.lineJoin,bW.lineCap=null!=bT.lineCap?bT.lineCap:this.lineCap,bW.strokeStyle=bT.strokeStyle||this.strokeStyle||"rgba(0,0,0,"+bO+")",bW.fillStyle=bT.fillStyle||this.fillStyle||"rgba(0,0,0,"+bO+")";for(var bK=0;bN>bK;bK++){var bJ=bF.jqplot.LinePattern(bW,bL);if(bW.translate(Math.cos(this.angle*Math.PI/180)*bP,Math.sin(this.angle*Math.PI/180)*bP),bJ.beginPath(),bM){bW.arc(bV[0],bV[1],bV[2],bV[3],bV[4],!0)}else{if(bR){bR&&bW.fillRect(bV[0],bV[1],bV[2],bV[3])}else{if(bV&&bV.length){for(var bI=!0,bH=0;bH<bV.length;bH++){null!=bV[bH][0]&&null!=bV[bH][1]?bI?(bJ.moveTo(bV[bH][0],bV[bH][1]),bI=!1):bJ.lineTo(bV[bH][0],bV[bH][1]):bI=!0}}}}bQ&&bJ.closePath(),bS?bW.fill():bW.stroke()}bW.restore()},bF.jqplot.ShapeRenderer=function(bH){this.lineWidth=1.5,this.linePattern="solid",this.lineJoin="miter",this.lineCap="round",this.closePath=!1,this.fill=!1,this.isarc=!1,this.fillRect=!1,this.strokeRect=!1,this.clearRect=!1,this.strokeStyle="#999999",this.fillStyle="#999999",bF.extend(!0,this,bH)},bF.jqplot.ShapeRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.ShapeRenderer.prototype.draw=function(bU,bT,bS){bU.save();var bR=null!=bS?bS:{},bQ=null!=bR.fill?bR.fill:this.fill,bP=null!=bR.closePath?bR.closePath:this.closePath,bO=null!=bR.fillRect?bR.fillRect:this.fillRect,bN=null!=bR.strokeRect?bR.strokeRect:this.strokeRect,bM=null!=bR.clearRect?bR.clearRect:this.clearRect,bL=null!=bR.isarc?bR.isarc:this.isarc,bK=null!=bR.linePattern?bR.linePattern:this.linePattern,bJ=bF.jqplot.LinePattern(bU,bK);if(bU.lineWidth=bR.lineWidth||this.lineWidth,bU.lineJoin=bR.lineJoin||this.lineJoin,bU.lineCap=bR.lineCap||this.lineCap,bU.strokeStyle=bR.strokeStyle||bR.color||this.strokeStyle,bU.fillStyle=bR.fillStyle||this.fillStyle,bU.beginPath(),bL){return bU.arc(bT[0],bT[1],bT[2],bT[3],bT[4],!0),bP&&bU.closePath(),bQ?bU.fill():bU.stroke(),void bU.restore()}if(bM){return bU.clearRect(bT[0],bT[1],bT[2],bT[3]),void bU.restore()}if(bO||bN){if(bO&&bU.fillRect(bT[0],bT[1],bT[2],bT[3]),bN){return bU.strokeRect(bT[0],bT[1],bT[2],bT[3]),void bU.restore()}}else{if(bT&&bT.length){for(var bI=!0,bH=0;bH<bT.length;bH++){null!=bT[bH][0]&&null!=bT[bH][1]?bI?(bJ.moveTo(bT[bH][0],bT[bH][1]),bI=!1):bJ.lineTo(bT[bH][0],bT[bH][1]):bI=!0}bP&&bJ.closePath(),bQ?bU.fill():bU.stroke()}}bU.restore()},bF.jqplot.TableLegendRenderer=function(){},bF.jqplot.TableLegendRenderer.prototype.init=function(bH){bF.extend(!0,this,bH)},bF.jqplot.TableLegendRenderer.prototype.addrow=function(bQ,bP,bO,bN){var bM,bL,bK,bJ,bI,bH=bO?this.rowSpacing+"px":"0px";bK=document.createElement("tr"),bM=bF(bK),bM.addClass("jqplot-table-legend"),bK=null,bN?bM.prependTo(this._elem):bM.appendTo(this._elem),this.showSwatches&&(bL=bF(document.createElement("td")),bL.addClass("jqplot-table-legend jqplot-table-legend-swatch"),bL.css({textAlign:"center",paddingTop:bH}),bJ=bF(document.createElement("div")),bJ.addClass("jqplot-table-legend-swatch-outline"),bI=bF(document.createElement("div")),bI.addClass("jqplot-table-legend-swatch"),bI.css({backgroundColor:bP,borderColor:bP}),bM.append(bL.append(bJ.append(bI)))),this.showLabels&&(bL=bF(document.createElement("td")),bL.addClass("jqplot-table-legend jqplot-table-legend-label"),bL.css("paddingTop",bH),bM.append(bL),this.escapeHtml?bL.text(bQ):bL.html(bQ)),bL=null,bJ=null,bI=null,bM=null,bK=null},bF.jqplot.TableLegendRenderer.prototype.draw=function(){if(this._elem&&(this._elem.emptyForce(),this._elem=null),this.show){var bR=this._series,bQ=document.createElement("table");this._elem=bF(bQ),this._elem.addClass("jqplot-table-legend");var bP={position:"absolute"};this.background&&(bP.background=this.background),this.border&&(bP.border=this.border),this.fontSize&&(bP.fontSize=this.fontSize),this.fontFamily&&(bP.fontFamily=this.fontFamily),this.textColor&&(bP.textColor=this.textColor),null!=this.marginTop&&(bP.marginTop=this.marginTop),null!=this.marginBottom&&(bP.marginBottom=this.marginBottom),null!=this.marginLeft&&(bP.marginLeft=this.marginLeft),null!=this.marginRight&&(bP.marginRight=this.marginRight);for(var bO,bN=!1,bM=!1,bL=0;bL<bR.length;bL++){if(bO=bR[bL],(bO._stack||bO.renderer.constructor==bF.jqplot.BezierCurveRenderer)&&(bM=!0),bO.show&&bO.showLabel){var bK=this.labels[bL]||bO.label.toString();if(bK){var bJ=bO.color;bM&&bL<bR.length-1?bN=!0:bM&&bL==bR.length-1&&(bN=!1),this.renderer.addrow.call(this,bK,bJ,bN,bM),bN=!0}for(var bI=0;bI<bF.jqplot.addLegendRowHooks.length;bI++){var bH=bF.jqplot.addLegendRowHooks[bI].call(this,bO);bH&&(this.renderer.addrow.call(this,bH.label,bH.color,bN),bN=!0)}bK=null}}}return this._elem},bF.jqplot.TableLegendRenderer.prototype.pack=function(bI){if(this.show){if("insideGrid"==this.placement){switch(this.location){case"nw":var bH=bI.left,bJ=bI.top;this._elem.css("left",bH),this._elem.css("top",bJ);break;case"n":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2,bJ=bI.top;this._elem.css("left",bH),this._elem.css("top",bJ);break;case"ne":var bH=bI.right,bJ=bI.top;this._elem.css({right:bH,top:bJ});break;case"e":var bH=bI.right,bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({right:bH,top:bJ});break;case"se":var bH=bI.right,bJ=bI.bottom;this._elem.css({right:bH,bottom:bJ});break;case"s":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2,bJ=bI.bottom;this._elem.css({left:bH,bottom:bJ});break;case"sw":var bH=bI.left,bJ=bI.bottom;this._elem.css({left:bH,bottom:bJ});break;case"w":var bH=bI.left,bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({left:bH,top:bJ});break;default:var bH=bI.right,bJ=bI.bottom;this._elem.css({right:bH,bottom:bJ})}}else{if("outside"==this.placement){switch(this.location){case"nw":var bH=this._plotDimensions.width-bI.left,bJ=bI.top;this._elem.css("right",bH),this._elem.css("top",bJ);break;case"n":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2,bJ=this._plotDimensions.height-bI.top;this._elem.css("left",bH),this._elem.css("bottom",bJ);break;case"ne":var bH=this._plotDimensions.width-bI.right,bJ=bI.top;this._elem.css({left:bH,top:bJ});break;case"e":var bH=this._plotDimensions.width-bI.right,bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({left:bH,top:bJ});break;case"se":var bH=this._plotDimensions.width-bI.right,bJ=bI.bottom;this._elem.css({left:bH,bottom:bJ});break;case"s":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2,bJ=this._plotDimensions.height-bI.bottom;this._elem.css({left:bH,top:bJ});break;case"sw":var bH=this._plotDimensions.width-bI.left,bJ=bI.bottom;this._elem.css({right:bH,bottom:bJ});break;case"w":var bH=this._plotDimensions.width-bI.left,bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({right:bH,top:bJ});break;default:var bH=bI.right,bJ=bI.bottom;this._elem.css({right:bH,bottom:bJ})}}else{switch(this.location){case"nw":this._elem.css({left:0,top:bI.top});break;case"n":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2;this._elem.css({left:bH,top:bI.top});break;case"ne":this._elem.css({right:0,top:bI.top});break;case"e":var bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({right:bI.right,top:bJ});break;case"se":this._elem.css({right:bI.right,bottom:bI.bottom});break;case"s":var bH=(bI.left+(this._plotDimensions.width-bI.right))/2-this.getWidth()/2;this._elem.css({left:bH,bottom:bI.bottom});break;case"sw":this._elem.css({left:bI.left,bottom:bI.bottom});break;case"w":var bJ=(bI.top+(this._plotDimensions.height-bI.bottom))/2-this.getHeight()/2;this._elem.css({left:bI.left,top:bJ});break;default:this._elem.css({right:bI.right,bottom:bI.bottom})}}}}},bF.jqplot.ThemeEngine=function(){this.themes={},this.activeTheme=null},bF.jqplot.ThemeEngine.prototype.init=function(){var bH,bN,bM,bL=new bF.jqplot.Theme({_name:"Default"});for(bH in bL.target){"textColor"==bH?bL.target[bH]=this.target.css("color"):bL.target[bH]=this.target.css(bH)}if(this.title.show&&this.title._elem){for(bH in bL.title){"textColor"==bH?bL.title[bH]=this.title._elem.css("color"):bL.title[bH]=this.title._elem.css(bH)}}for(bH in bL.grid){bL.grid[bH]=this.grid[bH]}if(null==bL.grid.backgroundColor&&null!=this.grid.background&&(bL.grid.backgroundColor=this.grid.background),this.legend.show&&this.legend._elem){for(bH in bL.legend){"textColor"==bH?bL.legend[bH]=this.legend._elem.css("color"):bL.legend[bH]=this.legend._elem.css(bH)}}var bK;for(bN=0;bN<this.series.length;bN++){bK=this.series[bN],bK.renderer.constructor==bF.jqplot.LineRenderer?bL.series.push(new a3):bK.renderer.constructor==bF.jqplot.BarRenderer?bL.series.push(new a1):bK.renderer.constructor==bF.jqplot.PieRenderer?bL.series.push(new a0):bK.renderer.constructor==bF.jqplot.DonutRenderer?bL.series.push(new aZ):bK.renderer.constructor==bF.jqplot.FunnelRenderer?bL.series.push(new aY):bK.renderer.constructor==bF.jqplot.MeterGaugeRenderer?bL.series.push(new aX):bL.series.push({});for(bH in bL.series[bN]){bL.series[bN][bH]=bK[bH]}}var bJ,bI;for(bH in this.axes){if(bI=this.axes[bH],bJ=bL.axes[bH]=new a6,bJ.borderColor=bI.borderColor,bJ.borderWidth=bI.borderWidth,bI._ticks&&bI._ticks[0]){for(bM in bJ.ticks){bI._ticks[0].hasOwnProperty(bM)?bJ.ticks[bM]=bI._ticks[0][bM]:bI._ticks[0]._elem&&(bJ.ticks[bM]=bI._ticks[0]._elem.css(bM))}}if(bI._label&&bI._label.show){for(bM in bJ.label){bI._label[bM]?bJ.label[bM]=bI._label[bM]:bI._label._elem&&("textColor"==bM?bJ.label[bM]=bI._label._elem.css("color"):bJ.label[bM]=bI._label._elem.css(bM))}}}this.themeEngine._add(bL),this.themeEngine.activeTheme=this.themeEngine.themes[bL._name]},bF.jqplot.ThemeEngine.prototype.get=function(bH){return bH?this.themes[bH]:this.activeTheme},bF.jqplot.ThemeEngine.prototype.getThemeNames=function(){var bI=[];for(var bH in this.themes){bI.push(bH)}return bI.sort(bg)},bF.jqplot.ThemeEngine.prototype.getThemes=function(){var bI=[],bH=[];for(var bK in this.themes){bI.push(bK)}bI.sort(bg);for(var bJ=0;bJ<bI.length;bJ++){bH.push(this.themes[bI[bJ]])}return bH},bF.jqplot.ThemeEngine.prototype.activate=function(bW,bV){var bU=!1;if(!bV&&this.activeTheme&&this.activeTheme._name&&(bV=this.activeTheme._name),!this.themes.hasOwnProperty(bV)){throw new Error("No theme of that name")}var bT=this.themes[bV];this.activeTheme=bT;var bS,bR=["xaxis","x2axis","yaxis","y2axis"];for(bI=0;bI<bR.length;bI++){var bQ=bR[bI];null!=bT.axesStyles.borderColor&&(bW.axes[bQ].borderColor=bT.axesStyles.borderColor),null!=bT.axesStyles.borderWidth&&(bW.axes[bQ].borderWidth=bT.axesStyles.borderWidth)}for(var bP in bW.axes){var bO=bW.axes[bP];if(bO.show){var bN=bT.axes[bP]||{},bM=bT.axesStyles,bL=bF.jqplot.extend(!0,{},bN,bM);if(bS=null!=bT.axesStyles.borderColor?bT.axesStyles.borderColor:bL.borderColor,null!=bL.borderColor&&(bO.borderColor=bL.borderColor,bU=!0),bS=null!=bT.axesStyles.borderWidth?bT.axesStyles.borderWidth:bL.borderWidth,null!=bL.borderWidth&&(bO.borderWidth=bL.borderWidth,bU=!0),bO._ticks&&bO._ticks[0]){for(var bK in bL.ticks){bS=bL.ticks[bK],null!=bS&&(bO.tickOptions[bK]=bS,bO._ticks=[],bU=!0)}}if(bO._label&&bO._label.show){for(var bK in bL.label){bS=bL.label[bK],null!=bS&&(bO.labelOptions[bK]=bS,bU=!0)}}}}for(var bJ in bT.grid){null!=bT.grid[bJ]&&(bW.grid[bJ]=bT.grid[bJ])}if(bU||bW.grid.draw(),bW.legend.show){for(bJ in bT.legend){null!=bT.legend[bJ]&&(bW.legend[bJ]=bT.legend[bJ])}}if(bW.title.show){for(bJ in bT.title){null!=bT.title[bJ]&&(bW.title[bJ]=bT.title[bJ])}}var bI;for(bI=0;bI<bT.series.length;bI++){var bH={};for(bJ in bT.series[bI]){bS=null!=bT.seriesStyles[bJ]?bT.seriesStyles[bJ]:bT.series[bI][bJ],null!=bS&&(bH[bJ]=bS,"color"==bJ?(bW.series[bI].renderer.shapeRenderer.fillStyle=bS,bW.series[bI].renderer.shapeRenderer.strokeStyle=bS,bW.series[bI][bJ]=bS):"lineWidth"==bJ||"linePattern"==bJ?(bW.series[bI].renderer.shapeRenderer[bJ]=bS,bW.series[bI][bJ]=bS):"markerOptions"==bJ?(bd(bW.series[bI].markerOptions,bS),bd(bW.series[bI].markerRenderer,bS)):bW.series[bI][bJ]=bS,bU=!0)}}bU&&(bW.target.empty(),bW.draw());for(bJ in bT.target){null!=bT.target[bJ]&&bW.target.css(bJ,bT.target[bJ])}},bF.jqplot.ThemeEngine.prototype._add=function(bI,bH){if(bH&&(bI._name=bH),bI._name||(bI._name=Date.parse(new Date)),this.themes.hasOwnProperty(bI._name)){throw new Error("jqplot.ThemeEngine Error: Theme already in use")}this.themes[bI._name]=bI},bF.jqplot.ThemeEngine.prototype.remove=function(bH){return"Default"==bH?!1:delete this.themes[bH]},bF.jqplot.ThemeEngine.prototype.newTheme=function(bH,bJ){"object"==typeof bH&&(bJ=bJ||bH,bH=null),bH=bJ&&bJ._name?bJ._name:bH||Date.parse(new Date);var bI=this.copy(this.themes.Default._name,bH);return bF.jqplot.extend(bI,bJ),bI},bF.jqplot.clone=be,bF.jqplot.merge=bd,bF.jqplot.extend=function(){var bH,bO=arguments[0]||{},bN=1,bM=arguments.length,bL=!1;for("boolean"==typeof bO&&(bL=bO,bO=arguments[1]||{},bN=2),"object"!=typeof bO&&"[object Function]"===!toString.call(bO)&&(bO={});bM>bN;bN++){if(null!=(bH=arguments[bN])){for(var bK in bH){var bJ=bO[bK],bI=bH[bK];bO!==bI&&(bL&&bI&&"object"==typeof bI&&!bI.nodeType?bO[bK]=bF.jqplot.extend(bL,bJ||(null!=bI.length?[]:{}),bI):bI!==a9&&(bO[bK]=bI))}}}return bO},bF.jqplot.ThemeEngine.prototype.rename=function(bI,bH){if("Default"==bI||"Default"==bH){throw new Error("jqplot.ThemeEngine Error: Cannot rename from/to Default")}if(this.themes.hasOwnProperty(bH)){throw new Error("jqplot.ThemeEngine Error: New name already in use.")}if(this.themes.hasOwnProperty(bI)){var bJ=this.copy(bI,bH);return this.remove(bI),bJ}throw new Error("jqplot.ThemeEngine Error: Old name or new name invalid")},bF.jqplot.ThemeEngine.prototype.copy=function(bH,bL,bK){if("Default"==bL){throw new Error("jqplot.ThemeEngine Error: Cannot copy over Default theme")}if(!this.themes.hasOwnProperty(bH)){var bJ="jqplot.ThemeEngine Error: Source name invalid";throw new Error(bJ)}if(this.themes.hasOwnProperty(bL)){var bJ="jqplot.ThemeEngine Error: Target name invalid";throw new Error(bJ)}var bI=be(this.themes[bH]);return bI._name=bL,bF.jqplot.extend(!0,bI,bK),this._add(bI),bI},bF.jqplot.Theme=function(bH,bI){"object"==typeof bH&&(bI=bI||bH,bH=null),bH=bH||Date.parse(new Date),this._name=bH,this.target={backgroundColor:null},this.legend={textColor:null,fontFamily:null,fontSize:null,border:null,background:null},this.title={textColor:null,fontFamily:null,fontSize:null,textAlign:null},this.seriesStyles={},this.series=[],this.grid={drawGridlines:null,gridLineColor:null,gridLineWidth:null,backgroundColor:null,borderColor:null,borderWidth:null,shadow:null},this.axesStyles={label:{},ticks:{}},this.axes={},"string"==typeof bI?this._name=bI:"object"==typeof bI&&bF.jqplot.extend(!0,this,bI)};var a6=function(){this.borderColor=null,this.borderWidth=null,this.ticks=new a5,this.label=new a4},a5=function(){this.show=null,this.showGridline=null,this.showLabel=null,this.showMark=null,this.size=null,this.textColor=null,this.whiteSpace=null,this.fontSize=null,this.fontFamily=null},a4=function(){this.textColor=null,this.whiteSpace=null,this.fontSize=null,this.fontFamily=null,this.fontWeight=null},a3=function(){this.color=null,this.lineWidth=null,this.linePattern=null,this.shadow=null,this.fillColor=null,this.showMarker=null,this.markerOptions=new a2},a2=function(){this.show=null,this.style=null,this.lineWidth=null,this.size=null,this.color=null,this.shadow=null},a1=function(){this.color=null,this.seriesColors=null,this.lineWidth=null,this.shadow=null,this.barPadding=null,this.barMargin=null,this.barWidth=null,this.highlightColors=null},a0=function(){this.seriesColors=null,this.padding=null,this.sliceMargin=null,this.fill=null,this.shadow=null,this.startAngle=null,this.lineWidth=null,this.highlightColors=null},aZ=function(){this.seriesColors=null,this.padding=null,this.sliceMargin=null,this.fill=null,this.shadow=null,this.startAngle=null,this.lineWidth=null,this.innerDiameter=null,this.thickness=null,this.ringMargin=null,this.highlightColors=null},aY=function(){this.color=null,this.lineWidth=null,this.shadow=null,this.padding=null,this.sectionMargin=null,this.seriesColors=null,this.highlightColors=null},aX=function(){this.padding=null,this.backgroundColor=null,this.ringColor=null,this.tickColor=null,this.ringWidth=null,this.intervalColors=null,this.intervalInnerRadius=null,this.intervalOuterRadius=null,this.hubRadius=null,this.needleThickness=null,this.needlePad=null};bF.fn.jqplotChildText=function(){return bF(this).contents().filter(function(){return 3==this.nodeType}).text()},bF.fn.jqplotGetComputedFontStyle=function(){for(var bI=window.getComputedStyle?window.getComputedStyle(this[0],""):this[0].currentStyle,bH=bI["font-style"]?["font-style","font-weight","font-size","font-family"]:["fontStyle","fontWeight","fontSize","fontFamily"],bL=[],bK=0;bK<bH.length;++bK){var bJ=String(bI[bH[bK]]);bJ&&"normal"!=bJ&&bL.push(bJ)}return bL.join(" ")},bF.fn.jqplotToImageCanvas=function(b2){function b1(b3){var b4=parseInt(bF(b3).css("line-height"),10);return isNaN(b4)&&(b4=1.2*parseInt(bF(b3).css("font-size"),10)),b4}function b0(ci,ch,cg,cf,ce,cd){for(var cc=b1(ci),cb=bF(ci).innerWidth(),ca=(bF(ci).innerHeight(),cg.split(/\s+/)),b9=ca.length,b8="",b7=[],b6=ce,b5=cf,b4=0;b9>b4;b4++){b8+=ca[b4],ch.measureText(b8).width>cb&&b8.length>ca[b4].length&&(b7.push(b4),b8="",b4--)}if(0===b7.length){"center"===bF(ci).css("textAlign")&&(b5=cf+(cd-ch.measureText(b8).width)/2-bL),ch.fillText(cg,b5,ce)}else{b8=ca.slice(0,b7[0]).join(" "),"center"===bF(ci).css("textAlign")&&(b5=cf+(cd-ch.measureText(b8).width)/2-bL),ch.fillText(b8,b5,b6),b6+=cc;for(var b4=1,b3=b7.length;b3>b4;b4++){b8=ca.slice(b7[b4-1],b7[b4]).join(" "),"center"===bF(ci).css("textAlign")&&(b5=cf+(cd-ch.measureText(b8).width)/2-bL),ch.fillText(b8,b5,b6),b6+=cc}b8=ca.slice(b7[b4-1],ca.length).join(" "),"center"===bF(ci).css("textAlign")&&(b5=cf+(cd-ch.measureText(b8).width)/2-bL),ch.fillText(b8,b5,b6)}}function bZ(cc,cb,ca){var b9=cc.tagName.toLowerCase(),b8=bF(cc).position(),b7=window.getComputedStyle?window.getComputedStyle(cc,""):cc.currentStyle,b6=cb+b8.left+parseInt(b7.marginLeft,10)+parseInt(b7.borderLeftWidth,10)+parseInt(b7.paddingLeft,10),b5=ca+b8.top+parseInt(b7.marginTop,10)+parseInt(b7.borderTopWidth,10)+parseInt(b7.paddingTop,10),b4=bR.width;if("div"!=b9&&"span"!=b9||bF(cc).hasClass("jqplot-highlighter-tooltip")){if("table"===b9&&bF(cc).hasClass("jqplot-table-legend")){bH.strokeStyle=bF(cc).css("border-top-color"),bH.fillStyle=bF(cc).css("background-color"),bH.fillRect(b6,b5,bF(cc).innerWidth(),bF(cc).innerHeight()),parseInt(bF(cc).css("border-top-width"),10)>0&&bH.strokeRect(b6,b5,bF(cc).innerWidth(),bF(cc).innerHeight()),bF(cc).find("div.jqplot-table-legend-swatch-outline").each(function(){var cd=bF(this);bH.strokeStyle=cd.css("border-top-color");var ci=b6+cd.position().left,ch=b5+cd.position().top;bH.strokeRect(ci,ch,cd.innerWidth(),cd.innerHeight()),ci+=parseInt(cd.css("padding-left"),10),ch+=parseInt(cd.css("padding-top"),10);var cg=cd.innerHeight()-2*parseInt(cd.css("padding-top"),10),cf=cd.innerWidth()-2*parseInt(cd.css("padding-left"),10),ce=cd.children("div.jqplot-table-legend-swatch");bH.fillStyle=ce.css("background-color"),bH.fillRect(ci,ch,cf,cg)}),bF(cc).find("td.jqplot-table-legend-label").each(function(){var cd=bF(this),cf=b6+cd.position().left,ce=b5+cd.position().top+parseInt(cd.css("padding-top"),10);bH.font=cd.jqplotGetComputedFontStyle(),bH.fillStyle=cd.css("color"),b0(cd,bH,cd.text(),cf,ce,b4)})}else{"canvas"==b9&&bH.drawImage(cc,b6,b5)}}else{bF(cc).children().each(function(){bZ(this,b6,b5)});var b3=bF(cc).jqplotChildText();b3&&(bH.font=bF(cc).jqplotGetComputedFontStyle(),bH.fillStyle=bF(cc).css("color"),b0(cc,bH,b3,b6,b5,b4))}}b2=b2||{};var bY=null==b2.x_offset?0:b2.x_offset,bX=null==b2.y_offset?0:b2.y_offset,bW=null==b2.backgroundColor?"rgb(255,255,255)":b2.backgroundColor;if(0==bF(this).width()||0==bF(this).height()){return null}if(bF.jqplot.use_excanvas){return null}for(var bV,bU,bT,bS,bR=document.createElement("canvas"),bQ=bF(this).outerHeight(!0),bP=bF(this).outerWidth(!0),bO=bF(this).offset(),bN=bO.left,bM=bO.top,bL=0,bK=0,bJ=["jqplot-table-legend","jqplot-xaxis-tick","jqplot-x2axis-tick","jqplot-yaxis-tick","jqplot-y2axis-tick","jqplot-y3axis-tick","jqplot-y4axis-tick","jqplot-y5axis-tick","jqplot-y6axis-tick","jqplot-y7axis-tick","jqplot-y8axis-tick","jqplot-y9axis-tick","jqplot-xaxis-label","jqplot-x2axis-label","jqplot-yaxis-label","jqplot-y2axis-label","jqplot-y3axis-label","jqplot-y4axis-label","jqplot-y5axis-label","jqplot-y6axis-label","jqplot-y7axis-label","jqplot-y8axis-label","jqplot-y9axis-label"],bI=0;bI<bJ.length;bI++){bF(this).find("."+bJ[bI]).each(function(){bV=bF(this).offset().top-bM,bU=bF(this).offset().left-bN,bS=bU+bF(this).outerWidth(!0)+bL,bT=bV+bF(this).outerHeight(!0)+bK,-bL>bU&&(bP=bP-bL-bU,bL=-bU),-bK>bV&&(bQ=bQ-bK-bV,bK=-bV),bS>bP&&(bP=bS),bT>bQ&&(bQ=bT)})}bR.width=bP+Number(bY),bR.height=bQ+Number(bX);var bH=bR.getContext("2d");return bH.save(),bH.fillStyle=bW,bH.fillRect(0,0,bR.width,bR.height),bH.restore(),bH.translate(bL,bK),bH.textAlign="left",bH.textBaseline="top",bF(this).children().each(function(){bZ(this,bY,bX)}),bR},bF.fn.jqplotToImageStr=function(bH){var bI=bF(this).jqplotToImageCanvas(bH);return bI?bI.toDataURL("image/png"):null},bF.fn.jqplotToImageElem=function(bH){var bJ=document.createElement("img"),bI=bF(this).jqplotToImageStr(bH);return bJ.src=bI,bJ},bF.fn.jqplotToImageElemStr=function(bH){var bI="<img src="+bF(this).jqplotToImageStr(bH)+" />";return bI},bF.fn.jqplotSaveImage=function(){var bH=bF(this).jqplotToImageStr({});bH&&(window.location.href=bH.replace("image/png","image/octet-stream"))},bF.fn.jqplotViewImage=function(){var bH=bF(this).jqplotToImageElemStr({});bF(this).jqplotToImageStr({});if(bH){var bI=window.open("");bI.document.open("image/png"),bI.document.write(bH),bI.document.close(),bI=null}};var aW=function(){switch(this.syntax=aW.config.syntax,this._type="jsDate",this.proxy=new Date,this.options={},this.locale=aW.regional.getLocale(),this.formatString="",this.defaultCentury=aW.config.defaultCentury,arguments.length){case 0:break;case 1:if("[object Object]"==bb(arguments[0])&&"jsDate"!=arguments[0]._type){var bI=this.options=arguments[0];this.syntax=bI.syntax||this.syntax,this.defaultCentury=bI.defaultCentury||this.defaultCentury,this.proxy=aW.createDate(bI.date)}else{this.proxy=aW.createDate(arguments[0])}break;default:for(var bH=[],bJ=0;bJ<arguments.length;bJ++){bH.push(arguments[bJ])}this.proxy=new Date,this.proxy.setFullYear.apply(this.proxy,bH.slice(0,3)),bH.slice(3).length&&this.proxy.setHours.apply(this.proxy,bH.slice(3))}};aW.config={defaultLocale:"en",syntax:"perl",defaultCentury:1900},aW.prototype.add=function(bI,bH){var bJ=aT[bH]||aT.day;return"number"==typeof bJ?this.proxy.setTime(this.proxy.getTime()+bJ*bI):bJ.add(this,bI),this},aW.prototype.clone=function(){return new aW(this.proxy.getTime())},aW.prototype.getUtcOffset=function(){return 60000*this.proxy.getTimezoneOffset()},aW.prototype.diff=function(bI,bH,bL){if(bI=new aW(bI),null===bI){return null}var bK=aT[bH]||aT.day;if("number"==typeof bK){var bJ=(this.proxy.getTime()-bI.proxy.getTime())/bK}else{var bJ=bK.diff(this.proxy,bI.proxy)}return bL?bJ:Math[bJ>0?"floor":"ceil"](bJ)},aW.prototype.getAbbrDayName=function(){return aW.regional[this.locale].dayNamesShort[this.proxy.getDay()]},aW.prototype.getAbbrMonthName=function(){return aW.regional[this.locale].monthNamesShort[this.proxy.getMonth()]},aW.prototype.getAMPM=function(){return this.proxy.getHours()>=12?"PM":"AM"},aW.prototype.getAmPm=function(){return this.proxy.getHours()>=12?"pm":"am"},aW.prototype.getCentury=function(){return parseInt(this.proxy.getFullYear()/100,10)},aW.prototype.getDate=function(){return this.proxy.getDate()},aW.prototype.getDay=function(){return this.proxy.getDay()},aW.prototype.getDayOfWeek=function(){var bH=this.proxy.getDay();return 0===bH?7:bH},aW.prototype.getDayOfYear=function(){var bI=this.proxy,bH=bI-new Date(""+bI.getFullYear()+"/1/1 GMT");return bH+=60000*bI.getTimezoneOffset(),bI=null,parseInt(bH/60000/60/24,10)+1},aW.prototype.getDayName=function(){return aW.regional[this.locale].dayNames[this.proxy.getDay()]},aW.prototype.getFullWeekOfYear=function(){var bI=this.proxy,bH=this.getDayOfYear(),bK=6-bI.getDay(),bJ=parseInt((bH+bK)/7,10);return bJ},aW.prototype.getFullYear=function(){return this.proxy.getFullYear()},aW.prototype.getGmtOffset=function(){var bI=this.proxy.getTimezoneOffset()/60,bH=0>bI?"+":"-";return bI=Math.abs(bI),bH+aU(Math.floor(bI),2)+":"+aU(bI%1*60,2)},aW.prototype.getHours=function(){return this.proxy.getHours()},aW.prototype.getHours12=function(){var bH=this.proxy.getHours();return bH>12?bH-12:0==bH?12:bH},aW.prototype.getIsoWeek=function(){var bI=this.proxy,bH=this.getWeekOfYear(),bK=new Date(""+bI.getFullYear()+"/1/1").getDay(),bJ=bH+(bK>4||1>=bK?0:1);return 53==bJ&&new Date(""+bI.getFullYear()+"/12/31").getDay()<4?bJ=1:0===bJ&&(bI=new aW(new Date(""+(bI.getFullYear()-1)+"/12/31")),bJ=bI.getIsoWeek()),bI=null,bJ},aW.prototype.getMilliseconds=function(){return this.proxy.getMilliseconds()},aW.prototype.getMinutes=function(){return this.proxy.getMinutes()},aW.prototype.getMonth=function(){return this.proxy.getMonth()},aW.prototype.getMonthName=function(){return aW.regional[this.locale].monthNames[this.proxy.getMonth()]},aW.prototype.getMonthNumber=function(){return this.proxy.getMonth()+1},aW.prototype.getSeconds=function(){return this.proxy.getSeconds()},aW.prototype.getShortYear=function(){return this.proxy.getYear()%100},aW.prototype.getTime=function(){return this.proxy.getTime()},aW.prototype.getTimezoneAbbr=function(){return this.proxy.toString().replace(/^.*\(([^)]+)\)$/,"$1")},aW.prototype.getTimezoneName=function(){var bH=/(?:\((.+)\)$| ([A-Z]{3}) )/.exec(this.toString());return bH[1]||bH[2]||"GMT"+this.getGmtOffset()},aW.prototype.getTimezoneOffset=function(){return this.proxy.getTimezoneOffset()},aW.prototype.getWeekOfYear=function(){var bI=this.getDayOfYear(),bH=7-this.getDayOfWeek(),bJ=parseInt((bI+bH)/7,10);return bJ},aW.prototype.getUnix=function(){return Math.round(this.proxy.getTime()/1000,0)},aW.prototype.getYear=function(){return this.proxy.getYear()},aW.prototype.next=function(bH){return bH=bH||"day",this.clone().add(1,bH)},aW.prototype.set=function(){switch(arguments.length){case 0:this.proxy=new Date;break;case 1:if("[object Object]"==bb(arguments[0])&&"jsDate"!=arguments[0]._type){var bI=this.options=arguments[0];this.syntax=bI.syntax||this.syntax,this.defaultCentury=bI.defaultCentury||this.defaultCentury,this.proxy=aW.createDate(bI.date)}else{this.proxy=aW.createDate(arguments[0])}break;default:for(var bH=[],bJ=0;bJ<arguments.length;bJ++){bH.push(arguments[bJ])}this.proxy=new Date,this.proxy.setFullYear.apply(this.proxy,bH.slice(0,3)),bH.slice(3).length&&this.proxy.setHours.apply(this.proxy,bH.slice(3))}return this},aW.prototype.setDate=function(bH){return this.proxy.setDate(bH),this},aW.prototype.setFullYear=function(){return this.proxy.setFullYear.apply(this.proxy,arguments),this},aW.prototype.setHours=function(){return this.proxy.setHours.apply(this.proxy,arguments),this},aW.prototype.setMilliseconds=function(bH){return this.proxy.setMilliseconds(bH),this},aW.prototype.setMinutes=function(){return this.proxy.setMinutes.apply(this.proxy,arguments),this},aW.prototype.setMonth=function(){return this.proxy.setMonth.apply(this.proxy,arguments),this},aW.prototype.setSeconds=function(){return this.proxy.setSeconds.apply(this.proxy,arguments),this},aW.prototype.setTime=function(bH){return this.proxy.setTime(bH),this},aW.prototype.setYear=function(){return this.proxy.setYear.apply(this.proxy,arguments),this},aW.prototype.strftime=function(bH){return bH=bH||this.formatString||aW.regional[this.locale].formatString,aW.strftime(this,bH,this.syntax)},aW.prototype.toString=function(){return this.proxy.toString()},aW.prototype.toYmdInt=function(){return 10000*this.proxy.getFullYear()+100*this.getMonthNumber()+this.proxy.getDate()},aW.regional={en:{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],formatString:"%Y-%m-%d %H:%M:%S"},fr:{monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],formatString:"%Y-%m-%d %H:%M:%S"},de:{monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],formatString:"%Y-%m-%d %H:%M:%S"},es:{monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],dayNamesShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},ru:{monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],formatString:"%Y-%m-%d %H:%M:%S"},ar:{monthNames:["كانون الثاني","شباط","آذار","نيسان","آذار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["السبت","الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة"],dayNamesShort:["سبت","أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة"],formatString:"%Y-%m-%d %H:%M:%S"},pt:{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},"pt-BR":{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},pl:{monthNames:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthNamesShort:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"],dayNames:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],dayNamesShort:["Ni","Pn","Wt","Śr","Cz","Pt","Sb"],formatString:"%Y-%m-%d %H:%M:%S"},nl:{monthNames:["Januari","Februari","Maart","April","Mei","Juni","July","Augustus","September","Oktober","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:",".Zaterdag,dayNamesShort:["Zo","Ma","Di","Wo","Do","Vr","Za"],formatString:"%Y-%m-%d %H:%M:%S"},sv:{monthNames:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],monthNamesShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayNames:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],dayNamesShort:["sön","mån","tis","ons","tor","fre","lör"],formatString:"%Y-%m-%d %H:%M:%S"},it:{monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Lunedi","Martedi","Mercoledi","Giovedi","Venerdi","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],formatString:"%d-%m-%Y %H:%M:%S"}},aW.regional["en-US"]=aW.regional["en-GB"]=aW.regional.en,aW.regional.getLocale=function(){var bH=aW.config.defaultLocale;return document&&document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang&&(bH=document.getElementsByTagName("html")[0].lang,aW.regional.hasOwnProperty(bH)||(bH=aW.config.defaultLocale)),bH};var aV=86400000,aU=function(bI,bH){bI=String(bI);var bK=bH-bI.length,bJ=String(Math.pow(10,bK)).slice(1);return bJ.concat(bI)},aT={millisecond:1,second:1000,minute:60000,hour:3600000,day:aV,week:7*aV,month:{add:function(bI,bH){aT.year.add(bI,Math[bH>0?"floor":"ceil"](bH/12));var bJ=bI.getMonth()+bH%12;12==bJ?(bJ=0,bI.setYear(bI.getFullYear()+1)):-1==bJ&&(bJ=11,bI.setYear(bI.getFullYear()-1)),bI.setMonth(bJ)},diff:function(bI,bH){var bL=bI.getFullYear()-bH.getFullYear(),bK=bI.getMonth()-bH.getMonth()+12*bL,bJ=bI.getDate()-bH.getDate();return bK+bJ/30}},year:{add:function(bI,bH){bI.setYear(bI.getFullYear()+Math[bH>0?"floor":"ceil"](bH))},diff:function(bI,bH){return aT.month.diff(bI,bH)/12}}};for(var aS in aT){"s"!=aS.substring(aS.length-1)&&(aT[aS+"s"]=aT[aS])}var aR=function(bI,bH,bL){if(aW.formats[bL].shortcuts[bH]){return aW.strftime(bI,aW.formats[bL].shortcuts[bH],bL)}var bK=(aW.formats[bL].codes[bH]||"").split("."),bJ=bI["get"+bK[0]]?bI["get"+bK[0]]():"";return bK[1]&&(bJ=aU(bJ,bK[1])),bJ};aW.strftime=function(bP,bO,bN,bM){var bL="perl",bK=aW.regional.getLocale();bN&&aW.formats.hasOwnProperty(bN)?bL=bN:bN&&aW.regional.hasOwnProperty(bN)&&(bK=bN),bM&&aW.formats.hasOwnProperty(bM)?bL=bM:bM&&aW.regional.hasOwnProperty(bM)&&(bK=bM),("[object Object]"!=bb(bP)||"jsDate"!=bP._type)&&(bP=new aW(bP),bP.locale=bK),bO||(bO=bP.formatString||aW.regional[bK].formatString);for(var bJ,bI=bO||"%Y-%m-%d",bH="";bI.length>0;){(bJ=bI.match(aW.formats[bL].codes.matcher))?(bH+=bI.slice(0,bJ.index),bH+=(bJ[1]||"")+aR(bP,bJ[2],bL),bI=bI.slice(bJ.index+bJ[0].length)):(bH+=bI,bI="")}return bH},aW.formats={ISO:"%Y-%m-%dT%H:%M:%S.%N%G",SQL:"%Y-%m-%d %H:%M:%S"},aW.formats.perl={codes:{matcher:/()%(#?(%|[a-z]))/i,Y:"FullYear",y:"ShortYear.2",m:"MonthNumber.2","#m":"MonthNumber",B:"MonthName",b:"AbbrMonthName",d:"Date.2","#d":"Date",e:"Date",A:"DayName",a:"AbbrDayName",w:"Day",H:"Hours.2","#H":"Hours",I:"Hours12.2","#I":"Hours12",p:"AMPM",M:"Minutes.2","#M":"Minutes",S:"Seconds.2","#S":"Seconds",s:"Unix",N:"Milliseconds.3","#N":"Milliseconds",O:"TimezoneOffset",Z:"TimezoneName",G:"GmtOffset"},shortcuts:{F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",D:"%m/%d/%y","#c":"%a %b %e %H:%M:%S %Y",v:"%e-%b-%Y",R:"%H:%M",r:"%I:%M:%S %p",t:"	",n:"\n","%":"%"}},aW.formats.php={codes:{matcher:/()%((%|[a-z]))/i,a:"AbbrDayName",A:"DayName",d:"Date.2",e:"Date",j:"DayOfYear.3",u:"DayOfWeek",w:"Day",U:"FullWeekOfYear.2",V:"IsoWeek.2",W:"WeekOfYear.2",b:"AbbrMonthName",B:"MonthName",m:"MonthNumber.2",h:"AbbrMonthName",C:"Century.2",y:"ShortYear.2",Y:"FullYear",H:"Hours.2",I:"Hours12.2",l:"Hours12",p:"AMPM",P:"AmPm",M:"Minutes.2",S:"Seconds.2",s:"Unix",O:"TimezoneOffset",z:"GmtOffset",Z:"TimezoneAbbr"},shortcuts:{D:"%m/%d/%y",F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",R:"%H:%M",r:"%I:%M:%S %p",t:"	",n:"\n","%":"%"}},aW.createDate=function(bS){function bR(b2,b1){var b0,bZ,bY,bX,bW=parseFloat(b1[1]),bV=parseFloat(b1[2]),bU=parseFloat(b1[3]),bT=aW.config.defaultCentury;return bW>31?(bZ=bU,bY=bV,b0=bT+bW):(bZ=bV,bY=bW,b0=bT+bU),bX=bY+"/"+bZ+"/"+b0,b2.replace(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})/,bX)}if(null==bS){return new Date}if(bS instanceof Date){return bS}if("number"==typeof bS){return new Date(bS)}var bQ=String(bS).replace(/^\s*(.+)\s*$/g,"$1");bQ=bQ.replace(/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,4})/,"$1/$2/$3"),bQ=bQ.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{4})/i,"$1 $2 $3");var bP=bQ.match(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i);if(bP&&bP.length>3){var bO=parseFloat(bP[3]),bN=aW.config.defaultCentury+bO;bN=String(bN),bQ=bQ.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i,bP[1]+" "+bP[2]+" "+bN)}bP=bQ.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})[^0-9]/),bP&&bP.length>3&&(bQ=bR(bQ,bP));var bP=bQ.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})$/);bP&&bP.length>3&&(bQ=bR(bQ,bP));for(var bM,bL,bK,bJ=0,bI=aW.matchers.length,bH=bQ;bI>bJ;){if(bL=Date.parse(bH),!isNaN(bL)){return new Date(bL)}if(bM=aW.matchers[bJ],"function"==typeof bM){if(bK=bM.call(aW,bH),bK instanceof Date){return bK}}else{bH=bQ.replace(bM[0],bM[1])}bJ++}return NaN},aW.daysInMonth=function(bI,bH){return 2==bH?29==new Date(bI,1,29).getDate()?29:28:[a9,31,a9,31,30,31,30,31,31,30,31,30,31][bH]},aW.matchers=[[/(3[01]|[0-2]\d)\s*\.\s*(1[0-2]|0\d)\s*\.\s*([1-9]\d{3})/,"$2/$1/$3"],[/([1-9]\d{3})\s*-\s*(1[0-2]|0\d)\s*-\s*(3[01]|[0-2]\d)/,"$2/$3/$1"],function(bI){var bH=bI.match(/^(?:(.+)\s+)?([012]?\d)(?:\s*\:\s*(\d\d))?(?:\s*\:\s*(\d\d(\.\d*)?))?\s*(am|pm)?\s*$/i);if(bH){if(bH[1]){var bK=this.createDate(bH[1]);if(isNaN(bK)){return}}else{var bK=new Date;bK.setMilliseconds(0)}var bJ=parseFloat(bH[2]);return bH[6]&&(bJ="am"==bH[6].toLowerCase()?12==bJ?0:bJ:12==bJ?12:bJ+12),bK.setHours(bJ,parseInt(bH[3]||0,10),parseInt(bH[4]||0,10),1000*(parseFloat(bH[5]||0)||0)),bK}return bI},function(bI){var bH=bI.match(/^(?:(.+))[T|\s+]([012]\d)(?:\:(\d\d))(?:\:(\d\d))(?:\.\d+)([\+\-]\d\d\:\d\d)$/i);if(bH){if(bH[1]){var bK=this.createDate(bH[1]);if(isNaN(bK)){return}}else{var bK=new Date;bK.setMilliseconds(0)}var bJ=parseFloat(bH[2]);return bK.setHours(bJ,parseInt(bH[3],10),parseInt(bH[4],10),1000*parseFloat(bH[5])),bK}return bI},function(bP){var bO=bP.match(/^([0-3]?\d)\s*[-\/.\s]{1}\s*([a-zA-Z]{3,9})\s*[-\/.\s]{1}\s*([0-3]?\d)$/);if(bO){var bN,bM,bL,bK=new Date,bJ=aW.config.defaultCentury,bI=parseFloat(bO[1]),bH=parseFloat(bO[3]);bI>31?(bM=bH,bN=bJ+bI):(bM=bI,bN=bJ+bH);var bL=bc(bO[2],aW.regional[aW.regional.getLocale()].monthNamesShort);return -1==bL&&(bL=bc(bO[2],aW.regional[aW.regional.getLocale()].monthNames)),bK.setFullYear(bN,bL,bM),bK.setHours(0,0,0,0),bK}return bP}],bF.jsDate=aW,bF.jqplot.sprintf=function(){function bH(bQ,bP,bT,bS){var bR=bQ.length>=bP?"":Array(1+bP-bQ.length>>>0).join(bT);return bS?bQ+bR:bR+bQ}function bO(bP){for(var bR=new String(bP),bQ=10;bQ>0&&bR!=(bR=bR.replace(/^(\d+)(\d{3})/,"$1"+bF.jqplot.sprintf.thousandsSeparator+"$2"));bQ--){}return bR}function bN(bP,bW,bV,bU,bT,bS){var bR=bU-bP.length;if(bR>0){var bQ=" ";bS&&(bQ="&nbsp;"),bP=bV||!bT?bH(bP,bU,bQ,bV):bP.slice(0,bW.length)+bH("",bR,"0",!0)+bP.slice(bW.length)}return bP}function bM(bX,bW,bV,bU,bT,bS,bR,bQ){var bP=bX>>>0;return bV=bV&&bP&&{2:"0b",8:"0",16:"0x"}[bW]||"",bX=bV+bH(bP.toString(bW),bS||0,"0",!1),bN(bX,bV,bU,bT,bR,bQ)}function bL(bQ,bP,bU,bT,bS,bR){return null!=bT&&(bQ=bQ.slice(0,bT)),bN(bQ,"",bP,bU,bS,bR)}var bK=arguments,bJ=0,bI=bK[bJ++];return bI.replace(bF.jqplot.sprintf.regex,function(cd,cc,cb,ca,b9,b8,b7){if("%%"==cd){return"%"}for(var b6=!1,b4="",b2=!1,b0=!1,bY=!1,bW=!1,bU=0;cb&&bU<cb.length;bU++){switch(cb.charAt(bU)){case" ":b4=" ";break;case"+":b4="+";break;case"-":b6=!0;break;case"0":b2=!0;break;case"#":b0=!0;break;case"&":bY=!0;break;case"'":bW=!0}}if(ca=ca?"*"==ca?+bK[bJ++]:"*"==ca.charAt(0)?+bK[ca.slice(1,-1)]:+ca:0,0>ca&&(ca=-ca,b6=!0),!isFinite(ca)){throw new Error("$.jqplot.sprintf: (minimum-)width must be finite")}b8=b8?"*"==b8?+bK[bJ++]:"*"==b8.charAt(0)?+bK[b8.slice(1,-1)]:+b8:"fFeE".indexOf(b7)>-1?6:"d"==b7?0:void 0;var bS=cc?bK[cc.slice(0,-1)]:bK[bJ++];switch(b7){case"s":return null==bS?"":bL(String(bS),b6,ca,b8,b2,bY);case"c":return bL(String.fromCharCode(+bS),b6,ca,b8,b2,bY);case"b":return bM(bS,2,b0,b6,ca,b8,b2,bY);case"o":return bM(bS,8,b0,b6,ca,b8,b2,bY);case"x":return bM(bS,16,b0,b6,ca,b8,b2,bY);case"X":return bM(bS,16,b0,b6,ca,b8,b2,bY).toUpperCase();case"u":return bM(bS,10,b0,b6,ca,b8,b2,bY);case"i":var bR=parseInt(+bS,10);if(isNaN(bR)){return""}var bQ=0>bR?"-":b4,bP=bW?bO(String(Math.abs(bR))):String(Math.abs(bR));return bS=bQ+bH(bP,b8,"0",!1),bN(bS,bQ,b6,ca,b2,bY);case"d":var bR=Math.round(+bS);if(isNaN(bR)){return""}var bQ=0>bR?"-":b4,bP=bW?bO(String(Math.abs(bR))):String(Math.abs(bR));return bS=bQ+bH(bP,b8,"0",!1),bN(bS,bQ,b6,ca,b2,bY);case"e":case"E":case"f":case"F":case"g":case"G":var bR=+bS;if(isNaN(bR)){return""}var bQ=0>bR?"-":b4,b5=["toExponential","toFixed","toPrecision"]["efg".indexOf(b7.toLowerCase())],b3=["toString","toUpperCase"]["eEfFgG".indexOf(b7)%2],bP=Math.abs(bR)[b5](b8),b1=bP.toString().split(".");b1[0]=bW?bO(b1[0]):b1[0],bP=b1.join(bF.jqplot.sprintf.decimalMark),bS=bQ+bP;var bZ=bN(bS,bQ,b6,ca,b2,bY)[b3]();return bZ;case"p":case"P":var bR=+bS;if(isNaN(bR)){return""}var bQ=0>bR?"-":b4,b1=String(Number(Math.abs(bR)).toExponential()).split(/e|E/),bX=-1!=b1[0].indexOf(".")?b1[0].length-1:String(bR).length,bV=b1[1]<0?-b1[1]-1:0;if(Math.abs(bR)<1){bS=b8>=bX+bV?bQ+Math.abs(bR).toPrecision(bX):b8-1>=bX?bQ+Math.abs(bR).toExponential(bX-1):bQ+Math.abs(bR).toExponential(b8-1)}else{var bT=b8>=bX?bX:b8;bS=bQ+Math.abs(bR).toPrecision(bT)}var b3=["toString","toUpperCase"]["pP".indexOf(b7)%2];return bN(bS,bQ,b6,ca,b2,bY)[b3]();case"n":return"";default:return cd}})},bF.jqplot.sprintf.thousandsSeparator=",",bF.jqplot.sprintf.decimalMark=".",bF.jqplot.sprintf.regex=/%%|%(\d+\$)?([-+#0&\' ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([nAscboxXuidfegpEGP])/g,bF.jqplot.getSignificantFigures=function(bI){var bH=String(Number(Math.abs(bI)).toExponential()).split(/e|E/),bN=-1!=bH[0].indexOf(".")?bH[0].length-1:bH[0].length,bM=bH[1]<0?-bH[1]-1:0,bL=parseInt(bH[1],10),bK=bL+1>0?bL+1:0,bJ=bK>=bN?0:bN-bL-1;return{significantDigits:bN,digitsLeft:bK,digitsRight:bJ,zeros:bM,exponent:bL}},bF.jqplot.getPrecision=function(bH){return bF.jqplot.getSignificantFigures(bH).digitsRight};var aQ=bF.uiBackCompat!==!1;bF.jqplot.effects={effect:{}};var aP="jqplot.storage.";bF.extend(bF.jqplot.effects,{version:"1.9pre",save:function(bI,bH){for(var bJ=0;bJ<bH.length;bJ++){null!==bH[bJ]&&bI.data(aP+bH[bJ],bI[0].style[bH[bJ]])}},restore:function(bI,bH){for(var bJ=0;bJ<bH.length;bJ++){null!==bH[bJ]&&bI.css(bH[bJ],bI.data(aP+bH[bJ]))}},setMode:function(bI,bH){return"toggle"===bH&&(bH=bI.is(":hidden")?"show":"hide"),bH},createWrapper:function(bH){if(bH.parent().is(".ui-effects-wrapper")){return bH.parent()}var bL={width:bH.outerWidth(!0),height:bH.outerHeight(!0),"float":bH.css("float")},bK=bF("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),bJ={width:bH.width(),height:bH.height()},bI=document.activeElement;return bH.wrap(bK),(bH[0]===bI||bF.contains(bH[0],bI))&&bF(bI).focus(),bK=bH.parent(),"static"===bH.css("position")?(bK.css({position:"relative"}),bH.css({position:"relative"})):(bF.extend(bL,{position:bH.css("position"),zIndex:bH.css("z-index")}),bF.each(["top","left","bottom","right"],function(bM,bN){bL[bN]=bH.css(bN),isNaN(parseInt(bL[bN],10))&&(bL[bN]="auto")}),bH.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),bH.css(bJ),bK.css(bL).show()},removeWrapper:function(bH){var bI=document.activeElement;return bH.parent().is(".ui-effects-wrapper")&&(bH.parent().replaceWith(bH),(bH[0]===bI||bF.contains(bH[0],bI))&&bF(bI).focus()),bH}}),bF.fn.extend({jqplotEffect:function(bQ,bP,bO,bN){function bM(bR){function bV(){bF.isFunction(bT)&&bT.call(bU[0]),bF.isFunction(bR)&&bR()}var bU=bF(this),bT=bL.complete,bS=bL.mode;(bU.is(":hidden")?"hide"===bS:"show"===bS)?bV():bI.call(bU[0],bL,bV)}var bL=ba.apply(this,arguments),bK=bL.mode,bJ=bL.queue,bI=bF.jqplot.effects.effect[bL.effect],bH=!bI&&aQ&&bF.jqplot.effects[bL.effect];return bF.fx.off||!bI&&!bH?bK?this[bK](bL.duration,bL.complete):this.each(function(){bL.complete&&bL.complete.call(this)}):bI?bJ===!1?this.each(bM):this.queue(bJ||"fx",bM):bH.call(this,{options:bL,duration:bL.duration,callback:bL.complete,mode:bL.mode})}});var bf=/up|down|vertical/,bG=/up|left|vertical|horizontal/;bF.jqplot.effects.effect.blind=function(bV,bU){var bT,bS,bR,bQ=bF(this),bP=["position","top","bottom","left","right","height","width"],bO=bF.jqplot.effects.setMode(bQ,bV.mode||"hide"),bN=bV.direction||"up",bM=bf.test(bN),bL=bM?"height":"width",bK=bM?"top":"left",bJ=bG.test(bN),bI={},bH="show"===bO;bQ.parent().is(".ui-effects-wrapper")?bF.jqplot.effects.save(bQ.parent(),bP):bF.jqplot.effects.save(bQ,bP),bQ.show(),bR=parseInt(bQ.css("top"),10),bT=bF.jqplot.effects.createWrapper(bQ).css({overflow:"hidden"}),bS=bM?bT[bL]()+bR:bT[bL](),bI[bL]=bH?String(bS):"0",bJ||(bQ.css(bM?"bottom":"right",0).css(bM?"top":"left","").css({position:"absolute"}),bI[bK]=bH?"0":String(bS)),bH&&(bT.css(bL,0),bJ||bT.css(bK,bS)),bT.animate(bI,{duration:bV.duration,easing:bV.easing,queue:!1,complete:function(){"hide"===bO&&bQ.hide(),bF.jqplot.effects.restore(bQ,bP),bF.jqplot.effects.removeWrapper(bQ),bU()}})}}(jQuery)




